# Events concerning the Imperial Family
# by Silverswee(e)per

namespace = soh

# IDs 7001-7100 reserved



##### Hurt Shinto MA if someone tries simply removing the Imperial Family

# on_death if the Tenno dies without a dynastic heir
character_event = {
	id = soh.7001
	hide_window = yes
	
	is_triggered_only = yes # on_death
	
	only_playable = yes
	
	religion = shinto
	
	trigger = {
		controls_religion = yes
		
		current_heir = {
			NOT = {
				dynasty = ROOT
			}
		}
		
		NOT = {
			has_global_flag = end_of_the_imperial_family
		}
	}
	
	immediate = {
		set_global_flag = end_of_the_imperial_family # Don't do this more than once...
		
		k_chrysanthemum_throne = {
			unsafe_destroy_landed_title = THIS
		}
		
		any_demesne_title = {
			limit = {
				tier = emperor
			}
			unsafe_destroy_landed_title = THIS
			add_pressed_claim = ROOT
		}
		
		any_demesne_title = {
			limit = {
				tier = king
			}
			unsafe_destroy_landed_title = THIS
			add_pressed_claim = ROOT
		}
		
		any_demesne_title = {
			limit = {
				tier = duke
			}
			unsafe_destroy_landed_title = THIS
			add_pressed_claim = ROOT
		}
		
		# Hurt Shinto MA
		religion_authority = {
			modifier = imperial_family_line_ended
			years = 100
		}
		
		religion_authority = {
			modifier = amaterasu_defied
			years = 1000
		}
		
		# Scatter the Imperial Regalia to the four winds
		if = {
			limit = {
				has_artifact = kusanagi
			}
			
			random_character = { # Expensive, but nice here
				save_event_target_as = new_kusanagi_owner
			}
			
			any_artifact = {
				limit = {
					artifact_type = kusanagi
				}
				transfer_artifact = {
					from = ROOT
					to = event_target:new_kusanagi_owner
				}
			}
		}
		
		if = {
			limit = {
				has_artifact = yata_no_kagami
			}
			
			random_character = { # Expensive, but nice here
				save_event_target_as = new_yata_no_kagami_owner
			}
			
			any_artifact = {
				limit = {
					artifact_type = yata_no_kagami
				}
				transfer_artifact = {
					from = ROOT
					to = event_target:new_yata_no_kagami_owner
				}
			}
		}
		
		if = {
			limit = {
				has_artifact = yasakani_no_magatama
			}
			
			random_character = { # Expensive, but nice here
				save_event_target_as = new_yasakani_no_magatama_owner
			}
			
			any_artifact = {
				limit = {
					artifact_type = yasakani_no_magatama
				}
				
				transfer_artifact = {
					from = ROOT
					to = event_target:new_yasakani_no_magatama_owner
				}
			}
		}
		
		narrative_event = { id = soh.7002 } # Inform the world
	}
}

# Inform the world
narrative_event = {
	id = soh.7002
	title = EVTTITLE_SOH_7002
	desc = EVTDESC_SOH_7002
	picture = GFX_evt_china_civil_war
	border = GFX_event_narrative_frame_religion
	
	major = yes
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			can_have_japanese_bureaucracy_and_feudal_trigger = yes
		}
		
		name = EVTOPTA_SOH_7002 # Oh, no!
		
		ai_chance = {
			factor = 100
		}
	}
	
	option = {
		trigger = {
			true_religion = shinto
			NOT = {
				trait = zealous
			}
		}
		
		name = EVTOPTB_SOH_7002 # I guess Buddhism is the superior religion...
		
		piety = -100
		
		religion = buddhist
		
		add_trait = mahayana_buddhist
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				NOT = {
					culture_group = japonic
				}
			}
			
			mult_modifier = {
				factor = 0.1
				any_owned_bloodline = {
					has_bloodline_flag = imperial_family
					bloodline_is_active_for = PREV
				}
			}
		}
	}
	
	option = {
		trigger = {
			true_religion = shinto
			NOT = {
				trait = zealous
			}
		}
		
		name = EVTOPTC_SOH_7002 # I guess Shugendo is the superior religion...
		
		piety = -100
		
		religion = shugendo
		
		ai_chance = {
			factor = 100
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				NOT = {
					culture_group = japonic
				}
			}
			
			mult_modifier = {
				factor = 0.1
				any_owned_bloodline = {
					has_bloodline_flag = imperial_family
					bloodline_is_active_for = PREV
				}
			}
		}
	}
	
	option = {
		trigger = {
			true_religion = shinto
			NOT = {
				trait = zealous
			}
		}
		
		name = EVTOPTD_SOH_7002 # I guess Koshin is the superior religion...
		
		piety = -100
		
		religion = koshin
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				NOT = {
					culture_group = japonic
				}
			}
			
			mult_modifier = {
				factor = 0.1
				any_owned_bloodline = {
					has_bloodline_flag = imperial_family
					bloodline_is_active_for = PREV
				}
			}
		}
	}
	
	option = {
		trigger = {
			religion = shinto
			NOT = {
				true_religion = shinto
			}
		}
		
		name = EVTOPTE_SOH_7002 # Time to go public!
		
		convert_to_secret_religion = yes
		
		if = {
			limit = {
				religion = buddhist
			}
			add_trait = mahayana_buddhist
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 100
				trait = zealous
			}
			
			mult_modifier = {
				factor = 0.01
				NOR = {
					true_religion = shugendo
					true_religion = koshin
					AND = {
						culture_group = japonic
						true_religion = buddhist
					}
					true_religion = ryukyuan_pagan
					AND = {
						has_dlc = "Holy Fury"
						true_religion = ryukyuan_pagan_reformed
						ryukyuan_pagan_reformed = {
							OR = {
								religion_has_japanese_government_reformation_trigger = yes
								religion_has_divine_imperial_reformation_trigger = yes
							}
						}
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				any_owned_bloodline = {
					has_bloodline_flag = imperial_family
					bloodline_is_active_for = PREV
				}
			}
		}
	}
	
	option = {
		trigger = {
			can_have_japanese_bureaucracy_and_feudal_trigger = no
		}
		
		name = EVTOPTD_SOH_7002 # So much for those "Ten thousand years"!
	}
}



##### Trait/blooldine inheritance

### General on_birth handling of traits/bloodlines

# on_birth handling of traits/bloodlines
character_event = {
	id = soh.7003
	hide_window = yes
	
	is_triggered_only = yes # on_birth
	
	immediate = {
		save_event_target_as = inheritance_sanity_check_character
		
		inheritance_sanity_check_effect = yes
	}
}



##### Marriages

### Handling of the Tenno's marriages

# on_marriage, make damn sure the Tenno isn't matri-married to another dynasty if not female
character_event = {
	id = soh.7004
	hide_window = yes
	
	is_triggered_only = yes
	
	only_playable = yes
	
	religion = shinto
	
	trigger = {
		controls_religion = yes
		is_female = no
		is_married_matrilineally = yes
		spouse = {
			NOT = {
				dynasty = ROOT
			}
		}
	}
	
	immediate = {
		spouse = {
			save_event_target_as = my_spouse
		}
		
		remove_spouse = event_target:my_spouse
		
		add_spouse = event_target:my_spouse
	}
}

# on_marriage, make damn sure the Tenno isn't regularly married to another dynasty if female
character_event = {
	id = soh.7005
	hide_window = yes
	
	is_triggered_only = yes
	
	only_playable = yes
	
	religion = shinto
	
	trigger = {
		controls_religion = yes
		is_female = yes
		is_married_matrilineally = no
		spouse = {
			NOT = {
				dynasty = ROOT
			}
		}
	}
	
	immediate = {
		spouse = {
			save_event_target_as = my_spouse
		}
		
		remove_spouse = event_target:my_spouse
		
		add_spouse_matrilineal = event_target:my_spouse # Still very wrong, but...
	}
}



##### Imperial Family restoration + conversion

# on_yearly_pulse Imperial Family restoration for the AI
character_event = {
	id = soh.7006
	hide_window = yes
	
	is_triggered_only = yes # on_yearly_pulse
	
	only_playable = yes
	
	religion = shinto
	
	trigger = {
		controls_religion = yes
		ai = yes # The player has a decision for a reason
		NOT = {
			any_dynasty_member = {
				count = 10
				is_possible_tenno_trigger = yes
			}
		}
	}
	
	immediate = {
		any_owned_bloodline = {
			limit = {
				has_bloodline_flag = imperial_family
			}
			
			random_bloodline_member = {
				limit = {
					religion = shinto
					could_be_restored_to_imperial_family_potential_trigger = yes
					could_be_restored_to_imperial_family_allow_trigger = yes
					could_be_restored_to_imperial_family_ai_qualifier = yes
				}
				
				preferred_limit = {
					OR = {
						is_friend = ROOT
						is_lover = ROOT
						is_close_relative = ROOT
					}
				}
				
				preferred_limit = {
					reverse_opinion = {
						who = ROOT
						value >= 75
					}
				}
				
				preferred_limit = {
					reverse_opinion = {
						who = ROOT
						value >= 50
					}
				}
				
				preferred_limit = {
					reverse_opinion = {
						who = ROOT
						value >= 25
					}
				}
				
				preferred_limit = {
					reverse_opinion = {
						who = ROOT
						value >= 0
					}
				}
				
				preferred_limit = {
					NOT = {
						is_rival = ROOT
					}
				}
				
				# Rejoin the Imperial Family, with ancestors
				dynasty = 1000027000 # Imperial Family
				
				forefathers_join_imperial_family_effect = yes
				
				clr_character_flag = got_minamoto_surname
				
				clr_character_flag = got_taira_surname
			}
		}
	}
}

# Japonic Buddhist/sensible Ryukyuan/Shugendo/Koshin member of the Imperial Family might convert on_yearly_pulse
character_event = {
	id = soh.7007
	hide_window = yes
	
	is_triggered_only = yes # on_yearly_pulse
	
	only_playable = yes
	
	religion = shinto
	
	trigger = {
		controls_religion = yes
		NOT = {
			any_dynasty_member = {
				count = 10
				is_possible_tenno_trigger = yes
			}
		}
	}
	
	immediate = {
		random_dynasty_member = {
			limit = {
				is_landed = no
				is_possible_tenno_not_shinto_trigger = yes
				OR = {
					true_religion = shinto
					NOT = {
						trait = zealous
					}
				}
			}
			
			preferred_limit = {
				true_religion = shinto
			}
			
			preferred_limit = {
				OR = {
					is_friend = ROOT
					is_lover = ROOT
					is_close_relative = ROOT
				}
			}
			
			preferred_limit = {
				reverse_opinion = {
					who = ROOT
					value >= 75
				}
			}
			
			preferred_limit = {
				reverse_opinion = {
					who = ROOT
					value >= 50
				}
			}
			
			preferred_limit = {
				reverse_opinion = {
					who = ROOT
					value >= 25
				}
			}
			
			preferred_limit = {
				reverse_opinion = {
					who = ROOT
					value >= 0
				}
			}
			
			preferred_limit = {
				NOT = {
					is_rival = ROOT
				}
			}
			
			religion = shinto
		}
	}
}

# on_new_holder/_inheritance/_usurpation event to fire the two above
character_event = {
	id = soh.7008
	hide_window = yes
	
	is_triggered_only = yes # on_new_holder/_inheritance/_usurpation
	
	only_playable = yes
	
	religion = shinto
	
	trigger = {
		FROM = {
			title = k_chrysanthemum_throne
		}
	}
	
	immediate = {
		if = {
			limit = {
				ai = yes
			}
			
			character_event = { id = soh.7006 } # Maybe restore a former member of the Imperial Family
		}
		
		character_event = { id = soh.7007 } # Maybe convert someone
	}
}



##### Regnal names and spare empire destruction for the Tenno

### Empire destruction

# Make sure the Tenno never holds more than one emperor-tier title
character_event = {
	id = soh.7009
	hide_window = yes
	
	is_triggered_only = yes # on_new_holder/_inheritance/_usurpation
	
	only_playable = yes
	
	religion = shinto
	
	trigger = {
		FROM = {
			tier = emperor
		}
		
		OR = {
			controls_religion = yes
			has_character_flag = temporarily_japanese_imperial
		}
		
		NOT = {
			has_character_flag = restoring_japan # Handled explicitly
		}
		
		num_of_emperor_titles = 2
	}
	
	immediate = {
		if = {
			limit = {
				has_landed_title = e_japan
				e_japan = {
					is_primary_holder_title = yes
				}
			}
			
			any_demesne_title = {
				limit = {
					tier = emperor
					NOT = {
						title = e_japan
					}
				}
				unsafe_destroy_landed_title = THIS
				add_pressed_claim = ROOT
			}
		}
		
		else_if = {
			limit = {
				has_landed_title = e_japan
				e_japan = {
					is_primary_holder_title = no
				}
			}
			
			e_japan = {
				make_primary_title = yes
			}
			
			any_demesne_title = {
				limit = {
					tier = emperor
					NOT = {
						title = e_japan
					}
				}
				unsafe_destroy_landed_title = THIS
				add_pressed_claim = ROOT
			}
		}
		
		else = {
			primary_title = {
				set_title_flag = keep_this_title
			}
			
			any_demesne_title = {
				limit = {
					tier = emperor
					NOT = {
						has_title_flag = keep_this_title
					}
				}
				
				unsafe_destroy_landed_title = THIS
				add_pressed_claim = ROOT
			}
			
			primary_title = {
				clr_title_flag = keep_this_title
			}
		}
	}
}

### Regnal names

# Various on_new_holder on_actions event
character_event = {
	id = soh.7010
	hide_window = yes
	
	only_playable = yes
	
	religion = shinto
	
	is_triggered_only = yes # on_new_holder/_inheritance/_usurpation
	
	trigger = {
		FROM = {
			title = k_chrysanthemum_throne
		}
		NOT = {
			has_character_flag = temporarily_japanese_imperial # Not a real ruler change
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = {
					has_character_flag = do_not_rename_me # Northern Court
				}
			}
			
			character_event = { id = soh.7011 days = 1 } # Needs to be offset
		}
		
		else = {
			clr_character_flag = do_not_rename_me
		}
	}
}

# Delayed event for picking a name
character_event = {
	id = soh.7011
	desc = EVTDESC_SOH_7011
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	only_playable = yes
	
	religion = shinto
	
	trigger = {
		controls_religion = yes
	}
	
	immediate = {
		pull_tenno_names_out_of_a_hat_effect = yes
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_jimmu
		}
		
		name = JIMMU
		
		set_name = "Jimmu"
		
		set_character_flag = emperor_jimmu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_jimmu_used
					}
				}
				
				set_title_flag = emperor_jimmu_used
			}
			
			else = {
				set_title_flag = emperor_jimmu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_suizei
		}
		
		name = SUIZEI
		
		set_name = "Suizei"
		
		set_character_flag = emperor_suizei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_suizei_used
					}
				}
				
				set_title_flag = emperor_suizei_used
			}
			
			else = {
				set_title_flag = emperor_suizei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_annei
		}
		
		name = ANNEI
		
		set_name = "Annei"
		
		set_character_flag = emperor_annei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_annei_used
					}
				}
				
				set_title_flag = emperor_annei_used
			}
			
			else = {
				set_title_flag = emperor_annei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_itoku
		}
		
		name = ITOKU
		
		set_name = "Itoku"
		
		set_character_flag = emperor_itoku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_itoku_used
					}
				}
				
				set_title_flag = emperor_itoku_used
			}
			
			else = {
				set_title_flag = emperor_itoku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kosho
		}
		
		name = KOSHO
		
		set_name = "Kosho"
		
		set_character_flag = emperor_kosho_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kosho_used
					}
				}
				
				set_title_flag = emperor_kosho_used
			}
			
			else = {
				set_title_flag = emperor_kosho_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_koan
		}
		
		name = KOAN
		
		set_name = "Koan"
		
		set_character_flag = emperor_koan_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_koan_used
					}
				}
				
				set_title_flag = emperor_koan_used
			}
			
			else = {
				set_title_flag = emperor_koan_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_korei
		}
		
		name = KOREI
		
		set_name = "Korei"
		
		set_character_flag = emperor_korei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_korei_used
					}
				}
				
				set_title_flag = emperor_korei_used
			}
			
			else = {
				set_title_flag = emperor_korei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kogen
		}
		
		name = KOGEN
		
		set_name = "Kogen"
		
		set_character_flag = emperor_kogen_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kogen_used
					}
				}
				
				set_title_flag = emperor_kogen_used
			}
			
			else = {
				set_title_flag = emperor_kogen_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kaika
		}
		
		name = KAIKA
		
		set_name = "Kaika"
		
		set_character_flag = emperor_kaika_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kaika_used
					}
				}
				
				set_title_flag = emperor_kaika_used
			}
			
			else = {
				set_title_flag = emperor_kaika_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_sujin
		}
		
		name = SUJIN
		
		set_name = "Sujin"
		
		set_character_flag = emperor_sujin_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_sujin_used
					}
				}
				
				set_title_flag = emperor_sujin_used
			}
			
			else = {
				set_title_flag = emperor_sujin_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_suinin
		}
		
		name = SUININ
		
		set_name = "Suinin"
		
		set_character_flag = emperor_suinin_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_suinin_used
					}
				}
				
				set_title_flag = emperor_suinin_used
			}
			
			else = {
				set_title_flag = emperor_suinin_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_keiko
		}
		
		name = KEIKO
		
		set_name = "Keiko"
		
		set_character_flag = emperor_keiko_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_keiko_used
					}
				}
				
				set_title_flag = emperor_keiko_used
			}
			
			else = {
				set_title_flag = emperor_keiko_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_seimu
		}
		
		name = SEIMU
		
		set_name = "Seimu"
		
		set_character_flag = emperor_seimu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_seimu_used
					}
				}
				
				set_title_flag = emperor_seimu_used
			}
			
			else = {
				set_title_flag = emperor_seimu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_chuai
		}
		
		name = CHUAI
		
		set_name = "Chuai"
		
		set_character_flag = emperor_chuai_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_chuai_used
					}
				}
				
				set_title_flag = emperor_chuai_used
			}
			
			else = {
				set_title_flag = emperor_chuai_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_jingu
		}
		
		name = JINGU
		
		set_name = "Jingu"
		
		set_character_flag = emperor_jingu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_jingu_used
					}
				}
				
				set_title_flag = emperor_jingu_used
			}
			
			else = {
				set_title_flag = emperor_jingu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_ojin
		}
		
		name = OJIN
		
		set_name = "Ojin"
		
		set_character_flag = emperor_ojin_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_ojin_used
					}
				}
				
				set_title_flag = emperor_ojin_used
			}
			
			else = {
				set_title_flag = emperor_ojin_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_richu
		}
		
		name = RICHU
		
		set_name = "Richu"
		
		set_character_flag = emperor_richu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_richu_used
					}
				}
				
				set_title_flag = emperor_richu_used
			}
			
			else = {
				set_title_flag = emperor_richu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_hanzei
		}
		
		name = HANZEI
		
		set_name = "Hanzei"
		
		set_character_flag = emperor_hanzei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_hanzei_used
					}
				}
				
				set_title_flag = emperor_hanzei_used
			}
			
			else = {
				set_title_flag = emperor_hanzei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_ingyo
		}
		
		name = INGYO
		
		set_name = "Ingyo"
		
		set_character_flag = emperor_ingyo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_ingyo_used
					}
				}
				
				set_title_flag = emperor_ingyo_used
			}
			
			else = {
				set_title_flag = emperor_ingyo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_anko
		}
		
		name = ANKO
		
		set_name = "Anko"
		
		set_character_flag = emperor_anko_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_anko_used
					}
				}
				
				set_title_flag = emperor_anko_used
			}
			
			else = {
				set_title_flag = emperor_anko_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_yuryaku
		}
		
		name = YURYAKU
		
		set_name = "Yuryaku"
		
		set_character_flag = emperor_yuryaku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_yuryaku_used
					}
				}
				
				set_title_flag = emperor_yuryaku_used
			}
			
			else = {
				set_title_flag = emperor_yuryaku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_seinei
		}
		
		name = SEINEI
		
		set_name = "Seinei"
		
		set_character_flag = emperor_seinei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_seinei_used
					}
				}
				
				set_title_flag = emperor_seinei_used
			}
			
			else = {
				set_title_flag = emperor_seinei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_tsunuzashi
		}
		
		name = TSUNUZASHI
		
		set_name = "Tsunuzashi"
		
		set_character_flag = emperor_tsunuzashi_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_tsunuzashi_used
					}
				}
				
				set_title_flag = emperor_tsunuzashi_used
			}
			
			else = {
				set_title_flag = emperor_tsunuzashi_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kenzo
		}
		
		name = KENZO
		
		set_name = "Kenzo"
		
		set_character_flag = emperor_kenzo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kenzo_used
					}
				}
				
				set_title_flag = emperor_kenzo_used
			}
			
			else = {
				set_title_flag = emperor_kenzo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_ninken
		}
		
		name = NINKEN
		
		set_name = "Ninken"
		
		set_character_flag = emperor_ninken_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_ninken_used
					}
				}
				
				set_title_flag = emperor_ninken_used
			}
			
			else = {
				set_title_flag = emperor_ninken_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_buretsu
		}
		
		name = BURETSU
		
		set_name = "Buretsu"
		
		set_character_flag = emperor_buretsu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_buretsu_used
					}
				}
				
				set_title_flag = emperor_buretsu_used
			}
			
			else = {
				set_title_flag = emperor_buretsu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_ankan
		}
		
		name = ANKAN
		
		set_name = "Ankan"
		
		set_character_flag = emperor_ankan_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_ankan_used
					}
				}
				
				set_title_flag = emperor_ankan_used
			}
			
			else = {
				set_title_flag = emperor_ankan_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_senka
		}
		
		name = SENKA
		
		set_name = "Senka"
		
		set_character_flag = emperor_senka_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_senka_used
					}
				}
				
				set_title_flag = emperor_senka_used
			}
			
			else = {
				set_title_flag = emperor_senka_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_oka
		}
		
		name = OKA
		
		set_name = "Oka"
		
		set_character_flag = emperor_oka_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_oka_used
					}
				}
				
				set_title_flag = emperor_oka_used
			}
			
			else = {
				set_title_flag = emperor_oka_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_sudojinkei
		}
		
		name = SUDOJINKEI
		
		set_name = "Sudojinkei"
		
		set_character_flag = emperor_sudojinkei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_sudojinkei_used
					}
				}
				
				set_title_flag = emperor_sudojinkei_used
			}
			
			else = {
				set_title_flag = emperor_sudojinkei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kasuga
		}
		
		name = KASUGA
		
		set_name = "Kasuga"
		
		set_character_flag = emperor_kasuga_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kasuga_used
					}
				}
				
				set_title_flag = emperor_kasuga_used
			}
			
			else = {
				set_title_flag = emperor_kasuga_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_sudo
		}
		
		name = SUDO # MAKE ME A SANDWICH!
		
		set_name = "Sudo"
		
		set_character_flag = emperor_sudo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_sudo_used
					}
				}
				
				set_title_flag = emperor_sudo_used
			}
			
			else = {
				set_title_flag = emperor_sudo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kinmei
		}
		
		name = KINMEI
		
		set_name = "Kinmei"
		
		set_character_flag = emperor_kinmei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kinmei_used
					}
				}
				
				set_title_flag = emperor_kinmei_used
			}
			
			else = {
				set_title_flag = emperor_kinmei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_bidatsu
		}
		
		name = BIDATSU
		
		set_name = "Bidatsu"
		
		set_character_flag = emperor_bidatsu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_bidatsu_used
					}
				}
				
				set_title_flag = emperor_bidatsu_used
			}
			
			else = {
				set_title_flag = emperor_bidatsu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_yomei
		}
		
		name = YOMEI
		
		set_name = "Yomei"
		
		set_character_flag = emperor_yomei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_yomei_used
					}
				}
				
				set_title_flag = emperor_yomei_used
			}
			
			else = {
				set_title_flag = emperor_yomei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_sushun
		}
		
		name = SUSHUN
		
		set_name = "Sushun"
		
		set_character_flag = emperor_sushun_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_sushun_used
					}
				}
				
				set_title_flag = emperor_sushun_used
			}
			
			else = {
				set_title_flag = emperor_sushun_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_suiko
		}
		
		name = SUIKO
		
		set_name = "Suiko"
		
		set_character_flag = emperor_suiko_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_suiko_used
					}
				}
				
				set_title_flag = emperor_suiko_used
			}
			
			else = {
				set_title_flag = emperor_suiko_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_jomei
		}
		
		name = JOMEI
		
		set_name = "Jomei"
		
		set_character_flag = emperor_jomei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_jomei_used
					}
				}
				
				set_title_flag = emperor_jomei_used
			}
			
			else = {
				set_title_flag = emperor_jomei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kogyoku
		}
		
		name = KOGYOKU
		
		set_name = "Kogyoku"
		
		set_character_flag = emperor_kogyoku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kogyoku_used
					}
				}
				
				set_title_flag = emperor_kogyoku_used
			}
			
			else = {
				set_title_flag = emperor_kogyoku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kotoku
		}
		
		name = KOTOKU
		
		set_name = "Kotoku"
		
		set_character_flag = emperor_kotoku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kotoku_used
					}
				}
				
				set_title_flag = emperor_kotoku_used
			}
			
			else = {
				set_title_flag = emperor_kotoku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_saimei
		}
		
		name = SAIMEI
		
		set_name = "Saimei"
		
		set_character_flag = emperor_saimei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_saimei_used
					}
				}
				
				set_title_flag = emperor_saimei_used
			}
			
			else = {
				set_title_flag = emperor_saimei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_tenji
		}
		
		name = TENJI
		
		set_name = "Tenji"
		
		set_character_flag = emperor_tenji_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_tenji_used
					}
				}
				
				set_title_flag = emperor_tenji_used
			}
			
			else = {
				set_title_flag = emperor_tenji_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kobun
		}
		
		name = KOBUN
		
		set_name = "Kobun"
		
		set_character_flag = emperor_kobun_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kobun_used
					}
				}
				
				set_title_flag = emperor_kobun_used
			}
			
			else = {
				set_title_flag = emperor_kobun_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_tenmu
		}
		
		name = TENMU
		
		set_name = "Tenmu"
		
		set_character_flag = emperor_tenmu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_tenmu_used
					}
				}
				
				set_title_flag = emperor_tenmu_used
			}
			
			else = {
				set_title_flag = emperor_tenmu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_jito
		}
		
		name = JITO
		
		set_name = "Jito"
		
		set_character_flag = emperor_jito_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_jito_used
					}
				}
				
				set_title_flag = emperor_jito_used
			}
			
			else = {
				set_title_flag = emperor_jito_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_monmu
		}
		
		name = MONMU
		
		set_name = "Monmu"
		
		set_character_flag = emperor_monmu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_monmu_used
					}
				}
				
				set_title_flag = emperor_monmu_used
			}
			
			else = {
				set_title_flag = emperor_monmu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_genmei
		}
		
		name = GENMEI
		
		set_name = "Genmei"
		
		set_character_flag = emperor_genmei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_genmei_used
					}
				}

				set_title_flag = emperor_genmei_used
			}
			
			else = {
				set_title_flag = emperor_genmei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_gensho
		}
		
		name = GENSHO
		
		set_name = "Gensho"
		
		set_character_flag = emperor_gensho_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_gensho_used
					}
				}
				
				set_title_flag = emperor_gensho_used
			}
			
			else = {
				set_title_flag = emperor_gensho_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_shomu
		}
		
		name = SHOMU
		
		set_name = "Shomu"
		
		set_character_flag = emperor_shomu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_shomu_used
					}
				}
				
				set_title_flag = emperor_shomu_used
			}
			
			else = {
				set_title_flag = emperor_shomu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_koken
		}
		
		name = KOKEN
		
		set_name = "Koken"
		
		set_character_flag = emperor_koken_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_koken_used
					}
				}
				
				set_title_flag = emperor_koken_used
			}
			
			else = {
				set_title_flag = emperor_koken_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_junnin
		}
		
		name = JUNNIN
		
		set_name = "Junnin"
		
		set_character_flag = emperor_junnin_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_junnin_used
					}
				}
				
				set_title_flag = emperor_junnin_used
			}
			
			else = {
				set_title_flag = emperor_junnin_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kashiwabara
		}
		
		name = KASHIWABARA
		
		set_name = "Kashiwabara"
		
		set_character_flag = emperor_kashiwabara_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kashiwabara_used
					}
				}
				
				set_title_flag = emperor_kashiwabara_used
			}
			
			else = {
				set_title_flag = emperor_kashiwabara_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_nara
		}
		
		name = NARA
		
		set_name = "Nara"
		
		set_character_flag = emperor_nara_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_nara_used
					}
				}
				
				set_title_flag = emperor_nara_used
			}
			
			else = {
				set_title_flag = emperor_nara_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_ogimachi
		}
		
		name = OGIMACHI
		
		set_name = "Ogimachi"
		
		set_character_flag = emperor_ogimachi_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_ogimachi_used
					}
				}
				
				set_title_flag = emperor_ogimachi_used
			}
			
			else = {
				set_title_flag = emperor_ogimachi_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_mizunoo
		}
		
		name = MIZUNOO
		
		set_name = "Mizunoo"
		
		set_character_flag = emperor_mizunoo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_mizunoo_used
					}
				}
				
				set_title_flag = emperor_mizunoo_used
			}
			
			else = {
				set_title_flag = emperor_mizunoo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_minoo
		}
		
		name = MINOO
		
		set_name = "Minoo"
		
		set_character_flag = emperor_minoo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_minoo_used
					}
				}
				
				set_title_flag = emperor_minoo_used
			}
			
			else = {
				set_title_flag = emperor_minoo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_meisho
		}
		
		name = MEISHO
		
		set_name = "Meisho"
		
		set_character_flag = emperor_meisho_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_meisho_used
					}
				}
				
				set_title_flag = emperor_meisho_used
			}
			
			else = {
				set_title_flag = emperor_meisho_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_sai
		}
		
		name = SAI
		
		set_name = "Sai"
		
		set_character_flag = emperor_sai_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_sai_used
					}
				}
				
				set_title_flag = emperor_sai_used
			}
			
			else = {
				set_title_flag = emperor_sai_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_reigen
		}
		
		name = REIGEN
		
		set_name = "Reigen"
		
		set_character_flag = emperor_reigen_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_reigen_used
					}
				}
				
				set_title_flag = emperor_reigen_used
			}
			
			else = {
				set_title_flag = emperor_reigen_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_higashiyama
		}
		
		name = HIGASHIYAMA
		
		set_name = "Higashiyama"
		
		set_character_flag = emperor_higashiyama_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_higashiyama_used
					}
				}
				
				set_title_flag = emperor_higashiyama_used
			}
			
			else = {
				set_title_flag = emperor_higashiyama_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_nakamikado
		}
		
		name = NAKAMIKADO
		
		set_name = "Nakamikado"
		
		set_character_flag = emperor_nakamikado_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_nakamikado_used
					}
				}
				
				set_title_flag = emperor_nakamikado_used
			}
			
			else = {
				set_title_flag = emperor_nakamikado_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_sakuramachi
		}
		
		name = SAKURAMACHI
		
		set_name = "Sakuramachi"
		
		set_character_flag = emperor_sakuramachi_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_sakuramachi_used
					}
				}
				
				set_title_flag = emperor_sakuramachi_used
			}
			
			else = {
				set_title_flag = emperor_sakuramachi_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_momozono
		}
		
		name = MOMOZONO
		
		set_name = "Momozono"
		
		set_character_flag = emperor_momozono_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_momozono_used
					}
				}
				
				set_title_flag = emperor_momozono_used
			}
			
			else = {
				set_title_flag = emperor_momozono_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kokaku
		}
		
		name = KOKAKU
		
		set_name = "Kokaku"
		
		set_character_flag = emperor_kokaku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kokaku_used
					}
				}
				
				set_title_flag = emperor_kokaku_used
			}
			
			else = {
				set_title_flag = emperor_kokaku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_ninko
		}
		
		name = NINKO
		
		set_name = "Ninko"
		
		set_character_flag = emperor_ninko_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_ninko_used
					}
				}
				
				set_title_flag = emperor_ninko_used
			}
			
			else = {
				set_title_flag = emperor_ninko_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_komei
		}
		
		name = KOMEI
		
		set_name = "Komei"
		
		set_character_flag = emperor_komei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_komei_used
					}
				}
				
				set_title_flag = emperor_komei_used
			}
			
			else = {
				set_title_flag = emperor_komei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_chokei
		}
		
		name = CHOKEI
		
		set_name = "Chokei"
		
		set_character_flag = emperor_chokei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_chokei_used
					}
				}
				
				set_title_flag = emperor_chokei_used
			}
			
			else = {
				set_title_flag = emperor_chokei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_shoko
		}
		
		name = SHOKO
		
		set_name = "Shoko"
		
		set_character_flag = emperor_shoko_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_shoko_used
					}
				}
				
				set_title_flag = emperor_shoko_used
			}
			
			else = {
				set_title_flag = emperor_shoko_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_komyo
		}
		
		name = KOMYO
		
		set_name = "Komyo"
		
		set_character_flag = emperor_komyo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_komyo_used
					}
				}
				
				set_title_flag = emperor_komyo_used
			}
			
			else = {
				set_title_flag = emperor_komyo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_suko
		}
		
		name = SUKO
		
		set_name = "Suko"
		
		set_character_flag = emperor_suko_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_suko_used
					}
				}
				
				set_title_flag = emperor_suko_used
			}
			
			else = {
				set_title_flag = emperor_suko_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kogo
		}
		
		name = KOGO
		
		set_name = "Kogo"
		
		set_character_flag = emperor_kogo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kogo_used
					}
				}
				
				set_title_flag = emperor_kogo_used
			}
			
			else = {
				set_title_flag = emperor_kogo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_komatsu
		}
		
		name = KOMATSU
		
		set_name = "Komatsu"
		
		set_character_flag = emperor_komatsu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_komatsu_used
					}
				}
				
				set_title_flag = emperor_komatsu_used
			}
			
			else = {
				set_title_flag = emperor_komatsu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_shotoku
		}
		
		name = SHOTOKU
		
		set_name = "Shotoku"
		
		set_character_flag = emperor_shotoku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_shotoku_used
					}
				}
				
				set_title_flag = emperor_shotoku_used
			}
			
			else = {
				set_title_flag = emperor_shotoku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_konin
		}
		
		name = KONIN
		
		set_name = "Konin"
		
		set_character_flag = emperor_konin_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_konin_used
					}
				}
				
				set_title_flag = emperor_konin_used
			}
			
			else = {
				set_title_flag = emperor_konin_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kanmu
		}
		
		name = KANMU
		
		set_name = "Kanmu"
		
		set_character_flag = emperor_kanmu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kanmu_used
					}
				}
				
				set_title_flag = emperor_kanmu_used
			}
			
			else = {
				set_title_flag = emperor_kanmu_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_heizei
		}
		
		name = HEIZEI
		
		set_name = "Heizei"
		
		set_character_flag = emperor_heizei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_heizei_used
					}
				}
				
				set_title_flag = emperor_heizei_used
			}
			
			else = {
				set_title_flag = emperor_heizei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_junna
		}
		
		name = JUNNA
		
		set_name = "Junna"
		
		set_character_flag = emperor_junna_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_junna_used
					}
				}
				
				set_title_flag = emperor_junna_used
			}
			
			else = {
				set_title_flag = emperor_junna_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_montoku
		}
		
		name = MONTOKU
		
		set_name = "Montoku"
		
		set_character_flag = emperor_montoku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_montoku_used
					}
				}
				
				set_title_flag = emperor_montoku_used
			}
			
			else = {
				set_title_flag = emperor_montoku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_seiwa
		}
		
		name = SEIWA
		
		set_name = "Seiwa"
		
		set_character_flag = emperor_seiwa_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_seiwa_used
					}
				}
				
				set_title_flag = emperor_seiwa_used
			}
			
			else = {
				set_title_flag = emperor_seiwa_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_yozei
		}
		
		name = YOZEI
		
		set_name = "Yozei"
		
		set_character_flag = emperor_yozei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_yozei_used
					}
				}
				
				set_title_flag = emperor_yozei_used
			}
			
			else = {
				set_title_flag = emperor_yozei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_koko
		}
		
		name = KOKO
		
		set_name = "Koko"
		
		set_character_flag = emperor_koko_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_koko_used
					}
				}
				
				set_title_flag = emperor_koko_used
			}
			
			else = {
				set_title_flag = emperor_koko_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_murakami
		}
		
		name = MURAKAMI
		
		set_name = "Murakami"
		
		set_character_flag = emperor_murakami_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_murakami_used
					}
				}
				
				set_title_flag = emperor_murakami_used
			}
			
			else = {
				set_title_flag = emperor_murakami_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_enyu
		}
		
		name = ENYU
		
		set_name = "En'yu"
		
		set_character_flag = emperor_enyu_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_enyu_used
					}
				}
				
				set_title_flag = emperor_enyu_used
			}
			
			else = {
				set_title_flag = emperor_enyu_used
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kazan
		}
		
		name = KAZAN
		
		set_name = "Kazan"
		
		set_character_flag = emperor_kazan_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kazan_used
					}
				}
				
				set_title_flag = emperor_kazan_used
			}
			
			else = {
				set_title_flag = emperor_kazan_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_sutoku
		}
		
		name = SUTOKU
		
		set_name = "Sutoku"
		
		set_character_flag = emperor_sutoku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_sutoku_used
					}
				}
				
				set_title_flag = emperor_sutoku_used
			}
			
			else = {
				set_title_flag = emperor_sutoku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_konoe
		}
		
		name = KONOE
		
		set_name = "Konoe"
		
		set_character_flag = emperor_konoe_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_konoe_used
					}
				}
				
				set_title_flag = emperor_konoe_used
			}
			
			else = {
				set_title_flag = emperor_konoe_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_rokujo
		}
		
		name = ROKUJO
		
		set_name = "Rokujo"
		
		set_character_flag = emperor_rokujo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_rokujo_used
					}
				}
				
				set_title_flag = emperor_rokujo_used
			}
			
			else = {
				set_title_flag = emperor_rokujo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_takakura
		}
		
		name = TAKAKURA
		
		set_name = "Takakura"
		
		set_character_flag = emperor_takakura_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_takakura_used
					}
				}
				
				set_title_flag = emperor_takakura_used
			}
			
			else = {
				set_title_flag = emperor_takakura_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_antoku
		}
		
		name = ANTOKU
		
		set_name = "Antoku"
		
		set_character_flag = emperor_antoku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_antoku_used
					}
				}
				
				set_title_flag = emperor_antoku_used
			}
			
			else = {
				set_title_flag = emperor_antoku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_tsuchimikado
		}
		
		name = TSUCHIMIKADO
		
		set_name = "Tsuchimikado"
		
		set_character_flag = emperor_tsuchimikado_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_tsuchimikado_used
					}
				}
				
				set_title_flag = emperor_tsuchimikado_used
			}
			
			else = {
				set_title_flag = emperor_tsuchimikado_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_juntoku
		}
		
		name = JUNTOKU
		
		set_name = "Juntoku"
		
		set_character_flag = emperor_juntoku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_juntoku_used
					}
				}
				
				set_title_flag = emperor_juntoku_used
			}
			
			else = {
				set_title_flag = emperor_juntoku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_shijo
		}
		
		name = SHIJO
		
		set_name = "Shijo"
		
		set_character_flag = emperor_shijo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_shijo_used
					}
				}
				
				set_title_flag = emperor_shijo_used
			}
			
			else = {
				set_title_flag = emperor_shijo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_kameyama
		}
		
		name = KAMEYAMA
		
		set_name = "Kameyama"
		
		set_character_flag = emperor_kameyama_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_kameyama_used
					}
				}
				
				set_title_flag = emperor_kameyama_used
			}
			
			else = {
				set_title_flag = emperor_kameyama_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_hanazono
		}
		
		name = HANAZONO
		
		set_name = "Hanazono"
		
		set_character_flag = emperor_hanazono_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_hanazono_used
					}
				}
				
				set_title_flag = emperor_hanazono_used
			}
			
			else = {
				set_title_flag = emperor_hanazono_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_ichijo
		}
		
		name = ICHIJO
		
		set_name = "Ichijo"
		
		set_character_flag = emperor_ichijo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_ichijo_used
					}
				}
				
				set_title_flag = emperor_ichijo_used
			}
			
			else = {
				set_title_flag = emperor_ichijo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_suzaku
		}
		
		name = SUZAKU
		
		set_name = "Suzaku"
		
		set_character_flag = emperor_suzaku_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_suzaku_used
					}
				}
				
				set_title_flag = emperor_suzaku_used
			}
			
			else = {
				set_title_flag = emperor_suzaku_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_reizei
		}
		
		name = REIZEI
		
		set_name = "Reizei"
		
		set_character_flag = emperor_reizei_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_reizei_used
					}
				}
				
				set_title_flag = emperor_reizei_used
			}
			
			else = {
				set_title_flag = emperor_reizei_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_sanjo
		}
		
		name = SANJO
		
		set_name = "Sanjo"
		
		set_character_flag = emperor_sanjo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_sanjo_used
					}
				}
				
				set_title_flag = emperor_sanjo_used
			}
			
			else = {
				set_title_flag = emperor_sanjo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_shirakawa
		}
		
		name = SHIRAKAWA
		
		set_name = "Shirakawa"
		
		set_character_flag = emperor_shirakawa_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_shirakawa_used
					}
				}
				
				set_title_flag = emperor_shirakawa_used
			}
			
			else = {
				set_title_flag = emperor_shirakawa_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_horikawa
		}
		
		name = HORIKAWA
		
		set_name = "Horikawa"
		
		set_character_flag = emperor_horikawa_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_horikawa_used
					}
				}
				
				set_title_flag = emperor_horikawa_used
			}
			
			else = {
				set_title_flag = emperor_horikawa_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_toba
		}
		
		name = TOBA
		
		set_name = "Toba"
		
		set_character_flag = emperor_toba_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_toba_used
					}
				}
				
				set_title_flag = emperor_toba_used
			}
			
			else = {
				set_title_flag = emperor_toba_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_saga
		}
		
		name = SAGA
		
		set_name = "Saga"
		
		set_character_flag = emperor_saga_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_saga_used
					}
				}
				
				set_title_flag = emperor_saga_used
			}
			
			else = {
				set_title_flag = emperor_saga_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_fukakusa
		}
		
		name = FUKAKUSA
		
		set_name = "Fukakusa"
		
		set_character_flag = emperor_fukakusa_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_fukakusa_used
					}
				}
				
				set_title_flag = emperor_fukakusa_used
			}
			
			else = {
				set_title_flag = emperor_fukakusa_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_ninmyo
		}
		
		name = NINMYO
		
		set_name = "Ninmyo"
		
		set_character_flag = emperor_ninmyo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_ninmyo_used
					}
				}
				
				set_title_flag = emperor_ninmyo_used
			}
			
			else = {
				set_title_flag = emperor_ninmyo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_uda
		}
		
		name = UDA
		
		set_name = "Uda"
		
		set_character_flag = emperor_uda_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_uda_used
					}
				}
				
				set_title_flag = emperor_uda_used
			}
			
			else = {
				set_title_flag = emperor_uda_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_fushimi
		}
		
		name = FUSHIMI
		
		set_name = "Fushimi"
		
		set_character_flag = emperor_fushimi_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_fushimi_used
					}
				}
				
				set_title_flag = emperor_fushimi_used
			}
			
			else = {
				set_title_flag = emperor_fushimi_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_nijo
		}
		
		name = NIJO
		
		set_name = "Nijo"
		
		set_character_flag = emperor_nijo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_nijo_used
					}
				}
				
				set_title_flag = emperor_nijo_used
			}
			
			else = {
				set_title_flag = emperor_nijo_used_2
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = sees_emperor_daigo
		}
		
		name = DAIGO
		
		set_name = "Daigo"
		
		set_character_flag = emperor_daigo_used
		
		k_chrysanthemum_throne = {
			if = {
				limit = {
					NOT = {
						has_title_flag = emperor_daigo_used
					}
				}
				
				set_title_flag = emperor_daigo_used
			}
			
			else = {
				set_title_flag = emperor_daigo_used_2
			}
		}
	}
			
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTA_SOH_7011 # More options!
		
		clear_all_tenno_name_flags_effect = yes
		
		character_event = { id = soh.7011 }
	}
	
	after = {
		clear_all_tenno_name_flags_effect = yes
	}
}

### Daijo Tenno cleanup

# Cleaning up retired_emperor upon regaining k_chrysanthemum_throne with any on_new_holder
character_event = {
	id = soh.7012
	desc = EVTDESC_SOH_7012
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes # on_new_holder/_inheritance/_usurpation
	
	only_playable = yes
	
	religion = shinto
	
	trigger = {
		FROM = {
			title = k_chrysanthemum_throne
		}
		trait = retired_emperor
	}
	
	option = {
		name = EVTOPTA_SOH_3513 # Banzai! Banzai! Banzai!
		
		remove_trait = retired_emperor
		
		if = {
			limit = {
				FROMFROM = {
					is_alive = yes
					is_dying = no
					can_have_japanese_bureaucracy_and_feudal_trigger = yes
				}
			}
			
			FROMFROM = {
				add_trait = retired_emperor
			}
		}
	}
}