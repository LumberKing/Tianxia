# set_up_new_treasure_fleet_effect

# finalize_treasure_fleet_setup_effect

# clear_all_global_treasure_fleet_flags_effect
# clear_all_province_treasure_fleet_flags_effect
# clear_all_character_treasure_fleet_flags_effect

# set_chinese_name_for_treasure_fleet_effect

# increase_all_treasure_fleet_attributes_random_effect
# increase_all_treasure_fleet_attributes_large_effect
# increase_all_treasure_fleet_attributes_medium_effect
# increase_all_treasure_fleet_attributes_small_effect

# increase_random_treasure_fleet_attribute_random_effect
# increase_random_treasure_fleet_attribute_large_effect
# increase_random_treasure_fleet_attribute_medium_effect
# increase_random_treasure_fleet_attribute_small_effect

# increase_treasure_fleet_army_strength_random_effect
# increase_treasure_fleet_army_strength_large_effect
# increase_treasure_fleet_army_strength_medium_effect
# increase_treasure_fleet_army_strength_small_effect

# increase_treasure_fleet_ship_strength_random_effect
# increase_treasure_fleet_ship_strength_large_effect
# increase_treasure_fleet_ship_strength_medium_effect
# increase_treasure_fleet_ship_strength_small_effect

# increase_treasure_fleet_supplies_random_effect
# increase_treasure_fleet_supplies_large_effect
# increase_treasure_fleet_supplies_medium_effect
# increase_treasure_fleet_supplies_small_effect

# increase_treasure_fleet_artifacts_random_effect
# increase_treasure_fleet_artifacts_large_effect
# increase_treasure_fleet_artifacts_medium_effect
# increase_treasure_fleet_artifacts_small_effect

# increase_treasure_fleet_wealth_random_effect
# increase_treasure_fleet_wealth_large_effect
# increase_treasure_fleet_wealth_medium_effect
# increase_treasure_fleet_wealth_small_effect

# increase_treasure_fleet_courtiers_random_effect
# increase_treasure_fleet_courtiers_large_effect
# increase_treasure_fleet_courtiers_medium_effect
# increase_treasure_fleet_courtiers_small_effect

# increase_treasure_fleet_modifiers_random_effect
# increase_treasure_fleet_modifiers_large_effect
# increase_treasure_fleet_modifiers_medium_effect
# increase_treasure_fleet_modifiers_small_effect

# increase_treasure_fleet_immigrants_random_effect
# increase_treasure_fleet_immigrants_large_effect
# increase_treasure_fleet_immigrants_medium_effect
# increase_treasure_fleet_immigrants_small_effect

# decrease_all_treasure_fleet_attributes_random_effect
# decrease_all_treasure_fleet_attributes_large_effect
# decrease_all_treasure_fleet_attributes_medium_effect
# decrease_all_treasure_fleet_attributes_small_effect

# decrease_random_treasure_fleet_attribute_random_effect
# decrease_random_treasure_fleet_attribute_large_effect
# decrease_random_treasure_fleet_attribute_medium_effect
# decrease_random_treasure_fleet_attribute_small_effect

# decrease_treasure_fleet_army_strength_random_effect
# decrease_treasure_fleet_army_strength_large_effect
# decrease_treasure_fleet_army_strength_medium_effect
# decrease_treasure_fleet_army_strength_small_effect

# decrease_treasure_fleet_ship_strength_random_effect
# decrease_treasure_fleet_ship_strength_large_effect
# decrease_treasure_fleet_ship_strength_medium_effect
# decrease_treasure_fleet_ship_strength_small_effect

# decrease_treasure_fleet_supplies_random_effect
# decrease_treasure_fleet_supplies_large_effect
# decrease_treasure_fleet_supplies_medium_effect
# decrease_treasure_fleet_supplies_small_effect

# decrease_treasure_fleet_artifacts_random_effect
# decrease_treasure_fleet_artifacts_large_effect
# decrease_treasure_fleet_artifacts_medium_effect
# decrease_treasure_fleet_artifacts_small_effect

# decrease_treasure_fleet_wealth_random_effect
# decrease_treasure_fleet_wealth_large_effect
# decrease_treasure_fleet_wealth_medium_effect
# decrease_treasure_fleet_wealth_small_effect

# decrease_treasure_fleet_courtiers_random_effect
# decrease_treasure_fleet_courtiers_large_effect
# decrease_treasure_fleet_courtiers_medium_effect
# decrease_treasure_fleet_courtiers_small_effect

# decrease_treasure_fleet_modifiers_random_effect
# decrease_treasure_fleet_modifiers_large_effect
# decrease_treasure_fleet_modifiers_medium_effect
# decrease_treasure_fleet_modifiers_small_effect

# decrease_treasure_fleet_immigrants_random_effect
# decrease_treasure_fleet_immigrants_large_effect
# decrease_treasure_fleet_immigrants_medium_effect
# decrease_treasure_fleet_immigrants_small_effect

# clean_up_all_treasure_fleet_flags_and_variables_effect
# clean_up_treasure_fleet_effect

# zero_all_treasure_fleet_variables_effect
# zero_all_negative_treasure_fleet_variables_effect

# disembark_regiments_until_stronger_or_unable_to_continue_effect
# disembark_regiments_until_unable_to_continue_effect

# take_treasure_fleet_wealth_effect

# treasure_fleet_epidemic_flag_effect

set_up_new_treasure_fleet_effect = {
	hidden_tooltip = {
		any_realm_character = {
			limit = {
				trait = treasure_fleet_preparation
			}
			
			remove_trait = treasure_fleet_preparation
			
			clear_flags_with_prefix = treasure_fleet_
		}
		
		# Initial setup
		clean_up_treasure_fleet_effect = yes
		
		set_global_flag = treasure_fleet_active
		
		set_global_flag = treasure_fleet_preparation # Correct phase
		
		add_trait = treasure_fleet_preparation # EoC should not start wars
		
		2753 = { # Hangzhou
			if = {
				limit = {
					has_dlc = "Jade Dragon"
				}
				
				add_province_modifier = {
					name = jd_dry_docks
					years = 20
				}
			}
			
			set_variable = {
				which = treasure_fleet_preparation
				value = 0
			}
		}
		
		set_chinese_name_for_treasure_fleet_effect = yes # Ensure artifacts get the proper name
		
		increase_all_treasure_fleet_attributes_large_effect = yes # Starting setup
		
		if = {
			limit = {
				has_character_modifier = mandate_of_heaven_5
			}
			
			increase_all_treasure_fleet_attributes_large_effect = yes
			
			increase_all_treasure_fleet_attributes_large_effect = yes
		}
		
		else_if = {
			limit = {
				has_character_modifier = mandate_of_heaven_4
			}
			
			increase_all_treasure_fleet_attributes_large_effect = yes
		}
	}
}

finalize_treasure_fleet_setup_effect = {
	hidden_tooltip = {
		activate_title = {
			title = d_treasure_fleet
			status = yes
		}
		
		2753 = { # Hangzhou
			if = {
				limit = {
					persistent_event_target:treasure_fleet_commander = {
						is_alive = yes
					}
				}
			
				persistent_event_target:treasure_fleet_commander = {
					grant_title = d_treasure_fleet
					
					set_defacto_liege = THIS
				}
			}
			
			else = {
				e_china = {
					holder_scope = {
						create_new_court_eunuch_effect = yes
						
						new_character = {
							change_diplomacy = 2
							change_martial = 2
							change_stewardship = 2
							change_intrigue = 2
							change_learning = 2
							
							save_event_target_as = new_treasure_fleet_commander
							
							2753 = { # Hangzhou
								save_persistent_event_target = {
									name = treasure_fleet_commander
									scope = event_target:new_treasure_fleet_commander
								}
							}
							
							grant_title = d_treasure_fleet
							
							set_defacto_liege = THIS
						}
					}
				}
			}
		}
	}
}

clear_all_global_treasure_fleet_flags_effect = {
	# Make sure to update this if any global flags (that should be cleared) are added!
	clr_global_flag = treasure_fleet_arrival
	clr_global_flag = treasure_fleet_at_atlantis
	clr_global_flag = treasure_fleet_at_kumari_kandam
	clr_global_flag = treasure_fleet_at_mount_penglai
	clr_global_flag = treasure_fleet_at_pacific_crossing
	clr_global_flag = treasure_fleet_at_rlyeh
	clr_global_flag = treasure_fleet_at_salt
	clr_global_flag = treasure_fleet_at_utter_east
	clr_global_flag = treasure_fleet_at_yamatai
	clr_global_flag = treasure_fleet_departure
	clr_global_flag = treasure_fleet_destroyed
	clr_global_flag = treasure_fleet_eastern_islands
	clr_global_flag = treasure_fleet_has_returned
	clr_global_flag = treasure_fleet_inca_encounter
	clr_global_flag = treasure_fleet_invasion_failed_to_launch
	clr_global_flag = treasure_fleet_is_going_home
	clr_global_flag = treasure_fleet_leaving_china
	clr_global_flag = treasure_fleet_new_world
	clr_global_flag = treasure_fleet_next_stop_china
	clr_global_flag = treasure_fleet_pacific
	clr_global_flag = treasure_fleet_pacific_return
	clr_global_flag = treasure_fleet_port_locals
	clr_global_flag = treasure_fleet_port_visitors
	clr_global_flag = treasure_fleet_sabotage_opportunity
	clr_global_flag = treasure_fleet_voyage
	clr_global_flag = treasure_fleet_will_arrive_at_atlantis
	clr_global_flag = treasure_fleet_will_arrive_at_kumari_kandam
	clr_global_flag = treasure_fleet_will_arrive_at_nazca
	clr_global_flag = treasure_fleet_will_arrive_at_penglai
	clr_global_flag = treasure_fleet_will_arrive_at_rlyeh
	clr_global_flag = treasure_fleet_will_arrive_at_salt
	clr_global_flag = treasure_fleet_will_arrive_at_utter_east
	clr_global_flag = treasure_fleet_will_arrive_at_yamatai
}

clear_all_province_treasure_fleet_flags_effect = {
	# Make sure all Treasure Fleet-related province flags that should be cleared have the treasure_fleet_ prefix
	2753 = { # Hangzhou
		clear_flags_with_prefix = treasure_fleet_
	}
}

clear_all_character_treasure_fleet_flags_effect = {
	clear_flags_with_prefix = treasure_fleet_
	
	remove_trait = treasure_fleet_voyage
}

set_chinese_name_for_treasure_fleet_effect = {
	e_china = {
		trigger_switch = {
			on_trigger = has_title_flag
			
			ba_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ba_china
				}
			}
			
			bei_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_bei_china
				}
			}
			
			bi_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_bi_china
				}
			}
			
			bing_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_bing_china
				}
			}
			
			cai_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_cai_china
				}
			}
			
			cao_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_cao_china
				}
			}
			
			chao_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_chao_china
				}
			}
			
			chen_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_chen_china
				}
			}
			
			cheng_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_cheng_china
				}
			}
			
			chu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_chu_china
				}
			}
			
			dai_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_dai_china
				}
			}
			
			dao_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_dao_china
				}
			}
			
			deng_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_deng_china
				}
			}
			
			ding_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ding_china
				}
			}
			
			e_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_e_china
				}
			}
			
			emei_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_emei_china
				}
			}
			
			fan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_fan_china
				}
			}
			
			gan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_gan_china
				}
			}
			
			gao_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_gao_china
				}
			}
			
			ge_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ge_china
				}
			}
			
			gong_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_gong_china
				}
			}
			
			guang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_guang_china
				}
			}
			
			guo_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_guo_china
				}
			}
			
			han_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_han_china
				}
			}
			
			heng_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_heng_china
				}
			}
			
			hu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_hu_china
				}
			}
			
			hua_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_hua_china
				}
			}
			
			huang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_huang_china
				}
			}
			
			huo_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_huo_china
				}
			}
			
			ji_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ji_china
				}
			}
			
			jia_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_jia_china
				}
			}
			
			jiang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_jiang_china
				}
			}
			
			jie_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_jie_china
				}
			}
			
			jin_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_jin_china
				}
			}
			
			jing_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_jing_china
				}
			}
			
			ju_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ju_china
				}
			}
			
			lai_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_lai_china
				}
			}
			
			lan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_lan_china
				}
			}
			
			liang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_liang_china
				}
			}
			
			liao_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_liao_china
				}
			}
			
			liu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_liu_china
				}
			}
			
			long_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_long_china
				}
			}
			
			lu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_lu_china
				}
			}
			
			luo_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_luo_china
				}
			}
			
			lu2_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_lu2_china
				}
			}
			
			mao_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_mao_china
				}
			}
			
			min_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_min_china
				}
			}
			
			ming_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ming_china
				}
			}
			
			miu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_miu_china
				}
			}
			
			ni_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ni_china
				}
			}
			
			pang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_pang_china
				}
			}
			
			peng_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_peng_china
				}
			}
			
			pi_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_pi_china
				}
			}
			
			ping_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ping_china
				}
			}
			
			qi_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_qi_china
				}
			}
			
			qin_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_qing_china
				}
			}
			
			qing_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_qing_china
				}
			}
			
			quan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_quan_china
				}
			}
			
			ren_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ren_china
				}
			}
			
			rui_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_rui_china
				}
			}
			
			sai_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_sai_china
				}
			}
			
			shan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_shan_china
				}
			}
			
			shang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_shang_china
				}
			}
			
			shao_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_shao_china
				}
			}
			
			shen_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_shen_china
				}
			}
			
			shu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_shu_china
				}
			}
			
			shun_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_shun_china
				}
			}
			
			song_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_song_china
				}
			}
			
			su_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_su_china
				}
			}
			
			sui_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_sui_china
				}
			}
			
			tai_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_tai_china
				}
			}
			
			tan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_tan_china
				}
			}
			
			tang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_tang_china
				}
			}
			
			teng_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_teng_china
				}
			}
			
			tian_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_tian_china
				}
			}
			
			wei_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_wei_china
				}
			}
			
			wen_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_wen_china
				}
			}
			
			wu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_wu_china
				}
			}
			
			xi_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_xi_china
				}
			}
			
			xia_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_xia_china
				}
			}
			
			xian_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_xian_china
				}
			}
			
			xiang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_xiang_china
				}
			}
			
			xie_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_xie_china
				}
			}
			
			xin_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_xin_china
				}
			}
			
			xing_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_xing_china
				}
			}
			
			xu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_xu_china
				}
			}
			
			xue_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_xue_china
				}
			}
			
			yan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_yan_china
				}
			}
			
			yang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_yang_china
				}
			}
			
			yin_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_yin_china
				}
			}
			
			ying_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_ying_china
				}
			}
			
			yong_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_yong_china
				}
			}
			
			you_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_you_china
				}
			}
			
			yu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_yu_china
				}
			}
			
			yuan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_yuan_china
				}
			}
			
			yue_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_yue_china
				}
			}
			
			zeng_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zeng_china
				}
			}
			
			zhan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zhan_china
				}
			}
			
			zhang_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zhang_china
				}
			}
			
			zhao_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zhao_china
				}
			}
			
			zheng_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zheng_china
				}
			}
			
			zhong_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zhong_china
				}
			}
			
			zhou_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zhou_china
				}
			}
			
			zhu_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zhu_china
				}
			}
			
			zhuan_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zhuan_china
				}
			}
			
			zou_china = {
				2753 = { # Hangzhou
					set_province_flag = treasure_fleet_china_is_zou_china
				}
			}
		}
	}
}

increase_all_treasure_fleet_attributes_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			increase_treasure_fleet_army_strength_random_effect = yes
			increase_treasure_fleet_ship_strength_random_effect = yes
			increase_treasure_fleet_supplies_random_effect = yes
			increase_treasure_fleet_artifacts_random_effect = yes
			increase_treasure_fleet_wealth_random_effect = yes
			increase_treasure_fleet_courtiers_random_effect = yes
			increase_treasure_fleet_modifiers_random_effect = yes
			increase_treasure_fleet_immigrants_random_effect = yes
		}
	}
}

increase_all_treasure_fleet_attributes_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			increase_treasure_fleet_army_strength_large_effect = yes
			increase_treasure_fleet_ship_strength_large_effect = yes
			increase_treasure_fleet_supplies_large_effect = yes
			increase_treasure_fleet_artifacts_large_effect = yes
			increase_treasure_fleet_wealth_large_effect = yes
			increase_treasure_fleet_courtiers_large_effect = yes
			increase_treasure_fleet_modifiers_large_effect = yes
			increase_treasure_fleet_immigrants_large_effect = yes
		}
	}
}

increase_all_treasure_fleet_attributes_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			increase_treasure_fleet_army_strength_medium_effect = yes
			increase_treasure_fleet_ship_strength_medium_effect = yes
			increase_treasure_fleet_supplies_medium_effect = yes
			increase_treasure_fleet_artifacts_medium_effect = yes
			increase_treasure_fleet_wealth_medium_effect = yes
			increase_treasure_fleet_courtiers_medium_effect = yes
			increase_treasure_fleet_modifiers_medium_effect = yes
			increase_treasure_fleet_immigrants_medium_effect = yes
		}
	}
}

increase_all_treasure_fleet_attributes_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			increase_treasure_fleet_army_strength_small_effect = yes
			increase_treasure_fleet_ship_strength_small_effect = yes
			increase_treasure_fleet_supplies_small_effect = yes
			increase_treasure_fleet_artifacts_small_effect = yes
			increase_treasure_fleet_wealth_small_effect = yes
			increase_treasure_fleet_courtiers_small_effect = yes
			increase_treasure_fleet_modifiers_small_effect = yes
			increase_treasure_fleet_immigrants_small_effect = yes
		}
	}
}

increase_random_treasure_fleet_attribute_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_army_strength_random_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_ship_strength_random_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_supplies_random_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_artifacts_random_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_wealth_random_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_courtiers_random_effect = yes
				}
				
				1 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					increase_treasure_fleet_modifiers_random_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_immigrants_random_effect = yes
				}
			}
		}
	}
}

increase_random_treasure_fleet_attribute_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_army_strength_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_ship_strength_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_supplies_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_artifacts_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_wealth_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_courtiers_large_effect = yes
				}
				
				1 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					increase_treasure_fleet_modifiers_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_immigrants_large_effect = yes
				}
			}
		}
	}
}

increase_random_treasure_fleet_attribute_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_army_strength_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_ship_strength_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_supplies_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_artifacts_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_wealth_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_courtiers_medium_effect = yes
				}
				
				1 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					increase_treasure_fleet_modifiers_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_immigrants_medium_effect = yes
				}
			}
		}
	}
}

increase_random_treasure_fleet_attribute_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_army_strength_small_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_ship_strength_small_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_supplies_small_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_artifacts_small_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_wealth_small_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_courtiers_small_effect = yes
				}
				
				1 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					increase_treasure_fleet_modifiers_small_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_immigrants_small_effect = yes
				}
			}
		}
	}
}

increase_treasure_fleet_army_strength_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_army_strength_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_army_strength_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_army_strength_small_effect = yes
				}
			}
		}
	}
}

increase_treasure_fleet_army_strength_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_army_strength
				value = 10
			}
		}
	}
}

increase_treasure_fleet_army_strength_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_army_strength
				value = 5
			}
		}
	}
}

increase_treasure_fleet_army_strength_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_army_strength
				value = 1
			}
		}
	}
}

increase_treasure_fleet_ship_strength_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_ship_strength_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_ship_strength_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_ship_strength_small_effect = yes
				}
			}
		}
	}
}

increase_treasure_fleet_ship_strength_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_ship_strength
				value = 10
			}
		}
	}
}

increase_treasure_fleet_ship_strength_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_ship_strength
				value = 5
			}
		}
	}
}

increase_treasure_fleet_ship_strength_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_ship_strength
				value = 1
			}
		}
	}
}

increase_treasure_fleet_supplies_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_supplies_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_supplies_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_supplies_small_effect = yes
				}
			}
		}
	}
}

increase_treasure_fleet_supplies_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_supplies
				value = 10
			}
		}
	}
}

increase_treasure_fleet_supplies_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_supplies
				value = 5
			}
		}
	}
}

increase_treasure_fleet_supplies_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_supplies
				value = 1
			}
		}
	}
}

increase_treasure_fleet_artifacts_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_artifacts_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_artifacts_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_artifacts_small_effect = yes
				}
			}
		}
	}
}

increase_treasure_fleet_artifacts_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_artifacts
				value = 10
			}
		}
	}
}

increase_treasure_fleet_artifacts_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_artifacts
				value = 5
			}
		}
	}
}

increase_treasure_fleet_artifacts_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_artifacts
				value = 1
			}
		}
	}
}

increase_treasure_fleet_wealth_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_wealth_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_wealth_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_wealth_small_effect = yes
				}
			}
		}
	}
}

increase_treasure_fleet_wealth_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_wealth
				value = 10
			}
		}
	}
}

increase_treasure_fleet_wealth_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_wealth
				value = 5
			}
		}
	}
}

increase_treasure_fleet_wealth_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_wealth
				value = 1
			}
		}
	}
}

increase_treasure_fleet_courtiers_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_courtiers_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_courtiers_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_courtiers_small_effect = yes
				}
			}
		}
	}
}

increase_treasure_fleet_courtiers_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_courtiers
				value = 5
			}
		}
	}
}

increase_treasure_fleet_courtiers_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_courtiers
				value = 3
			}
		}
	}
}

increase_treasure_fleet_courtiers_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_courtiers
				value = 1
			}
		}
	}
}

increase_treasure_fleet_modifiers_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			if = {
				limit = {
					has_dlc = "Jade Dragon"
				}
				
				random_list = {
					1 = {
						increase_treasure_fleet_modifiers_large_effect = yes
					}
					
					1 = {
						increase_treasure_fleet_modifiers_medium_effect = yes
					}
					
					1 = {
						increase_treasure_fleet_modifiers_small_effect = yes
					}
				}
			}
		}
	}
}

increase_treasure_fleet_modifiers_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			if = {
				limit = {
					has_dlc = "Jade Dragon"
				}
				
				change_variable = {
					which = treasure_fleet_modifiers
					value = 10
				}
			}
		}
	}
}

increase_treasure_fleet_modifiers_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			if = {
				limit = {
					has_dlc = "Jade Dragon"
				}
				
				change_variable = {
					which = treasure_fleet_modifiers
					value = 5
				}
			}
		}
	}
}

increase_treasure_fleet_modifiers_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			if = {
				limit = {
					has_dlc = "Jade Dragon"
				}
				
				change_variable = {
					which = treasure_fleet_modifiers
					value = 1
				}
			}
		}
	}
}

increase_treasure_fleet_immigrants_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					increase_treasure_fleet_immigrants_large_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_immigrants_medium_effect = yes
				}
				
				1 = {
					increase_treasure_fleet_immigrants_small_effect = yes
				}
			}
		}
	}
}

increase_treasure_fleet_immigrants_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_immigrants
				value = 3
			}
		}
	}
}

increase_treasure_fleet_immigrants_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_immigrants
				value = 2
			}
		}
	}
}

increase_treasure_fleet_immigrants_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_immigrants
				value = 1
			}
		}
	}
}

decrease_all_treasure_fleet_attributes_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			decrease_treasure_fleet_army_strength_random_effect = yes
			decrease_treasure_fleet_ship_strength_random_effect = yes
			decrease_treasure_fleet_supplies_random_effect = yes
			decrease_treasure_fleet_artifacts_random_effect = yes
			decrease_treasure_fleet_wealth_random_effect = yes
			decrease_treasure_fleet_courtiers_random_effect = yes
			decrease_treasure_fleet_modifiers_random_effect = yes
			decrease_treasure_fleet_immigrants_random_effect = yes
		}
	}
}

decrease_all_treasure_fleet_attributes_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			decrease_treasure_fleet_army_strength_large_effect = yes
			decrease_treasure_fleet_ship_strength_large_effect = yes
			decrease_treasure_fleet_supplies_large_effect = yes
			decrease_treasure_fleet_artifacts_large_effect = yes
			decrease_treasure_fleet_wealth_large_effect = yes
			decrease_treasure_fleet_courtiers_large_effect = yes
			decrease_treasure_fleet_modifiers_large_effect = yes
			decrease_treasure_fleet_immigrants_large_effect = yes
		}
	}
}

decrease_all_treasure_fleet_attributes_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			decrease_treasure_fleet_army_strength_medium_effect = yes
			decrease_treasure_fleet_ship_strength_medium_effect = yes
			decrease_treasure_fleet_supplies_medium_effect = yes
			decrease_treasure_fleet_artifacts_medium_effect = yes
			decrease_treasure_fleet_wealth_medium_effect = yes
			decrease_treasure_fleet_courtiers_medium_effect = yes
			decrease_treasure_fleet_modifiers_medium_effect = yes
			decrease_treasure_fleet_immigrants_medium_effect = yes
		}
	}
}

decrease_all_treasure_fleet_attributes_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			decrease_treasure_fleet_army_strength_small_effect = yes
			decrease_treasure_fleet_ship_strength_small_effect = yes
			decrease_treasure_fleet_supplies_small_effect = yes
			decrease_treasure_fleet_artifacts_small_effect = yes
			decrease_treasure_fleet_wealth_small_effect = yes
			decrease_treasure_fleet_courtiers_small_effect = yes
			decrease_treasure_fleet_modifiers_small_effect = yes
			decrease_treasure_fleet_immigrants_small_effect = yes
		}
	}
}

decrease_random_treasure_fleet_attribute_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_army_strength_random_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_ship_strength_random_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_supplies_random_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_artifacts_random_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_wealth_random_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_courtiers_random_effect = yes
				}
				
				1 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					decrease_treasure_fleet_modifiers_random_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_immigrants_random_effect = yes
				}
			}
		}
	}
}

decrease_random_treasure_fleet_attribute_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_army_strength_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_ship_strength_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_supplies_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_artifacts_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_wealth_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_courtiers_large_effect = yes
				}
				
				1 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					decrease_treasure_fleet_modifiers_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_immigrants_large_effect = yes
				}
			}
		}
	}
}

decrease_random_treasure_fleet_attribute_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_army_strength_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_ship_strength_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_supplies_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_artifacts_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_wealth_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_courtiers_medium_effect = yes
				}
				
				1 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					decrease_treasure_fleet_modifiers_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_immigrants_medium_effect = yes
				}
			}
		}
	}
}

decrease_random_treasure_fleet_attribute_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_army_strength_small_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_ship_strength_small_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_supplies_small_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_artifacts_small_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_wealth_small_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_courtiers_small_effect = yes
				}
				
				1 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					decrease_treasure_fleet_modifiers_small_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_immigrants_small_effect = yes
				}
			}
		}
	}
}

decrease_treasure_fleet_army_strength_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_army_strength_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_army_strength_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_army_strength_small_effect = yes
				}
			}
		}
	}
}

decrease_treasure_fleet_army_strength_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_army_strength
				value = -10
			}
		}
	}
}

decrease_treasure_fleet_army_strength_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_army_strength
				value = -5
			}
		}
	}
}

decrease_treasure_fleet_army_strength_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_army_strength
				value = -1
			}
		}
	}
}

decrease_treasure_fleet_ship_strength_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_ship_strength_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_ship_strength_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_ship_strength_small_effect = yes
				}
			}
		}
	}
}

decrease_treasure_fleet_ship_strength_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_ship_strength
				value = -10
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value <= 0
					}
				}
				
				set_variable = {
					which = treasure_fleet_ship_strength
					value = 1
				}
			}
		}
	}
}

decrease_treasure_fleet_ship_strength_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_ship_strength
				value = -5
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value <= 0
					}
				}
				
				set_variable = {
					which = treasure_fleet_ship_strength
					value = 1
				}
			}
		}
	}
}

decrease_treasure_fleet_ship_strength_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_ship_strength
				value = -1
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value <= 0
					}
				}
				
				set_variable = {
					which = treasure_fleet_ship_strength
					value = 1
				}
			}
		}
	}
}

decrease_treasure_fleet_supplies_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_supplies_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_supplies_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_supplies_small_effect = yes
				}
			}
		}
	}
}

decrease_treasure_fleet_supplies_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_supplies
				value = -10
			}
		}
	}
}

decrease_treasure_fleet_supplies_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_supplies
				value = -5
			}
		}
	}
}

decrease_treasure_fleet_supplies_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_supplies
				value = -1
			}
		}
	}
}

decrease_treasure_fleet_artifacts_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_artifacts_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_artifacts_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_artifacts_small_effect = yes
				}
			}
		}
	}
}

decrease_treasure_fleet_artifacts_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_artifacts
				value = -10
			}
		}
	}
}

decrease_treasure_fleet_artifacts_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_artifacts
				value = -5
			}
		}
	}
}

decrease_treasure_fleet_artifacts_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_artifacts
				value = -1
			}
		}
	}
}

decrease_treasure_fleet_wealth_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_wealth_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_wealth_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_wealth_small_effect = yes
				}
			}
		}
	}
}

decrease_treasure_fleet_wealth_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_wealth
				value = -10
			}
		}
	}
}

decrease_treasure_fleet_wealth_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_wealth
				value = -5
			}
		}
	}
}

decrease_treasure_fleet_wealth_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_wealth
				value = -1
			}
		}
	}
}

decrease_treasure_fleet_courtiers_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_courtiers_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_courtiers_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_courtiers_small_effect = yes
				}
			}
		}
	}
}

decrease_treasure_fleet_courtiers_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_courtiers
				value = -5
			}
		}
	}
}

decrease_treasure_fleet_courtiers_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_courtiers
				value = -3
			}
		}
	}
}

decrease_treasure_fleet_courtiers_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_courtiers
				value = -1
			}
		}
	}
}

decrease_treasure_fleet_modifiers_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_modifiers_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_modifiers_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_modifiers_small_effect = yes
				}
			}
		}
	}
}

decrease_treasure_fleet_modifiers_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_modifiers
				value = -10
			}
		}
	}
}

decrease_treasure_fleet_modifiers_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_modifiers
				value = -5
			}
		}
	}
}

decrease_treasure_fleet_modifiers_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_modifiers
				value = -1
			}
		}
	}
}

decrease_treasure_fleet_immigrants_random_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			random_list = {
				1 = {
					decrease_treasure_fleet_immigrants_large_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_immigrants_medium_effect = yes
				}
				
				1 = {
					decrease_treasure_fleet_immigrants_small_effect = yes
				}
			}
		}
	}
}

decrease_treasure_fleet_immigrants_large_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_immigrants
				value = -3
			}
		}
	}
}

decrease_treasure_fleet_immigrants_medium_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_immigrants
				value = -2
			}
		}
	}
}

decrease_treasure_fleet_immigrants_small_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_immigrants
				value = -1
			}
		}
	}
}

clean_up_all_treasure_fleet_flags_and_variables_effect = {
	# More thorough; used when the TF ends abnormally (destroyed or as a consequence of a TF invasion ending)
	hidden_tooltip = {
		clear_all_global_treasure_fleet_flags_effect = yes
		
		clear_all_province_treasure_fleet_flags_effect = yes
		
		zero_all_treasure_fleet_variables_effect = yes
		
		e_china = {
			holder_scope = {
				any_realm_character = {
					limit = {
						trait = treasure_fleet_voyage
						NOR = {
							has_character_flag = left_treasure_fleet_voyage
							any_war = {
								attacker = {
									character = PREV
								}
								using_cb = treasure_fleet_invasion
							}
						}
					}
					
					clear_all_character_treasure_fleet_flags_effect = yes
				}
				
				save_event_target_as = eoc
			}
		}
		
		activate_title = {
			title = d_treasure_fleet
			status = no
		}
		
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_commander = {
				if = {
					limit = {
						is_alive = yes
					}
					
					clear_all_character_treasure_fleet_flags_effect = yes
					
					move_character = event_target:eoc
					
					force_host = event_target:eoc
				}
			}
		}
	}
}

clean_up_treasure_fleet_effect = {
	# Less thorough; used when the TF ends normally
	hidden_tooltip = {
		clear_all_global_treasure_fleet_flags_effect = yes
		
		clear_all_province_treasure_fleet_flags_effect = yes
		
		decrease_all_treasure_fleet_attributes_random_effect = yes # To ensure the new fleet isn't far too strong
		
		zero_all_negative_treasure_fleet_variables_effect = yes
		
		e_china = {
			holder_scope = {
				any_realm_character = {
					limit = {
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					clear_all_character_treasure_fleet_flags_effect = yes
				}
				
				save_event_target_as = eoc
			}
		}
		
		activate_title = {
			title = d_treasure_fleet
			status = no
		}
		
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_commander = {
				clear_all_character_treasure_fleet_flags_effect = yes
				
				move_character = event_target:eoc
				
				force_host = event_target:eoc
			}
		}
	}
}

zero_all_treasure_fleet_variables_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			set_variable = {
				which = treasure_fleet_army_strength
				value = 0
			}
			
			set_variable = {
				which = treasure_fleet_ship_strength
				value = 0
			}
			
			set_variable = {
				which = treasure_fleet_supplies
				value = 0
			}
			
			set_variable = {
				which = treasure_fleet_artifacts
				value = 0
			}
			
			set_variable = {
				which = treasure_fleet_wealth
				value = 0
			}
			
			set_variable = {
				which = treasure_fleet_courtiers
				value = 0
			}
			
			set_variable = {
				which = treasure_fleet_modifiers
				value = 0
			}
			
			set_variable = {
				which = treasure_fleet_immigrants
				value = 0
			}
		}
	}
}

zero_all_negative_treasure_fleet_variables_effect = {
	hidden_tooltip = {
		2753 = { # Hangzhou
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_army_strength
						value < 1
					}
				}
				
				set_variable = {
					which = treasure_fleet_army_strength
					value = 0
				}
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value < 1
					}
				}
				
				set_variable = {
					which = treasure_fleet_ship_strength
					value = 0
				}
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_supplies
						value < 1
					}
				}
				
				set_variable = {
					which = treasure_fleet_supplies
					value = 0
				}
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_artifacts
						value < 1
					}
				}
				
				set_variable = {
					which = treasure_fleet_artifacts
					value = 0
				}
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_wealth
						value < 1
					}
				}
				
				set_variable = {
					which = treasure_fleet_wealth
					value = 0
				}
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_courtiers
						value < 1
					}
				}
				
				set_variable = {
					which = treasure_fleet_courtiers
					value = 0
				}
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_modifiers
						value < 1
					}
				}
				
				set_variable = {
					which = treasure_fleet_modifiers
					value = 0
				}
			}
			
			if = {
				limit = {
					check_variable = {
						which = treasure_fleet_immigrants
						value < 1
					}
				}
				
				set_variable = {
					which = treasure_fleet_immigrants
					value = 0
				}
			}
		}
	}
}

disembark_regiments_until_stronger_or_unable_to_continue_effect = {
	while = {
		limit = {
			2753 = { # Hangzhou
				check_variable = {
					which = treasure_fleet_army_strength
					value >= 15
				}
			}
			
			event_target:treasure_fleet_attacker = {
				relative_power = {
					who = event_target:treasure_fleet_punitive_expedition_leader
					power >= 1
				}
			}
		}
		
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_army_strength
				value = -1
			}
		}
		
		event_target:treasure_fleet_punitive_expedition_leader = {
			event_target:treasure_fleet_beachhead = {
				PREV = {
					spawn_unit = {
						province = PREV
						home = PREV
						owner = event_target:treasure_fleet_punitive_expedition_leader
						earmark = tf_punitive_expedition
						troops = {
							light_infantry = { 300 300 } # Sailors
							heavy_infantry = { 200 200 }
							pikemen = { 200 200 }
							archers = { 200 200 }
							light_cavalry = { 50 50 } # Very little cavalry; horses are annoying to transport
							knights = { 50 50 } # Very little cavalry; horses are annoying to transport
						}
					}
				}
				
				sea_zone = {
					event_target:treasure_fleet_punitive_expedition_leader = {
						spawn_unit = {
							province = PREV
							home = PREV
							owner = event_target:treasure_fleet_punitive_expedition_leader
							earmark = tf_punitive_expedition
							troops = {
								galleys = { 10 10 }
							}
						}
					}
				}
			}
		}
	}
}

disembark_regiments_until_unable_to_continue_effect = {
	while = {
		limit = {
			2753 = { # Hangzhou
				check_variable = {
					which = treasure_fleet_army_strength
					value >= 1
				}
			}
		}
		
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_army_strength
				value = -1
			}
		}
		
		ROOT = {
			event_target:potential_treasure_fleet_invasion_target_beachhead = {
				ROOT = {
					spawn_unit = {
						province = PREV
						home = PREV
						owner = ROOT
						earmark = treasure_fleet_invasion
						troops = {
							light_infantry = { 300 300 } # Sailors
							heavy_infantry = { 200 200 }
							pikemen = { 200 200 }
							archers = { 200 200 }
							light_cavalry = { 50 50 } # Very little cavalry; horses are annoying to transport
							knights = { 50 50 } # Very little cavalry; horses are annoying to transport
						}
					}
				}
				
				sea_zone = {
					ROOT = {
						spawn_unit = {
							province = PREV
							home = PREV
							owner = ROOT
							earmark = treasure_fleet_invasion
							troops = {
								galleys = { 10 10 }
							}
						}
					}
				}
			}
		}
	}
}

take_treasure_fleet_wealth_effect = {
	while = {
		limit = {
			2753 = { # Hangzhou
				check_variable = {
					which = treasure_fleet_wealth
					value >= 1
				}
			}
		}
		
		2753 = { # Hangzhou
			change_variable = {
				which = treasure_fleet_wealth
				value = -1
			}
		}
		
		wealth = 100
	}
}

treasure_fleet_epidemic_flag_effect = {
	any_independent_ruler = {
		limit = {
			any_realm_province = {
				is_in_active_treasure_fleet_region_trigger = yes
				has_epidemic = yes
			}
		}
		
		any_realm_province = {
			limit = {
				has_epidemic = yes
				is_in_active_treasure_fleet_region_trigger = yes
			}
			
			if = {
				limit = {
					disease = dancing_plague
				}
				
				ROOT = {
					set_province_flag = treasure_fleet_disease_dancing_plague
				}
			}
			
			if = {
				limit = {
					disease = syphilis
				}
				
				ROOT = {
					set_province_flag = treasure_fleet_disease_aztec_disease
				}
			}
			
			if = {
				limit = {
					disease = bubonic_plague
				}
				
				ROOT = {
					set_province_flag = treasure_fleet_disease_bubonic_plague
				}
			}
			
			if = {
				limit = {
					disease = measles
				}
				
				ROOT = {
					set_province_flag = treasure_fleet_disease_measles
				}
			}
			
			if = {
				limit = {
					disease = smallpox
				}
				
				ROOT = {
					set_province_flag = treasure_fleet_disease_smallpox
				}
			}
			
			if = {
				limit = {
					disease = consumption
				}
				
				ROOT = {
					set_province_flag = treasure_fleet_disease_consumption
				}
			}
			
			if = {
				limit = {
					disease = slow_fever
				}
				
				ROOT = {
					set_province_flag = treasure_fleet_disease_slow_fever
				}
			}
			
			if = {
				limit = {
					disease = camp_fever
				}
				
				ROOT = {
					set_province_flag = treasure_fleet_disease_camp_fever
				}
			}
		}
	}
}