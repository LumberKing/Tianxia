# TODO: Sort

### Grace decision flag cleanup
clear_grace_decision_flags_effect = {
	clr_character_flag = grace_refuse_offer
	clr_character_flag = grace_accept_offer
	clr_character_flag = grace_neutral_offer
	clr_character_flag = grace_refuse_offer_gc
	clr_character_flag = grace_accept_offer_gc
	clr_character_flag = grace_neutral_offer_gc
}

### Chinese artifact creation effects

add_random_chinese_artifact_effect = {} # TODO
add_random_chinese_artifact_with_moh_weight_effect = {} # TODO

### Chinese Imperial Bloodline (real and pretender) creation

create_new_court_eunuch_effect = {
	# Based on JD scholar-bureaucrats
	# Only fires if JD is active
	random_realm_province = {
		save_event_target_as = eunuch_origin
	}
	
	create_character = {
		age = 30
		dynasty = NONE
		religion = event_target:eunuch_origin
		culture = event_target:eunuch_origin
		female = no
		health = 6
		random_traits = yes
	}
	
	new_character = {
		# Randomize religion
		random = {
			chance = 25
			religion = ROOT
		}
		
		# Randomize culture
		random = {
			chance = 25
			culture = ROOT
		}
		
		# Randomize age
		random_list = {
			1 = {
				add_age = -10
			}
			5 = {
				add_age = -5
			}
			10 = {}
			15 = {
				add_age = 5
			}
			15 = {
				add_age = 10
			}
			15 = {
				add_age = 15
			}
			15 = {
				add_age = 20
			}
			10 = {
				add_age = 25
			}
			10 = {
				add_age = 30
			}
			10 = {
				add_age = 35
			}
			10 = {
				add_age = 40
			}
			5 = {
				add_age = 45
			}
			5 = {
				add_age = 50
			}
			2 = {
				add_age = 55
			}
			1 = {
				add_age = 60
			}
		}
		random_list = {
			10 =  {
				add_age = -4
			}
			10 =  {
				add_age = -3
			}
			10 =  {
				add_age = -2
			}
			10 =  {
				add_age = -1
			}
			10 =  {}
			10 =  {
				add_age = 1
			}
			10 =  {
				add_age = 2
			}
			10 =  {
				add_age = 3
			}
			10 =  {
				add_age = 4
			}
		}
		
		add_trait = eunuch # Important!
		
		#Education & other basic stuff
		set_character_flag = ai_flag_refuse_concubinage
		set_character_flag = ai_flag_refuse_marriage
		set_character_flag = originated_from_chinese_court
		set_character_flag = no_court_invites
		random = {
			chance = 50
			remove_education_effect = yes
			random_list = {
				30 = { add_trait = thrifty_clerk }
				15 = { add_trait = fortune_builder }
				5 = { add_trait = midas_touched }
				30 = { add_trait = martial_cleric }
				15 = { add_trait = scholarly_theologian }
				5 = { add_trait = mastermind_theologian }
				30 = { add_trait = flamboyant_schemer }
				15 = { add_trait = intricate_webweaver }
				5 = { add_trait = elusive_shadow }
			}
		}
		random_list = {
			100 = { } #Nothing
			30 = { add_trait = erudite }
			25 = { add_trait = shrewd }
			15 = { add_trait = quick }
			5 = { add_trait = genius }
			5 = { add_trait = fair }
		}
		random_list = {
			85 = { } #Nothing
			1 = { add_trait = clubfooted }
			2 = { add_trait = harelip }
			2 = { add_trait = hunchback }
			3 = { add_trait = lisp }
			3 = { add_trait = stutter }
			2 = { 
				add_trait = ugly 
				remove_trait = fair 
			}
			1 = { add_trait = dwarf }
			1 = {  add_trait = weak }
		}
		random = {
			chance = 10
			add_trait = homosexual
		}

		#Add archetype 
		random_list = {
			#Conservative 
			25 = {
				set_character_flag = archetype_conservative
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						50 = { add_trait = scholar }
						50 = { add_trait = administrator }
					}
				}
				random = {
					chance = 50
					add_trait = zealous
				}
				add_trait = stubborn
				add_trait = temperate
				random_list = {
					20 = { add_trait = greedy }
					20 = { add_trait = wroth }
					20 = { add_trait = deceitful }
					20 = { add_trait = shy }
					20 = { add_trait = cruel }
				}
				random_list = {
					25 = { add_trait = poet }
					25 = { add_trait = chaste }
					25 = { 
						add_trait = patient
						remove_trait = wroth
					}
					25 = { add_trait = just }
				}
			}
			#Supportive
			25 = {
				set_character_flag = archetype_supportive
				if = {
					limit = { has_dlc = "Way of Life" }    
					random_list = {
						50 = { add_trait = administrator }
						25 = { add_trait = scholar }
						25 = { add_trait = gardener }
					}
				}
				add_trait = humble
				add_trait = patient
				random_list = {
					33 = { add_trait = slothful }
					33 = { add_trait = craven }
					33 = { add_trait = shy }
				}
				random_list = {
					25 = { add_trait = content }
					25 = { add_trait = charitable }
					25 = { add_trait = kind }
					25 = { add_trait = trusting }
				}      
			}
			#Decisive
			25 = {
				set_character_flag = archetype_decisive
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						75 = { add_trait = administrator }
						25 = { add_trait = architect }
					}
				}
				add_trait = ambitious
				add_trait = cynical
				random_list = {
					20 = { add_trait = cruel }
					20 = { add_trait = stubborn }
					20 = { add_trait = greedy }
					20 = { add_trait = wroth }
					20 = { add_trait = proud }
				}
				random_list = {
					20 = { add_trait = falconer }
					20 = { add_trait = diligent }
					20 = { add_trait = brave }
					20 = { add_trait = honest }
					20 = { add_trait = gregarious }
				}    
			}
			#Sociable
			25 = {
				set_character_flag = archetype_sociable
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						25 = { add_trait = administrator }
						30 = { add_trait = socializer }
						25 = { add_trait = hedonist}
						20 = { # Technically fine...
							trigger = { is_female = no }
							add_trait = seducer
							add_trait = lustful
						}
					}
				}
				add_trait = gregarious
				add_trait = charitable
				random_list = {
					25 = { add_trait = craven }
					25 = { add_trait = envious }
					25 = { add_trait = gluttonous }
					25 = { add_trait = proud }
				}
				random_list = {
					25 = { add_trait = poet }
					25 = { add_trait = kind }
					25 = { add_trait = honest }
					25 = { add_trait = lustful }
				}   
			}
			500 = {} # Nothing; random traits are set initially, so this could be good
		}
	}
}

increase_tributary_tier_or_vassalize_effect = {
	save_event_target_as = target_tributary
	if = {
		limit = {
			is_tributary = {
				type = chinese_client_state
			}
		}
		any_vassal = {
			limit = {
				tier = king
			}
			set_defacto_liege = e_china
		}
		any_demesne_title = {
			limit = {
				tier = emperor
			}
			unsafe_destroy_landed_title = THIS
		}
		hidden_tooltip = {
			e_china = {
				holder_scope = {
					hidden_tooltip = {
						remove_tributary = event_target:target_tributary
					}
					remove_tributary = event_target:target_tributary
				}
			}
		}
		set_defacto_liege = e_china
	}
	else_if = {
		limit = {
			is_tributary = {
				type = chinese_protectorate
			}
		}
		e_china = {
			holder_scope = {
				hidden_tooltip = {
					remove_tributary = event_target:target_tributary
				}
				make_tributary = {
					who = event_target:target_tributary
					tributary_type = chinese_client_state
				}
			}
		}
	}
	else_if = {
		limit = {
			is_tributary = {
				type = chinese_imperial_tributary
			}
		}
		e_china = {
			holder_scope = {
				hidden_tooltip = {
					remove_tributary = event_target:target_tributary
				}
				make_tributary = {
					who = event_target:target_tributary
					tributary_type = chinese_protectorate
				}
			}
		}
	}
	else = {
		e_china = {
			holder_scope = {
				hidden_tooltip = {
					remove_tributary = event_target:target_tributary
				}
				make_tributary = {
					who = event_target:target_tributary
					tributary_type = chinese_imperial_tributary
				}
			}
		}
	}
	e_china = {
		holder_scope = {
			opinion = {
				who = event_target:target_tributary
				modifier = opinion_grace_increased_tributary_tier
			}
		}
	}
	clear_event_target = target_tributary
}

increase_tributary_tier_or_vassalize_end_of_war_effect = {
	save_event_target_as = target_tributary
	if = {
		limit = {
			e_china = {
				holder_scope = {
					reverse_has_opinion_modifier = {
						who = event_target:target_tributary
						modifier = i_was_client_state
					}
				}
			}
		}
		any_vassal = {
			limit = {
				tier = king
			}
			set_defacto_liege = e_china
		}
		any_demesne_title = {
			limit = {
				tier = emperor
			}
			unsafe_destroy_landed_title = THIS
		}
		hidden_tooltip = {
			e_china = {
				holder_scope = {
					hidden_tooltip = {
						remove_tributary = event_target:target_tributary
						reverse_remove_opinion = {
							who = event_target:target_tributary
							modifier = i_was_client_state
						}
					}
					remove_tributary = event_target:target_tributary
				}
			}
		}
		set_defacto_liege = e_china
	}
	else_if = {
		limit = {
			e_china = {
				holder_scope = {
					reverse_has_opinion_modifier = {
						who = event_target:target_tributary
						modifier = i_was_protectorate
					}
				}
			}
		}
		e_china = {
			holder_scope = {
				hidden_tooltip = {
					remove_tributary = event_target:target_tributary
					reverse_remove_opinion = {
						who = event_target:target_tributary
						modifier = i_was_protectorate
					}
				}
				make_tributary = {
					who = event_target:target_tributary
					tributary_type = chinese_client_state
				}
			}
		}
	}
	else_if = {
		limit = {
			e_china = {
				holder_scope = {
					reverse_has_opinion_modifier = {
						who = event_target:target_tributary
						modifier = i_was_imperial_tributary
					}
				}
			}
		}
		e_china = {
			holder_scope = {
				hidden_tooltip = {
					remove_tributary = event_target:target_tributary
					reverse_remove_opinion = {
						who = event_target:target_tributary
						modifier = i_was_imperial_tributary
					}
				}
				make_tributary = {
					who = event_target:target_tributary
					tributary_type = chinese_protectorate
				}
			}
		}
	}
	else = {
		e_china = {
			holder_scope = {
				hidden_tooltip = {
					remove_tributary = event_target:target_tributary
					reverse_remove_opinion = {
						who = event_target:target_tributary
						modifier = i_was_misc_tributary
					}
				}
				make_tributary = {
					who = event_target:target_tributary
					tributary_type = chinese_imperial_tributary
				}
			}
		}
	}
	e_china = {
		holder_scope = {
			opinion = {
				who = event_target:target_tributary
				modifier = opinion_grace_increased_tributary_tier
			}
		}
	}
	clear_event_target = target_tributary
}

decrease_tributary_tier_or_release_effect = {
	save_event_target_as = target_tributary
	if = {
		limit = {
			is_tributary = {
				type = chinese_client_state
			}
		}
		suzerain = {
			hidden_tooltip = {
				remove_tributary = event_target:target_tributary
			}
		}
		e_china = {
			holder_scope = {
				make_tributary = {
					who = event_target:target_tributary
					tributary_type = chinese_protectorate
				}
			}
		}
	}
	else_if = {
		limit = {
			is_tributary = {
				type = chinese_protectorate
			}
		}
		suzerain = {
			hidden_tooltip = {
				remove_tributary = event_target:target_tributary
			}
		}
		e_china = {
			holder_scope = {
				make_tributary = {
					who = event_target:target_tributary
					tributary_type = chinese_imperial_tributary
				}
			}
		}
	}
	else_if = {
		limit = {
			is_tributary = {
				type = chinese_imperial_tributary
			}
		}
		suzerain = {
			hidden_tooltip = {
				remove_tributary = event_target:target_tributary
			}
		}
		e_china = {
			holder_scope = {
				make_tributary = {
					who = event_target:target_tributary
					tributary_type = chinese_peripheral_tributary
				}
			}
		}
	}
	else = {
		suzerain = {
			hidden_tooltip = {
				remove_tributary = event_target:target_tributary
			}
			opinion = {
				who = event_target:target_tributary
				modifier = opinion_china_breakaway_tributary
			}
		}
	}
	e_china = {
		holder_scope = {
			opinion = {
				who = event_target:target_tributary
				modifier = opinion_grace_decreased_tributary_tier
			}
		}
	}
	clear_event_target = target_tributary
}

sixteen_prefectures_transfer_effect = { # (Later) Jin/Tang to Liao
	log = "The Sixteen Prefectures are being handed over"
	# Kings
	any_realm_lord = {
		limit = {
			tier = king
			# Owns land in the Sixteen Prefectures
			any_demesne_title = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
		}
		log = "[This.GetBestName] holds land in the Sixteen Prefectures!"
		# The vassal becomes a Liao tributary
		if = {
			limit = {
				NOT = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
			}
			log = "[This.GetBestName] holds no land elsewhere!"
			# Take care of sub-vassals that shouldn't become Liao tributaries
			any_realm_lord = {
				limit = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
				log = "[This.GetBestName] remains with the Black Turtle!"
				set_defacto_liege = e_black_turtle
			}
			log = "[This.GetBestName] became a Liao tributary!"
			set_defacto_liege = THIS
			event_target:liao_emperor = {
				make_tributary = {
					who = PREV
					tributary_type = nomadic
				}
			}
		}
		# A new ruler is created as a Liao tributary
		else = {
			log = "[This.GetBestName] holds land elsewhere!"
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 25
			}
			new_character = {
				save_event_target_as = liao_tributary_character
			}
			any_demesne_title = {
				limit = {
					OR = {
						title = c_wuzhai
						title = c_shuozhou
						title = c_datong
						title = c_dadu
						title = c_zhangjiakou
						title = c_chengde
						title = c_kaiping
					}
				}
				grant_title_no_opinion = event_target:liao_tributary_character
			}
			event_target:liao_tributary_character = {
				log = "[This.GetBestName] is the actual Liao tributary!"
				set_defacto_liege = THIS
				event_target:liao_emperor = {
					make_tributary = {
						who = PREV
						tributary_type = nomadic
					}
				}
			}
		}
	}

	# Dukes
	any_realm_lord = {
		limit = {
			tier = duke
			# Owns land in the Sixteen Prefectures
			any_demesne_title = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
		}
		log = "[This.GetBestName] holds land in the Sixteen Prefectures!"
		# The vassal becomes a Liao tributary
		if = {
			limit = {
				NOT = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
			}
			log = "[This.GetBestName] holds no land elsewhere!"
			# Take care of sub-vassals that shouldn't become Liao tributaries
			any_realm_lord = {
				limit = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
				log = "[This.GetBestName] remains with the Black Turtle!"
				set_defacto_liege = e_black_turtle
			}
			log = "[This.GetBestName] became a Liao tributary!"
			set_defacto_liege = THIS
			event_target:liao_emperor = {
				make_tributary = {
					who = PREV
					tributary_type = nomadic
				}
			}
		}
		# A new ruler is created as a Liao tributary
		else = {
			log = "[This.GetBestName] holds land elsewhere!"
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 25
			}
			new_character = {
				save_event_target_as = liao_tributary_character
			}
			any_demesne_title = {
				limit = {
					OR = {
						title = c_wuzhai
						title = c_shuozhou
						title = c_datong
						title = c_dadu
						title = c_zhangjiakou
						title = c_chengde
						title = c_kaiping
					}
				}
				grant_title_no_opinion = event_target:liao_tributary_character
			}
			event_target:liao_tributary_character = {
				log = "[This.GetBestName] is the actual Liao tributary!"
				set_defacto_liege = THIS
				event_target:liao_emperor = {
					make_tributary = {
						who = PREV
						tributary_type = nomadic
					}
				}
			}
		}
	}

	# Counts
	any_realm_lord = {
		limit = {
			tier = count
			# Owns land in the Sixteen Prefectures
			any_demesne_title = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
		}
		log = "[This.GetBestName] holds land in the Sixteen Prefectures!"
		# The vassal becomes a Liao tributary
		if = {
			limit = {
				NOT = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
			}
			log = "[This.GetBestName] holds no land elsewhere!"
			log = "[This.GetBestName] became a Liao tributary!"
			set_defacto_liege = THIS
			event_target:liao_emperor = {
				make_tributary = {
					who = PREV
					tributary_type = nomadic
				}
			}
		}
		# A new ruler is created as a Liao tributary
		else = {
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 25
			}
			new_character = {
				save_event_target_as = liao_tributary_character
			}
			any_demesne_title = {
				limit = {
					OR = {
						title = c_wuzhai
						title = c_shuozhou
						title = c_datong
						title = c_dadu
						title = c_zhangjiakou
						title = c_chengde
						title = c_kaiping
					}
				}
				grant_title_no_opinion = event_target:liao_tributary_character
			}
			event_target:liao_tributary_character = {
				log = "[This.GetBestName] is the actual Liao tributary!"
				set_defacto_liege = THIS
				event_target:liao_emperor = {
					make_tributary = {
						who = PREV
						tributary_type = nomadic
					}
				}
			}
		}
	}

	# ROOT, if relevant
	if = {
		limit = {
			any_demesne_title = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
		}
		# A new ruler is created as a Liao tributary
		create_random_soldier = {
			random_traits = yes
			dynasty = random
			religion = ROOT
			culture = ROOT
			female = no
			age = 25
		}
		new_character = {
			save_event_target_as = liao_tributary_character
		}
		any_demesne_title = {
			limit = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
			grant_title_no_opinion = event_target:liao_tributary_character
		}
		event_target:liao_tributary_character = {
			log = "[This.GetBestName] is the actual Liao tributary!"
			set_defacto_liege = THIS
			event_target:liao_emperor = {
				make_tributary = {
					who = PREV
					tributary_type = nomadic
				}
			}
		}
	}
}

sixteen_prefectures_transfer_2_effect = { # (Jurchen) Jin to Song
	log = "The Sixteen Prefectures are being handed over"
	# Kings
	any_realm_lord = {
		limit = {
			tier = king
			# Owns land in the Sixteen Prefectures
			any_demesne_title = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
		}
		log = "[This.GetBestName] holds land in the Sixteen Prefectures!"
		# The vassal becomes a Song vassal
		if = {
			limit = {
				NOT = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
			}
			log = "[This.GetBestName] holds no land elsewhere!"
			# Take care of sub-vassals that shouldn't become Song vassals
			any_realm_lord = {
				limit = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
				log = "[This.GetBestName] remains with Jurchen Jin!"
				set_defacto_liege = e_golden_river
			}
			log = "[This.GetBestName] became a Song vassal!"
			set_defacto_liege = e_china
		}
		# A new ruler is created as a Song vassal
		else = {
			log = "[This.GetBestName] holds land elsewhere!"
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = confucian
				culture = han
				female = no
				age = 25
			}
			new_character = {
				save_event_target_as = song_vassal_character
			}
			any_demesne_title = {
				limit = {
					OR = {
						title = c_wuzhai
						title = c_shuozhou
						title = c_datong
						title = c_dadu
						title = c_zhangjiakou
						title = c_chengde
						title = c_kaiping
					}
				}
				grant_title_no_opinion = event_target:song_vassal_character
			}
			event_target:song_vassal_character = {
				log = "[This.GetBestName] is the actual Song vassal!"
				set_defacto_liege = e_china
			}
		}
	}

	# Dukes
	any_realm_lord = {
		limit = {
			tier = duke
			# Owns land in the Sixteen Prefectures
			any_demesne_title = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
		}
		log = "[This.GetBestName] holds land in the Sixteen Prefectures!"
		# The vassal becomes a Song vassal
		if = {
			limit = {
				NOT = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
			}
			log = "[This.GetBestName] holds no land elsewhere!"
			# Take care of sub-vassals that shouldn't become Liao tributaries
			any_realm_lord = {
				limit = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
				log = "[This.GetBestName] remains with Jurchen Jin!"
				set_defacto_liege = e_golden_river
			}
			log = "[This.GetBestName] became a Song vassal!"
			set_defacto_liege = e_china
		}
		# A new ruler is created as a Song vassal
		else = {
			log = "[This.GetBestName] holds land elsewhere!"
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = confucian
				culture = han
				female = no
				age = 25
			}
			new_character = {
				save_event_target_as = song_vassal_character
			}
			any_demesne_title = {
				limit = {
					OR = {
						title = c_wuzhai
						title = c_shuozhou
						title = c_datong
						title = c_dadu
						title = c_zhangjiakou
						title = c_chengde
						title = c_kaiping
					}
				}
				grant_title_no_opinion = event_target:song_vassal_character
			}
			event_target:song_vassal_character = {
				log = "[This.GetBestName] is the actual Song vassal!"
				set_defacto_liege = e_china
			}
		}
	}

	# Counts
	any_realm_lord = {
		limit = {
			tier = count
			# Owns land in the Sixteen Prefectures
			any_demesne_title = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
		}
		log = "[This.GetBestName] holds land in the Sixteen Prefectures!"
		# The vassal becomes a Song vassal
		if = {
			limit = {
				NOT = {
					any_demesne_title = {
						tier = count
						NOR = {
							title = c_wuzhai
							title = c_shuozhou
							title = c_datong
							title = c_dadu
							title = c_zhangjiakou
							title = c_chengde
							title = c_kaiping
						}
					}
				}
			}
			log = "[This.GetBestName] holds no land elsewhere!"
			log = "[This.GetBestName] became a Song vassal!"
			set_defacto_liege = e_china
		}
		# A new ruler is created as a Song vassal
		else = {
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = confucian
				culture = han
				female = no
				age = 25
			}
			new_character = {
				save_event_target_as = song_vassal_character
			}
			any_demesne_title = {
				limit = {
					OR = {
						title = c_wuzhai
						title = c_shuozhou
						title = c_datong
						title = c_dadu
						title = c_zhangjiakou
						title = c_chengde
						title = c_kaiping
					}
				}
				grant_title_no_opinion = event_target:song_vassal_character
			}
			event_target:song_vassal_character = {
				log = "[This.GetBestName] is the actual Song vassal!"
				set_defacto_liege = e_china
			}
		}
	}

	# ROOT, if relevant
	if = {
		limit = {
			any_demesne_title = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
		}
		# A new ruler is created as a Song vassal
		create_random_soldier = {
			random_traits = yes
			dynasty = random
			religion = confucian
			culture = han
			female = no
			age = 25
		}
		new_character = {
			save_event_target_as = song_vassal_character
		}
		any_demesne_title = {
			limit = {
				OR = {
					title = c_wuzhai
					title = c_shuozhou
					title = c_datong
					title = c_dadu
					title = c_zhangjiakou
					title = c_chengde
					title = c_kaiping
				}
			}
			grant_title_no_opinion = event_target:song_vassal_character
		}
		event_target:song_vassal_character = {
			log = "[This.GetBestName] is the actual Song vassal!"
			set_defacto_liege = e_china
		}
	}
}

create_chinese_strategist_effect = {
	random_list = {
		50 = { #Female
			modifier = {
				NOR = {
					has_game_rule = {
						name = gender
						value = all
					}
					primary_title = {
						has_law = status_of_women_4
					}
					has_religion_feature = religion_matriarchal
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
				}
				factor = 0
			}
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 6
						diplomacy = 2
						stewardship = 3
						intrigue = 4
						learning = 2
					}
				}
			}
			else = {
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 6
						diplomacy = 2
						stewardship = 3
						intrigue = 4
						learning = 2
					}
				}
			}
		}
		50 = { #Male
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = no
					health = 7
					random_traits = no
					attributes = {
						martial = 6
						diplomacy = 2
						stewardship = 3
						intrigue = 4
						learning = 2
					}
				}
			}
			else = {
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = no
					health = 7
					random_traits = no
					attributes = {
						martial = 6
						diplomacy = 2
						stewardship = 3
						intrigue = 4
						learning = 2
					}
				}
			}
		}
	}
	new_character = {
		#Education & other basic stuff
		save_event_target_as = chinese_strategist
		add_character_modifier = {
			name = jd_strategist
			duration = -1
		}
		if = {
			limit = {
				ROOT = { # TODO: Check appropriate character
					has_character_modifier = mandate_of_heaven_5
				}
			}
			random_list = {
				25 = {
					trigger = { NOT = {trait = master_of_flame } }
					add_trait = master_of_flame
				}
				25 = {
					trigger = { NOT = {trait = logistics_expert } }
					add_trait = logistics_expert
				}
				25 = {
					trigger = { NOT = {trait = levy_coordinator } }
					add_trait = levy_coordinator
				}
				25 = {
					trigger = { NOT = {trait = sapper } }
					add_trait = sapper
				}
			}
			set_character_flag = jd_strategist_golden_age
		}
		set_character_flag = ai_flag_refuse_concubinage
		set_character_flag = ai_flag_refuse_marriage
		set_character_flag = originated_from_chinese_court
		set_character_flag = no_court_invites
		set_character_flag = is_chinese_strategist
		random_list = {
			80 = { add_trait = skilled_tactician }
			20 = { add_trait = brilliant_strategist }
		}
		random_list = {
			20 = { add_trait = brave } 
			20 = { add_trait = strong }
			20 = { add_trait = shrewd }
			40 = { add_trait = robust }
		}
		random_list = {
			71 = { } #Nothing
			20 = { add_trait = scarred }
			5 = { 
				trigger = { has_dlc = Reapers }
				add_trait = one_eyed 
				change_martial = 1
			}
			2 = { 
				trigger = { has_dlc = Reapers }
				add_trait = one_handed
				change_martial = 1
			}
			2 = { add_trait = ugly }
		}
		random = {
			chance = 10
			add_trait = homosexual
		}
		opinion = {
			who = ROOT
			modifier = opinion_servant
			months = 1200
		}
		random_list = {
			50 = {}
			25 = {
				religion = confucian
			}
			20 = {
				religion = taoist
			}
			4 = {
				religion = buddhist
			}
			1 = {
				religion = nestorian
			}
		}
		#Add archetype 
		random_list = {
			#Conservative 
			25 = {
				set_character_flag = archetype_conservative
				if = {
					limit = { has_dlc = "Way of Life" }
					add_trait = strategist
				}
				add_trait = logistics_expert
				random = {
					chance = 50
					add_trait = zealous
				}
				add_trait = stubborn
				add_trait = temperate
				random_list = {
					20 = { add_trait = greedy }
					20 = { add_trait = wroth }
					20 = { add_trait = deceitful }
					20 = { add_trait = shy }
					20 = { add_trait = cruel }
				}
				random_list = {
					25 = { add_trait = poet }
					25 = { add_trait = chaste }
					25 = { 
						add_trait = patient
						remove_trait = wroth
					}
					25 = { add_trait = just }
				}
			}
			#Supportive
			25 = {
				set_character_flag = archetype_supportive
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						50 = { add_trait = hunter }
						50 = { add_trait = strategist }
					}
				}
				add_trait = sapper 
				add_trait = humble
				add_trait = patient
				random_list = {
					30 = { add_trait = slothful }
					70 = { add_trait = shy }
				}
				random_list = {
					25 = { add_trait = content }
					25 = { add_trait = charitable }
					25 = { add_trait = kind }
					25 = { add_trait = trusting }
				}  
			}
			#Decisive
			25 = {
				set_character_flag = archetype_decisive
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						50 = { add_trait = strategist }
						50 = { add_trait = duelist }
					}
				}
				add_trait = master_of_flame 
				add_trait = ambitious
				add_trait = cynical
				random_list = {
					20 = { add_trait = cruel }
					20 = { add_trait = stubborn }
					20 = { add_trait = greedy }
					20 = { add_trait = wroth }
					20 = { add_trait = proud }
				}
				random_list = {
					20 = { add_trait = falconer }
					20 = { add_trait = diligent }
					20 = { add_trait = brave }
					20 = { add_trait = honest }
					20 = { add_trait = gregarious }
				}
			}
			#Sociable
			25 = {
				set_character_flag = archetype_sociable
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						20 = { add_trait = duelist }
						40 = { add_trait = hunter }
						40 = { add_trait = gamer }
					}
				}
				add_trait = levy_coordinator 
				add_trait = gregarious
				add_trait = charitable
				random_list = {
					33 = { add_trait = envious }
					33 = { add_trait = gluttonous }
					33 = { add_trait = proud }
				}
				random_list = {
					25 = { add_trait = falconer }
					25 = { add_trait = kind }
					25 = { add_trait = honest }
					25 = { add_trait = lustful }
				}   
			}
		}

		#Add second commander trait
		random_list = {
			10 = {
				trigger = { NOT = {trait = master_of_flame } }
				add_trait = master_of_flame
			}
			10 = {
				trigger = { NOT = {trait = logistics_expert } }
				add_trait = logistics_expert
			}
			10 = {
				trigger = { NOT = {trait = levy_coordinator } }
				add_trait = levy_coordinator
			}
			10 = {
				trigger = { NOT = {trait = sapper } }
				add_trait = sapper
			}
			60 = {}
		}
	}
	new_character = {
		save_event_target_as = new_strategist
	}
}

create_chinese_siege_engineer_effect = {
	random_list = {
		33 = {
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				random_list = {
					50 = { #Female
						modifier = {
							NOR = {
								has_game_rule = {
									name = gender
									value = all
								}
								primary_title = {
									has_law = status_of_women_4
								}
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_equal
								has_religion_feature = religion_feature_bon
								has_religion_feature = religion_feature_ryukyuan_three_mountains
								has_religion_feature = religion_feature_ryukyuan_historical
							}
							factor = 0
						}
						create_random_soldier = {
							age = 55
							dynasty = actually_culture
							religion = ROOT
							culture = ROOT
							female = yes
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 16
							}
						}
					}
					50 = {
						create_random_soldier = {
							age = 55
							dynasty = actually_culture
							religion = ROOT
							culture = ROOT
							female = no
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 16
							}
						}
					}
				}
			}
			else = {
				random_list = {
					50 = { #Female
						modifier = {
							NOR = {
								has_game_rule = {
									name = gender
									value = all
								}
								primary_title = {
									has_law = status_of_women_4
								}
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_equal
								has_religion_feature = religion_feature_bon
								has_religion_feature = religion_feature_ryukyuan_three_mountains
								has_religion_feature = religion_feature_ryukyuan_historical
							}
							factor = 0
						}
						create_random_soldier = {
							age = 55
							dynasty = actually_culture
							religion = confucian
							culture = han
							female = yes
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 16
							}
						}
					}
					50 = {
						create_random_soldier = {
							age = 55
							dynasty = actually_culture
							religion = confucian
							culture = han
							female = no
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 16
							}
						}
					}
				}
			}
			new_character = {
				save_event_target_as = chinese_siege_engineer
				set_character_flag = ai_flag_refuse_concubinage
				set_character_flag = ai_flag_refuse_marriage
				set_character_flag = originated_from_chinese_court
				set_character_flag = no_court_invites
				set_character_flag = taught_chinese_strategy
				set_character_flag = is_chinese_siege_engineer
				
				remove_trait = weak
				remove_trait = slow
				remove_trait = imbecile
				remove_trait = dull
				
				remove_trait = craven
				remove_trait = mystic
				remove_trait = socializer
				remove_trait = gamer
				remove_trait = hedonist
				remove_trait = duelist
				remove_trait = hunter
				remove_trait = strategist
				remove_trait = administrator
				remove_trait = architect
				remove_trait = gardener
				remove_trait = schemer
				remove_trait = impaler
				remove_trait = seducer
				remove_trait = seductress
				remove_trait = theologian
				remove_trait = scholar
				
				add_trait = sapper
				if = {
					limit = {
						ROOT = { # TODO: Check appropriate character
							has_character_modifier = mandate_of_heaven_5
						}
					}
					change_martial = 5
				}
				
				random_list = { # Flavor Randomization
					15 = {
						change_martial = 2
					}
					10 = {
						add_trait = robust
					}
					10 = {
						add_trait = duelist
					}
					10 = {
						add_trait = architect
					}
					5 = {
						add_trait = strategist
					}
					5 = {
						change_martial = 4
					}
					5 = {
						if = {
							limit = {
								has_dlc = "Reapers"
							}
							add_trait = one_eyed
						}
					}
					5 = { 
						add_trait = shrewd
					}
				}
				opinion = {
					who = ROOT
					modifier = opinion_servant
					months = 1200
				}
			}
		}
		33 = {
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				random_list = {
					50 = { #Female
						modifier = {
							NOR = {
								has_game_rule = {
									name = gender
									value = all
								}
								primary_title = {
									has_law = status_of_women_4
								}
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_equal
								has_religion_feature = religion_feature_bon
								has_religion_feature = religion_feature_ryukyuan_three_mountains
								has_religion_feature = religion_feature_ryukyuan_historical
							}
							factor = 0
						}
						create_random_soldier = {
							age = 35
							dynasty = actually_culture
							religion = ROOT
							culture = ROOT
							female = yes
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 8
							}
						}
					}
					50 = {
						create_random_soldier = {
							age = 35
							dynasty = actually_culture
							religion = ROOT
							culture = ROOT
							female = no
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 8
							}
						}
					}
				}
			}
			else = {
				random_list = {
					50 = { #Female
						modifier = {
							NOR = {
								has_game_rule = {
									name = gender
									value = all
								}
								primary_title = {
									has_law = status_of_women_4
								}
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_equal
								has_religion_feature = religion_feature_bon
								has_religion_feature = religion_feature_ryukyuan_three_mountains
								has_religion_feature = religion_feature_ryukyuan_historical
							}
							factor = 0
						}
						create_random_soldier = {
							age = 35
							dynasty = actually_culture
							religion = confucian
							culture = han
							female = yes
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 8
							}
						}
					}
					50 = {
						create_random_soldier = {
							age = 35
							dynasty = actually_culture
							religion = confucian
							culture = han
							female = no
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 8
							}
						}
					}
				}
			}
			new_character = {
				save_event_target_as = chinese_siege_engineer
				set_character_flag = ai_flag_refuse_concubinage
				set_character_flag = ai_flag_refuse_marriage
				set_character_flag = originated_from_chinese_court
				set_character_flag = no_court_invites
				set_character_flag = taught_chinese_strategy
				set_character_flag = is_chinese_siege_engineer
				
				remove_trait = weak
				remove_trait = slow
				remove_trait = imbecile
				remove_trait = dull
				
				remove_trait = craven
				remove_trait = mystic
				remove_trait = socializer
				remove_trait = gamer
				remove_trait = hedonist
				remove_trait = duelist
				remove_trait = hunter
				remove_trait = strategist
				remove_trait = administrator
				remove_trait = architect
				remove_trait = gardener
				remove_trait = schemer
				remove_trait = impaler
				remove_trait = seducer
				remove_trait = seductress
				remove_trait = theologian
				remove_trait = scholar
				
				add_trait = sapper
				random_list = { # Flavor Randomization
					15 = {
						change_martial = 2
					}
					10 = {
						add_trait = robust
					}
					10 = {
						add_trait = duelist
					}
					10 = {
						add_trait = architect
					}
					5 = {
						add_trait = strategist
					}
					5 = {
						change_martial = 4
					}
					5 = {
						if = {
							limit = {
								has_dlc = "Reapers"
							}
							add_trait = one_eyed
						}
					}
					5 = { 
						add_trait = shrewd
					}
				}
				opinion = {
					who = ROOT
					modifier = opinion_servant
					months = 1200
				}
			}
		}
		33 = {
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				random_list = {
					50 = { #Female
						modifier = {
							NOR = {
								has_game_rule = {
									name = gender
									value = all
								}
								primary_title = {
									has_law = status_of_women_4
								}
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_equal
								has_religion_feature = religion_feature_bon
								has_religion_feature = religion_feature_ryukyuan_three_mountains
								has_religion_feature = religion_feature_ryukyuan_historical
							}
							factor = 0
						}
						create_random_soldier = {
							age = 37
							dynasty = actually_culture
							religion = ROOT
							culture = ROOT
							female = yes
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 8
							}
						}
					}
					50 = {
						create_random_soldier = {
							age = 37
							dynasty = actually_culture
							religion = ROOT
							culture = ROOT
							female = no
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 8
							}
						}
					}
				}
			}
			else = {
				random_list = {
					50 = { #Female
						modifier = {
							NOR = {
								has_game_rule = {
									name = gender
									value = all
								}
								primary_title = {
									has_law = status_of_women_4
								}
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_equal
								has_religion_feature = religion_feature_bon
								has_religion_feature = religion_feature_ryukyuan_three_mountains
								has_religion_feature = religion_feature_ryukyuan_historical
							}
							factor = 0
						}
						create_random_soldier = {
							age = 37
							dynasty = actually_culture
							religion = confucian
							culture = han
							female = yes
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 8
							}
						}
					}
					50 = {
						create_random_soldier = {
							age = 37
							dynasty = actually_culture
							religion = confucian
							culture = han
							female = no
							random_traits = yes
							attributes = {
								diplomacy = 2
								learning = 2
								stewardship = 2
								intrigue = 2
								martial = 8
							}
						}
					}
				}
			}
			new_character = {
				save_event_target_as = chinese_siege_engineer
				set_character_flag = ai_flag_refuse_concubinage
				set_character_flag = ai_flag_refuse_marriage
				set_character_flag = originated_from_chinese_court
				set_character_flag = no_court_invites
				set_character_flag = taught_chinese_strategy
				set_character_flag = is_chinese_siege_engineer
				
				remove_trait = weak
				remove_trait = slow
				remove_trait = imbecile
				remove_trait = dull
				
				remove_trait = craven
				remove_trait = mystic
				remove_trait = socializer
				remove_trait = gamer
				remove_trait = hedonist
				remove_trait = duelist
				remove_trait = hunter
				remove_trait = strategist
				remove_trait = administrator
				remove_trait = architect
				remove_trait = gardener
				remove_trait = schemer
				remove_trait = impaler
				remove_trait = seducer
				remove_trait = seductress
				remove_trait = theologian
				remove_trait = scholar
				
				add_trait = sapper
				
				random_list = { # Flavor Randomization
					15 = {
						change_martial = 2
					}
					10 = {
						add_trait = robust
					}
					10 = {
						add_trait = duelist
					}
					10 = {
						add_trait = architect
					}
					5 = {
						add_trait = strategist
					}
					5 = {
						change_martial = 4
					}
					5 = {
						if = {
							limit = {
								has_dlc = "Reapers"
							}
							add_trait = one_eyed
						}
					}
					5 = { 
						add_trait = shrewd
					}
				}
				opinion = {
					who = ROOT
					modifier = opinion_servant
					months = 1200
				}
			}
		}
	}
	new_character = {
		random_list = {
			50 = {}
			25 = {
				religion = confucian
			}
			20 = {
				religion = taoist
			}
			4 = {
				religion = buddhist
			}
			1 = {
				religion = nestorian
			}
		}
		save_event_target_as = new_siege_engineer
	}
}

create_chinese_administrator_effect = {
	random_list = {
		50 = { #Female
			modifier = {
				NOR = {
					has_game_rule = {
						name = gender
						value = all
					}
					primary_title = {
						has_law = status_of_women_4
					}
					has_religion_feature = religion_matriarchal
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
				}
				factor = 0.05
			}
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 6
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 4
						stewardship = 6
						intrigue = 2
						learning = 5
					}
				}
			}
			else = {
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 6
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 4
						stewardship = 6
						intrigue = 2
						learning = 5
					}
				}
			}
		}
		50 = { #Male
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = no
					health = 6
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 4
						stewardship = 6
						intrigue = 2
						learning = 5
					}
				}
			}
			else = {
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = no
					health = 6
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 4
						stewardship = 6
						intrigue = 2
						learning = 5
					}
				}
			}
		}
	}
	new_character = {
		#Education & other basic stuff
		save_event_target_as = chinese_administrator
		add_character_modifier = {
			name = jd_administrator
			duration = -1
		}
		if = {
			limit = {
				ROOT = { # TODO: Check appropriate character
					has_character_modifier = mandate_of_heaven_5
				}
			}
			set_character_flag = jd_administrator_golden_age
		}
		set_character_flag = ai_flag_refuse_concubinage
		set_character_flag = ai_flag_refuse_marriage
		set_character_flag = originated_from_chinese_court
		set_character_flag = no_court_invites
		set_character_flag = is_chinese_administrator
		random_list = {
			30 = { add_trait = thrifty_clerk }
			15 = { add_trait = fortune_builder }
			5 = { add_trait = midas_touched }
			30 = { add_trait = martial_cleric }
			15 = { add_trait = scholarly_theologian }
			5 = { add_trait = mastermind_theologian }
		}
		random_list = {
			20 = { } #Nothing
			30 = { add_trait = erudite }
			25 = { add_trait = shrewd }
			15 = { add_trait = quick }
			5 = { add_trait = genius }
			5 = { add_trait = fair }
		}
		random_list = {
			85 = { } #Nothing
			1 = { add_trait = clubfooted }
			2 = { add_trait = harelip }
			2 = { add_trait = hunchback }
			3 = { add_trait = lisp }
			3 = { add_trait = stutter }
			2 = { 
				add_trait = ugly 
				remove_trait = fair 
			}
			1 = { add_trait = dwarf }
			1 = {  add_trait = weak }
		}
		random = {
			chance = 10
			add_trait = homosexual
		}
		opinion = {
			who = ROOT
			modifier = opinion_servant
			months = 1200
		}

		#Add archetype 
		random_list = {
			#Conservative 
			25 = {
				set_character_flag = archetype_conservative
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						50 = { add_trait = scholar }
						50 = { add_trait = administrator }
					}
				}
				random = {
					chance = 50
					add_trait = zealous
				}
				add_trait = stubborn
				add_trait = temperate
				random_list = {
					20 = { add_trait = greedy }
					20 = { add_trait = wroth }
					20 = { add_trait = deceitful }
					20 = { add_trait = shy }
					20 = { add_trait = cruel }
				}
				random_list = {
					25 = { add_trait = poet }
					25 = { add_trait = chaste }
					25 = { 
						add_trait = patient
						remove_trait = wroth
					}
					25 = { add_trait = just }
				}
			}
			#Supportive
			25 = {
				set_character_flag = archetype_supportive
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						50 = { add_trait = administrator }
						25 = { add_trait = scholar }
						25 = { add_trait = gardener }
					}
				}
				add_trait = humble
				add_trait = patient
				random_list = {
					33 = { add_trait = slothful }
					33 = { add_trait = craven }
					33 = { add_trait = shy }
				}
				random_list = {
					25 = { add_trait = content }
					25 = { add_trait = charitable }
					25 = { add_trait = kind }
					25 = { add_trait = trusting }
				}  
			}
			#Decisive
			25 = {
				set_character_flag = archetype_decisive
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						75 = { add_trait = administrator }
						25 = { add_trait = architect }
					}
				}
				add_trait = ambitious
				add_trait = cynical
				random_list = {
					20 = { add_trait = cruel }
					20 = { add_trait = stubborn }
					20 = { add_trait = greedy }
					20 = { add_trait = wroth }
					20 = { add_trait = proud }
				}
				random_list = {
					20 = { add_trait = falconer }
					20 = { add_trait = diligent }
					20 = { add_trait = brave }
					20 = { add_trait = honest }
					20 = { add_trait = gregarious }
				}
			}
			#Sociable
			25 = {
				set_character_flag = archetype_sociable
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						25 = { add_trait = administrator }
						30 = { add_trait = socializer }
						25 = { add_trait = hedonist}
						20 = {
							trigger = { is_female = yes }
							add_trait = seductress
							add_trait = lustful
						}
						20 = {
							trigger = { is_female = no }
							add_trait = seducer
							add_trait = lustful
						}
					}
				}
				add_trait = gregarious
				add_trait = charitable
				random_list = {
					25 = { add_trait = craven }
					25 = { add_trait = envious }
					25 = { add_trait = gluttonous }
					25 = { add_trait = proud }
				}
				random_list = {
					25 = { add_trait = poet }
					25 = { add_trait = kind }
					25 = { add_trait = honest }
					25 = { add_trait = lustful }
				}   
			}
		}
	}
	new_character = {
		random_list = {
			50 = {}
			25 = {
				religion = confucian
			}
			20 = {
				religion = taoist
			}
			4 = {
				religion = buddhist
			}
			1 = {
				religion = nestorian
			}
		}
		save_event_target_as = new_administrator
	}
}

create_chinese_master_engineer_effect = {
	random_list = {
		50 = { #Female
			modifier = {
				NOR = {
					has_game_rule = {
						name = gender
						value = all
					}
					primary_title = {
						has_law = status_of_women_4
					}
					has_religion_feature = religion_matriarchal
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
				}
				factor = 0.05
			}
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 6
					random_traits = no
					attributes = {
						martial = 5
						diplomacy = 2
						stewardship = 6
						intrigue = 3
						learning = 3
					}
				}
			}
			else = {
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 6
					random_traits = no
					attributes = {
						martial = 5
						diplomacy = 2
						stewardship = 6
						intrigue = 3
						learning = 3
					}
				}
			}
		}
		50 = { #Male
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = no
					health = 6
					random_traits = no
					attributes = {
						martial = 5
						diplomacy = 2
						stewardship = 6
						intrigue = 3
						learning = 3
					}
				}
			}
			else = {
				create_character = {
					age = 30
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = no
					health = 6
					random_traits = no
					attributes = {
						martial = 5
						diplomacy = 2
						stewardship = 6
						intrigue = 3
						learning = 3
					}
				}
			}
		}
	}
	new_character = {
		#Education & other basic stuff
		save_event_target_as = chinese_master_engineer
		add_character_modifier = {
			name = jd_master_engineer
			duration = -1
		}
		set_character_flag = master_engineer_just_spawned
		if = {
			limit = {
				ROOT = { # TODO: Check appropriate character
					has_character_modifier = mandate_of_heaven_5
				}
			}
			set_character_flag = china_master_engineer_golden_age
		}
		set_character_flag = ai_flag_refuse_concubinage
		set_character_flag = ai_flag_refuse_marriage
		set_character_flag = originated_from_chinese_court
		set_character_flag = no_court_invites
		set_character_flag = is_chinese_master_engineer
		random_list = {
			30 = { add_trait = thrifty_clerk }
			15 = { add_trait = fortune_builder }
			5 = { add_trait = midas_touched }
			30 = { add_trait = tough_soldier }
			15 = { add_trait = skilled_tactician }
			5 = { add_trait = brilliant_strategist }
		}
		random_list = {
			20 = { } #Nothing
			20 = { add_trait = erudite }
			20 = { add_trait = shrewd }
			15 = { add_trait = quick }
			5 = { add_trait = genius }
			10 = { add_trait = robust }
			5 = { add_trait = strong }
			5 = { add_trait = fair }
		}
		random_list = {
			85 = { } #Nothing
			1 = { add_trait = clubfooted }
			2 = { add_trait = harelip }
			2 = { add_trait = hunchback }
			3 = { add_trait = lisp }
			3 = { add_trait = stutter }
			2 = { 
				add_trait = ugly 
				remove_trait = fair 
			}
			1 = { add_trait = dwarf }
			1 = { 
				add_trait = weak 
				remove_trait = strong 
				remove_trait = robust
			}
		}
		random = {
			chance = 10
			add_trait = homosexual
		}
		opinion = {
			who = ROOT
			modifier = opinion_servant
			months = 1200
		}

		#Add archetype 
		random_list = {
			#Conservative
			25 = {
				set_character_flag = archetype_conservative
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						75 = { add_trait = architect }
						25 = { add_trait = theologian }
					}
				}
				random = {
					chance = 50
					add_trait = zealous
				}
				add_trait = stubborn
				add_trait = temperate
				random_list = {
					20 = { add_trait = greedy }
					20 = { add_trait = wroth }
					20 = { add_trait = deceitful }
					20 = { add_trait = shy }
					20 = { add_trait = cruel }
				}
				random_list = {
					25 = { add_trait = poet }
					25 = { add_trait = chaste }
					25 = { 
						add_trait = patient
						remove_trait = wroth
					}
					25 = { add_trait = just }
				}
			}
			#Supportive
			25 = {
				set_character_flag = archetype_supportive
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						50 = { add_trait = architect }
						25 = { add_trait = socializer }
						25 = { add_trait = gardener }
					}
				}
				add_trait = humble
				add_trait = patient
				random_list = {
					33 = { add_trait = slothful }
					33 = { add_trait = craven }
					33 = { add_trait = shy }
				}
				random_list = {
					25 = { add_trait = content }
					25 = { add_trait = charitable }
					25 = { add_trait = kind }
					25 = { add_trait = trusting }
				}  
			}
			#Decisive
			25 = {
				set_character_flag = archetype_decisive
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						50 = { add_trait = architect }
						50 = { add_trait = strategist }
					}
				}
				add_trait = ambitious
				add_trait = cynical
				random_list = {
					20 = { add_trait = cruel }
					20 = { add_trait = stubborn }
					20 = { add_trait = greedy }
					20 = { add_trait = wroth }
					20 = { add_trait = proud }
				}
				random_list = {
					20 = { add_trait = falconer }
					20 = { add_trait = diligent }
					20 = { add_trait = brave }
					20 = { add_trait = honest }
					20 = { add_trait = gregarious }
				}
			}
			#Sociable
			25 = {
				set_character_flag = archetype_sociable
				if = {
					limit = { has_dlc = "Way of Life" }
					random_list = {
						25 = { add_trait = architect }
						30 = { add_trait = socializer }
						25 = { add_trait = hedonist}
						20 = {
							trigger = { is_female = yes }
							add_trait = seductress
							add_trait = lustful
						}
						20 = {
							trigger = { is_female = no }
							add_trait = seducer
							add_trait = lustful
						}
					}
				}
				add_trait = gregarious
				add_trait = charitable
				random_list = {
					25 = { add_trait = craven }
					25 = { add_trait = envious }
					25 = { add_trait = gluttonous }
					25 = { add_trait = proud }
				}
				random_list = {
					25 = { add_trait = poet }
					25 = { add_trait = kind }
					25 = { add_trait = honest }
					25 = { add_trait = lustful }
				}
			}
		}
	}
	new_character = {
		random_list = {
			50 = {}
			25 = {
				religion = confucian
			}
			20 = {
				religion = taoist
			}
			4 = {
				religion = buddhist
			}
			1 = {
				religion = nestorian
			}
		}
		save_event_target_as = new_master_engineer
	}
}

create_chinese_physician_effect = {
	random_list = {
		50 = { #Female
			modifier = {
				NOR = {
					has_game_rule = {
						name = gender
						value = all
					}
					primary_title = {
						has_law = status_of_women_4
					}
					has_religion_feature = religion_matriarchal
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
					has_religion_feature = religion_feature_ryukyuan_three_mountains
					has_religion_feature = religion_feature_ryukyuan_historical
				}
				factor = 0.05
			}
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				create_character = {
					age = 35
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 6
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 5
						stewardship = 3
						intrigue = 3
						learning = 6
					}
				}
			}
			else = {
				create_character = {
					age = 35
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 6
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 5
						stewardship = 3
						intrigue = 3
						learning = 6
					}
				}
			}
		}
		50 = { #Male
			if = {
				limit = {
					has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
					can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
				}
				create_character = {
					age = 35
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = no
					health = 6
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 5
						stewardship = 3
						intrigue = 3
						learning = 6
					}
				}
			}
			else = {
				create_character = {
					age = 35
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = no
					health = 6
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 5
						stewardship = 3
						intrigue = 3
						learning = 6
					}
				}
			}
		}
	}
	new_character = {
		#Education & other basic stuff
		set_character_flag = ai_flag_refuse_concubinage
		set_character_flag = ai_flag_refuse_marriage
		set_character_flag = originated_from_chinese_court
		set_character_flag = no_court_invites
		set_character_flag = is_chinese_physician
		random_list = {
			50 = { add_trait = scholarly_theologian }
			25 = { add_trait = mastermind_theologian }
		}
		add_trait = physician
		random_list = {
			20 = { } #Nothing
			30 = { add_trait = erudite }
			30 = { add_trait = shrewd }
			15 = { add_trait = quick }
			5 = { add_trait = genius }
		}
		random_list = {
			80 = { } #Nothing
			2 = { add_trait = clubfooted }
			2 = { add_trait = harelip }
			2 = { add_trait = hunchback }
			4 = { add_trait = lisp }
			4 = { add_trait = stutter }
			2 = { add_trait = ugly }
			2 = { add_trait = dwarf }
			2 = { add_trait = weak }
		}
		random_list = {
			50 = { } #Nothing
			25 = { add_trait = patient }
			25 = { add_trait = diligent }
		}
		random = {
			chance = 10
			add_trait = homosexual
		}
		opinion = {
			who = ROOT
			modifier = opinion_servant
			months = 1200
		}
		random_list = {
			50 = {}
			25 = {
				religion = confucian
			}
			20 = {
				religion = taoist
			}
			4 = {
				religion = buddhist
			}
			1 = {
				religion = nestorian
			}
		}

		#Add archetype 
		random_list = {
			20 = { #Combat medic
				set_character_flag = archetype_decisive
				random_list = {
					50 = { add_trait = duelist }
					50 = { add_trait = scholar }
				}
				add_trait = scarred
				add_trait = robust
				random_list = {
					60 = { } #Nothing
					20 = { 
						trigger = { has_dlc = Reapers }
						add_trait = one_legged 
					}
					20 = { 
						trigger = { has_dlc = Reapers }
						add_trait = one_eyed 
					}
				}
				add_trait = brave
				random_list = {
					30 = { } #Nothing
					50 = { add_trait = cynical }
					10 = {
						add_trait = cynical
						add_trait = depressed
					}
					10 = {
						add_trait = cynical
						add_trait = depressed
						add_trait = drunkard
					}
				}
				random_list = {
					50 = { } #Nothing
					20 = { add_trait = kind }
					30 = { add_trait = honest }
				}
				remove_trait = dwarf
				remove_trait = weak
			}
			#Dr Jerk
			15 = { 
				set_character_flag = archetype_decisive
				add_trait = scholar
				add_trait = wroth
				remove_trait = patient
				random_list = {
					30 = { add_trait = proud }
					30 = { add_trait = envious }
					40 = { } #Nothing
				}
				add_trait = honest
				add_trait = cynical
				random = {
					chance = 30
					add_trait = drunkard
				}
				random_list = {
					60 = { }
					20 = { 
						add_trait = clubfooted
						set_name = Wu #House
					}
					20 = {
						trigger = { has_dlc = Reapers }
						add_trait = one_legged
						set_name = Wu #House
					}
				}
			}
			10 = { #Mad genius 
				set_character_flag = archetype_sociable
				random_list = {
					50 = { add_trait = impaler }
					50 = { add_trait = mystic }
				}
				random_list = {
					33 = { add_trait = drunkard } 
					33 = { add_trait = lunatic }
					33 = { add_trait = possessed }
				}
				add_trait = genius
				remove_trait = quick
				remove_trait = shrewd
				add_trait = paranoid
				random_list = {
					25 = { add_trait = gluttonous } 
					25 = { add_trait = wroth }
					25 = { add_trait = proud }
					25 = { add_trait = greedy }
				}   
			}
			20 = { #Herbalist
				set_character_flag = archetype_supportive
				add_trait = gardener
				add_trait = diligent
				add_trait = humble
				random_list = {
					33 = { add_trait = content } 
					33 = { add_trait = shy }
					33 = { add_trait = poet }
				}
				random = {
					chance = 50
					add_trait = robust
				}
				remove_trait = weak
			}
			20 = { #Health nut
				set_character_flag = archetype_conservative
				add_trait = mystic
				add_trait = celibate
				add_trait = chaste
				add_trait = temperate
				random_list = {
					50 = { add_trait = craven } 
					25 = { add_trait = shy }
					25 = { add_trait = content }
				}
				set_focus = focus_scholarship
			}
			20 = { #Compassionate doctor
				set_character_flag = archetype_supportive
				random_list = {
					50 = { add_trait = socializer }
					50 = { add_trait = scholar }
				}
				add_trait = kind
				add_trait = patient
				random_list = {
					25 = { add_trait = content } 
					25 = { add_trait = humble }
					25 = { add_trait = trusting }
					25 = { add_trait = charitable }
				}
				set_focus = focus_family
			}
			15 = { #McDreamy
				set_character_flag = archetype_sociable
				if = {
					limit = { is_female = yes }
					add_trait = seductress
				}
				if = {
					limit = { is_female = no }
					add_trait = seducer
				}
				random_list = {
					50 = { } #Nothing
					25 = { add_trait = poet }
					25 = { add_trait = falconer }
				}
				random_list = {
					30 = { add_trait = fair }
					50 = { add_trait = strong }
				}
				add_trait = lustful
				random_list = {
					35 = { add_trait = ambitious }
					35 = { add_trait = gregarious }
					30 = { } #Nothing
				}
				set_focus = focus_seduction
				remove_trait = clubfooted
				remove_trait = harelip
				remove_trait =  hunchback 
				remove_trait = lisp
				remove_trait = stutter
				remove_trait = ugly
				remove_trait = dwarf
				remove_trait = weak
			}
		}
	}
	new_character = {
		if = {
			limit = { # TODO: Check appropriate character
				has_character_modifier = mandate_of_heaven_5
			}
			change_learning = 5
		}
		save_event_target_as = new_chinese_doctor
	}
}

create_chinese_courtesan_effect = {
	if = {
		limit = {
			has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
			can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
		}
		random_list = {
			# Base randomization
			25 = {
				create_random_diplomat = {
					age = 25
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 4
						stewardship = 2
						intrigue = 3
						learning = 2
					}
				}
			}
			50 = {
				create_random_intriguer = {
					age = 25
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 3
						stewardship = 2
						intrigue = 4
						learning = 2
					}
				}
			}
			25 = { 
				create_random_steward = {
					age = 25
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 2
						stewardship = 4
						intrigue = 2
						learning = 3
					}
				}
			}
		}
	}
	else = {
		random_list = {
			# Base randomization
			25 = {
				create_random_diplomat = {
					age = 25
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 4
						stewardship = 2
						intrigue = 3
						learning = 2
					}
				}
			}
			50 = {
				create_random_intriguer = {
					age = 25
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 3
						stewardship = 2
						intrigue = 4
						learning = 2
					}
				}
			}
			25 = { 
				create_random_steward = {
					age = 25
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 2
						stewardship = 4
						intrigue = 2
						learning = 3
					}
				}
			}
		}
	}
	new_character = {
		# Age randomization
		random_list = {
			1 = {
				add_age = 10
			}
			2 = {
				add_age = 9
			}
			3 = {
				add_age = 8
			}
			4 = {
				add_age = 7
			}
			5 = {
				add_age = 6
			}
			6 = {
				add_age = 5
			}
			7 = {
				add_age = 3
			}
			8 = {
				add_age = 2
			}
			9 = {
				add_age = 1
			}
			10 = {}
			2 = {
				add_age = -9
			}
			3 = {
				add_age = -8
			}
			4 = {
				add_age = -7
			}
			5 = {
				add_age = -6
			}
			6 = {
				add_age = -5
			}
			7 = {
				add_age = -3
			}
			8 = {
				add_age = -2
			}
			9 = {
				add_age = -1
			}
		}
		# Religion randomization
		random_list = {
			50 = {}
			25 = {
				religion = confucian
			}
			20 = {
				religion = taoist
			}
			4 = {
				religion = buddhist
			}
			1 = {
				religion = nestorian
			}
		}
		# Courtesans are not ugly, but are not certain to be attractive
		random_list = {
			10 = {
				add_trait = fair
			}
			5 = {
				add_trait = fair
				add_trait = groomed
			}
			85 = {
				add_trait = groomed
			}
		}
		# Lifestyle trait
		random_list = {
			25 = {
				add_trait = seductress
			}
			25 = {
				add_trait = hedonist
			}
			25 = {
				add_trait = socializer
			}
			25 = {
				add_trait = schemer
			}
		}
		# Somewhat likely to be Lustful
		random = {
			chance = 50
			add_trait = lustful
		}
		# Genetic traits
		random_list = {
			80 = {}
			1 = {
				add_trait = genius
			}
			2 = {
				add_trait = quick
			}
			2 = {
				add_trait = slow
			}
			1 = {
				add_trait = imbecile
			}
			5 = {
				add_trait = lefthanded
			}
			1 = {
				add_trait = strong
			}
			1 = {
				add_trait = giant
			}
			2 = {
				add_trait = lisp
			}
			2 = {
				add_trait = stutter
			}
		}
		# Non-genetic traits
		random_list = {
			50 = {}
			2 = {
				add_trait = robust
			}
			2 = {
				add_trait = sturdy
			}
			2 = {
				add_trait = feeble
			}
			5 = {
				add_trait = shrewd
			}
			5 = {
				add_trait = dull
			}
		}
		# One random trait
		random_list = {
			2 = {
				add_trait = poet
			}
			5 = {
				add_trait = temperate
			}
			1 = {
				add_trait = charitable
			}
			2 = {
				add_trait = diligent
			}
			2 = {
				add_trait = patient
			}
			2 = {
				add_trait = kind
			}
			5 = {
				add_trait = humble
			}
			2 = {
				add_trait = gluttonous
			}
			5 = {
				add_trait = greedy
			}
			2 = {
				add_trait = slothful
			}
			2 = {
				add_trait = wroth
			}
			5 = {
				add_trait = envious
			}
			2 = {
				add_trait = proud
			}
			5 = {
				add_trait = ambitious
			}
			5 = {
				add_trait = arbitrary
			}
			2 = {
				add_trait = brave
			}
			1 = {
				add_trait = content
			}
			2 = {
				add_trait = craven
			}
			2 = {
				add_trait = cruel
			}
			5 = {
				add_trait = cynical
			}
			5 = {
				add_trait = deceitful
			}
			2 = {
				add_trait = erudite
			}
			5 = {
				add_trait = gregarious
			}
			1 = {
				add_trait = honest
			}
			1 = {
				add_trait = just
			}
			5 = {
				add_trait = paranoid
			}
			5 = {
				add_trait = shy
			}
			1 = {
				add_trait = stubborn
			}
			1 = {
				add_trait = trusting
			}
			1 = {
				add_trait = zealous
			}
		}
		# Another random trait
		random_list = {
			2 = {
				add_trait = poet
			}
			5 = {
				add_trait = temperate
			}
			1 = {
				add_trait = charitable
			}
			2 = {
				add_trait = diligent
			}
			2 = {
				add_trait = patient
			}
			2 = {
				add_trait = kind
			}
			5 = {
				add_trait = humble
			}
			2 = {
				add_trait = gluttonous
			}
			5 = {
				add_trait = greedy
			}
			2 = {
				add_trait = slothful
			}
			2 = {
				add_trait = wroth
			}
			5 = {
				add_trait = envious
			}
			2 = {
				add_trait = proud
			}
			5 = {
				add_trait = ambitious
			}
			5 = {
				add_trait = arbitrary
			}
			2 = {
				add_trait = brave
			}
			1 = {
				add_trait = content
			}
			2 = {
				add_trait = craven
			}
			2 = {
				add_trait = cruel
			}
			5 = {
				add_trait = cynical
			}
			5 = {
				add_trait = deceitful
			}
			2 = {
				add_trait = erudite
			}
			5 = {
				add_trait = gregarious
			}
			1 = {
				add_trait = honest
			}
			1 = {
				add_trait = just
			}
			5 = {
				add_trait = paranoid
			}
			5 = {
				add_trait = shy
			}
			1 = {
				add_trait = stubborn
			}
			1 = {
				add_trait = trusting
			}
			1 = {
				add_trait = zealous
			}
		}
		# Smaller chance of a third random trait
		random = {
			chance = 50
			random_list = {
				2 = {
					add_trait = poet
				}
				5 = {
					add_trait = temperate
				}
				1 = {
					add_trait = charitable
				}
				2 = {
					add_trait = diligent
				}
				2 = {
					add_trait = patient
				}
				2 = {
					add_trait = kind
				}
				5 = {
					add_trait = humble
				}
				2 = {
					add_trait = gluttonous
				}
				5 = {
					add_trait = greedy
				}
				2 = {
					add_trait = slothful
				}
				2 = {
					add_trait = wroth
				}
				5 = {
					add_trait = envious
				}
				2 = {
					add_trait = proud
				}
				5 = {
					add_trait = ambitious
				}
				5 = {
					add_trait = arbitrary
				}
				2 = {
					add_trait = brave
				}
				1 = {
					add_trait = content
				}
				2 = {
					add_trait = craven
				}
				2 = {
					add_trait = cruel
				}
				5 = {
					add_trait = cynical
				}
				5 = {
					add_trait = deceitful
				}
				2 = {
					add_trait = erudite
				}
				5 = {
					add_trait = gregarious
				}
				1 = {
					add_trait = honest
				}
				1 = {
					add_trait = just
				}
				5 = {
					add_trait = paranoid
				}
				5 = {
					add_trait = shy
				}
				1 = {
					add_trait = stubborn
				}
				1 = {
					add_trait = trusting
				}
				1 = {
					add_trait = zealous
				}
			}
		}
		# Very small chance of a fourth (or third) random trait
		random = {
			chance = 10
			random_list = {
				2 = {
					add_trait = poet
				}
				5 = {
					add_trait = temperate
				}
				1 = {
					add_trait = charitable
				}
				2 = {
					add_trait = diligent
				}
				2 = {
					add_trait = patient
				}
				2 = {
					add_trait = kind
				}
				5 = {
					add_trait = humble
				}
				2 = {
					add_trait = gluttonous
				}
				5 = {
					add_trait = greedy
				}
				2 = {
					add_trait = slothful
				}
				2 = {
					add_trait = wroth
				}
				5 = {
					add_trait = envious
				}
				2 = {
					add_trait = proud
				}
				5 = {
					add_trait = ambitious
				}
				5 = {
					add_trait = arbitrary
				}
				2 = {
					add_trait = brave
				}
				1 = {
					add_trait = content
				}
				2 = {
					add_trait = craven
				}
				2 = {
					add_trait = cruel
				}
				5 = {
					add_trait = cynical
				}
				5 = {
					add_trait = deceitful
				}
				2 = {
					add_trait = erudite
				}
				5 = {
					add_trait = gregarious
				}
				1 = {
					add_trait = honest
				}
				1 = {
					add_trait = just
				}
				5 = {
					add_trait = paranoid
				}
				5 = {
					add_trait = shy
				}
				1 = {
					add_trait = stubborn
				}
				1 = {
					add_trait = trusting
				}
				1 = {
					add_trait = zealous
				}
			}
		}
		# Sexuality
		random = {
			chance = 10
			add_trait = homosexual
		}
		# Courtesans have certain occupational hazards...
		random_list = {
			95 = {}
			5 = {
				add_trait = lovers_pox
			}
		}
		# Save the event target
		save_event_target_as = not_a_dragon_bride
		set_character_flag = chinese_courtesan
	}
	# Low chance of something unexpected
	if = {
		limit = {
			event_target:not_a_dragon_bride = {
				age = 17
			}
		}
		random = {
			chance = 1
			random_list = {
				90 = {
					e_china = {
						holder_scope = {
							random_realm_province = {
								save_event_target_as = bastard_origin
							}
						}
					}
				}
				10 = {
					random_independent_ruler = {
						random_realm_province = {
							save_event_target_as = bastard_origin
						}
					}
				}
			}
			create_character = {
				age = 0
				female = 50
				dynasty = event_target:not_a_dragon_bride
				culture = event_target:bastard_origin
				religion = event_target:not_a_dragon_bride
				random_traits = no
				add_trait = bastard
			}
			new_character = {
				culture = event_target:not_a_dragon_bride
				save_event_target_as = bastard_1
				random_list = {
					1 = {}
					1 = {
						modifier = {
							factor = 0
							NOT = {
								event_target:not_a_dragon_bride = {
									age = 18
								}
							}
						}
						add_age = 1
					}
					1 = {
						modifier = {
							factor = 0
							NOT = {
								event_target:not_a_dragon_bride = {
									age = 19
								}
							}
						}
						add_age = 2
					}
					1 = {
						modifier = {
							factor = 0
							NOT = {
								event_target:not_a_dragon_bride = {
									age = 20
								}
							}
						}
						add_age = 3
					}
					1 = {
						modifier = {
							factor = 0
							NOT = {
								event_target:not_a_dragon_bride = {
									age = 21
								}
							}
						}
						add_age = 4
					}
					1 = {
						modifier = {
							factor = 0
							NOT = {
								event_target:not_a_dragon_bride = {
									age = 22
								}
							}
						}
						add_age = 5
					}
					1 = {
						modifier = {
							factor = 0
							NOT = {
								event_target:not_a_dragon_bride = {
									age = 23
								}
							}
						}
						add_age = 6
					}
					1 = {
						modifier = {
							factor = 0
							NOT = {
								event_target:not_a_dragon_bride = {
									age = 24
								}
							}
						}
						add_age = 7
					}
				}
			}
		}
		if = {
			limit = {
				event_target:not_a_dragon_bride = {
					age = 25
				}
			}
			random = {
				chance = 1
				e_china = {
					holder_scope = {
						random_realm_province = {
							save_event_target_as = bastard_origin
						}
					}
				}
				create_character = {
					age = 8
					female = 50
					dynasty = event_target:not_a_dragon_bride
					culture = event_target:bastard_origin
					religion = event_target:not_a_dragon_bride
					random_traits = no
					add_trait = bastard
				}
				new_character = {
					culture = event_target:not_a_dragon_bride
					save_event_target_as = bastard_2
					random_list = {
						1 = {}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									event_target:not_a_dragon_bride = {
										age = 26
									}
								}
							}
							add_age = 1
						}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									event_target:not_a_dragon_bride = {
										age = 27
									}
								}
							}
							add_age = 2
						}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									event_target:not_a_dragon_bride = {
										age = 28
									}
								}
							}
							add_age = 3
						}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									event_target:not_a_dragon_bride = {
										age = 29
									}
								}
							}
							add_age = 4
						}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									event_target:not_a_dragon_bride = {
										age = 30
									}
								}
							}
							add_age = 5
						}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									event_target:not_a_dragon_bride = {
										age = 31
									}
								}
							}
							add_age = 6
						}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									event_target:not_a_dragon_bride = {
										age = 32
									}
								}
							}
							add_age = 7
						}
					}
				}
			}
		}
	}
	random = {
		chance = 5
		event_target:not_a_dragon_bride = {
			impregnate = 0
		}
	}
}

create_chinese_beauty_effect = {
	if = {
		limit = {
			has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
			can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
		}
		random_list = {
			# Base randomization
			50 = {
				create_random_diplomat = {
					age = 25
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 5
						stewardship = 1
						intrigue = 3
						learning = 1
					}
				}
			}
			25 = {
				create_random_intriguer = {
					age = 25
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 3
						stewardship = 1
						intrigue = 2
						learning = 1
					}
				}
			}
			25 = { 
				create_random_priest = {
					age = 25
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 2
						stewardship = 2
						intrigue = 2
						learning = 4
					}
				}
			}
		}
	}
	else = {
		random_list = {
			# Base randomization
			50 = {
				create_random_diplomat = {
					age = 25
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 5
						stewardship = 1
						intrigue = 3
						learning = 1
					}
				}
			}
			25 = {
				create_random_intriguer = {
					age = 25
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 3
						stewardship = 1
						intrigue = 5
						learning = 1
					}
				}
			}
			25 = { 
				create_random_priest = {
					age = 25
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 1
						diplomacy = 2
						stewardship = 2
						intrigue = 2
						learning = 4
					}
				}
			}
		}
	}
	new_character = {
		# Age randomization
		random_list = {
			1 = {
				add_age = 10
			}
			2 = {
				add_age = 9
			}
			3 = {
				add_age = 8
			}
			4 = {
				add_age = 7
			}
			5 = {
				add_age = 6
			}
			6 = {
				add_age = 5
			}
			7 = {
				add_age = 3
			}
			8 = {
				add_age = 2
			}
			9 = {
				add_age = 1
			}
			10 = {}
			2 = {
				add_age = -9
			}
			3 = {
				add_age = -8
			}
			4 = {
				add_age = -7
			}
			5 = {
				add_age = -6
			}
			6 = {
				add_age = -5
			}
			7 = {
				add_age = -3
			}
			8 = {
				add_age = -2
			}
			9 = {
				add_age = -1
			}
		}
		# Religion randomization
		random_list = {
			50 = {}
			25 = {
				religion = confucian
			}
			20 = {
				religion = taoist
			}
			4 = {
				religion = buddhist
			}
			1 = {
				religion = nestorian
			}
		}
		# Beauties are not ugly
		random_list = {
			80 = {
				add_trait = fair
			}
			10 = {
				add_trait = fair
				add_trait = groomed
			}
			10 = {
				add_trait = fair
				add_trait = uncouth
			}
		}
		# Lifestyle trait
		random_list = {
			25 = {}
			25 = {
				add_trait = socializer
			}
			25 = {
				add_trait = seductress
			}
			25 = {
				add_trait = schemer
			}
		}
		# Genetic traits - skews negative to balance against Attractive
		random_list = {
			80 = {}
			1 = {
				add_trait = genius
			}
			2 = {
				add_trait = quick
			}
			5 = {
				add_trait = slow
			}
			10 = {
				add_trait = imbecile
			}
			5 = {
				add_trait = lefthanded
			}
			1 = {
				add_trait = strong
			}
			1 = {
				add_trait = giant
			}
			2 = {
				add_trait = lisp
			}
			2 = {
				add_trait = stutter
			}
		}
		# Non-genetic traits
		random_list = {
			50 = {}
			2 = {
				add_trait = robust
			}
			2 = {
				add_trait = sturdy
			}
			5 = {
				add_trait = feeble
			}
			1 = {
				add_trait = shrewd
			}
			5 = {
				add_trait = dull
			}
		}
		# One random trait
		random_list = {
			2 = {
				add_trait = poet
			}
			5 = {
				add_trait = chaste
			}
			5 = {
				add_trait = temperate
			}
			2 = {
				add_trait = charitable
			}
			1 = {
				add_trait = diligent
			}
			2 = {
				add_trait = patient
			}
			1 = {
				add_trait = kind
			}
			1 = {
				add_trait = humble
			}
			5 = {
				add_trait = lustful
			}
			1 = {
				add_trait = gluttonous
			}
			2 = {
				add_trait = greedy
			}
			5 = {
				add_trait = slothful
			}
			1 = {
				add_trait = wroth
			}
			5 = {
				add_trait = envious
			}
			5 = {
				add_trait = proud
			}
			2 = {
				add_trait = ambitious
			}
			5 = {
				add_trait = arbitrary
			}
			1 = {
				add_trait = brave
			}
			1 = {
				add_trait = content
			}
			2 = {
				add_trait = craven
			}
			1 = {
				add_trait = cruel
			}
			1 = {
				add_trait = cynical
			}
			1 = {
				add_trait = deceitful
			}
			1 = {
				add_trait = erudite
			}
			2 = {
				add_trait = gregarious
			}
			2 = {
				add_trait = honest
			}
			1 = {
				add_trait = just
			}
			1 = {
				add_trait = paranoid
			}
			1 = {
				add_trait = shy
			}
			2 = {
				add_trait = stubborn
			}
			2 = {
				add_trait = trusting
			}
			1 = {
				add_trait = zealous
			}
		}
		# Another random trait
		random_list = {
			2 = {
				add_trait = poet
			}
			5 = {
				add_trait = chaste
			}
			5 = {
				add_trait = temperate
			}
			2 = {
				add_trait = charitable
			}
			1 = {
				add_trait = diligent
			}
			2 = {
				add_trait = patient
			}
			1 = {
				add_trait = kind
			}
			1 = {
				add_trait = humble
			}
			5 = {
				add_trait = lustful
			}
			1 = {
				add_trait = gluttonous
			}
			2 = {
				add_trait = greedy
			}
			5 = {
				add_trait = slothful
			}
			1 = {
				add_trait = wroth
			}
			5 = {
				add_trait = envious
			}
			5 = {
				add_trait = proud
			}
			2 = {
				add_trait = ambitious
			}
			5 = {
				add_trait = arbitrary
			}
			1 = {
				add_trait = brave
			}
			1 = {
				add_trait = content
			}
			2 = {
				add_trait = craven
			}
			1 = {
				add_trait = cruel
			}
			1 = {
				add_trait = cynical
			}
			1 = {
				add_trait = deceitful
			}
			1 = {
				add_trait = erudite
			}
			2 = {
				add_trait = gregarious
			}
			2 = {
				add_trait = honest
			}
			1 = {
				add_trait = just
			}
			1 = {
				add_trait = paranoid
			}
			1 = {
				add_trait = shy
			}
			2 = {
				add_trait = stubborn
			}
			2 = {
				add_trait = trusting
			}
			1 = {
				add_trait = zealous
			}
		}
		# Smaller chance of a third random trait
		random = {
			chance = 50
			random_list = {
				2 = {
					add_trait = poet
				}
				5 = {
					add_trait = chaste
				}
				5 = {
					add_trait = temperate
				}
				2 = {
					add_trait = charitable
				}
				1 = {
					add_trait = diligent
				}
				2 = {
					add_trait = patient
				}
				1 = {
					add_trait = kind
				}
				1 = {
					add_trait = humble
				}
				5 = {
					add_trait = lustful
				}
				1 = {
					add_trait = gluttonous
				}
				2 = {
					add_trait = greedy
				}
				5 = {
					add_trait = slothful
				}
				1 = {
					add_trait = wroth
				}
				5 = {
					add_trait = envious
				}
				5 = {
					add_trait = proud
				}
				2 = {
					add_trait = ambitious
				}
				5 = {
					add_trait = arbitrary
				}
				1 = {
					add_trait = brave
				}
				1 = {
					add_trait = content
				}
				2 = {
					add_trait = craven
				}
				1 = {
					add_trait = cruel
				}
				1 = {
					add_trait = cynical
				}
				1 = {
					add_trait = deceitful
				}
				1 = {
					add_trait = erudite
				}
				2 = {
					add_trait = gregarious
				}
				2 = {
					add_trait = honest
				}
				1 = {
					add_trait = just
				}
				1 = {
					add_trait = paranoid
				}
				1 = {
					add_trait = shy
				}
				2 = {
					add_trait = stubborn
				}
				2 = {
					add_trait = trusting
				}
				1 = {
					add_trait = zealous
				}
			}
		}
		# Very small chance of a fourth (or third) random trait
		random = {
			chance = 10
			random_list = {
				2 = {
					add_trait = poet
				}
				5 = {
					add_trait = chaste
				}
				5 = {
					add_trait = temperate
				}
				2 = {
					add_trait = charitable
				}
				1 = {
					add_trait = diligent
				}
				2 = {
					add_trait = patient
				}
				1 = {
					add_trait = kind
				}
				1 = {
					add_trait = humble
				}
				5 = {
					add_trait = lustful
				}
				1 = {
					add_trait = gluttonous
				}
				2 = {
					add_trait = greedy
				}
				5 = {
					add_trait = slothful
				}
				1 = {
					add_trait = wroth
				}
				5 = {
					add_trait = envious
				}
				5 = {
					add_trait = proud
				}
				2 = {
					add_trait = ambitious
				}
				5 = {
					add_trait = arbitrary
				}
				1 = {
					add_trait = brave
				}
				1 = {
					add_trait = content
				}
				2 = {
					add_trait = craven
				}
				1 = {
					add_trait = cruel
				}
				1 = {
					add_trait = cynical
				}
				1 = {
					add_trait = deceitful
				}
				1 = {
					add_trait = erudite
				}
				2 = {
					add_trait = gregarious
				}
				2 = {
					add_trait = honest
				}
				1 = {
					add_trait = just
				}
				1 = {
					add_trait = paranoid
				}
				1 = {
					add_trait = shy
				}
				2 = {
					add_trait = stubborn
				}
				2 = {
					add_trait = trusting
				}
				1 = {
					add_trait = zealous
				}
			}
		}
		# Sexuality
		random = {
			chance = 10
			add_trait = homosexual
		}
		# Save the event target
		save_event_target_as = not_a_dragon_bride
		set_character_flag = chinese_beauty
	}
	# Small chance of something unexpected
	if = {
		limit = {
			event_target:not_a_dragon_bride = {
				NOR = {
					trait = chaste
					trait = homosexual
				}
			}
		}
		random = {
			chance = 2
			event_target:not_a_dragon_bride = {
				impregnate = 0
			}
		}
	}
}

create_chinese_entertainer_effect = {
	if = {
		limit = {
			has_chinese_or_historical_culture_for_chinese_imperial_trigger = yes
			can_have_confucian_bureaucracy_and_eastern_imperial_only_religion_trigger = yes
		}
		random_list = {
			# Base randomization
			25 = {
				create_random_diplomat = {
					age = 25
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 4
						stewardship = 1
						intrigue = 1
						learning = 3
					}
				}
			}
			25 = {
				create_random_steward = {
					age = 25
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 1
						stewardship = 4
						intrigue = 1
						learning = 3
					}
				}
			}
			50 = { 
				create_random_priest = {
					age = 25
					dynasty = actually_culture
					religion = ROOT
					culture = ROOT
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 3
						diplomacy = 1
						stewardship = 2
						intrigue = 1
						learning = 4
					}
				}
			}
		}
	}
	else = {
		random_list = {
			# Base randomization
			25 = {
				create_random_diplomat = {
					age = 25
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 4
						stewardship = 1
						intrigue = 1
						learning = 3
					}
				}
			}
			25 = {
				create_random_steward = {
					age = 25
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 2
						diplomacy = 1
						stewardship = 4
						intrigue = 1
						learning = 3
					}
				}
			}
			50 = { 
				create_random_priest = {
					age = 25
					dynasty = actually_culture
					religion = confucian
					culture = han
					female = yes
					health = 7
					random_traits = no
					attributes = {
						martial = 3
						diplomacy = 1
						stewardship = 2
						intrigue = 1
						learning = 4
					}
				}
			}
		}
	}
	new_character = {
		# Age randomization
		random_list = {
			1 = {
				add_age = 10
			}
			2 = {
				add_age = 9
			}
			3 = {
				add_age = 8
			}
			4 = {
				add_age = 7
			}
			5 = {
				add_age = 6
			}
			6 = {
				add_age = 5
			}
			7 = {
				add_age = 3
			}
			8 = {
				add_age = 2
			}
			9 = {
				add_age = 1
			}
			10 = {}
			2 = {
				add_age = -9
			}
			3 = {
				add_age = -8
			}
			4 = {
				add_age = -7
			}
			5 = {
				add_age = -6
			}
			6 = {
				add_age = -5
			}
			7 = {
				add_age = -3
			}
			8 = {
				add_age = -2
			}
			9 = {
				add_age = -1
			}
		}
		# Religion randomization
		random_list = {
			50 = {}
			25 = {
				religion = confucian
			}
			20 = {
				religion = taoist
			}
			4 = {
				religion = buddhist
			}
			1 = {
				religion = nestorian
			}
		}
		# Entertainers are not stupid, but are not guaranteed to be smart
		random_list = {
			60 = {}
			20 = {
				add_trait = shrewd
			}
			10 = {
				add_trait = quick
			}
			5 = {
				add_trait = genius
			}
		}
		# Lifestyle trait
		random_list = {
			10 = {
				add_trait = administrator
			}
			10 = {
				add_trait = architect
			}
			25 = {
				add_trait = gamer
			}
			10 = {
				add_trait = gardener
			}
			10 = {
				add_trait = schemer
			}
			25 = {
				add_trait = mystic
			}
			10 = {
				add_trait = scholar
			}
			5 = {
				add_trait = strategist
			}
			10 = {
				add_trait = socializer
			}
		}
		# Genetic traits
		random_list = {
			80 = {}
			2 = {
				add_trait = fair
			}
			2 = {
				add_trait = strong
			}
			2 = {
				add_trait = clubfooted
			}
			2 = {
				add_trait = dwarf
			}
			2 = {
				add_trait = lisp
			}
			2 = {
				add_trait = stutter
			}
			2 = {
				add_trait = ugly
			}
			2 = {
				add_trait = weak
			}
			2 = {
				add_trait = giant
			}
			2 = {
				add_trait = lefthanded
			}
		}
		# Non-genetic traits
		random_list = {
			80 = {}
			5 = {
				add_trait = robust
			}
			5 = {
				add_trait = sturdy
			}
			5 = {
				add_trait = feeble
			}
			5 = {
				add_trait = groomed
			}
			5 = {
				add_trait = uncouth
			}
		}
		# Low chance of being maimed
		random_list = {
			5 = {}
			5 = {
				modifier = {
					factor = 0
					has_dlc = "Reapers"
				}
				add_trait = maimed
			}
			1 = {
				modifier = {
					factor = 0
					NOT = {
						has_dlc = "Reapers"
					}
				}
				add_trait = disfigured
			}
			1 = {
				modifier = {
					factor = 0
					NOT = {
						has_dlc = "Reapers"
					}
				}
				add_trait = mangled
			}
			1 = {
				modifier = {
					factor = 0
					NOT = {
						has_dlc = "Reapers"
					}
				}
				add_trait = one_eyed
			}
			1 = {
				modifier = {
					factor = 0
					NOT = {
						has_dlc = "Reapers"
					}
				}
				add_trait = one_handed
			}
			1 = {
				modifier = {
					factor = 0
					NOT = {
						has_dlc = "Reapers"
					}
				}
				add_trait = one_legged
			}
			1 = {
				modifier = {
					factor = 0
					NOT = {
						has_dlc = "Reapers"
					}
				}
				add_trait = severely_injured
			}
			1 = {
				add_trait = blinded
			}
			2 = {
				add_trait = wounded
			}
		}
		# Likely a poet
		random = {
			chance = 50
			add_trait = poet
		}
		# One random trait
		random_list = {
			5 = {
				add_trait = chaste
			}
			5 = {
				add_trait = temperate
			}
			1 = {
				add_trait = charitable
			}
			5 = {
				add_trait = diligent
			}
			5 = {
				add_trait = patient
			}
			1 = {
				add_trait = kind
			}
			2 = {
				add_trait = humble
			}
			2 = {
				add_trait = lustful
			}
			1 = {
				add_trait = gluttonous
			}
			1 = {
				add_trait = greedy
			}
			1 = {
				add_trait = slothful
			}
			1 = {
				add_trait = wroth
			}
			1 = {
				add_trait = envious
			}
			5 = {
				add_trait = proud
			}
			5 = {
				add_trait = ambitious
			}
			1 = {
				add_trait = arbitrary
			}
			1 = {
				add_trait = brave
			}
			5 = {
				add_trait = content
			}
			2 = {
				add_trait = craven
			}
			1 = {
				add_trait = cruel
			}
			2 = {
				add_trait = cynical
			}
			2 = {
				add_trait = deceitful
			}
			5 = {
				add_trait = erudite
			}
			1 = {
				add_trait = gregarious
			}
			2 = {
				add_trait = honest
			}
			2 = {
				add_trait = just
			}
			1 = {
				add_trait = paranoid
			}
			2 = {
				add_trait = shy
			}
			2 = {
				add_trait = stubborn
			}
			2 = {
				add_trait = trusting
			}
			1 = {
				add_trait = zealous
			}
		}
		# Another random trait
		random_list = {
			5 = {
				add_trait = chaste
			}
			5 = {
				add_trait = temperate
			}
			1 = {
				add_trait = charitable
			}
			5 = {
				add_trait = diligent
			}
			5 = {
				add_trait = patient
			}
			1 = {
				add_trait = kind
			}
			2 = {
				add_trait = humble
			}
			2 = {
				add_trait = lustful
			}
			1 = {
				add_trait = gluttonous
			}
			1 = {
				add_trait = greedy
			}
			1 = {
				add_trait = slothful
			}
			1 = {
				add_trait = wroth
			}
			1 = {
				add_trait = envious
			}
			5 = {
				add_trait = proud
			}
			5 = {
				add_trait = ambitious
			}
			1 = {
				add_trait = arbitrary
			}
			1 = {
				add_trait = brave
			}
			5 = {
				add_trait = content
			}
			2 = {
				add_trait = craven
			}
			1 = {
				add_trait = cruel
			}
			2 = {
				add_trait = cynical
			}
			2 = {
				add_trait = deceitful
			}
			5 = {
				add_trait = erudite
			}
			1 = {
				add_trait = gregarious
			}
			2 = {
				add_trait = honest
			}
			2 = {
				add_trait = just
			}
			1 = {
				add_trait = paranoid
			}
			2 = {
				add_trait = shy
			}
			2 = {
				add_trait = stubborn
			}
			2 = {
				add_trait = trusting
			}
			1 = {
				add_trait = zealous
			}
		}
		# Smaller chance of a third random trait
		random = {
			chance = 50
			random_list = {
				5 = {
					add_trait = chaste
				}
				5 = {
					add_trait = temperate
				}
				1 = {
					add_trait = charitable
				}
				5 = {
					add_trait = diligent
				}
				5 = {
					add_trait = patient
				}
				1 = {
					add_trait = kind
				}
				2 = {
					add_trait = humble
				}
				2 = {
					add_trait = lustful
				}
				1 = {
					add_trait = gluttonous
				}
				1 = {
					add_trait = greedy
				}
				1 = {
					add_trait = slothful
				}
				1 = {
					add_trait = wroth
				}
				1 = {
					add_trait = envious
				}
				5 = {
					add_trait = proud
				}
				5 = {
					add_trait = ambitious
				}
				1 = {
					add_trait = arbitrary
				}
				1 = {
					add_trait = brave
				}
				5 = {
					add_trait = content
				}
				2 = {
					add_trait = craven
				}
				1 = {
					add_trait = cruel
				}
				2 = {
					add_trait = cynical
				}
				2 = {
					add_trait = deceitful
				}
				5 = {
					add_trait = erudite
				}
				1 = {
					add_trait = gregarious
				}
				2 = {
					add_trait = honest
				}
				2 = {
					add_trait = just
				}
				1 = {
					add_trait = paranoid
				}
				2 = {
					add_trait = shy
				}
				2 = {
					add_trait = stubborn
				}
				2 = {
					add_trait = trusting
				}
				1 = {
					add_trait = zealous
				}
			}
		}
		# Very small chance of a fourth (or third) random trait
		random = {
			chance = 10
			random_list = {
				5 = {
					add_trait = chaste
				}
				5 = {
					add_trait = temperate
				}
				1 = {
					add_trait = charitable
				}
				5 = {
					add_trait = diligent
				}
				5 = {
					add_trait = patient
				}
				1 = {
					add_trait = kind
				}
				2 = {
					add_trait = humble
				}
				2 = {
					add_trait = lustful
				}
				1 = {
					add_trait = gluttonous
				}
				1 = {
					add_trait = greedy
				}
				1 = {
					add_trait = slothful
				}
				1 = {
					add_trait = wroth
				}
				1 = {
					add_trait = envious
				}
				5 = {
					add_trait = proud
				}
				5 = {
					add_trait = ambitious
				}
				1 = {
					add_trait = arbitrary
				}
				1 = {
					add_trait = brave
				}
				5 = {
					add_trait = content
				}
				2 = {
					add_trait = craven
				}
				1 = {
					add_trait = cruel
				}
				2 = {
					add_trait = cynical
				}
				2 = {
					add_trait = deceitful
				}
				5 = {
					add_trait = erudite
				}
				1 = {
					add_trait = gregarious
				}
				2 = {
					add_trait = honest
				}
				2 = {
					add_trait = just
				}
				1 = {
					add_trait = paranoid
				}
				2 = {
					add_trait = shy
				}
				2 = {
					add_trait = stubborn
				}
				2 = {
					add_trait = trusting
				}
				1 = {
					add_trait = zealous
				}
			}
		}
		# Sexuality
		random = {
			chance = 10
			add_trait = homosexual
		}
		# Save the event target
		save_event_target_as = not_a_dragon_bride
		set_character_flag = chinese_entertainer
	}
	# Small chance of something unexpected
	# Small chance of something unexpected
	if = {
		limit = {
			event_target:not_a_dragon_bride = {
				NOR = {
					trait = chaste
					trait = homosexual
				}
			}
		}
		random = {
			chance = 1
			event_target:not_a_dragon_bride = {
				impregnate = 0
			}
		}
	}
}