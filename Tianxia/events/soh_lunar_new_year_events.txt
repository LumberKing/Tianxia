# Lunar New Year events

# by Silverswee(e)per

namespace = LNY

# Currently, the following characters have access to the LNY:
# - Taoists (that are not Koreanic, unless Chinese imperial)
# - Confucians (that are not Koreanic, unless Chinese imperial)
# - Shenists
# - Reformed Shenists - even if not "Chinese enough"
# - Chinese culture group Buddhists; this might potentially be expanded a bit in the future to cover at least *some* "Chinese enough" Buddhists
# - The Emperor of China and pretender emperors, if "Chinese enough" (i.e. if they're eligible for Chinese Imperial)
# This choice should give the festival to most characters that realistically should be interested in it while not giving it to characters that have some other festival (e.g. Japonic Buddhists have the Hanami).

# The LNY can be celebrated Jan-Feb in the mod, and the actual LNY is assumed to take place February 1 (the sixty year cycle is rather more complicated to include).
# Festivities might not be in the right order, but the chosen order should lead to a payoff at the end and should hopefully have stuff happen throughout the LNY.
# There is a game rule specifically for disabling the supernatural stuff that's less Chinese, if that's desired

##### Initial setup (1-13)

# Determine if zodiac and/or element matches
character_event = {
	id = LNY.1
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		# Clear various flags from any previous LNY celebration
		clr_character_flag = acrobats_hired
		clr_character_flag = coming_to_lny
		clr_character_flag = dragon_boon_fertility
		clr_character_flag = dragon_boon_health
		clr_character_flag = dragon_boon_intelligence
		clr_character_flag = dragon_boon_martial
		clr_character_flag = dragon_boon_prosperity
		clr_character_flag = dragon_boon_rulership
		clr_character_flag = dragon_boon_strength
		clr_character_flag = dragon_boon_wisdom
		clr_character_flag = dragon_combat_undecided
		clr_character_flag = guest_lny_started
		clr_character_flag = helping_with_bandits
		clr_character_flag = helping_with_dragon
		clr_character_flag = host_lny_started
		clr_character_flag = large_fireworks
		clr_character_flag = lavishly_food
		clr_character_flag = lion_dance
		clr_character_flag = lny_artifact_theft
		clr_character_flag = lny_cleaned_a_little
		clr_character_flag = lny_cleaned_properly
		clr_character_flag = lny_did_not_clean
		clr_character_flag = lny_element_match
		clr_character_flag = lny_extra_dragon_guards
		clr_character_flag = lny_extravagant_decorations
		clr_character_flag = lny_no_decorations
		clr_character_flag = lny_normal_decorations
		clr_character_flag = lny_zodiac_match
		clr_character_flag = low_food
		clr_character_flag = massive_fireworks
		clr_character_flag = medium_food
		clr_character_flag = musicians_hired
		clr_character_flag = nine_dragon_dance
		clr_character_flag = no_lion_dance
		clr_character_flag = normal_dragon_dance
		clr_character_flag = normal_fireworks
		clr_character_flag = ongoing_dragon_attack
		clr_character_flag = red_envelopes
		clr_character_flag = sent_invitations
		clr_character_flag = small_dragon_dance
		clr_character_flag = small_fireworks
		clr_character_flag = two_dragon_dance
		# Determine ROOT's zodiac/element
		set_this_chinese_year_zodiac_element_yin_yang_effect = yes
		# Determine the zodiac/element of the new year and the old year - done globally
		set_old_chinese_year_zodiac_element_yin_yang_effect = yes
		set_new_chinese_year_zodiac_element_yin_yang_effect = yes
		# Check if there's a match
		if = {
			limit = {
				lunar_new_year_is_this_zodiac_trigger = yes
			}
			set_character_flag = lny_zodiac_match
		}
		if = {
			limit = {
				lunar_new_year_is_this_element_trigger = yes
			}
			set_character_flag = lny_element_match
		}
		character_event = { id = LNY.2 } # Dragon dance - always happens!
		random = {
			chance = 50
			character_event = { id = LNY.3 days = 1 } # Musicians
		}
		random = {
			chance = 50
			character_event = { id = LNY.4 days = 2 } # Acrobats
		}
		character_event = { id = LNY.5 days = 3 } # Fireworks - always happens!
		random = {
			chance = 50
			character_event = { id = LNY.6 days = 4 } # Lion dance
		}
		character_event = { id = LNY.7 days = 5 } # Decorations - always happens!
		random = {
			chance = 50
			character_event = { id = LNY.8 days = 6 } # Red envelopes
		}
		if = {
			limit = {
				has_global_flag = first_dragon_attack
				#NOT = {
				#	has_global_flag = dragon_slain # There could always be more dragons out there, so why take the risk...?
				#}
			}
			character_event = { id = LNY.85 days = 7 } # Extra guards in case of dragon attack
		}
		character_event = { id = LNY.9 days = 8 } # Food - always happens!
		character_event = { id = LNY.10 days = 9 } # Invitations - always happens!
	}
}

# Decide on dragon dance
character_event = {
	id = LNY.2
	desc = EVTDESC_LNY_2
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	option = {
		name = EVTOPTA_LNY_2 # What is the smallest dragon I can get away with?
		
		wealth = -5
		set_character_flag = small_dragon_dance
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = charitable
			}
			modifier = {
				factor = 0.1
				NOT = {
					trait = greedy
				}
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_2 # Give me one normal-sized dragon!
		
		wealth = -10
		set_character_flag = normal_dragon_dance
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = greedy
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
	option = {
		name = EVTOPTC_LNY_2 # Two dragons!
		
		wealth = -25
		set_character_flag = two_dragon_dance
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = greedy
			}
		}
	}
	option = {
		trigger = {
			OR = {
				tier = king
				tier = emperor
			}
			is_feudal = yes
		}
		name = EVTOPTD_LNY_2 # Give me the full nine dragons!
		
		wealth = -200
		set_character_flag = nine_dragon_dance
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = greedy
			}
			modifier = {
				factor = 10
				trait = ambitious
			}
			modifier = {
				factor = 10
				trait = proud
			}
			modifier = {
				factor = 10
				is_chinese_emperor_trigger = yes
			}
		}
	}
}

# Musicians
character_event = {
	id = LNY.3
	desc = EVTDESC_LNY_3
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	option = {
		name = EVTOPTA_LNY_3 # Musicians would make the celebration better
		
		wealth = -15
		set_character_flag = musicians_hired
		
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0.1
				trait = greedy
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_3 # No thanks!
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.1
				trait = charitable
			}
		}
	}
}

# Acrobats
character_event = {
	id = LNY.4
	desc = EVTDESC_LNY_4
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	option = {
		name = EVTOPTA_LNY_4 # Acrobats would make the celebration better
		
		wealth = -15
		set_character_flag = acrobats_hired
		
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0.1
				trait = greedy
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_4 # No thanks!
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.1
				trait = charitable
			}
		}
	}
}

# Fireworks
character_event = {
	id = LNY.5
	desc = EVTDESC_LNY_5
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	option = {
		name = EVTOPTA_LNY_5 # Get as few as possible
		
		wealth = -5
		set_character_flag = small_fireworks
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = charitable
			}
			modifier = {
				factor = 0.1
				NOT = {
					trait = greedy
				}
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_5 # Get a decent amount
		
		wealth = -10
		set_character_flag = normal_fireworks
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = greedy
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
	option = {
		name = EVTOPTC_LNY_5 # Get more than enough
		
		wealth = -25
		set_character_flag = large_fireworks
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = greedy
			}
		}
	}
	option = {
		name = EVTOPTD_LNY_5 # Get a LOT more than expected
		
		wealth = -100
		set_character_flag = massive_fireworks
		
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				trait = greedy
			}
			modifier = {
				factor = 10
				trait = ambitious
			}
			modifier = {
				factor = 10
				trait = proud
			}
			modifier = {
				factor = 10
				is_chinese_emperor_trigger = yes
			}
		}
	}
}

# Lion dance
character_event = {
	id = LNY.6
	desc = EVTDESC_LNY_6
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	option = {
		name = EVTOPTA_LNY_6 # Sure, let's have one of those!
		
		wealth = -15
		set_character_flag = lion_dance
		
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0.1
				trait = greedy
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_6 # It's not worth it...
		
		set_character_flag = no_lion_dance
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.1
				trait = charitable
			}
		}
	}
}

# Decorations
character_event = {
	id = LNY.7
	desc = EVTDESC_LNY_7
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	option = {
		name = EVTOPTA_LNY_7 # Don't bother
		
		set_character_flag = lny_no_decorations
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = charitable
			}
			modifier = {
				factor = 0.1
				NOT = {
					trait = greedy
				}
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_7 # Get a decent amount
		
		wealth = -15
		set_character_flag = lny_normal_decorations
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = greedy
			}
		}
	}
	option = {
		name = EVTOPTC_LNY_7 # Get more than expected
		
		wealth = -50
		set_character_flag = lny_extravagant_decorations
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = greedy
			}
		}
	}
}

# Red envelopes
character_event = {
	id = LNY.8
	desc = EVTDESC_LNY_8
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	option = {
		name = EVTOPTA_LNY_8 # Sure, let's do that!
		
		wealth = -25
		set_character_flag = red_envelopes
		
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0.1
				trait = greedy
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_8 # It's not worth it...
		
		piety = -10
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.1
				trait = charitable
			}
		}
	}
}

# Food preparations - vanilla code
character_event = {
	id = LNY.9
	desc = EVTDESC_LNY_9
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = lny_in_progress
		NOT = {
			has_character_flag = lavishly_food
		}
		NOT = {
			has_character_flag = medium_food
		}
		NOT = {
			has_character_flag = low_food
		}
	}

	option = {
		name = "EVTOPTA72003" #Spend lavishly on food
		gain_weight_small_effect = yes
		weight_trait_check_effect = yes
		trigger = { NOT = { trait = temperate } }
		ai_chance = {

			factor = 30

			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 3
				trait = gluttonous
			}
			modifier = {
				factor = 0.1
				trait = temperate
			}
			modifier = {
				factor = 2
				primary_title = { higher_tier_than = DUKE }
			}
		}
		set_character_flag = lavishly_food
		treasury = -20
		prestige = 10
	}
	option = {
		name = "EVTOPTB72003" #Spend medium on food
		ai_chance = {
			factor = 30

			modifier = {
				factor = 0.5
				NOT = { trait = greedy }
			}
			modifier = {
				factor = 2
				NOT = { trait = gluttonous }
			}
			modifier = {
				factor = 2
				primary_title = { tier = DUKE }
			}
		}
		set_character_flag = medium_food
		treasury = -10
	}
	option = {
		name = "EVTOPTC72003" #Spend low on food
		trigger = { NOT = { trait = gluttonous } }
		ai_chance = {
			factor = 30

			modifier = {
				factor = 2.5
				trait = greedy
			}
			modifier = {
				factor = 0.1
				trait = gluttonous
			}
			modifier = {
				factor = 2
				primary_title = { tier = COUNT }
			}
		}
		set_character_flag = low_food
		treasury = -5
		prestige = -5
	}
}

### Invitations (10-12)

# Time to send out invitations
character_event = {
	id = LNY.10
	desc = EVTDESC_LNY_10
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	trigger = {
		has_character_modifier = lny_in_progress
		OR = {
			has_character_flag = lavishly_food
			has_character_flag = medium_food
			has_character_flag = low_food
		}
		NOT = {
			has_character_flag = sent_invitations
		}
	}
	
	option = {
		name = "EVTOPTA72010"
		set_character_flag = sent_invitations
		custom_tooltip = {
			text = EVTTOOLTIP1_RoI_1000
		}
		hidden_tooltip = {
			character_event = { id = LNY.13 days = 15 }
			narrative_event = { id = LNY.14 days = 20 }
			any_vassal = {
				limit = {
					NOT = { is_inaccessible_trigger = yes }
					prisoner = no
					NOT = { has_character_flag = do_not_disturb }
					NOT = { trait = incapable }
					NOT = { has_character_modifier = lny_in_progress }
					war = no
					is_adult = yes
					NOT = {
						trait = treasure_fleet_preparation
					}
				}
				letter_event = {
					id = LNY.11
					days = 2
					#tooltip = "EVTTOOLTIP72011"
				}
			}
		}
	}
}

# Vassal gets invitation
letter_event = {
	id = LNY.11
	desc = EVTDESC_LNY_11

	is_triggered_only = yes

	trigger = { NOT = { is_inaccessible_trigger = yes } }

	option = {
		name = EVTOPTA_LNY_11 # Travel to the LNY celebration
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				opinion = { who = from value = -40 }
			}
			modifier  = {
				factor = 2
				opinion = { who = from value = -20 }
			}
		}
		set_character_flag = coming_to_lny
		set_character_flag = do_not_disturb
	}
	option = {
		name = EVTOPTB_LNY_11 # Refuse
		ai_chance = {
			factor = 1
			modifier  = {
				factor = 2
				NOT = { opinion = { who = from value = -60 } }
			}
			modifier  = {
				factor = 2
				NOT = { opinion = { who = from value = -80 } }
			}
		}
		FROM = {
			letter_event = {
				id = LNY.12
				days = 1
				random = 2
				tooltip = "EVTTOOLTIP72012"
			}
		}
	}
}

# Vassal refused invitation
letter_event = {
	id = LNY.12
	desc = EVTDESC_LNY_12

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72012"
		opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 10
		}
	}
}

# Cleaning
character_event = {
	id = LNY.13
	desc = EVTDESC_LNY_13
	picture = GFX_evt_china_famine
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_13 # Make sure everything is properly cleaned
		wealth = -10
		set_character_flag = lny_cleaned_properly
		
		random = {
			chance = 5
			add_trait = stressed
		}
		
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				trait = diligent
			}
			modifier = {
				factor = 0.1
				trait = slothful
			}
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_13 # Clean a little
		wealth = -5
		set_character_flag = lny_cleaned_a_little
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				trait = diligent
			}
			modifier = {
				factor = 0
				trait = zealous
			}
		}
	}
	option = {
		name = EVTOPTC_LNY_13 # Don't bother
		piety = -10
		set_character_flag = lny_did_not_clean
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				trait = diligent
			}
			modifier = {
				factor = 0
				trait = zealous
			}
		}
	}
}

##### Guests arrive + first event selection (14-15)

# Guests arrive - host
narrative_event = {
	id = LNY.14
	title = EVTTITLE_LNY_14
	desc = EVTDESC_LNY_14
	picture = GFX_evt_china_open
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_14 # Wishing you prosperity!
		
		set_character_flag = host_lny_started
		
		hidden_tooltip = {
			# Welcome the guests
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
				}
				set_character_flag = guest_lny_started
			}
			any_vassal = {
				limit = {
					ai = no # No need to spam the AI
					has_character_flag =  coming_to_lny
				}
				narrative_event = { id = LNY.15 }
			}
			
			# Cleaning
			random_list = {
				25 = {
					modifier = {
						factor = 0
						has_character_flag = lny_did_not_clean
					}
					modifier = {
						factor = 0.25
						has_character_flag = lny_cleaned_a_little
					}
					modifier = {
						factor = 0
						NOT = {
							any_vassal = {
								has_character_flag = coming_to_lny
								war = no
							}
						}
					}
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.16 days = 1 random = 1 } # Vassal compliments thorough cleaning
					}
				}
				50 = {
					modifier = {
						factor = 0
						has_character_flag = lny_cleaned_properly
					}
					modifier = {
						factor = 0.1
						has_character_flag = lny_did_not_clean
					}
					modifier = {
						factor = 0
						NOT = {
							any_vassal = {
								has_character_flag = coming_to_lny
								war = no
							}
						}
					}
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.18 days = 1 random = 1 } # Vassal comments on somewhat bad cleaning
					}
				}
				25 = {
					modifier = {
						factor = 0
						has_character_flag = lny_cleaned_properly
					}
					modifier = {
						factor = 0.1
						has_character_flag = lny_cleaned_a_little
					}
					modifier = {
						factor = 0
						NOT = {
							any_vassal = {
								has_character_flag = coming_to_lny
								war = no
							}
						}
					}
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.20 days = 1 random = 1 } # Vassal complains about lack of cleaning
					}
				}
			}
			
			# Food complaints/compliments - based on vanilla
			random_list = {
				10 = { #Lavish food (vassal)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = lavishly_food
							any_vassal = {
								has_character_flag = coming_to_lny
								war = no
							}
						}
					}
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.23 days = 6 random = 3 } # High food
					}
				}
				10 = { #Medium food (vassal)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = medium_food
							any_vassal = {
								has_character_flag = coming_to_lny
								war = no
							}
						}
					}
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.24 days = 6 random = 3 } # Medium food
					}
				}
				10 = { #Low food (vassal)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = low_food
							any_vassal = {
								has_character_flag = coming_to_lny
								war = no
							}
						}
					}
					any_vassal = {
						limit = {
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.25 days = 6 random = 3 } # Low food
					}
				}
			}
			
			# Decorations
			random_list = {
				25 = {
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = lny_extravagant_decorations
							any_vassal = {
								has_character_flag = coming_to_lny
								war = no
							}
						}
					}
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.28 days = 3 random = 2 } # Vassal compliments decorations
					}
				}
				50 = {
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = lny_no_decorations
							any_vassal = {
								has_character_flag = coming_to_lny
								war = no
							}
						}
					}
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.30 days = 3 random = 2 } # Vassal disparages lack  of decorations
					}
				}
				25 = {} # No event
			}
			
			# Stewardship discussion
			hidden_tooltip = {
				if = {
					limit = {
						any_vassal = {
							has_character_flag = coming_to_lny
							war = no
							stewardship = 16
						}
					}
					any_vassal = {
						limit = {
							has_character_flag = coming_to_lny
							war = no
							stewardship = 16
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						save_event_target_as = lny_stewardship_teacher
					}
					if = {
						limit = {
							NOT = {
								stewardship = 8
							}
						}
						character_event = { id = LNY.32 days = 7 random = 2 } # Chance to teach liege... or not
					}
					any_vassal = {
						limit = {
							has_character_flag = coming_to_lny
							war = no
							NOT = {
								stewardship = 8
							}
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.37 days = 4 random = 5 } # Chance to teach fellow vassal... or not
					}
				}
			}
			
			# If zodiac matches, fire a special event
			if = {
				limit = {
					has_character_flag = lny_zodiac_match
					NOT = {
						has_character_flag = lny_element_match
					}
				}
				character_event = { id = LNY.42 days = 8 random = 1 } # Priest blesses ruler's reign
			}
			# If zodiac AND element matches, fire a special event
			else_if = {
				limit = {
					has_character_flag = lny_zodiac_match
					has_character_flag = lny_element_match
				}
				narrative_event = { id = LNY.43 days = 8 random = 1 } # Priest blesses ruler's reign (major)
			}
			
			# Fire the second event selection
			character_event = { id = LNY.45 days = 10 } # More events
		}
	}
}

# Guests arrive - guest
narrative_event = {
	id = LNY.15
	title = EVTTITLE_LNY_15
	desc = EVTDESC_LNY_15
	picture = GFX_evt_china_open
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				any_rival = {
					character = FROM
				}
			}
			NOT = {
				is_dumb_trigger = yes
			}
		}
		name = EVTOPTA_LNY_15 # Wishing you prosperity!
		
		piety = 5
	}
	option = {
		trigger = {
			any_rival = {
				character = FROM
			}
		}
		name = EVTOPTB_LNY_15 # Wishing you prosperity... NOT!
		
		prestige = 25
		piety = -25
	}
	option = {
		trigger = {
			is_dumb_trigger = yes
		}
		name = EVTOPTC_LNY_15 # Happy New Year! - NOT what you're supposed to say!
		
		prestige = -25
	}
}

##### First event group (16-44)

### Cleaning (16-22)

# Vassal notices good cleaning
character_event = {
	id = LNY.16
	desc = EVTDESC_LNY_16
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_16 # How auspicious!
		opinion = {
			who = FROM
			modifier = approves_of_lny_cleaning
			months = 12
		}
		FROM = {
			character_event = { id = LNY.17 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_16 # Who cares?
		
		piety = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = -25
				}
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Liege notified of approval
character_event = {
	id = LNY.17
	desc = EVTDESC_LNY_17
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_17 # Good to hear!
		
		piety = 25
	}
}

# Vassal notices poor cleaning
character_event = {
	id = LNY.18
	desc = EVTDESC_LNY_18
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_18 # How inauspicious!
		opinion = {
			who = FROM
			modifier = disapproves_of_lny_cleaning
			months = 12
		}
		FROM = {
			character_event = { id = LNY.19 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = -25
				}
				NOT = {
					trait = zealous
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_18 # Who cares?
		
		piety = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					NOT = {
						opinion = {
							who = FROM
							value = -25
						}
					}
					trait = zealous
				}
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Liege notified of dislike
character_event = {
	id = LNY.19
	desc = EVTDESC_LNY_19
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_19 # Unfortunate
		
		piety = -10
		
		opinion = {
			who = FROM
			modifier = troublesome_guest
			months = 12
		}
	}
}

# Vassal notices NO cleaning
character_event = {
	id = LNY.20
	desc = EVTDESC_LNY_20
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_20 # Most inauspicious!
		FROM = {
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
				}
				opinion = {
					who = FROM
					modifier = disapproves_of_lny_cleaning
					months = 12
				}
			}
		}
		FROM = {
			character_event = { id = LNY.21 }
			any_vassal = {
				limit = {
					NOT = {
						character = ROOT
					}
					has_character_flag = coming_to_lny
				}
				character_event = { id = LNY.22 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 25
				}
				NOT = {
					trait = zealous
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_20 # Who cares?
		
		piety = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					NOT = {
						opinion = {
							who = FROM
							value = 25
						}
					}
					trait = zealous
				}
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Liege informed of vassal's comments
character_event = {
	id = LNY.21
	desc = EVTDESC_LNY_21
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
		
	option = {
		name = EVTOPTA_LNY_21 # Most unfortunate
		
		piety = -50
		
		opinion = {
			who = FROM
			modifier = troublesome_guest
			months = 12
		}
	}
}

# Other vassals informed
character_event = {
	id = LNY.22
	desc = EVTDESC_LNY_22
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_22 # Most inauspicious!
	}
}

### Food events - based on vanilla (23-27)

# Lavish Food
character_event = {
	id = LNY.23
	desc = EVTDESC_LNY_23
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTA_LNY_23 # Approve publicly
		trigger = {
			NOT = { trait = temperate }
		}
		gain_weight_small_effect = yes
		weight_trait_check_effect = yes
		ai_chance = {
			factor = 40

			modifier = {
				factor = 5
				trait = gluttonous
			}
		}
		FROM = {
			character_event = { id = LNY.26 }
		}
	}
	option = {
		name = EVTOPTB_LNY_23 # Disapprove
		trigger = {
			NOT = { trait = gluttonous }
		}
		ai_chance = {
			factor = 20

			modifier = {
				factor = 5
				trait = temperate
			}
		}
		FROM = {
			character_event = { id = LNY.27 }
		}
	}
	option = {
		name = EVTOPTC_LNY_23 # Say nothing
		prestige = -10
	}
}

# Medium Food
character_event = {
	id = LNY.24
	desc = EVTDESC_LNY_24
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTA_LNY_23 # Approve publicly
		FROM = {
			character_event = { id = LNY.26 }
		}
	}
	option = {
		name = EVTOPTB_LNY_23 # Disapprove publicly
		FROM = {
			character_event = { id = LNY.27 }
		}
	}
	option = {
		name = EVTOPTC_LNY_23 # Say nothing
		prestige = -10
	}
}

# Low Food
character_event = {
	id = LNY.25
	desc = EVTDESC_LNY_25
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTA_LNY_23 #Approve publicly
		trigger = {
			NOT = { trait = gluttonous }
		}
		ai_chance = {
			factor = 20

			modifier = {
				factor = 5
				trait = temperate
			}
		}
		FROM = {
			character_event = { id = LNY.26 }
		}
	}
	option = {
		name = EVTOPTB_LNY_23 #A pprove publicly
		trigger = {
			NOT = { trait = temperate }
		}
		ai_chance = {
			factor = 40

			modifier = {
				factor = 5
				trait = gluttonous
			}
		}
		FROM = {
			character_event = { id = LNY.27 }
		}
	}
	option = {
		name = EVTOPTC_LNY_23 # Say nothing
		prestige = -10
	}
}

# Liege is glad you liked the food at the feast
character_event = {
	id = LNY.26
	desc = EVTDESC_LNY_26
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = EVTOPTA_LNY_26 # Good!
		opinion = {
			modifier = opinion_happy
			who = FROM
			years = 10
		}
		reverse_opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
	}
}

# Liege dislikes you complaining about the food at the feast
character_event = {
	id = LNY.27
	desc = EVTDESC_LNY_27
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = EVTOPTA_LNY_27 # Shut up!
		opinion = {
			modifier = opinion_irritated
			who = FROM
			years = 10
		}
		reverse_opinion = {
			modifier = opinion_disapprove
			who = FROM
			years = 10
		}
	}
}

### Decorations (28-31)


# Vassal notices decorations
character_event = {
	id = LNY.28
	desc = EVTDESC_LNY_28
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_28 # How auspicious!
		opinion = {
			who = FROM
			modifier = approves_of_lny_decorations
			months = 12
		}
		FROM = {
			character_event = { id = LNY.29 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_28 # Who cares?
		
		prestige = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = -25
				}
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Liege notified of approval
character_event = {
	id = LNY.29
	desc = EVTDESC_LNY_29
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_29 # Good to hear!
		
		prestige = 25
	}
}

# Vassal notices lack of decorations
character_event = {
	id = LNY.30
	desc = EVTDESC_LNY_30
	picture = GFX_evt_china_famine
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_30 # Most inauspicious!
		opinion = {
			who = FROM
			modifier = disapproves_of_lny_decorations
			months = 12
		}
		FROM = {
			character_event = { id = LNY.31 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = -25
				}
				NOT = {
					trait = proud
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_30 # Who cares?
		
		prestige = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					NOT = {
						opinion = {
							who = FROM
							value = -25
						}
					}
					trait = proud
				}
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Liege notified of dislike
character_event = {
	id = LNY.31
	desc = EVTDESC_LNY_31
	picture = GFX_evt_china_famine
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_31 # Unfortunate
		
		prestige = -10
		
		opinion = {
			who = FROM
			modifier = troublesome_guest
			months = 12
		}
	}
}

### Stewardship (32-41)

# Approach vassal?
character_event = {
	id = LNY.32
	desc = EVTDESC_LNY_32
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		event_target:lny_stewardship_teacher = {
			is_inaccessible_or_incapable_trigger = no
			war = no
		}
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_32 # Let's ask!
		
		event_target:lny_stewardship_teacher = {
			character_event = { id = LNY.33 }
		}
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = ambitious
			}
			modifier = {
				factor = 0.01
				trait = proud
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_32 # Nah!
		
		prestige = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = content
			}
			modifier = {
				factor = 0.01
				trait = humble
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Vassal apporached
character_event = {
	id = LNY.33
	desc = EVTDESC_LNY_33
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_33 # Sure!
		
		prestige = 25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					opinion = {
						who = FROM
						value = 25
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.34 days = 1 } # Inform FROM
		}
	}
	option = {
		name = EVTOPTB_LNY_33 # I don't think so!
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 50
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -50
					}
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.35 days = 1 } # Inform FROM
		}
	}
	option = {
		trigger = {
			intrigue = 12
			FROM = {
				NOT = {
					intrigue = 8
				}
			}
		}
		name = EVTOPTC_LNY_33 # I'll teach FROM a lesson, to be sure...
		
		prestige = 50
		piety = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 25
				}
			}
			modifier = {
				factor = 0.1
				opinion = {
					who = FROM
					value = -25
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.36 days = 1 } # Inform FROM
		}
	}
}

# Got the lesson
character_event = {
	id = LNY.34
	desc = EVTDESC_LNY_34
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_34 # Great!
		
		add_character_modifier = {
			modifier = lny_stewardship
			months = 12
		}
		
		opinion = {
			who = FROM
			modifier = good_lny_teacher
		}
	}
}

# Got no lesson
character_event = {
	id = LNY.35
	desc = EVTDESC_LNY_35
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_35 # How rude!
		
		prestige = -5
		
		opinion = {
			who = FROM
			modifier = no_lny_teacher
		}
	}
}

# Got the wrong kind of lesson
character_event = {
	id = LNY.36
	desc = EVTDESC_LNY_36
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_36 # Curses!
		
		add_character_modifier = {
			modifier = bad_lny_stewardship
			months = 12
		}
		
		opinion = {
			who = FROM
			modifier = bad_lny_teacher
		}
		random = {
			chance = 25
			add_rival = FROM
		}
	}
}

# Approach fellow vassal?
character_event = {
	id = LNY.37
	desc = EVTDESC_LNY_37
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	is_triggered_only = yes
	
	trigger = {
		event_target:lny_stewardship_teacher = {
			is_inaccessible_or_incapable_trigger = no
			war = no
		}
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_32 # Let's ask!
		
		event_target:lny_stewardship_teacher = {
			character_event = { id = LNY.38 }
		}
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = ambitious
			}
			modifier = {
				factor = 0.01
				trait = proud
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_32 # Nah!
		
		prestige = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = content
			}
			modifier = {
				factor = 0.01
				trait = humble
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Vassal apporached
character_event = {
	id = LNY.38
	desc = EVTDESC_LNY_38
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_33 # Sure!
		
		prestige = 25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					opinion = {
						who = FROM
						value = 25
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.39 days = 1 } # Inform FROM
		}
	}
	option = {
		name = EVTOPTB_LNY_33 # I don't think so!
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 50
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -50
					}
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.40 days = 1 } # Inform FROM
		}
	}
	option = {
		trigger = {
			intrigue = 12
			FROM = {
				NOT = {
					intrigue = 8
				}
			}
		}
		name = EVTOPTC_LNY_33 # I'll teach FROM a lesson, to be sure...
		
		prestige = 50
		piety = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 25
				}
			}
			modifier = {
				factor = 0.1
				opinion = {
					who = FROM
					value = -25
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.41 days = 1 } # Inform FROM
		}
	}
}

# Got the lesson
character_event = {
	id = LNY.39
	desc = EVTDESC_LNY_39
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_34 # Great!
		
		add_character_modifier = {
			modifier = lny_stewardship
			months = 12
		}
		
		opinion = {
			who = FROM
			modifier = good_lny_teacher
		}
	}
}

# Got no lesson
character_event = {
	id = LNY.40
	desc = EVTDESC_LNY_40
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_35 # How rude!
		
		prestige = -5
		
		opinion = {
			who = FROM
			modifier = no_lny_teacher
		}
	}
}

# Got the wrong kind of lesson
character_event = {
	id = LNY.41
	desc = EVTDESC_LNY_41
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_36 # Curses!
		
		add_character_modifier = {
			modifier = bad_lny_stewardship
			months = 12
		}
		
		opinion = {
			who = FROM
			modifier = bad_lny_teacher
		}
		random = {
			chance = 25
			add_rival = FROM
		}
	}
}

### Zodiac (+ element) blessings (42-44)

# Priest blesses ruler (zodiac only)
character_event = {
	id = LNY.42
	desc = EVTDESC_LNY_42
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_42 # As if there was any doubt!
		
		prestige = 250
		piety = 100
		add_character_modifier = {
			modifier = lny_blessing
			months = 18
		}
	}
}

# Priest blesses ruler (zodiac + element)
narrative_event = {
	id = LNY.43
	title = EVTTITLE_LNY_43
	desc = EVTDESC_LNY_43
	picture = GFX_evt_china_golden_age
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_43 # As if there was any doubt!
		
		prestige = 500
		piety = 250
		add_character_modifier = {
			modifier = lny_major_blessing
			months = 36
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
			}
			opinion = {
				who = ROOT
				modifier = zodiac_element_match
			}
			if = {
				limit = {
					ai = no
				}
				narrative_event = { id = LNY.44 }
			}
		}
	}
}

# Vassals informed of major blessing
narrative_event = {
	id = LNY.44
	title = EVTTITLE_LNY_44
	desc = EVTDESC_LNY_44
	picture = GFX_evt_china_golden_age
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_44 # Good for FROM, I suppose
	}
}

##### Second event selection (45)

# Select events
character_event = {
	id = LNY.45
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	immediate = {
		# Musicians
		if = {
			limit = {
				has_character_flag = musicians_hired
			}
			random_list = {
				30 = {
					character_event = { id = LNY.46 } # Tone-deaf musicians upset townspeople
				}
				60 = {
					character_event = { id = LNY.47 } # Townspeople like musicians
				}
				10 = {
					character_event = { id = LNY.48 } # Musicians don't show up
				}
			}
		}
		
		# Acrobats
		if = {
			limit = {
				has_character_flag = acrobats_hired
			}
			random_list = {
				50 = {
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.49 days = 2 random = 1 } # Vassal likes acrobats
					}
				}
				10 = {
					character_event = { id = LNY.51 days = 2 random = 1 } # Burgled by acrobats
				}
				40 = {
					any_vassal = {
						count = 2
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.52 days = 2 random = 1 } # Vassal approached by burglar acrobats
					}
				}
			}
		}
		
		# Lion dance
		random_list = {
			25 = {
				modifier = {
					factor = 0
					NOT = {
						has_character_flag = no_lion_dance
					}
				}
				any_vassal = {
					limit = { 
						has_character_flag = coming_to_lny
						war = no
					}
					score_value = { #Prioritizes selecting an interesting courtier...
						value = 10
						interesting_courtier_selection_score = yes
					}
					character_event = { id = LNY.60 days = 4 random = 2 } # Vassal dislikes lack of lion dance
				}
			}
			50 = {
				modifier = {
					factor = 0
					NOT = {
						has_character_flag = lion_dance
					}
				}
				any_vassal = {
					limit = { 
						has_character_flag = coming_to_lny
						war = no
						ai = no
					}
					character_event = { id = LNY.62 days = 4 random = 2 } # Lettuce fight bet?
				}
				character_event = { id = LNY.62 days = 4 random = 2 } # Lettuce fight bet?
			}
			25 = {
				modifier = {
					factor = 0
					NOT = {
						has_character_flag = lion_dance
					}
				}
				any_vassal = {
					limit = { 
						has_character_flag = coming_to_lny
						war = no
						ai = no
						is_maimed_trigger = no
						NOT = {
							trait = pregnant
						}
						is_ill_trigger = no
					}
					character_event = { id = LNY.65 days = 4 random = 2 } # Replacement dancer needed for competition - join in?
				}
				if = {
					limit = {
						is_maimed_trigger = no
						NOT = {
							trait = pregnant
						}
						is_ill_trigger = no
					}
					character_event = { id = LNY.65 days = 4 random = 2 } # Replacement dancer needed for competition - join in?
				}
			}
			1 = {} # Nothing
		}
		
		# Red envelopes
		if = {
			limit = {
				has_character_flag = red_envelopes
			}
			any_vassal = {
				limit = { 
					has_character_flag = coming_to_lny
					war = no
				}
				random_list = {
					25 = {
						character_event = { id = LNY.70 days = 6 random = 2 } # Red envelope - nothing
					}
					50 = {
						character_event = { id = LNY.71 days = 6 random = 2 } # Red envelope - small
					}
					49 = {
						character_event = { id = LNY.72 days = 6 random = 2 } # Red envelope - medium
					}
					1 = {
						character_event = { id = LNY.73 days = 6 random = 2 } # Red envelope - large
					}
				}
			}
		}
		
		# Learning discussion
		if = {
			limit = {
				any_vassal = {
					has_character_flag = coming_to_lny
					war = no
					learning = 16
				}
			}
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
					war = no
					learning = 16
				}
				score_value = { #Prioritizes selecting an interesting courtier...
					value = 10
					interesting_courtier_selection_score = yes
				}
				save_event_target_as = lny_learning_teacher
			}
			if = {
				limit = {
					NOT = {
						learning = 8
					}
				}
				character_event = { id = LNY.74 days = 7 random = 2 } # Chance to teach liege... or not
			}
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
					war = no
					NOT = {
						learning = 8
					}
				}
				score_value = { #Prioritizes selecting an interesting courtier...
					value = 10
					interesting_courtier_selection_score = yes
				}
				character_event = { id = LNY.79 days = 4 random = 5 } # Chance to teach fellow vassal... or not
			}
		}
		
		# Third event group (+ dragons)
		character_event = { id = LNY.84 days = 10 } # Here there (might) be dragons!
	}
}

##### Second event group (46-83)

### Musicians (46-48)

# Tone-deaf musicians upset townspeople
character_event = {
	id = LNY.46
	desc = EVTDESC_LNY_46
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_46 # Curses!
		
		prestige = -10
		
		capital_scope = {
			add_province_modifier = {
				name = peasants_upset
				duration = 365
			}
		}
	}
}

# Good musicians make townspeople happy
character_event = {
	id = LNY.47
	desc = EVTDESC_LNY_47
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_47 # Great!
		
		prestige = 10
		
		capital_scope = {
			add_province_modifier = {
				name = peasants_happy
				duration = 365
			}
		}
	}
}

# Musicians don't show up
character_event = {
	id = LNY.48
	desc = EVTDESC_LNY_48
	picture = GFX_evt_china_isolationist
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_48 # Curses!
		
		prestige = -25
	}
}

### Acrobats (49-59)

# Vassal likes acrobats
character_event = {
	id = LNY.49
	desc = EVTDESC_LNY_49
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_49 # A good show indeed!
		opinion = {
			who = FROM
			modifier = approves_of_acrobats
			months = 12
		}
		FROM = {
			character_event = { id = LNY.50 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_49 # Who cares?
		
		piety = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = -25
				}
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Liege notified of approval
character_event = {
	id = LNY.50
	desc = EVTDESC_LNY_50
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_50 # Good to hear!
		
		prestige = 25
	}
}

# Burgled by acrobats
character_event = {
	id = LNY.51
	desc = EVTDESC_LNY_51
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_51 # Curses!
		
		prestige = -25
		wealth = -25
	}
}

# Vassal approached by burglar acrobats
character_event = {
	id = LNY.52
	desc = EVTDESC_LNY_52
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
			any_vassal = {
				has_character_flag = coming_to_lny
				war = no
				NOT = {
					character = ROOT
				}
			}
		}
	}
	
	immediate = {
		FROM = {
			any_vassal = {
				limit = { 
					has_character_flag = coming_to_lny
					war = no
					NOT = {
						character = ROOT
					}
				}
				score_value = { #Prioritizes selecting an interesting courtier...
					value = 10
					interesting_courtier_selection_score = yes
				}
				save_event_target_as = lny_burglar_target
			}
		}
	}
	
	option = {
		name = EVTOPTA_LNY_52 # I'm in!
		
		hidden_tooltip = {
			event_target:lny_burglar_target = { # ROOT's intrigue doesn't matter, since ROOT isn't part of the burglary
				random_list = {
					25 = {
						modifier = {
							factor = 10
							NOT = {
								intrigue = 10
							}
						}
						modifier = {
							factor = 10
							ROOT = {
								intrigue = 20
							}
						}
						character_event = { id = LNY.53 days = 1 } # Burglars successful
						ROOT = {
							character_event = { id = LNY.54 days = 1 } # Burglars successful
						}
					}
					50 = {
						character_event = { id = LNY.55 days = 1 } # Burglars unsuccesful, but flee
						ROOT = {
							character_event = { id = LNY.56 days = 1 } # Burglars unsuccesful, but flee
						}
					}
					25 = {
						modifier = {
							factor = 10
							intrigue = 20
						}
						modifier = {
							factor = 10
							NOT = {
								ROOT = {
									intrigue = 10
								}
							}
						}
						character_event = { id = LNY.57 days = 1 } # Burglars unsuccesful, and caught
					}
				}
			}
		}
		
		if = {
			limit = {
				NOR = {
					trait = just
					trait = honest
					trait = charitable
				}
			}
			random_list = {
				33 = {
					add_trait = arbitrary
				}
				34 = {
					add_trait = deceitful
				}
				33 = {
					add_trait = greedy
				}
			}
		}
		
		if = {
			limit = {
				trait = just
			}
			random = {
				chance = 25
				remove_trait = just
			}
		}
		if = {
			limit = {
				trait = honest
			}
			random = {
				chance = 25
				remove_trait = honest
			}
		}
		if = {
			limit = {
				trait = charitable
			}
			random = {
				chance = 25
				remove_trait = charitable
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = event_target:lny_burglar_target
					value = 50
				}
			}
			modifier = {
				factor = 0
				opinion = {
					who = event_target:lny_burglar_target
					value = 25
				}
				NOR = {
					trait = deceitful
					trait = arbitrary
					trait = greedy
				}
			}
			modifier = {
				factor = 0.01
				event_target:lny_burglar_target = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_52 # Get out of my sight!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = just
					trait = honest
				}
			}
			modifier = {
				factor = 0.1
				opinion = {
					who = event_target:lny_burglar_target
					value = 0
				}
			}
			modifier = {
				factor = 0.001
				event_target:lny_burglar_target = {
					any_rival = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0.01
				trait = greedy
			}
		}
	}
}

# Burglar acrobats strike successfully - victim
character_event = {
	id = LNY.53
	desc = EVTDESC_LNY_53
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_53 # Oh no!
		wealth = -50
	}
}

# Vassal gets spoils
character_event = {
	id = LNY.54
	desc = EVTDESC_LNY_54
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_54 # A job well done!
		
		prestige = 25
		wealth = 25
	}
}

# Burglar acrobats strike unsuccesfully but escape - victim
character_event = {
	id = LNY.55
	desc = EVTDESC_LNY_55
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_55 # I wonder who sent them...
	}
}

# Vassal informed burglars escaped
character_event = {
	id = LNY.56
	desc = EVTDESC_LNY_56
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_56 # At least they escaped!
	}
}

# Burglar acrobats strike unsuccesfully and are caught - victim
character_event = {
	id = LNY.57
	desc = EVTDESC_LNY_57
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_57 # It was YOU!
		
		add_rival = FROM
		
		FROM = {
			character_event = { id = LNY.58 }
		}
	}
}

# Vassal informed burglars tattled
character_event = {
	id = LNY.58
	desc = EVTDESC_LNY_58
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_58 # Lies! Lies and slander!
		
		add_rival = FROM
		
		FROMFROMFROM = {
			character_event = { id = LNY.59 }
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
					war = no
				}
				if = {
					limit = {
						ai = no
					}
					character_event = { id = LNY.59 }
				}
			}
		}
	}
}

# Everyone informed of possibly criminal vassal
character_event = {
	id = LNY.59
	desc = EVTDESC_LNY_59
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_59 # Word against word, but I suspect FROM did it...
		
		opinion = {
			who = FROM
			modifier = lny_thief
		}
	}
}

### Lion dance (60-69)

# Lack of lion dance upsets vassal
character_event = {
	id = LNY.60
	desc = EVTDESC_LNY_60
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_60 # How disappointing!
		opinion = {
			who = FROM
			modifier = disapproves_of_lny_no_lion_dance
			months = 12
		}
		FROM = {
			character_event = { id = LNY.61 }
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = -25
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_60 # Who cares?
		
		prestige = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Liege informed
character_event = {
	id = LNY.61
	desc = EVTDESC_LNY_61
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_61 # Unfortunate
		
		prestige = -10
		
		opinion = {
			who = FROM
			modifier = troublesome_guest
			months = 12
		}
	}
}

# Lettuce fight - bet?
character_event = {
	id = LNY.62
	desc = EVTDESC_LNY_62
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_62 # I bet on that one!
		
		wealth = -25
		random_list = {
			50 = {
				character_event = { id = LNY.63 days = 1 } # Won
			}
			50 = {
				character_event = { id = LNY.64 days = 1 } # Lost
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				trait = content
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_62 # No bets for me!
		
		prestige = -5
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				trait = gamer
			}
		}
	}
}

# Bet won
character_event = {
	id = LNY.63
	desc = EVTDESC_LNY_63
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_63 # Excellent!
		
		wealth = 50
	}
}

# Bet lost
character_event = {
	id = LNY.64
	desc = EVTDESC_LNY_64
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_64 # Curses!
		
		prestige = -25
	}
}

# Replacement acrobat needed - want to join?
character_event = {
	id = LNY.65
	desc = EVTDESC_LNY_65
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_65 # I'll join you!
		
		random_list = {
			25 = {
				modifier = {
					factor = 1.5
					combat_rating = 100
				}
				modifier = {
					factor = 1.5
					combat_rating = 90
				}
				modifier = {
					factor = 1.5
					combat_rating = 80
				}
				modifier = {
					factor = 1.5
					combat_rating = 70
				}
				modifier = {
					factor = 1.5
					combat_rating = 60
				}
				modifier = {
					factor = 1.5
					combat_rating = 50
				}
				modifier = {
					factor = 1.5
					combat_rating = 45
				}
				modifier = {
					factor = 1.5
					combat_rating = 40
				}
				modifier = {
					factor = 1.5
					combat_rating = 35
				}
				character_event = { id = LNY.66 days = 1 } # Won
			}
			60 = {
				modifier = {
					factor = 1.5
					combat_rating = 50
				}
				modifier = {
					factor = 1.5
					combat_rating = 45
				}
				modifier = {
					factor = 1.5
					combat_rating = 40
				}
				modifier = {
					factor = 1.5
					combat_rating = 35
				}
				character_event = { id = LNY.67 days = 1 } # Lost
			}
			10 = {
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 30
					}
				}
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 20
					}
				}
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 0
					}
				}
				character_event = { id = LNY.68 days = 1 } # Wounded
			}
			5 = {
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 30
					}
				}
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 25
					}
				}
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 20
					}
				}
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 10
					}
				}
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 5
					}
				}
				modifier = {
					factor = 1.5
					NOT = {
						combat_rating = 0
					}
				}
				character_event = { id = LNY.69 days = 1 } # Maimed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				trait = content
			}
			modifier = {
				factor = 0
				trait = proud
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_65 # No thanks!
		
		prestige = -10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				trait = humble
			}
		}
	}
}

# Competition won
character_event = {
	id = LNY.66
	desc = EVTDESC_LNY_66
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_66 # Excellent!
		
		wealth = 10
		prestige = 50
	}
}

# Competition lost
character_event = {
	id = LNY.67
	desc = EVTDESC_LNY_67
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_67 # At least I didn't make a fool of myself...
		
		prestige = 10
	}
}

# Competition went poorly
character_event = {
	id = LNY.68
	desc = EVTDESC_LNY_68
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_68 # Curses!
		
		prestige = -5
		add_trait = wounded
	}
}

# Competition went really poorly
character_event = {
	id = LNY.69
	desc = EVTDESC_LNY_69
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_69 # Ow!
		
		prestige = -25
		add_maimed_trait_effect = yes
	}
}

### Red envelopes (70-73)

# Got no money
character_event = {
	id = LNY.70
	desc = EVTDESC_LNY_70
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_70 # That's it?
	}
}

# Got small money
character_event = {
	id = LNY.71
	desc = EVTDESC_LNY_71
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_71 # That's it?
		
		wealth = 1
	}
}

# Got medium money
character_event = {
	id = LNY.72
	desc = EVTDESC_LNY_72
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_72 # Good!
		
		wealth = 5
	}
}

# Got large money
character_event = {
	id = LNY.73
	desc = EVTDESC_LNY_73
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_73 # Good!
		
		wealth = 10
	}
}

### Learning (74-83)

# Approach vassal?
character_event = {
	id = LNY.74
	desc = EVTDESC_LNY_74
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		event_target:lny_learning_teacher = {
			is_inaccessible_or_incapable_trigger = no
			war = no
		}
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_32 # Let's ask!
		
		event_target:lny_stewardship_teacher = {
			character_event = { id = LNY.75 }
		}
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = ambitious
			}
			modifier = {
				factor = 0.01
				trait = proud
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_32 # Nah!
		
		prestige = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = content
			}
			modifier = {
				factor = 0.01
				trait = humble
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Vassal apporached
character_event = {
	id = LNY.75
	desc = EVTDESC_LNY_75
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_33 # Sure!
		
		prestige = 25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					opinion = {
						who = FROM
						value = 25
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.76 days = 1 } # Inform FROM
		}
	}
	option = {
		name = EVTOPTB_LNY_33 # I don't think so!
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 50
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -50
					}
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.77 days = 1 } # Inform FROM
		}
	}
	option = {
		trigger = {
			intrigue = 12
			FROM = {
				NOT = {
					intrigue = 8
				}
			}
		}
		name = EVTOPTC_LNY_33 # I'll teach FROM a lesson, to be sure...
		
		prestige = 50
		piety = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 25
				}
			}
			modifier = {
				factor = 0.1
				opinion = {
					who = FROM
					value = -25
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.78 days = 1 } # Inform FROM
		}
	}
}

# Got the lesson
character_event = {
	id = LNY.76
	desc = EVTDESC_LNY_76
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_34 # Great!
		
		add_character_modifier = {
			modifier = lny_learning
			months = 12
		}
		
		opinion = {
			who = FROM
			modifier = good_lny_teacher
		}
	}
}

# Got no lesson
character_event = {
	id = LNY.77
	desc = EVTDESC_LNY_77
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_35 # How rude!
		
		prestige = -5
		
		opinion = {
			who = FROM
			modifier = no_lny_teacher
		}
	}
}

# Got the wrong kind of lesson
character_event = {
	id = LNY.78
	desc = EVTDESC_LNY_78
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_36 # Curses!
		
		add_character_modifier = {
			modifier = bad_lny_learning
			months = 12
		}
		
		opinion = {
			who = FROM
			modifier = bad_lny_teacher
		}
		random = {
			chance = 25
			add_rival = FROM
		}
	}
}

# Approach fellow vassal?
character_event = {
	id = LNY.79
	desc = EVTDESC_LNY_79
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	is_triggered_only = yes
	
	trigger = {
		event_target:lny_learning_teacher = {
			is_inaccessible_or_incapable_trigger = no
			war = no
		}
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_32 # Let's ask!
		
		event_target:lny_stewardship_teacher = {
			character_event = { id = LNY.80 }
		}
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = ambitious
			}
			modifier = {
				factor = 0.01
				trait = proud
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_32 # Nah!
		
		prestige = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = content
			}
			modifier = {
				factor = 0.01
				trait = humble
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Vassal apporached
character_event = {
	id = LNY.80
	desc = EVTDESC_LNY_80
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_33 # Sure!
		
		prestige = 25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					opinion = {
						who = FROM
						value = 25
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -25
					}
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.81 days = 1 } # Inform FROM
		}
	}
	option = {
		name = EVTOPTB_LNY_33 # I don't think so!
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 50
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -50
					}
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.82 days = 1 } # Inform FROM
		}
	}
	option = {
		trigger = {
			intrigue = 12
			FROM = {
				NOT = {
					intrigue = 8
				}
			}
		}
		name = EVTOPTC_LNY_33 # I'll teach FROM a lesson, to be sure...
		
		prestige = 50
		piety = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 25
				}
			}
			modifier = {
				factor = 0.1
				opinion = {
					who = FROM
					value = -25
				}
			}
		}
		
		FROM = {
			character_event = { id = LNY.83 days = 1 } # Inform FROM
		}
	}
}

# Got the lesson
character_event = {
	id = LNY.81
	desc = EVTDESC_LNY_81
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_34 # Great!
		
		add_character_modifier = {
			modifier = lny_learning
			months = 12
		}
		
		opinion = {
			who = FROM
			modifier = good_lny_teacher
		}
	}
}

# Got no lesson
character_event = {
	id = LNY.82
	desc = EVTDESC_LNY_82
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_35 # How rude!
		
		prestige = -5
		
		opinion = {
			who = FROM
			modifier = no_lny_teacher
		}
	}
}

# Got the wrong kind of lesson
character_event = {
	id = LNY.83
	desc = EVTDESC_LNY_83
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_36 # Curses!
		
		add_character_modifier = {
			modifier = bad_lny_learning
			months = 12
		}
		
		opinion = {
			who = FROM
			modifier = bad_lny_teacher
		}
		random = {
			chance = 25
			add_rival = FROM
		}
	}
}

##### Third event selection (+ dragons) (84)

character_event = {
	id = LNY.84
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	immediate = {
		# Dragon events - supernatural!
		if = {
			limit = {
				OR = {
					AND = {
						ai = yes
						has_game_rule = {
							name = supernatural_events
							value = unrestricted
						}
					}
					AND = {
						ai = no
						NOT = {
							has_game_rule = {
								name = supernatural_events
								value = off
							}
						}
					}
				}
			}
			random_list = {
				70 = {
					modifier = {
						factor = 0
						has_global_flag = lunar_new_year_zodiac_is_dragon # The Year of the Dragon WILL contain a dragon event!
					}
				}
				20 = { # Chinese dragon - more likely than others
					modifier = {
						factor = 2
						has_global_flag = lunar_new_year_element_is_air
					}
					modifier = {
						factor = 5
						has_character_modifier = mandate_of_heaven_5
					}
					modifier = {
						factor = 2
						has_character_modifier = mandate_of_heaven_4
					}
					modifier = {
						factor = 0
						has_game_rule = {
							name =  western_dragons
							value = allowed
						}
						NOT = {
							has_global_flag = first_dragon_attack
						}
						has_global_flag = lunar_new_year_element_is_fire # If it is the Year of the Fire Dragon, !!FUN!! is about to begin...
						ai = no
					}
					random_list = {
						5 = {
							character_event = { id = LNY.86 } # Chinese dragon sighted
						}
						10 = {
							character_event = { id = LNY.88 } # Chinese dragon flyby
						}
						5 = {
							modifier = {
								factor = 0
								NOT = {
									has_character_flag = lny_extra_dragon_guards
								}
							}
							character_event = { id = LNY.90 } # Chinese dragon driven off
						}
						5 = {
							modifier = {
								factor = 0
								NOT = {
									has_character_flag = lny_extra_dragon_guards
								}
							}
							narrative_event = { id = LNY.92 } # Chinese dragon displeased due to guards attacking it
						}
						5 = {
							modifier = {
								factor = 2
								has_character_flag = two_dragon_dance
							}
							modifier = {
								factor = 5
								has_character_flag = nine_dragon_dance
							}
							narrative_event = { id = LNY.94 } # Chinese dragon lands, might offer boon
						}
					}
				}
				5 = { # Silver dragon on a mission to smite evil
					modifier = {
						factor = 0
						has_game_rule = {
							name =  western_dragons
							value = forbidden
						}
					}
					modifier = {
						factor = 5
						has_global_flag = lunar_new_year_element_is_metal
					}
					modifier = {
						factor = 0
						has_global_flag = silver_dragon_active # We don't want to have it fight in two places at once
					}
					modifier = {
						factor = 2
						has_global_flag = first_dragon_attack
						NOT = {
							has_global_flag = dragon_slain
						}
					}
					modifier = {
						factor = 0
						has_game_rule = {
							name =  western_dragons
							value = allowed
						}
						NOT = {
							has_global_flag = first_dragon_attack
						}
						has_global_flag = lunar_new_year_element_is_fire # If it is the Year of the Fire Dragon, !!FUN!! is about to begin...
						ai = no
					}
					random_list = {
						5 = {
							character_event = { id = LNY.114 } # Silver dragon sighted
						}
						10 = {
							character_event = { id = LNY.116 } # Silver dragon flyby
						}
						10 = {
							modifier = {
								factor = 0
								NOT = {
									has_character_flag = lny_extra_dragon_guards
								}
							}
							character_event = { id = LNY.118 } # Silver dragon driven off
						}
						5 = {
							modifier = {
								factor = 0
								NOT = {
									has_character_flag = lny_extra_dragon_guards
								}
							}
							modifier = {
								factor = 0
								NOR = {
									any_vassal = {
										has_character_flag = coming_to_lny
										war = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
									any_courtier = {
										is_inaccessible_or_incapable_trigger = no
										prisoner = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
								}
							}
							if = {
								limit = {
									any_vassal = {
										has_character_flag = coming_to_lny
										war = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
								}
								any_vassal = {
									limit = {
										has_character_flag = coming_to_lny
										war = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
									score_value = { #Prioritizes selecting an interesting courtier...
										value = 10
										interesting_courtier_selection_score = yes
									}
									save_event_target_as = smite_evil_target
								}
							}
							else = {
								any_courtier = {
									limit = {
										is_inaccessible_or_incapable_trigger = no
										prisoner = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
									score_value = { #Prioritizes selecting an interesting courtier...
										value = 10
										interesting_courtier_selection_score = yes
									}
									save_event_target_as = smite_evil_target
								}
							}
							set_global_flag = silver_dragon_active
							narrative_event = { id = LNY.120 } # Silver dragon displeased due to guards attacking it
						}
						10 = {
							modifier = {
								factor = 0
								NOR = {
									any_vassal = {
										has_character_flag = coming_to_lny
										war = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
									any_courtier = {
										is_inaccessible_or_incapable_trigger = no
										prisoner = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
								}
							}
							if = {
								limit = {
									any_vassal = {
										has_character_flag = coming_to_lny
										war = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
								}
								any_vassal = {
									limit = {
										has_character_flag = coming_to_lny
										war = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
									score_value = { #Prioritizes selecting an interesting courtier...
										value = 10
										interesting_courtier_selection_score = yes
									}
									save_event_target_as = smite_evil_target
								}
							}
							else = {
								any_courtier = {
									limit = {
										is_inaccessible_or_incapable_trigger = no
										prisoner = no
										is_adult = yes
										OR = {
											AND = {
												is_evil_trigger = yes
												has_vice_trigger = yes
											}
											is_devil_worshiper_trigger = yes
										}
										is_ill_trigger = no
										is_maimed_trigger = no
										NOT = {
											trait = pregnant
										}
									}
									score_value = { #Prioritizes selecting an interesting courtier...
										value = 10
										interesting_courtier_selection_score = yes
									}
									save_event_target_as = smite_evil_target
								}
							}
							set_global_flag = silver_dragon_active
							narrative_event = { id = LNY.130 } # Silver dragon targets evildoer
						}
						5 = {
							modifier = {
								factor = 0
								is_benevolent_trigger = no
							}
							modifier = {
								factor = 0
								has_pleasant_trait_trigger = no
							}
							modifier = {
								factor = 0
								has_pious_trait_trigger = no
							}
							modifier = {
								factor = 0
								has_virtue_trigger = no
							}
							modifier = {
								factor = 0
								has_global_flag = gram_exists
							}
							modifier = {
								factor = 0
								NOT = {
									has_global_flag = first_dragon_attack # If the evil dragon isn't known to exist, don't give away gram
								}
							}
							modifier = {
								factor = 0
								has_global_flag = dragon_slain # The evil dragon is no more
							}
							modifier = {
								factor = 0
								NOT = {
									piety = 2000
								}
							}
							modifier = {
								factor = 0
								is_devil_worshiper_trigger = yes
							}
							modifier = {
								factor = 0
								is_evil_trigger = yes
								has_vice_trigger = yes
							}
							set_global_flag = gram_exists
							set_global_flag = silver_dragon_active
							narrative_event = { id = LNY.137 } # Silver dragon gifts Gram to the ruler
						}
					}
				}
				5 = { # Red dragon on a mission to burninate
					modifier = {
						factor = 0
						has_game_rule = {
							name = western_dragons
							value = forbidden
						}
					}
					modifier = {
						factor = 10
						has_global_flag = first_dragon_attack
					}
					modifier = {
						factor = 10
						has_global_flag = lunar_new_year_element_is_fire
					}
					modifier = {
						factor = 0
						has_global_flag = dragon_injured # The dragon needs to recover between attacks
					}
					modifier = {
						factor = 0
						has_global_flag = ongoing_dragon_attack # We don't want to risk the dragon being killed in one place while attacking another
					}
					modifier = {
						factor = 0
						has_global_flag = dragon_slain # The evil dragon is no more
					}
					modifier = {
						factor = 0
						has_game_rule = {
							name =  western_dragons
							value = allowed
						}
						NOT = {
							has_global_flag = first_dragon_attack
						}
						NAND = {
							# The fun begins a certain year...
							has_global_flag = lunar_new_year_zodiac_is_dragon
							has_global_flag = lunar_new_year_element_is_fire 
						}
					}
					random_list = {
						1 = {
							modifier = {
								factor = 0
								NOT = {
									has_global_flag = first_dragon_attack
								}
							}
							character_event = { id = LNY.139 } # Red dragon sighted
						}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									has_global_flag = first_dragon_attack
								}
							}
							character_event = { id = LNY.141 } # Red dragon flyby
						}
						1 = {
							modifier = {
								factor = 0
								NOT = {
									has_character_flag = lny_extra_dragon_guards
								}
							}
							modifier = {
								factor = 0
								NOT = {
									has_global_flag = first_dragon_attack
								}
							}
							character_event = { id = LNY.143 } # Red dragon driven off
						}
						10 = {
							modifier = {
								factor = 0
								has_global_flag = first_dragon_attack
							}
							set_global_flag = first_dragon_attack
							set_global_flag = ongoing_dragon_attack
							set_character_flag = ongoing_dragon_attack
							narrative_event = { id = LNY.146 } # First red dragon attack
						}
						10 = {
							modifier = {
								factor = 0
								NOT = {
									has_global_flag = first_dragon_attack
								}
							}
							set_global_flag = ongoing_dragon_attack
							set_character_flag = ongoing_dragon_attack
							narrative_event = { id = LNY.163 } # Red dragon attacks
						}
					}
				}
			}
		}
		
		if = {
			limit = {
				NOT = {
					has_character_flag = ongoing_dragon_attack # Dragon attacks derail festivities, but otherwise the show must go on
				}
			}
			
			# Dragon dance
			random_list = {
				10 = {
					modifier = {
						factor = 0
						has_character_flag = nine_dragon_dance
					}
					modifier = {
						factor = 0
						has_character_flag = two_dragon_dance
					}
					modifier = {
						factor = 0
						NOR = {
							tier = king
							tier = emperor
						}
						has_character_flag = normal_dragon_dance
					}
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.181 days = 4 } # Vassal might complain
					}
				}
				10 = {
					modifier = {
						factor = 0
						has_character_flag = nine_dragon_dance
					}
					modifier = {
						factor = 0
						has_character_flag = two_dragon_dance
					}
					character_event = { id = LNY.184 days = 4 } # Dragon dance is good
				}
				10 = {
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = nine_dragon_dance
							has_character_flag = two_dragon_dance
						}
					}
					character_event = { id = LNY.186 days = 4 } # Dragon dancers get tangled up
				}
				10 = {
					modifier = {
						factor = 0
						NOT = {
							has_character_flag = two_dragon_dance
						}
					}
					character_event = { id = LNY.188 days = 4 } # Two dragons are more impressive than one
				}
				10 = {
					modifier = {
						factor = 0
						NOT = {
							has_character_flag = nine_dragon_dance
						}
					}
					narrative_event = { id = LNY.190 days = 4 } # Nine dragons are most impressive
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							primary_title = {
								has_law = status_of_women_4
							}
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_equal
						}
					}
					narrative_event = { id = LNY.192 days = 4 } # Bandits disguise themselves as dragon dancers
				}
			}
			
			# Fireworks
			random_list = {
				10 = {
					modifier = {
						factor = 0
						has_character_flag = massive_fireworks
					}
					modifier = {
						factor = 0
						has_character_flag = large_fireworks
					}
					modifier = {
						factor = 0
						NOR = {
							tier = king
							tier = emperor
						}
						has_character_flag = normal_fireworks
					}
					any_vassal = {
						limit = { 
							has_character_flag = coming_to_lny
							war = no
						}
						score_value = { #Prioritizes selecting an interesting courtier...
							value = 10
							interesting_courtier_selection_score = yes
						}
						character_event = { id = LNY.201 days = 7 } # Vassal might complain
					}
				}
				10 = {
					modifier = {
						factor = 0
						has_character_flag = massive_fireworks
					}
					modifier = {
						factor = 0
						has_character_flag = large_fireworks
					}
					character_event = { id = LNY.204 days = 7 } # Fireworks are acceptable
				}
				10 = {
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = massive_fireworks
							has_character_flag = large_fireworks
						}
					}
					character_event = { id = LNY.206 days = 7 } # Larger than normal fireworks are good
				}
				10 = {
					modifier = {
						factor = 0
						NOT = {
							has_character_flag = two_dragon_dance
						}
					}
					narrative_event = { id = LNY.208 days = 7 } # Massive fireworks are great
				}
			}
			
			# End of the LNY
			character_event = { id = LNY.210 days = 10 } # Ends the LNY
		}
	}
}

##### Supernatural dragon events (separated from the rest) (85-180)

# Extra guards (85)
character_event = {
	id = LNY.85
	desc = EVTDESC_LNY_85
	picture = GFX_evt_china_invades
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	trigger = {
		has_character_modifier = lny_in_progress
	}
	
	option = {
		name = EVTOPTA_LNY_85 # Yes! Get me more guards!
		
		wealth = -100
		
		set_character_flag = lny_extra_dragon_guards
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = greedy # Surely I won't have to pay more if attacked!
			}
			modifier = {
				factor = 0.1
				trait = brave # I fear no dragon!
			}
			modifier = {
				factor = 0.1
				is_dumb_trigger = yes # "Hire guards"? Can you use smaller words?
			}
			modifier = {
				factor = 0.1
				any_artifact = {
					has_flag = dragonslayer # I should win... right?
				}
			}
		}
	}
	option = {
		name = EVTOPTB_LNY_85 # There's no need for more guards!
		
		prestige = 25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven # Dragons are scary!
			}
			modifier = {
				factor = 0.1
				is_smart_trigger = yes # Let's not be foolhardy...
			}
		}
	}
}

### Chinese dragon (86-113)

# Chinese dragon sighted
character_event = {
	id = LNY.86
	desc = EVTDESC_LNY_86
	picture = GFX_evt_chinese_mythology
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_86 # Auspicious!
		
		piety = 25
		prestige = 25
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.87 } # Inform vassals
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.87
	desc = EVTDESC_LNY_87
	picture = GFX_evt_chinese_mythology
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_87 # Auspicious!
	}
}

# Chinese dragon flyby
character_event = {
	id = LNY.88
	desc = EVTDESC_LNY_88
	picture = GFX_evt_chinese_mythology
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_88 # Most auspicious!
		
		piety = 50
		prestige = 50
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.89 } # Inform vassals
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.89
	desc = EVTDESC_LNY_89
	picture = GFX_evt_chinese_mythology
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_89 # Most auspicious!
	}
}

# Chinese dragon accidentally driven off
character_event = {
	id = LNY.90
	desc = EVTDESC_LNY_90
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_90 # Inauspicious!
		
		piety = -50
		prestige = -50
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.91 } # Inform vassals
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.91
	desc = EVTDESC_LNY_91
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_91 # Inauspicious!
	}
}

# Chinese dragon angered by attack
narrative_event = {
	id = LNY.92
	title = EVTTITLE_LNY_92
	desc = EVTDESC_LNY_92
	picture = GFX_evt_china_diplomatic_incident
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_92 # Most inauspicious!
		
		piety = -100
		prestige = -100
		
		hidden_tooltip = {
			if = {
				limit = {
					government = chinese_imperial_government
				}
				change_variable = {
					which = mandate_of_heaven
					value = -2
				}
			}
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
			}
			opinion = {
				who = ROOT
				modifier = angered_chinese_dragon
			}
			if = {
				limit = {
					ai = no
				}
				narrative_event = { id = LNY.93 } # Inform vassals
			}
		}
	}
}

# Inform vassals
narrative_event = {
	id = LNY.93
	title = EVTTITLE_LNY_93
	desc = EVTDESC_LNY_93
	picture = GFX_evt_china_diplomatic_incident
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_93 # Most inauspicious!
	}
}

# Chinese dragon lands, might agree to boon
narrative_event = {
	id = LNY.94
	title = EVTTITLE_LNY_94
	desc = EVTDESC_LNY_94
	picture = GFX_evt_chinese_mythology
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	immediate = {
		# Select a few possible boons
		if = {
			limit = {
				is_adult = yes
				OR = {
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
					trait = ambitious
					martial = 15
				}
			}
			random = {
				chance = 25
				set_character_flag = dragon_boon_martial
			}
		}
		if = {
			limit = {
				NOT = {
					trait = strong
				}
			}
			random = {
				chance = 25
				set_character_flag = dragon_boon_strength
			}
		}
		if = {
			limit = {
				OR = {
					is_ill_trigger = yes
					is_maimed_trigger = yes
					any_realm_province = {
						has_disease = yes
					}
					age = 60
				}
			}
			random = {
				chance = 25
				set_character_flag = dragon_boon_health
			}
		}
		if = {
			limit = {
				is_adult = yes
				NAND = {
					is_female = yes
					age = 45
				}
				NOT = {
					trait = celibate
				}
			}
			random = {
				chance = 25
				set_character_flag = dragon_boon_fertility
			}
		}
		if = {
			limit = {
				OR = {
					has_education_stewardship_trigger = yes
					has_lifestyle_stewardship_trigger = yes
					stewardship = 15
					trait = diligent
				}
			}
			random = {
				chance = 25
				set_character_flag = dragon_boon_prosperity
			}
		}
		if = {
			limit = {
				OR = {
					has_education_learning_trigger = yes
					has_lifestyle_learning_trigger = yes
					NOT = {
						diplomacy = 8
					}
					NOT = {
						martial = 8
					}
					NOT = {
						stewardship = 8
					}
					NOT = {
						intrigue = 8
					}
					NOT = {
						learning = 8
					}
				}
			}
			random = {
				chance = 25
				set_character_flag = dragon_boon_wisdom
			}
		}
		if = {
			limit = {
				NOT = {
					trait = genius
				}
			}
			random = {
				chance = 25
				set_character_flag = dragon_boon_intelligence
			}
		}
		set_character_flag = dragon_boon_rulership
	}
	
	option = {
		name = EVTOPTA_LNY_94 # Your presence is boon enough!
		
		hidden_tooltip = {
			if = {
				limit = {
					government = chinese_imperial_government
				}
				change_variable = {
					which = mandate_of_heaven
					value = 1
				}
			}
		}
		
		prestige = 500
		piety = 500
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					trait = humble
				}
			}
			modifier = {
				factor = 0.01
				NOT = {
					trait = content
				}
			}
			modifier = {
				factor = 0.1
				NOT = {
					trait = zealous
				}
			}
			modifier = {
				factor = 0
				trait = ambitious
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = dragon_boon_martial
		}
		name = EVTOPTB_LNY_94 # Bless my armies, oh mighty dragon!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.01
					has_character_flag = small_dragon_dance # Likely to fail
				}
				modifier = {
					factor = 2
					has_character_flag = two_dragon_dance
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_5
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_4
				}
				character_event = { id = LNY.96 days = 1 }
			}
			50 = {
				modifier = {
					factor = 100
					is_devil_worshiper_trigger = yes # The dragon knows...
				}
				modifier = {
					factor = 0.01
					has_character_flag = nine_dragon_dance # Likely to succeed
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_2
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_1
				}
				character_event = { id = LNY.112 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = content
			}
			modifier = {
				factor = 0.1
				trait = kind
			}
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = dragon_boon_strength
		}
		name = EVTOPTC_LNY_94 # Bless me with your strength, oh mighty dragon!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.01
					has_character_flag = small_dragon_dance # Likely to fail
				}
				modifier = {
					factor = 2
					has_character_flag = two_dragon_dance
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_5
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_4
				}
				character_event = { id = LNY.98 days = 1 }
			}
			50 = {
				modifier = {
					factor = 100
					is_devil_worshiper_trigger = yes # The dragon knows...
				}
				modifier = {
					factor = 0.01
					has_character_flag = nine_dragon_dance # Likely to succeed
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_2
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_1
				}
				character_event = { id = LNY.112 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = weak
					trait = feeble
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = dragon_boon_health
		}
		name = EVTOPTD_LNY_94 # Grant me health, oh mighty dragon!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.01
					has_character_flag = small_dragon_dance # Likely to fail
				}
				modifier = {
					factor = 2
					has_character_flag = two_dragon_dance
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_5
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_4
				}
				character_event = { id = LNY.100 days = 1 }
			}
			50 = {
				modifier = {
					factor = 100
					is_devil_worshiper_trigger = yes # The dragon knows...
				}
				modifier = {
					factor = 0.01
					has_character_flag = nine_dragon_dance # Likely to succeed
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_2
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_1
				}
				character_event = { id = LNY.112 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				NOR = {
					is_ill_trigger = yes
					is_maimed_trigger = yes
					age = 60
				}
			}
			modifier = {
				factor = 0
				trait = depressed
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = dragon_boon_fertility
		}
		name = EVTOPTE_LNY_94 # Bless me with fertility, oh mighty dragon!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.01
					has_character_flag = small_dragon_dance # Likely to fail
				}
				modifier = {
					factor = 2
					has_character_flag = two_dragon_dance
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_5
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_4
				}
				character_event = { id = LNY.102 days = 1 }
			}
			50 = {
				modifier = {
					factor = 100
					is_devil_worshiper_trigger = yes # The dragon knows...
				}
				modifier = {
					factor = 0.01
					has_character_flag = nine_dragon_dance # Likely to succeed
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_2
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_1
				}
				character_event = { id = LNY.112 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				trait = chaste
			}
			modifier = {
				factor = 0.01
				any_child = {
					count = 5
					is_alive = yes
				}
			}
			modifier = {
				factor = 100
				NOT = {
					any_child = {
						count = 5
						is_alive = yes
					}
				}
			}
			modifier = {
				factor = 0.01
				NOR = {
					is_married = yes
					num_of_consorts = 1
					any_lover = {
						NOT = {
							same_sex = PREV
						}
					}
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = dragon_boon_prosperity
		}
		name = EVTOPTF_LNY_94 # Grant me prosperity, oh mighty dragon!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.01
					has_character_flag = small_dragon_dance # Likely to fail
				}
				modifier = {
					factor = 2
					has_character_flag = two_dragon_dance
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_5
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_4
				}
				character_event = { id = LNY.104 days = 1 }
			}
			50 = {
				modifier = {
					factor = 100
					is_devil_worshiper_trigger = yes # The dragon knows...
				}
				modifier = {
					factor = 0.01
					has_character_flag = nine_dragon_dance # Likely to succeed
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_2
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_1
				}
				character_event = { id = LNY.112 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				trait = charitable
			}
			modifier = {
				factor = 0.01
				wealth = 10000
			}
			modifier = {
				factor = 100
				trait = greedy
			}
			modifier = {
				factor = 100
				NOT = {
					wealth = 100
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = dragon_boon_wisdom
		}
		name = EVTOPTG_LNY_94 # Bless me with wisdom, oh mighty dragon!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.01
					has_character_flag = small_dragon_dance # Likely to fail
				}
				modifier = {
					factor = 2
					has_character_flag = two_dragon_dance
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_5
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_4
				}
				character_event = { id = LNY.106 days = 1 }
			}
			50 = {
				modifier = {
					factor = 100
					is_devil_worshiper_trigger = yes # The dragon knows...
				}
				modifier = {
					factor = 0.01
					has_character_flag = nine_dragon_dance # Likely to succeed
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_2
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_1
				}
				character_event = { id = LNY.112 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				diplomacy = 12
				martial = 12
				stewardship = 12
				intrigue = 12
				learning = 12
			}
			modifier = {
				factor = 0.01
				diplomacy = 8
				martial = 8
				stewardship = 8
				intrigue = 8
				learning = 8
			}
			modifier = {
				factor = 100
				NAND = {
					diplomacy = 4
					martial = 4
					stewardship = 4
					intrigue = 4
					learning = 4
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = dragon_boon_intelligence
		}
		name = EVTOPTH_LNY_94 # Bless my mind, oh mighty dragon!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.01
					has_character_flag = small_dragon_dance # Likely to fail
				}
				modifier = {
					factor = 2
					has_character_flag = two_dragon_dance
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_5
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_4
				}
				character_event = { id = LNY.108 days = 1 }
			}
			50 = {
				modifier = {
					factor = 100
					is_devil_worshiper_trigger = yes # The dragon knows...
				}
				modifier = {
					factor = 0.01
					has_character_flag = nine_dragon_dance # Likely to succeed
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_2
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_1
				}
				character_event = { id = LNY.112 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				is_smart_trigger = yes
			}
			modifier = {
				factor = 0.01
				is_dumb_trigger = no
			}
		}
	}
	
	option = {
		trigger = {
			has_character_flag = dragon_boon_rulership
		}
		name = EVTOPTI_LNY_94 # Bless my rule, oh mighty dragon!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.01
					has_character_flag = small_dragon_dance # Likely to fail
				}
				modifier = {
					factor = 2
					has_character_flag = two_dragon_dance
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_5
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_4
				}
				character_event = { id = LNY.110 days = 1 }
			}
			50 = {
				modifier = {
					factor = 100
					is_devil_worshiper_trigger = yes # The dragon knows...
				}
				modifier = {
					factor = 0.01
					has_character_flag = nine_dragon_dance # Likely to succeed
				}
				modifier = {
					factor = 2
					has_character_modifier = mandate_of_heaven_2
				}
				modifier = {
					factor = 5
					has_character_modifier = mandate_of_heaven_1
				}
				character_event = { id = LNY.112 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = proud
			}
			modifier = {
				factor = 10
				tier = emperor
			}
		}
	}
	
	after = {
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			narrative_event = { id = LNY.95 } # Inform vassals that the dragon arrived
		}
	}
}

# Inform vassals
narrative_event = {
	id = LNY.95
	title = EVTTITLE_LNY_95
	desc = EVTDESC_LNY_95
	picture = GFX_evt_chinese_mythology
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_95 # Truly an auspicious day!
	}
}

# Boon bestowed - military power
character_event = {
	id = LNY.96
	desc = EVTDESC_LNY_96
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_96 # Thank you, oh mighty dragon!
		
		if = {
			limit = {
				trait = brilliant_strategist
			}
			add_character_modifier = {
				modifier = dragon_boon_martial
				days = 3650
			}
		}
		else = {
			upgrade_education_effect = yes
		}
		
		prestige = 100
		piety = 100
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.97 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.97
	desc = EVTDESC_LNY_97
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_97 # A powerful boon indeed!
	}
}

# Boon bestowed - strength
character_event = {
	id = LNY.98
	desc = EVTDESC_LNY_98
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_96 # Thank you, oh mighty dragon!
		
		if = {
			limit = {
				is_weak_trigger = yes
			}
			remove_trait = weak
			remove_trait = feeble
		}
		else = {
			hidden_tooltip = {
				remove_trait = robust
			}
			add_trait = strong
		}
		
		prestige = 100
		piety = 100
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.99 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.99
	desc = EVTDESC_LNY_99
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_97 # A powerful boon indeed!
	}
}

# Boon bestowed - good health
character_event = {
	id = LNY.100
	desc = EVTDESC_LNY_100
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_96 # Thank you, oh mighty dragon!
		
		if = {
			limit = {
				is_ill_trigger = no
				is_maimed_trigger = no
			}
			add_character_modifier = {
				modifier = dragon_boon_health
				days = 3650
			}
		}
		if = {
			limit = {
				is_ill_trigger = yes
			}
			remove_random_disease_effect = yes
			remove_random_epidemic_disease_effect = yes
			remove_symptoms_effect = yes
		}
		if = {
			limit = {
				is_maimed_trigger  = yes
			}
			remove_random_maimed_effect = yes
		}
		
		prestige = 100
		piety = 100
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.101 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.101
	desc = EVTDESC_LNY_101
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_97 # A powerful boon indeed!
	}
}

# Boon bestowed - fertility
character_event = {
	id = LNY.102
	desc = EVTDESC_LNY_102
	picture =GFX_evt_china_golden_age
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_96 # Thank you, oh mighty dragon!
		
		if = {
			limit = {
				trait = eunuch
			}
			remove_trait = eunuch
		}
		else_if = {
			limit = {
				trait = chaste
			}
			remove_trait = chaste
		}
		else_if = {
			limit = {
				NOT = {
					trait = lustful
				}
			}
			add_trait = lustful
		}
		else = {
			add_character_modifier = {
				modifier = dragon_boon_fertility
				days = 3650
			}
		}
		
		prestige = 100
		piety = 100
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.103 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.103
	desc = EVTDESC_LNY_103
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_97 # A powerful boon indeed!
	}
}

# Boon bestowed - prosperity
character_event = {
	id = LNY.104
	desc = EVTDESC_LNY_104
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_96 # Thank you, oh mighty dragon!
		
		if = {
			limit = {
				has_dlc = "Reapers"
				any_demesne_province = {
					OR = {
						has_province_modifier = depopulated_1
						has_province_modifier = depopulated_2
						has_province_modifier = depopulated_3
					}
				}
			}
			any_demesne_province = {
				limit = {
					OR = {
						has_province_modifier = depopulated_1
						has_province_modifier = depopulated_2
						has_province_modifier = depopulated_3
					}
				}
				decrease_depopulation_effect = yes
			}
		}
		else_if = {
			limit = {
				has_dlc = "Reapers"
				any_demesne_province = {
					NOT = {
						has_province_modifier = prosperity_modifier_3
					}
				}
			}
			any_demesne_province = {
				limit = {
					NOT = {
						has_province_modifier = prosperity_modifier_3
					}
				}
				increase_prosperity_effect = yes
			}
		}
		else = {
			wealth = 1000
		}
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.105 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.105
	desc = EVTDESC_LNY_105
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_97 # A powerful boon indeed!
	}
}

# Boon bestowed - wisdom
character_event = {
	id = LNY.106
	desc = EVTDESC_LNY_106
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_96 # Thank you, oh mighty dragon!
		
		# Order is Learning > Stewardship > Diplomacy > Intrigue > Martial
		if = {
			limit = {
				NOT = {
					learning = 8
				}
			}
			change_learning = 4
		}
		else_if = {
			limit = {
				NOT = {
					stewardship = 8
				}
			}
			change_stewardship = 4
		}
		else_if = {
			limit = {
				NOT = {
					diplomacy = 8
				}
			}
			change_diplomacy = 4
		}
		else_if = {
			limit = {
				NOT = {
					intrigue = 8
				}
			}
			change_intrigue = 4
		}
		else_if = {
			limit = {
				NOT = {
					martial = 8
				}
			}
			change_martial = 4
		}
		else = {
			random_list = {
				20 = {
					modifier = {
						factor = 0.01
						diplomacy = 25
					}
					change_diplomacy = 4
				}
				20 = {
					modifier = {
						factor = 0.01
						martial = 25
					}
					change_martial = 4
				}
				20 = {
					modifier = {
						factor = 0.01
						stewardship = 25
					}
					change_stewardship = 4
				}
				20 = {
					modifier = {
						factor = 0.01
						intrigue = 25
					}
					change_intrigue = 4
				}
				20 = {
					modifier = {
						factor = 0.01
						learning = 25
					}
					change_learning = 4
				}
			}
		}
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.107 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.107
	desc = EVTDESC_LNY_107
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_97 # A powerful boon indeed!
	}
}

# Boon bestowed - intelligence
character_event = {
	id = LNY.108
	desc = EVTDESC_LNY_108
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_96 # Thank you, oh mighty dragon!
		
		if = {
			limit = {
				OR = {
					trait = quick
					trait = shrewd
				}
			}
			remove_trait = quick
			remove_trait = shrewd
			add_trait = genius
		}
		else_if = {
			limit = {
				is_dumb_trigger = no
			}
			add_trait = quick
		}
		else_if = {
			limit = {
				OR = {
					trait = slow
					trait = dull
				}
			}
			remove_trait = slow
			remove_trait = dull
		}
		else = {
			remove_trait = imbecile
			add_trait = slow
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.109 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.109
	desc = EVTDESC_LNY_109
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_97 # A powerful boon indeed!
	}
}

# Boon bestowed - rulership blessing
character_event = {
	id = LNY.110
	desc = EVTDESC_LNY_110
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_96 # Thank you, oh mighty dragon!
		
		hidden_tooltip = {
			if = {
				limit = {
					government = chinese_imperial_government
				}
				change_variable = {
					which = mandate_of_heaven
					value = 5
				}
			}
		}
		add_character_modifier = {
			modifier = dragon_boon_rulership
			days = 3650
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.111 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.111
	desc = EVTDESC_LNY_111
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_97 # A powerful boon indeed!
	}
}

# Declared unworthy of boon
character_event = {
	id = LNY.112
	desc = EVTDESC_LNY_112
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_112 # B-b-but why...?
		
		hidden_tooltip = {
			if = {
				limit = {
					government = chinese_imperial_government
				}
				change_variable = {
					which = mandate_of_heaven
					value = -5
				}
			}
		}
		
		prestige = -100
		piety = -100
		
		add_character_modifier = {
			modifier = unworthy_of_dragon_boon
			days = 3650
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.113 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.113
	desc = EVTDESC_LNY_113
	picture =GFX_evt_china_unrest
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_113 # Unworthy? Ha!
	}
}

### Silver dragon (Icava, the Champion of Justice) (114-138)

# Silver dragon sighted
character_event = {
	id = LNY.114
	desc = EVTDESC_LNY_114
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_114 # Maybe it was just a bird...
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.115 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.115
	desc = EVTDESC_LNY_115
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_115 # Maybe it was just a bird...
	}
}

# Silver dragon flyby
character_event = {
	id = LNY.116
	desc = EVTDESC_LNY_116
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_116 # Worrisome...
		
		if = {
			limit = {
				OR = {
					AND = {
						is_evil_trigger = yes
						has_vice_trigger = yes
					}
					is_devil_worshiper_trigger = yes
				}
			}
			random = {
				chance = 25
				add_trait = stressed
			}
			random = {
				chance = 25
				add_trait = paranoid
			}
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.117 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.117
	desc = EVTDESC_LNY_117
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_117 # Worrisome
	}
}

# Silver dragon driven off
character_event = {
	id = LNY.118
	desc = EVTDESC_LNY_118
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_118 # Probably for the best...
		
		prestige = 50
		piety = -50
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.119 }
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.119
	desc = EVTDESC_LNY_119
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_119 # Probably for the best...
	}
}

# Silver dragon angered by being attacked
narrative_event = {
	id = LNY.120
	title = EVTTITLE_LNY_120
	desc = EVTDESC_LNY_120
	picture = GFX_evt_china_diplomatic_incident
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_120 # There's been a misunderstanding!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					OR = {
						AND = {
							is_evil_trigger = yes
							has_vice_trigger = yes
						}
						is_devil_worshiper_trigger = yes
					}
				}
				modifier = {
					factor = 0.8
					NOT = {
						diplomacy = 20
					}
				}
				modifier = {
					factor = 0.8
					NOT = {
						diplomacy = 15
					}
				}
				modifier = {
					factor = 0
					NOT = {
						diplomacy = 10
					}
				}
				character_event = { id = LNY.122 days = 1 } # Diplomacy succeeded
			}
			50 = {
				character_event = { id = LNY.124 days = 1 } # Diplomacy barely succeeded
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = brave
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.1
				any_artifact = {
					has_flag = dragonslayer
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_120 # Let's fight, then!
		
		hidden_tooltip = {
			random_list = {
				1 = { # Critical success
					character_event = { id = LNY.126 days = 1 } # Victory
				}
				18 = {
					set_character_flag = dragon_combat_undecided
					random_list = {
						1 = {
							set_variable = {
								which = d20
								value = 19
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 18
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 17
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 16
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 15
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 14
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 13
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 12
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 11
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 10
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 9
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 8
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 7
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 6
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 4
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 3
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 2
							}
						}
					}
				}
				1 = {  # Critical failure
					character_event = { id = LNY.128 days = 1 } # Defeat
				}
			}
			
			if = {
				limit = {
					has_character_flag = dragon_combat_undecided
				}
				if = {
					limit = {
						OR = {
							AND = {
								is_evil_trigger = yes
								has_vice_trigger = yes
							}
							is_devil_worshiper_trigger = yes
						}
					}
					change_variable = {
						which = d20
						value = -10 # Detects as Evil, so certain things will help in combat...
					}
				}
				if = {
					limit = {
						OR = {
							AND = {
								ai = yes
								any_artifact = {
									has_flag = dragonslayer
								}
							}
							any_artifact = {
								is_artifact_equipped = yes
								has_flag = dragonslayer
							}
						}
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						check_variable = {
							which = d20
							value = 25 # Intentionally easier to defeat than Fredak
						}
					}
					character_event = { id = LNY.126 days = 1 } # Victory
				}
				else = {
					# Combat rating - checks up to 500 in case someone has some insane bloodline stacking or the like
					if = {
						limit = {
							combat_rating = 500
						}
						change_variable = {
							which = d20
							value = 50
						}
					}
					else_if = {
						limit = {
							combat_rating = 490
						}
						change_variable = {
							which = d20
							value = 49
						}
					}
					else_if = {
						limit = {
							combat_rating = 480
						}
						change_variable = {
							which = d20
							value = 48
						}
					}
					else_if = {
						limit = {
							combat_rating = 470
						}
						change_variable = {
							which = d20
							value = 47
						}
					}
					else_if = {
						limit = {
							combat_rating = 460
						}
						change_variable = {
							which = d20
							value = 46
						}
					}
					else_if = {
						limit = {
							combat_rating = 450
						}
						change_variable = {
							which = d20
							value = 45
						}
					}
					else_if = {
						limit = {
							combat_rating = 440
						}
						change_variable = {
							which = d20
							value = 44
						}
					}
					else_if = {
						limit = {
							combat_rating = 430
						}
						change_variable = {
							which = d20
							value = 43
						}
					}
					else_if = {
						limit = {
							combat_rating = 420
						}
						change_variable = {
							which = d20
							value = 42
						}
					}
					else_if = {
						limit = {
							combat_rating = 410
						}
						change_variable = {
							which = d20
							value = 41
						}
					}
					else_if = {
						limit = {
							combat_rating = 400
						}
						change_variable = {
							which = d20
							value = 40
						}
					}
					else_if = {
						limit = {
							combat_rating = 390
						}
						change_variable = {
							which = d20
							value = 39
						}
					}
					else_if = {
						limit = {
							combat_rating = 380
						}
						change_variable = {
							which = d20
							value = 38
						}
					}
					else_if = {
						limit = {
							combat_rating = 370
						}
						change_variable = {
							which = d20
							value = 37
						}
					}
					else_if = {
						limit = {
							combat_rating = 360
						}
						change_variable = {
							which = d20
							value = 36
						}
					}
					else_if = {
						limit = {
							combat_rating = 350
						}
						change_variable = {
							which = d20
							value = 35
						}
					}
					else_if = {
						limit = {
							combat_rating = 340
						}
						change_variable = {
							which = d20
							value = 34
						}
					}
					else_if = {
						limit = {
							combat_rating = 330
						}
						change_variable = {
							which = d20
							value = 33
						}
					}
					else_if = {
						limit = {
							combat_rating = 320
						}
						change_variable = {
							which = d20
							value = 32
						}
					}
					else_if = {
						limit = {
							combat_rating = 310
						}
						change_variable = {
							which = d20
							value = 31
						}
					}
					else_if = {
						limit = {
							combat_rating = 300
						}
						change_variable = {
							which = d20
							value = 30
						}
					}
					else_if = {
						limit = {
							combat_rating = 290
						}
						change_variable = {
							which = d20
							value = 29
						}
					}
					else_if = {
						limit = {
							combat_rating = 280
						}
						change_variable = {
							which = d20
							value = 28
						}
					}
					else_if = {
						limit = {
							combat_rating = 270
						}
						change_variable = {
							which = d20
							value = 27
						}
					}
					else_if = {
						limit = {
							combat_rating = 260
						}
						change_variable = {
							which = d20
							value = 26
						}
					}
					else_if = {
						limit = {
							combat_rating = 250
						}
						change_variable = {
							which = d20
							value = 25
						}
					}
					else_if = {
						limit = {
							combat_rating = 240
						}
						change_variable = {
							which = d20
							value = 24
						}
					}
					else_if = {
						limit = {
							combat_rating = 230
						}
						change_variable = {
							which = d20
							value = 23
						}
					}
					else_if = {
						limit = {
							combat_rating = 220
						}
						change_variable = {
							which = d20
							value = 22
						}
					}
					else_if = {
						limit = {
							combat_rating = 210
						}
						change_variable = {
							which = d20
							value = 21
						}
					}
					else_if = {
						limit = {
							combat_rating = 200
						}
						change_variable = {
							which = d20
							value = 20
						}
					}
					else_if = {
						limit = {
							combat_rating = 190
						}
						change_variable = {
							which = d20
							value = 19
						}
					}
					else_if = {
						limit = {
							combat_rating = 180
						}
						change_variable = {
							which = d20
							value = 18
						}
					}
					else_if = {
						limit = {
							combat_rating = 170
						}
						change_variable = {
							which = d20
							value = 17
						}
					}
					else_if = {
						limit = {
							combat_rating = 160
						}
						change_variable = {
							which = d20
							value = 16
						}
					}
					else_if = {
						limit = {
							combat_rating = 150
						}
						change_variable = {
							which = d20
							value = 15
						}
					}
					else_if = {
						limit = {
							combat_rating = 140
						}
						change_variable = {
							which = d20
							value = 14
						}
					}
					else_if = {
						limit = {
							combat_rating = 130
						}
						change_variable = {
							which = d20
							value = 13
						}
					}
					else_if = {
						limit = {
							combat_rating = 120
						}
						change_variable = {
							which = d20
							value = 12
						}
					}
					else_if = {
						limit = {
							combat_rating = 110
						}
						change_variable = {
							which = d20
							value = 11
						}
					}
					else_if = {
						limit = {
							combat_rating = 100
						}
						change_variable = {
							which = d20
							value = 10
						}
					}
					else_if = {
						limit = {
							combat_rating = 90
						}
						change_variable = {
							which = d20
							value = 9
						}
					}
					else_if = {
						limit = {
							combat_rating = 80
						}
						change_variable = {
							which = d20
							value = 8
						}
					}
					else_if = {
						limit = {
							combat_rating = 70
						}
						change_variable = {
							which = d20
							value = 7
						}
					}
					else_if = {
						limit = {
							combat_rating = 60
						}
						change_variable = {
							which = d20
							value = 6
						}
					}
					else_if = {
						limit = {
							combat_rating = 50
						}
						change_variable = {
							which = d20
							value = 5
						}
					}
					else_if = {
						limit = {
							combat_rating = 40
						}
						change_variable = {
							which = d20
							value = 4
						}
					}
					else_if = {
						limit = {
							combat_rating = 30
						}
						change_variable = {
							which = d20
							value = 3
						}
					}
					else_if = {
						limit = {
							combat_rating = 20
						}
						change_variable = {
							which = d20
							value = 2
						}
					}
					else_if = {
						limit = {
							combat_rating = 10
						}
						change_variable = {
							which = d20
							value = 1
						}
					}
					if = {
						limit = {
							check_variable = {
								which = d20
								value = 25 # Intentionally easier to defeat than Fredak
							}
						}
						character_event = { id = LNY.126 days = 1 } # Victory
					}
					else = {
						character_event = { id = LNY.128 days = 1 } # Defeat
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0.1
				is_benevolent_trigger = no
			}
			modifier = {
				factor = 0.1
				has_pleasant_trait_trigger = no
			}
			modifier = {
				factor = 0.1
				has_pious_trait_trigger = no
			}
			modifier = {
				factor = 0.1
				has_virtue_trigger = no
			}
		}
	}
	
	option = {
		trigger = {
			is_devil_worshiper_trigger = yes
		}
		
		name = EVTOPTC_LNY_120 # I am more powerful than you think!
		
		custom_tooltip = {
			text = use_dark_power_if_necessary
		}
		
		hidden_tooltip = {
			random_list = {
				1 = { # Critical success
					character_event = { id = LNY.126 days = 1 } # Victory
				}
				18 = {
					set_character_flag = dragon_combat_undecided
					random_list = {
						1 = {
							set_variable = {
								which = d20
								value = 19
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 18
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 17
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 16
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 15
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 14
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 13
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 12
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 11
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 10
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 9
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 8
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 7
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 6
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 4
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 3
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 2
							}
						}
					}
				}
				1 = {  # Critical failure
					character_event = { id = LNY.128 days = 1 } # Defeat
				}
			}
			
			if = {
				limit = {
					has_character_flag = dragon_combat_undecided
				}
				if = {
					limit = {
						OR = {
							AND = {
								is_evil_trigger = yes
								has_vice_trigger = yes
							}
							is_devil_worshiper_trigger = yes
						}
					}
					change_variable = {
						which = d20
						value = -10 # Detects as Evil, so certain things will help in combat...
					}
				}
				if = {
					limit = {
						OR = {
							AND = {
								ai = yes
								any_artifact = {
									has_flag = dragonslayer
								}
							}
							any_artifact = {
								is_artifact_equipped = yes
								has_flag = dragonslayer
							}
						}
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						check_variable = {
							which = d20
							value = 25 # Intentionally easier to defeat than Fredak
						}
					}
					character_event = { id = LNY.126 days = 1 } # Victory
				}
				else = {
					# Combat rating - checks up to 500 in case someone has some insane bloodline stacking or the like
					if = {
						limit = {
							combat_rating = 500
						}
						change_variable = {
							which = d20
							value = 50
						}
					}
					else_if = {
						limit = {
							combat_rating = 490
						}
						change_variable = {
							which = d20
							value = 49
						}
					}
					else_if = {
						limit = {
							combat_rating = 480
						}
						change_variable = {
							which = d20
							value = 48
						}
					}
					else_if = {
						limit = {
							combat_rating = 470
						}
						change_variable = {
							which = d20
							value = 47
						}
					}
					else_if = {
						limit = {
							combat_rating = 460
						}
						change_variable = {
							which = d20
							value = 46
						}
					}
					else_if = {
						limit = {
							combat_rating = 450
						}
						change_variable = {
							which = d20
							value = 45
						}
					}
					else_if = {
						limit = {
							combat_rating = 440
						}
						change_variable = {
							which = d20
							value = 44
						}
					}
					else_if = {
						limit = {
							combat_rating = 430
						}
						change_variable = {
							which = d20
							value = 43
						}
					}
					else_if = {
						limit = {
							combat_rating = 420
						}
						change_variable = {
							which = d20
							value = 42
						}
					}
					else_if = {
						limit = {
							combat_rating = 410
						}
						change_variable = {
							which = d20
							value = 41
						}
					}
					else_if = {
						limit = {
							combat_rating = 400
						}
						change_variable = {
							which = d20
							value = 40
						}
					}
					else_if = {
						limit = {
							combat_rating = 390
						}
						change_variable = {
							which = d20
							value = 39
						}
					}
					else_if = {
						limit = {
							combat_rating = 380
						}
						change_variable = {
							which = d20
							value = 38
						}
					}
					else_if = {
						limit = {
							combat_rating = 370
						}
						change_variable = {
							which = d20
							value = 37
						}
					}
					else_if = {
						limit = {
							combat_rating = 360
						}
						change_variable = {
							which = d20
							value = 36
						}
					}
					else_if = {
						limit = {
							combat_rating = 350
						}
						change_variable = {
							which = d20
							value = 35
						}
					}
					else_if = {
						limit = {
							combat_rating = 340
						}
						change_variable = {
							which = d20
							value = 34
						}
					}
					else_if = {
						limit = {
							combat_rating = 330
						}
						change_variable = {
							which = d20
							value = 33
						}
					}
					else_if = {
						limit = {
							combat_rating = 320
						}
						change_variable = {
							which = d20
							value = 32
						}
					}
					else_if = {
						limit = {
							combat_rating = 310
						}
						change_variable = {
							which = d20
							value = 31
						}
					}
					else_if = {
						limit = {
							combat_rating = 300
						}
						change_variable = {
							which = d20
							value = 30
						}
					}
					else_if = {
						limit = {
							combat_rating = 290
						}
						change_variable = {
							which = d20
							value = 29
						}
					}
					else_if = {
						limit = {
							combat_rating = 280
						}
						change_variable = {
							which = d20
							value = 28
						}
					}
					else_if = {
						limit = {
							combat_rating = 270
						}
						change_variable = {
							which = d20
							value = 27
						}
					}
					else_if = {
						limit = {
							combat_rating = 260
						}
						change_variable = {
							which = d20
							value = 26
						}
					}
					else_if = {
						limit = {
							combat_rating = 250
						}
						change_variable = {
							which = d20
							value = 25
						}
					}
					else_if = {
						limit = {
							combat_rating = 240
						}
						change_variable = {
							which = d20
							value = 24
						}
					}
					else_if = {
						limit = {
							combat_rating = 230
						}
						change_variable = {
							which = d20
							value = 23
						}
					}
					else_if = {
						limit = {
							combat_rating = 220
						}
						change_variable = {
							which = d20
							value = 22
						}
					}
					else_if = {
						limit = {
							combat_rating = 210
						}
						change_variable = {
							which = d20
							value = 21
						}
					}
					else_if = {
						limit = {
							combat_rating = 200
						}
						change_variable = {
							which = d20
							value = 20
						}
					}
					else_if = {
						limit = {
							combat_rating = 190
						}
						change_variable = {
							which = d20
							value = 19
						}
					}
					else_if = {
						limit = {
							combat_rating = 180
						}
						change_variable = {
							which = d20
							value = 18
						}
					}
					else_if = {
						limit = {
							combat_rating = 170
						}
						change_variable = {
							which = d20
							value = 17
						}
					}
					else_if = {
						limit = {
							combat_rating = 160
						}
						change_variable = {
							which = d20
							value = 16
						}
					}
					else_if = {
						limit = {
							combat_rating = 150
						}
						change_variable = {
							which = d20
							value = 15
						}
					}
					else_if = {
						limit = {
							combat_rating = 140
						}
						change_variable = {
							which = d20
							value = 14
						}
					}
					else_if = {
						limit = {
							combat_rating = 130
						}
						change_variable = {
							which = d20
							value = 13
						}
					}
					else_if = {
						limit = {
							combat_rating = 120
						}
						change_variable = {
							which = d20
							value = 12
						}
					}
					else_if = {
						limit = {
							combat_rating = 110
						}
						change_variable = {
							which = d20
							value = 11
						}
					}
					else_if = {
						limit = {
							combat_rating = 100
						}
						change_variable = {
							which = d20
							value = 10
						}
					}
					else_if = {
						limit = {
							combat_rating = 90
						}
						change_variable = {
							which = d20
							value = 9
						}
					}
					else_if = {
						limit = {
							combat_rating = 80
						}
						change_variable = {
							which = d20
							value = 8
						}
					}
					else_if = {
						limit = {
							combat_rating = 70
						}
						change_variable = {
							which = d20
							value = 7
						}
					}
					else_if = {
						limit = {
							combat_rating = 60
						}
						change_variable = {
							which = d20
							value = 6
						}
					}
					else_if = {
						limit = {
							combat_rating = 50
						}
						change_variable = {
							which = d20
							value = 5
						}
					}
					else_if = {
						limit = {
							combat_rating = 40
						}
						change_variable = {
							which = d20
							value = 4
						}
					}
					else_if = {
						limit = {
							combat_rating = 30
						}
						change_variable = {
							which = d20
							value = 3
						}
					}
					else_if = {
						limit = {
							combat_rating = 20
						}
						change_variable = {
							which = d20
							value = 2
						}
					}
					else_if = {
						limit = {
							combat_rating = 10
						}
						change_variable = {
							which = d20
							value = 1
						}
					}
					if = {
						limit = {
							check_variable = {
								which = d20
								value = 25 # Intentionally easier to defeat than Fredak
							}
						}
						character_event = { id = LNY.126 days = 1 } # Victory
					}
					else = {
						increase_visibility_effect = yes
						if = {
							limit = {
								society_currency >= 1000
							}
							change_variable = {
								which = d20
								value = 10
							}
							change_society_currency = -1000
						}
						else_if = {
							limit = {
								society_currency >= 900
							}
							change_variable = {
								which = d20
								value = 9
							}
							change_society_currency = -900
						}
						else_if = {
							limit = {
								society_currency >= 800
							}
							change_variable = {
								which = d20
								value = 8
							}
							change_society_currency = -800
						}
						else_if = {
							limit = {
								society_currency >= 700
							}
							change_variable = {
								which = d20
								value = 7
							}
							change_society_currency = -700
						}
						else_if = {
							limit = {
								society_currency >= 600
							}
							change_variable = {
								which = d20
								value = 6
							}
							change_society_currency = -600
						}
						else_if = {
							limit = {
								society_currency >= 500
							}
							change_variable = {
								which = d20
								value = 5
							}
							change_society_currency = -500
						}
						else_if = {
							limit = {
								society_currency >= 400
							}
							change_variable = {
								which = d20
								value = 4
							}
							change_society_currency = -400
						}
						else_if = {
							limit = {
								society_currency >= 300
							}
							change_variable = {
								which = d20
								value = 3
							}
							change_society_currency = -300
						}
						else_if = {
							limit = {
								society_currency >= 200
							}
							change_variable = {
								which = d20
								value = 2
							}
							change_society_currency = -200
						}
						else_if = {
							limit = {
								society_currency >= 100
							}
							change_variable = {
								which = d20
								value = 1
							}
							change_society_currency = -100
						}
						if = {
							limit = {
								check_variable = {
									which = d20
									value = 25 # Intentionally easier to defeat than Fredak
								}
							}
							character_event = { id = LNY.126 days = 1 } # Victory
						}
						else = {
							character_event = { id = LNY.128 days = 1 } # Victory
						}
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 0.1
				is_benevolent_trigger = no
			}
			modifier = {
				factor = 0.1
				has_pleasant_trait_trigger = no
			}
			modifier = {
				factor = 0.1
				has_pious_trait_trigger = no
			}
			modifier = {
				factor = 0.1
				has_virtue_trigger = no
			}
		}
	}
	
	after = {
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				OR = {
					ai = no
					event_target:smite_evil_target = {
						character = ROOT
					}
				}
			}
			narrative_event = { id = LNY.121 }
		}
	}
}

# Inform vassals
narrative_event = {
	id = LNY.121
	title = EVTTITLE_LNY_121
	desc = EVTDESC_LNY_121
	picture = GFX_evt_china_diplomatic_incident
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		trigger = {
			event_target:smite_evil_target = {
				character = ROOT
			}
		}
		
		name = EVTOPTA_LNY_121 # Is she here for me...?
		
		random = {
			chance = 25
			add_trait = stressed
		}
		random = {
			chance = 25
			add_trait = paranoid
		}
	}
	option = {
		trigger = {
			NOT = {
				event_target:smite_evil_target = {
					character = ROOT
				}
			}
		}
		
		name = EVTOPTB_LNY_121 # Who might that evildoer be...?
	}
}

# Diplomacy worked
character_event = {
	id = LNY.122
	desc = EVTDESC_LNY_122
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_122 # Great!
		
		prestige = 100
		piety = 100
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.123 } # Inform vassals
		}
	}
	
	after = {
		clr_character_flag = silver_dragon_active
	}
}

# Inform vassals
character_event = {
	id = LNY.123
	desc = EVTDESC_LNY_123
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_123 # Great!
	}
}

# Diplomacy barely accepted
character_event = {
	id = LNY.124
	desc = EVTDESC_LNY_124
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_124 # Could be worse...
		
		prestige = -50
		piety = 10
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.125 } # Inform vassals
		}
	}
	
	after = {
		clr_character_flag = silver_dragon_active
	}
}

# Inform vassals
character_event = {
	id = LNY.125
	desc = EVTDESC_LNY_125
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_125 # Could be worse...
	}
}

# Fight successful, dragon chooses better part of valor
character_event = {
	id = LNY.126
	desc = EVTDESC_LNY_126
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_126 # Good riddance!
		
		prestige = 200
		piety = -100
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.127 } # Inform vassals
		}
	}
	
	after = {
		clr_character_flag = silver_dragon_active
	}
}

# Inform vassals
character_event = {
	id = LNY.127
	desc = EVTDESC_LNY_127
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_127 # Good riddance!
	}
}

# Fight goes poorly, wounded/maimed
character_event = {
	id = LNY.128
	desc = EVTDESC_LNY_128
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_128 # Good riddance!
		
		random_list = {
			25 = {
				add_trait = wounded
			}
			75 = {
				add_maimed_trait_effect = yes
			}
		}
		
		prestige = -100
		piety = -100
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.129 } # Inform vassals
		}
	}
	
	after = {
		clr_character_flag = silver_dragon_active
	}
}

# Inform vassals
character_event = {
	id = LNY.129
	desc = EVTDESC_LNY_129
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				event_target:smite_evil_target = {
					character = ROOT
				}
			}
		}
		name = EVTOPTA_LNY_129 # Could have been worse...
	}
	option = {
		trigger = {
			event_target:smite_evil_target = {
				character = ROOT
			}
		}
		name = EVTOPTB_LNY_129 # Better FROM than me...
	}
}

# Silver dragon challenges evildoer - liege
narrative_event = {
	id = LNY.130
	title = EVTTITLE_LNY_130
	desc = EVTDESC_LNY_130
	picture = GFX_evt_china_diplomatic_incident
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	immediate = {
		event_target:smite_evil_target = {
			narrative_event = { id = LNY.132 } # Evildoer informed right away
		}
	}
	
	option = {
		name = EVTOPTA_LNY_130 # This should be interesting...
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
				NOT = {
					event_target:smite_evil_target = {
						character = PREV
					}
				}
			}
			narrative_event = { id = LNY.131 } # Inform other vassals
		}
	}
}

# Silver dragon challenges evildoer - other vassals
narrative_event = {
	id = LNY.131
	title = EVTTITLE_LNY_131
	desc = EVTDESC_LNY_131
	picture = GFX_evt_china_diplomatic_incident
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_131 # This should be interesting...
	}
}

# Silver dragon challenges evildoer - evildoer
narrative_event = {
	id = LNY.132
	title = EVTTITLE_LNY_132
	desc = EVTDESC_LNY_132
	picture = GFX_evt_china_diplomatic_incident
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				ai = no
				is_devil_worshiper_trigger = no # It is a fight to the death for the evildoer; DWs should go for the event that gives them an advantage, even if it might expose them
			}
		}
		name = EVTOPTA_LNY_132 # Let's fight, then!
		
		hidden_tooltip = {
			random_list = {
				1 = { # Critical success
					character_event = { id = LNY.133 days = 1 } # Victory
				}
				18 = {
					set_character_flag = dragon_combat_undecided
					random_list = {
						1 = {
							set_variable = {
								which = d20
								value = 19
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 18
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 17
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 16
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 15
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 14
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 13
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 12
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 11
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 10
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 9
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 8
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 7
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 6
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 4
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 3
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 2
							}
						}
					}
				}
				1 = {  # Critical failure
					character_event = { id = LNY.135 days = 1 } # Defeat
				}
			}
			
			if = {
				limit = {
					has_character_flag = dragon_combat_undecided
				}
				if = {
					limit = {
						OR = {
							AND = {
								is_evil_trigger = yes
								has_vice_trigger = yes
							}
							is_devil_worshiper_trigger = yes
						}
					}
					change_variable = {
						which = d20
						value = -10 # Detects as Evil, so certain things will help in combat...
					}
				}
				if = {
					limit = {
						OR = {
							AND = {
								ai = yes
								any_artifact = {
									has_flag = dragonslayer
								}
							}
							any_artifact = {
								is_artifact_equipped = yes
								has_flag = dragonslayer
							}
						}
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						check_variable = {
							which = d20
							value = 25 # Intentionally easier to defeat than Fredak
						}
					}
					character_event = { id = LNY.133 days = 1 } # Victory
				}
				else = {
					# Combat rating - checks up to 500 in case someone has some insane bloodline stacking or the like
					if = {
						limit = {
							combat_rating = 500
						}
						change_variable = {
							which = d20
							value = 50
						}
					}
					else_if = {
						limit = {
							combat_rating = 490
						}
						change_variable = {
							which = d20
							value = 49
						}
					}
					else_if = {
						limit = {
							combat_rating = 480
						}
						change_variable = {
							which = d20
							value = 48
						}
					}
					else_if = {
						limit = {
							combat_rating = 470
						}
						change_variable = {
							which = d20
							value = 47
						}
					}
					else_if = {
						limit = {
							combat_rating = 460
						}
						change_variable = {
							which = d20
							value = 46
						}
					}
					else_if = {
						limit = {
							combat_rating = 450
						}
						change_variable = {
							which = d20
							value = 45
						}
					}
					else_if = {
						limit = {
							combat_rating = 440
						}
						change_variable = {
							which = d20
							value = 44
						}
					}
					else_if = {
						limit = {
							combat_rating = 430
						}
						change_variable = {
							which = d20
							value = 43
						}
					}
					else_if = {
						limit = {
							combat_rating = 420
						}
						change_variable = {
							which = d20
							value = 42
						}
					}
					else_if = {
						limit = {
							combat_rating = 410
						}
						change_variable = {
							which = d20
							value = 41
						}
					}
					else_if = {
						limit = {
							combat_rating = 400
						}
						change_variable = {
							which = d20
							value = 40
						}
					}
					else_if = {
						limit = {
							combat_rating = 390
						}
						change_variable = {
							which = d20
							value = 39
						}
					}
					else_if = {
						limit = {
							combat_rating = 380
						}
						change_variable = {
							which = d20
							value = 38
						}
					}
					else_if = {
						limit = {
							combat_rating = 370
						}
						change_variable = {
							which = d20
							value = 37
						}
					}
					else_if = {
						limit = {
							combat_rating = 360
						}
						change_variable = {
							which = d20
							value = 36
						}
					}
					else_if = {
						limit = {
							combat_rating = 350
						}
						change_variable = {
							which = d20
							value = 35
						}
					}
					else_if = {
						limit = {
							combat_rating = 340
						}
						change_variable = {
							which = d20
							value = 34
						}
					}
					else_if = {
						limit = {
							combat_rating = 330
						}
						change_variable = {
							which = d20
							value = 33
						}
					}
					else_if = {
						limit = {
							combat_rating = 320
						}
						change_variable = {
							which = d20
							value = 32
						}
					}
					else_if = {
						limit = {
							combat_rating = 310
						}
						change_variable = {
							which = d20
							value = 31
						}
					}
					else_if = {
						limit = {
							combat_rating = 300
						}
						change_variable = {
							which = d20
							value = 30
						}
					}
					else_if = {
						limit = {
							combat_rating = 290
						}
						change_variable = {
							which = d20
							value = 29
						}
					}
					else_if = {
						limit = {
							combat_rating = 280
						}
						change_variable = {
							which = d20
							value = 28
						}
					}
					else_if = {
						limit = {
							combat_rating = 270
						}
						change_variable = {
							which = d20
							value = 27
						}
					}
					else_if = {
						limit = {
							combat_rating = 260
						}
						change_variable = {
							which = d20
							value = 26
						}
					}
					else_if = {
						limit = {
							combat_rating = 250
						}
						change_variable = {
							which = d20
							value = 25
						}
					}
					else_if = {
						limit = {
							combat_rating = 240
						}
						change_variable = {
							which = d20
							value = 24
						}
					}
					else_if = {
						limit = {
							combat_rating = 230
						}
						change_variable = {
							which = d20
							value = 23
						}
					}
					else_if = {
						limit = {
							combat_rating = 220
						}
						change_variable = {
							which = d20
							value = 22
						}
					}
					else_if = {
						limit = {
							combat_rating = 210
						}
						change_variable = {
							which = d20
							value = 21
						}
					}
					else_if = {
						limit = {
							combat_rating = 200
						}
						change_variable = {
							which = d20
							value = 20
						}
					}
					else_if = {
						limit = {
							combat_rating = 190
						}
						change_variable = {
							which = d20
							value = 19
						}
					}
					else_if = {
						limit = {
							combat_rating = 180
						}
						change_variable = {
							which = d20
							value = 18
						}
					}
					else_if = {
						limit = {
							combat_rating = 170
						}
						change_variable = {
							which = d20
							value = 17
						}
					}
					else_if = {
						limit = {
							combat_rating = 160
						}
						change_variable = {
							which = d20
							value = 16
						}
					}
					else_if = {
						limit = {
							combat_rating = 150
						}
						change_variable = {
							which = d20
							value = 15
						}
					}
					else_if = {
						limit = {
							combat_rating = 140
						}
						change_variable = {
							which = d20
							value = 14
						}
					}
					else_if = {
						limit = {
							combat_rating = 130
						}
						change_variable = {
							which = d20
							value = 13
						}
					}
					else_if = {
						limit = {
							combat_rating = 120
						}
						change_variable = {
							which = d20
							value = 12
						}
					}
					else_if = {
						limit = {
							combat_rating = 110
						}
						change_variable = {
							which = d20
							value = 11
						}
					}
					else_if = {
						limit = {
							combat_rating = 100
						}
						change_variable = {
							which = d20
							value = 10
						}
					}
					else_if = {
						limit = {
							combat_rating = 90
						}
						change_variable = {
							which = d20
							value = 9
						}
					}
					else_if = {
						limit = {
							combat_rating = 80
						}
						change_variable = {
							which = d20
							value = 8
						}
					}
					else_if = {
						limit = {
							combat_rating = 70
						}
						change_variable = {
							which = d20
							value = 7
						}
					}
					else_if = {
						limit = {
							combat_rating = 60
						}
						change_variable = {
							which = d20
							value = 6
						}
					}
					else_if = {
						limit = {
							combat_rating = 50
						}
						change_variable = {
							which = d20
							value = 5
						}
					}
					else_if = {
						limit = {
							combat_rating = 40
						}
						change_variable = {
							which = d20
							value = 4
						}
					}
					else_if = {
						limit = {
							combat_rating = 30
						}
						change_variable = {
							which = d20
							value = 3
						}
					}
					else_if = {
						limit = {
							combat_rating = 20
						}
						change_variable = {
							which = d20
							value = 2
						}
					}
					else_if = {
						limit = {
							combat_rating = 10
						}
						change_variable = {
							which = d20
							value = 1
						}
					}
					if = {
						limit = {
							check_variable = {
								which = d20
								value = 25 # Intentionally easier to defeat than Fredak
							}
						}
						character_event = { id = LNY.133 days = 1 } # Victory
					}
					else = {
						character_event = { id = LNY.135 days = 1 } # Defeat
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}
	
	option = {
		trigger = {
			is_devil_worshiper_trigger = yes
		}
		
		name = EVTOPTB_LNY_132 # I am more powerful than you think!
		
		custom_tooltip = {
			text = use_dark_power_if_necessary
		}
		
		hidden_tooltip = {
			random_list = {
				1 = { # Critical success
					character_event = { id = LNY.133 days = 1 } # Victory
				}
				18 = {
					set_character_flag = dragon_combat_undecided
					random_list = {
						1 = {
							set_variable = {
								which = d20
								value = 19
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 18
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 17
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 16
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 15
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 14
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 13
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 12
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 11
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 10
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 9
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 8
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 7
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 6
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 4
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 3
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 2
							}
						}
					}
				}
				1 = {  # Critical failure
					character_event = { id = LNY.135 days = 1 } # Defeat
				}
			}
			
			if = {
				limit = {
					has_character_flag = dragon_combat_undecided
				}
				if = {
					limit = {
						OR = {
							AND = {
								is_evil_trigger = yes
								has_vice_trigger = yes
							}
							is_devil_worshiper_trigger = yes
						}
					}
					change_variable = {
						which = d20
						value = -10 # Detects as Evil, so certain things will help in combat...
					}
				}
				if = {
					limit = {
						OR = {
							AND = {
								ai = yes
								any_artifact = {
									has_flag = dragonslayer
								}
							}
							any_artifact = {
								is_artifact_equipped = yes
								has_flag = dragonslayer
							}
						}
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						check_variable = {
							which = d20
							value = 25 # Intentionally easier to defeat than Fredak
						}
					}
					character_event = { id = LNY.133 days = 1 } # Victory
				}
				else = {
					# Combat rating - checks up to 500 in case someone has some insane bloodline stacking or the like
					if = {
						limit = {
							combat_rating = 500
						}
						change_variable = {
							which = d20
							value = 50
						}
					}
					else_if = {
						limit = {
							combat_rating = 490
						}
						change_variable = {
							which = d20
							value = 49
						}
					}
					else_if = {
						limit = {
							combat_rating = 480
						}
						change_variable = {
							which = d20
							value = 48
						}
					}
					else_if = {
						limit = {
							combat_rating = 470
						}
						change_variable = {
							which = d20
							value = 47
						}
					}
					else_if = {
						limit = {
							combat_rating = 460
						}
						change_variable = {
							which = d20
							value = 46
						}
					}
					else_if = {
						limit = {
							combat_rating = 450
						}
						change_variable = {
							which = d20
							value = 45
						}
					}
					else_if = {
						limit = {
							combat_rating = 440
						}
						change_variable = {
							which = d20
							value = 44
						}
					}
					else_if = {
						limit = {
							combat_rating = 430
						}
						change_variable = {
							which = d20
							value = 43
						}
					}
					else_if = {
						limit = {
							combat_rating = 420
						}
						change_variable = {
							which = d20
							value = 42
						}
					}
					else_if = {
						limit = {
							combat_rating = 410
						}
						change_variable = {
							which = d20
							value = 41
						}
					}
					else_if = {
						limit = {
							combat_rating = 400
						}
						change_variable = {
							which = d20
							value = 40
						}
					}
					else_if = {
						limit = {
							combat_rating = 390
						}
						change_variable = {
							which = d20
							value = 39
						}
					}
					else_if = {
						limit = {
							combat_rating = 380
						}
						change_variable = {
							which = d20
							value = 38
						}
					}
					else_if = {
						limit = {
							combat_rating = 370
						}
						change_variable = {
							which = d20
							value = 37
						}
					}
					else_if = {
						limit = {
							combat_rating = 360
						}
						change_variable = {
							which = d20
							value = 36
						}
					}
					else_if = {
						limit = {
							combat_rating = 350
						}
						change_variable = {
							which = d20
							value = 35
						}
					}
					else_if = {
						limit = {
							combat_rating = 340
						}
						change_variable = {
							which = d20
							value = 34
						}
					}
					else_if = {
						limit = {
							combat_rating = 330
						}
						change_variable = {
							which = d20
							value = 33
						}
					}
					else_if = {
						limit = {
							combat_rating = 320
						}
						change_variable = {
							which = d20
							value = 32
						}
					}
					else_if = {
						limit = {
							combat_rating = 310
						}
						change_variable = {
							which = d20
							value = 31
						}
					}
					else_if = {
						limit = {
							combat_rating = 300
						}
						change_variable = {
							which = d20
							value = 30
						}
					}
					else_if = {
						limit = {
							combat_rating = 290
						}
						change_variable = {
							which = d20
							value = 29
						}
					}
					else_if = {
						limit = {
							combat_rating = 280
						}
						change_variable = {
							which = d20
							value = 28
						}
					}
					else_if = {
						limit = {
							combat_rating = 270
						}
						change_variable = {
							which = d20
							value = 27
						}
					}
					else_if = {
						limit = {
							combat_rating = 260
						}
						change_variable = {
							which = d20
							value = 26
						}
					}
					else_if = {
						limit = {
							combat_rating = 250
						}
						change_variable = {
							which = d20
							value = 25
						}
					}
					else_if = {
						limit = {
							combat_rating = 240
						}
						change_variable = {
							which = d20
							value = 24
						}
					}
					else_if = {
						limit = {
							combat_rating = 230
						}
						change_variable = {
							which = d20
							value = 23
						}
					}
					else_if = {
						limit = {
							combat_rating = 220
						}
						change_variable = {
							which = d20
							value = 22
						}
					}
					else_if = {
						limit = {
							combat_rating = 210
						}
						change_variable = {
							which = d20
							value = 21
						}
					}
					else_if = {
						limit = {
							combat_rating = 200
						}
						change_variable = {
							which = d20
							value = 20
						}
					}
					else_if = {
						limit = {
							combat_rating = 190
						}
						change_variable = {
							which = d20
							value = 19
						}
					}
					else_if = {
						limit = {
							combat_rating = 180
						}
						change_variable = {
							which = d20
							value = 18
						}
					}
					else_if = {
						limit = {
							combat_rating = 170
						}
						change_variable = {
							which = d20
							value = 17
						}
					}
					else_if = {
						limit = {
							combat_rating = 160
						}
						change_variable = {
							which = d20
							value = 16
						}
					}
					else_if = {
						limit = {
							combat_rating = 150
						}
						change_variable = {
							which = d20
							value = 15
						}
					}
					else_if = {
						limit = {
							combat_rating = 140
						}
						change_variable = {
							which = d20
							value = 14
						}
					}
					else_if = {
						limit = {
							combat_rating = 130
						}
						change_variable = {
							which = d20
							value = 13
						}
					}
					else_if = {
						limit = {
							combat_rating = 120
						}
						change_variable = {
							which = d20
							value = 12
						}
					}
					else_if = {
						limit = {
							combat_rating = 110
						}
						change_variable = {
							which = d20
							value = 11
						}
					}
					else_if = {
						limit = {
							combat_rating = 100
						}
						change_variable = {
							which = d20
							value = 10
						}
					}
					else_if = {
						limit = {
							combat_rating = 90
						}
						change_variable = {
							which = d20
							value = 9
						}
					}
					else_if = {
						limit = {
							combat_rating = 80
						}
						change_variable = {
							which = d20
							value = 8
						}
					}
					else_if = {
						limit = {
							combat_rating = 70
						}
						change_variable = {
							which = d20
							value = 7
						}
					}
					else_if = {
						limit = {
							combat_rating = 60
						}
						change_variable = {
							which = d20
							value = 6
						}
					}
					else_if = {
						limit = {
							combat_rating = 50
						}
						change_variable = {
							which = d20
							value = 5
						}
					}
					else_if = {
						limit = {
							combat_rating = 40
						}
						change_variable = {
							which = d20
							value = 4
						}
					}
					else_if = {
						limit = {
							combat_rating = 30
						}
						change_variable = {
							which = d20
							value = 3
						}
					}
					else_if = {
						limit = {
							combat_rating = 20
						}
						change_variable = {
							which = d20
							value = 2
						}
					}
					else_if = {
						limit = {
							combat_rating = 10
						}
						change_variable = {
							which = d20
							value = 1
						}
					}
					if = {
						limit = {
							check_variable = {
								which = d20
								value = 25 # Intentionally easier to defeat than Fredak
							}
						}
						character_event = { id = LNY.133 days = 1 } # Victory
					}
					else = {
						increase_visibility_effect = yes
						if = {
							limit = {
								society_currency >= 1000
							}
							change_variable = {
								which = d20
								value = 10
							}
							change_society_currency = -1000
						}
						else_if = {
							limit = {
								society_currency >= 900
							}
							change_variable = {
								which = d20
								value = 9
							}
							change_society_currency = -900
						}
						else_if = {
							limit = {
								society_currency >= 800
							}
							change_variable = {
								which = d20
								value = 8
							}
							change_society_currency = -800
						}
						else_if = {
							limit = {
								society_currency >= 700
							}
							change_variable = {
								which = d20
								value = 7
							}
							change_society_currency = -700
						}
						else_if = {
							limit = {
								society_currency >= 600
							}
							change_variable = {
								which = d20
								value = 6
							}
							change_society_currency = -600
						}
						else_if = {
							limit = {
								society_currency >= 500
							}
							change_variable = {
								which = d20
								value = 5
							}
							change_society_currency = -500
						}
						else_if = {
							limit = {
								society_currency >= 400
							}
							change_variable = {
								which = d20
								value = 4
							}
							change_society_currency = -400
						}
						else_if = {
							limit = {
								society_currency >= 300
							}
							change_variable = {
								which = d20
								value = 3
							}
							change_society_currency = -300
						}
						else_if = {
							limit = {
								society_currency >= 200
							}
							change_variable = {
								which = d20
								value = 2
							}
							change_society_currency = -200
						}
						else_if = {
							limit = {
								society_currency >= 100
							}
							change_variable = {
								which = d20
								value = 1
							}
							change_society_currency = -100
						}
						if = {
							limit = {
								check_variable = {
									which = d20
									value = 25 # Intentionally easier to defeat than Fredak
								}
							}
							character_event = { id = LNY.133 days = 1 } # Victory
						}
						else = {
							character_event = { id = LNY.135 days = 1 } # Victory
						}
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}
}

# Fight won - better part of valor
character_event = {
	id = LNY.133
	desc = EVTDESC_LNY_133
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_133 # You'd better run!
		
		prestige = 200
		piety = -100
		
		FROMFROM = {
			if = {
				limit = {
					ai = no
				}
				character_event = { id = LNY.134 } # Inform liege
			}
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
					ai = no
					NOT = {
						character = ROOT
					}
				}
				character_event = { id = LNY.134 } # Inform vassals
			}
		}
	}
	
	after = {
		clr_character_flag = silver_dragon_active
	}
}

# Inform others
character_event = {
	id = LNY.134
	desc = EVTDESC_LNY_134
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_134 # Perhaps the dragon was wrong...?
	}
}

# Fight lost - death
character_event = {
	id = LNY.135
	desc = EVTDESC_LNY_135
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_135 # Not like this!
		
		prestige = -200
		piety = -100
		
		FROMFROM = {
			if = {
				limit = {
					ai = no
				}
				character_event = { id = LNY.136 } # Inform liege
			}
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
					ai = no
					NOT = {
						character = ROOT
					}
				}
				character_event = { id = LNY.136 } # Inform vassals
			}
		}
		death = {
			death_reason = death_good_dragon
		}
	}
	
	after = {
		clr_character_flag = silver_dragon_active
	}
}

# Inform others
character_event = {
	id = LNY.136
	desc = EVTDESC_LNY_136
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_136 # Thus, always, to evil!
	}
}

# Silver dragon gifts you Gram
narrative_event = {
	id = LNY.137
	title = EVTTITLE_LNY_137
	desc = EVTDESC_LNY_137
	picture = GFX_evt_garden
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_137 # Thank you!
		
		prestige = 100
		piety = 100
		
		add_artifact = gram
		new_artifact = {
			set_creation_date = "-1.1.1"
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			narrative_event = { id = LNY.138 } # Inform other vassals
		}
	}
	
	after = {
		clr_character_flag = silver_dragon_active
	}
}

# Inform vassals
narrative_event = {
	id = LNY.138
	title = EVTTITLE_LNY_138
	desc = EVTDESC_LNY_138
	picture = GFX_evt_garden
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_138 # Interesting...
	}
}

### Red dragon (Fredak, the Emperor of Embers) (139-180)

# Red dragon sighted
character_event = {
	id = LNY.139
	desc = EVTDESC_LNY_139
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_139 # May it stay far away!
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.140 } # Inform vassals
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.140
	desc = EVTDESC_LNY_140
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_140 # May it stay far away!
	}
}

# Red dragon flyby
character_event = {
	id = LNY.141
	desc = EVTDESC_LNY_141
	picture = GFX_evt_china_famine
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_141 # That was close...
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.142 } # Inform vassals
		}
		if = {
			limit = {
				has_dlc = "Reapers"
			}
			capital_scope = {
				if = {
					limit = {
						OR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					random = {
						chance = 50
						decrease_prosperity_effect = yes
					}
				}
				else_if = {
					limit = {
						NOR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					random = {
						chance = 50
						if = {
							limit = {
								has_province_modifier = depopulated_1
							}
							remove_province_modifier = depopulated_1
							add_province_modifier = {
								name = depopulated_2
								duration = -1
							}
						}
						else_if = {
							limit = {
								has_province_modifier = depopulated_2
							}
							remove_province_modifier = depopulated_2
							add_province_modifier = {
								name = depopulated_3
								duration = -1
							}
						}
						else = {
							capital_holding = {
								destroy_random_building = yes
							}
						}
					}
				}
			}
		}
		else = {
			random = {
				chance = 50
				capital_scope = {
					capital_holding = {
						destroy_random_building = yes
					}
				}
			}
		}
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					any_realm_province = {
						has_province_flag = dragons_lair_province
					}
				}
				any_realm_province = {
					limit = {
						has_province_flag = dragons_lair_province
					}
					change_variable = {
						which = dragons_hoard
						value = 500
					}
				}
			}
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.142
	desc = EVTDESC_LNY_142
	picture = GFX_evt_china_famine
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_142 # That was close...
	}
}

# Red dragon driven off
character_event = {
	id = LNY.143
	desc = EVTDESC_LNY_143
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_143 # Almost reached us...
		
		clr_global_flag = dragon_injured
		set_global_flag = dragon_injured
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.144 } # Inform vassals
		}
		
		any_playable_ruler = {
			limit = {
				ai = no
				NOR = {
					character = ROOT
					AND = {
						has_character_flag = coming_to_lny
						liege = {
							character = ROOT
						}
					}
				}
			}
			character_event = { id = LNY.145 days = 30 } # Inform the world
		}
		
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					any_realm_province = {
						has_province_flag = dragons_lair_province
					}
				}
				any_realm_province = {
					limit = {
						has_province_flag = dragons_lair_province
					}
					province_event = { id = dragon.1 days = 180 random = 365 } # The dragon recovers from its wounds
				}
			}
		}
		
		if = {
			limit = {
				has_dlc = "Reapers"
			}
			capital_scope = {
				if = {
					limit = {
						OR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					decrease_prosperity_effect = yes
				}
				else_if = {
					limit = {
						NOR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					if = {
						limit = {
							has_province_modifier = depopulated_1
						}
						remove_province_modifier = depopulated_1
						add_province_modifier = {
							name = depopulated_2
							duration = -1
						}
					}
					else_if = {
						limit = {
							has_province_modifier = depopulated_2
						}
						remove_province_modifier = depopulated_2
						add_province_modifier = {
							name = depopulated_3
							duration = -1
						}
					}
					else = {
						capital_holding = {
							destroy_random_building = yes
						}
					}
				}
			}
		}
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					any_realm_province = {
						has_province_flag = dragons_lair_province
					}
				}
				any_realm_province = {
					limit = {
						has_province_flag = dragons_lair_province
					}
					change_variable = {
						which = dragons_hoard
						value = 500
					}
				}
			}
		}
	}
}

# Inform vassals
character_event = {
	id = LNY.144
	desc = EVTDESC_LNY_144
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_144 # Almost reached us...
	}
}

# Inform the world
character_event = {
	id = LNY.145
	desc = EVTDESC_LNY_145
	picture = GFX_evt_china_invades
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_145 # Maybe the time to kill the beast is now...
	}
}

# Red dragon arrives - special first time event
narrative_event = {
	id = LNY.146
	title = EVTTITLE_LNY_146
	desc = EVTDESC_LNY_146
	picture = GFX_evt_burning_house # If there's an option between this and the Irminsul picture, that'd be nice...
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	immediate = {
		log = "Fredak, the Emperor of Embers, has arrived! COWER BEFORE HIS FURY!"
		capital_scope = {
			save_event_target_as = dragon_attack_capital
			random_province = {
				limit = {
					terrain = mountain
					NOT = {
						province = PREV
					}
				}
				preferred_limit = {
					any_province_holding = {
						holding_type = tribal
					}
					owner = {
						ai = yes
					}
					NOT = {
						distance = {
							where = PREV
							value = 500
						}
					}
				}
				preferred_limit = {
					any_province_holding = {
						OR = {
							holding_type = castle
							holding_type = city
							holding_type = temple
						}
					}
					owner = {
						ai = yes
					}
					NOT = {
						distance = {
							where = PREV
							value = 500
						}
					}
				}
				preferred_limit = {
					any_province_holding = {
						holding_type = tribal
					}
					NOT = {
						distance = {
							where = PREV
							value = 500
						}
					}
				}
				preferred_limit = {
					any_province_holding = {
						OR = {
							holding_type = castle
							holding_type = city
							holding_type = temple
						}
					}
					NOT = {
						distance = {
							where = PREV
							value = 500
						}
					}
				}
				preferred_limit = {
					any_province_holding = {
						holding_type = tribal
					}
				}
				preferred_limit = {
					any_province_holding = {
						OR = {
							holding_type = castle
							holding_type = city
							holding_type = temple
						}
					}
				}
				set_province_flag = dragons_lair_province
				change_variable = {
					which = dragons_hoard
					value = 10000
				}
			}
		}
		any_vassal = {
			limit = {
				ai = no
				has_character_flag = coming_to_lny
			}
			narrative_event = { id = LNY.147 } # Inform vassals
		}
		any_playable_ruler = {
			limit = {
				ai = no
				NOR = {
					character = ROOT
					AND = {
						has_character_flag = coming_to_lny
						liege = {
							character = ROOT
						}
					}
				}
			}
			narrative_event = { id = LNY.148 days = 1 } # Inform the world
		}
	}
	
	option = {
		name = EVTOPTA_LNY_146 # Grovel
		
		character_event = { id = LNY.151 days = 1 } # Accepted
		
		any_independent_ruler = {
			limit = {
				any_realm_province = {
					has_province_flag = dragons_lair_province
				}
			}
			any_realm_province = {
				limit = {
					has_province_flag = dragons_lair_province
				}
				holder_scope = {
					character_event = { id = LNY.149 days = 3 } # Inform the owner of the lair province that it is the dragon's lair - ALWAYS happens
				}
			}
		}
		
		if = {
			limit = {
				has_dlc = "Reapers"
			}
			capital_scope = {
				if = {
					limit = {
						OR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					decrease_prosperity_effect = yes
				}
				else_if = {
					limit = {
						NOR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					if = {
						limit = {
							has_province_modifier = depopulated_1
						}
						remove_province_modifier = depopulated_1
						add_province_modifier = {
							name = depopulated_2
							duration = -1
						}
					}
					else_if = {
						limit = {
							has_province_modifier = depopulated_2
						}
						remove_province_modifier = depopulated_2
						add_province_modifier = {
							name = depopulated_3
							duration = -1
						}
					}
					else = {
						capital_holding = {
							destroy_random_building = yes
						}
					}
				}
			}
		}
		
		ai_chance = {
			factor = 1
			# We WANT the first attack to possibly result in a full display of power...
			modifier = {
				factor = 0
				NOT = {
					trait = craven
				}
			}
		}
	}
	
	option = {
		trigger = {
			is_adult = yes
			OR = {
				ai = no
				AND = {
					is_ill_trigger = no
					NOT = {
						trait = pregnant
					}
					is_maimed_trigger = no
				}
			}
		}
		
		name = EVTOPTB_LNY_146 # Begone, foul beast!
		
		if = {
			limit = {
				has_dlc = "Reapers"
			}
			capital_scope = {
				if = {
					limit = {
						OR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					decrease_prosperity_effect = yes
				}
				else_if = {
					limit = {
						NOR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					if = {
						limit = {
							has_province_modifier = depopulated_1
						}
						remove_province_modifier = depopulated_1
						add_province_modifier = {
							name = depopulated_2
							duration = -1
						}
					}
					else_if = {
						limit = {
							has_province_modifier = depopulated_2
						}
						remove_province_modifier = depopulated_2
						add_province_modifier = {
							name = depopulated_3
							duration = -1
						}
					}
					else = {
						capital_holding = {
							destroy_random_building = yes
						}
					}
				}
			}
		}
		
		any_independent_ruler = {
			limit = {
				any_realm_province = {
					has_province_flag = dragons_lair_province
				}
			}
			any_realm_province = {
				limit = {
					has_province_flag = dragons_lair_province
				}
				holder_scope = {
					character_event = { id = LNY.149 days = 3 } # Inform the owner of the lair province that it is the dragon's lair - ALWAYS happens
				}
			}
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
			}
			character_event = { id = LNY.153 days = 1 } # Inform vassals
		}
		character_event = { id = LNY.154 days = 2 } # Calculate outcome
		
		ai_chance = {
			factor = 1000
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 0.1
				trait = wounded
			}
			modifier = {
				factor = 0.01
				NOT = {
					combat_rating = 50
				}
			}
		}
	}
}

# Inform vassals at the LNY of the dragon's arrival
narrative_event = {
	id = LNY.147
	title = EVTTITLE_LNY_147
	desc = EVTDESC_LNY_147
	picture = GFX_evt_burning_house # If there's an option between this and the Irminsul picture, that'd be nice...
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_147 # This is going to be bad...
	}
}

# Inform the world of the dragon's existence
narrative_event = {
	id = LNY.148
	title = EVTTITLE_LNY_148
	desc = EVTDESC_LNY_148
	picture = GFX_evt_burning_house # If there's an option between this and the Irminsul picture, that'd be nice...
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_148 # Oh no!
	}
}

# Inform the lair's owner of the lair province
character_event = {
	id = LNY.149
	desc = EVTDESC_LNY_149
	picture = GFX_evt_irminsul_burning
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	immediate = {
		any_demesne_province = {
			limit = {
				has_province_flag = dragons_lair_province
			}
			save_event_target_as = dragons_lair_province
		}
		any_playable_ruler = {
			limit = {
				ai = no
				NOT = {
					character = ROOT
				}
			}
			character_event = { id = LNY.150 } # Inform everyone else about the lair - ALWAYS happens
		}
	}
	
	option = {
		name = EVTOPTA_LNY_149 # Here be dragons...
		
		event_target:dragons_lair_province = {
			hidden_tooltip = {
				change_variable = {
					which = dragons_hoard
					value = 1000
				}
			}
			add_province_modifier = {
				name = dragons_lair
				duration = -1
			}
			custom_tooltip = {
				text = is_burninated_with_extreme_prejudice
				burninate_with_extreme_prejudice_effect = yes
			}
		}
	}
}

# Inform everyone else about the lair
character_event = {
	id = LNY.150
	desc = EVTDESC_LNY_150
	picture = GFX_evt_irminsul_burning
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_150 # There be dragons...
	}
}

# Grovel accepted
character_event = {
	id = LNY.151
	desc = EVTDESC_LNY_151
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_151 # At least I'm alive...
		
		scaled_wealth = {
			value = -10
			min = 1000
		}
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					any_realm_province = {
						has_province_flag = dragons_lair_province
					}
				}
				any_realm_province = {
					limit = {
						has_province_flag = dragons_lair_province
					}
					change_variable = {
						which = dragons_hoard
						value = 1000
					}
				}
			}
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
			}
			character_event = { id = LNY.152 } # Inform vassals
		}
	}
	
	after = {
		clr_global_flag = ongoing_dragon_attack
	}
}

# Inform vassals that they, too, should grovel
character_event = {
	id = LNY.152
	desc = EVTDESC_LNY_152
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_152 # At least I'm alive...
		
		scaled_wealth = {
			value = -1
			min = 100
		}
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					any_realm_province = {
						has_province_flag = dragons_lair_province
					}
				}
				any_realm_province = {
					limit = {
						has_province_flag = dragons_lair_province
					}
					change_variable = {
						which = dragons_hoard
						value = 100
					}
				}
			}
		}
	}
}

# Fight about to happen - join?
character_event = {
	id = LNY.153
	desc = EVTDESC_LNY_153
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_153 # I'll leave this to FROM...
		
		ai_chance = {
			factor = 1000
			modifier = {
				factor = 0.1
				trait = brave
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.001
				has_character_flag = dragonslayer_wannabe
			}
			modifier = {
				factor = 0.1
				any_artifact = {
					has_flag = dragonslayer
				}
			}
		}
	}
	
	option = {
		trigger = {
			is_adult = yes
			OR = {
				ai = no
				AND = {
					is_ill_trigger = no
					NOT = {
						trait = pregnant
					}
					is_maimed_trigger = no
				}
			}
		}
		name = EVTOPTB_LNY_153 # I'll help fight the dragon!
		
		set_character_flag = helping_with_dragon
		
		ai_chance = {
			factor = 1000
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 10
				any_friend = {
					character = FROM
				}
			}
			modifier = {
				factor = 10
				any_lover = {
					character = FROM
				}
			}
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
			modifier = {
				factor = 0.1
				NOT = {
					opinion = {
						who = FROM
						value = 0
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -50
					}
				}
			}
			modifier = {
				factor = 0.1
				trait = wounded
			}
			modifier = {
				factor = 0.01
				NOT = {
					combat_rating = 50
				}
			}
			modifier = {
				factor = 0.01
				is_female = yes
				# If women are not expected to fight, don't do it unnecessarily...
				NOR = {
					is_member_of_any_warrior_lodge_trigger = yes
					trait = shieldmaiden
					has_character_flag = special_marshal
					has_religion_feature = religion_equal
					has_religion_feature = religion_matriarchal
				}
			}
			modifier = {
				factor = 0.01
				# If men are not expected to fight, don't do it unnecessarily...
				NOR = {
					is_member_of_any_warrior_lodge_trigger = yes
					has_character_flag = special_marshal
					NOT = {
						has_religion_feature = religion_matriarchal
					}
				}
			}
		}
	}
}

# Determine how the fight goes
character_event = {
	id = LNY.154
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		hidden_tooltip = {
			random_list = {
				19 = {
					set_character_flag = dragon_combat_undecided
					random_list = {
						1 = {
							set_variable = {
								which = d20
								value = 25 # Due to plot armor, a crit is only +5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 19
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 18
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 17
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 16
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 15
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 14
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 13
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 12
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 11
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 10
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 9
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 8
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 7
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 6
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 4
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 3
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 2
							}
						}
					}
				}
				1 = {  # Critical failure
					narrative_event = { id = LNY.159 } # Defeat
				}
			}
			
			if = {
				limit = {
					has_character_flag = dragon_combat_undecided
				}
				if = {
					limit = {
						ai = yes
					}
					change_variable = {
						which = d20
						value = -10 # Protection from AI - it is more fun if the player gets to kill Fredak
					}
				}
				if = {
					limit = {
						OR = {
							AND = {
								ai = yes
								any_artifact = {
									has_flag = dragonslayer
								}
							}
							any_artifact = {
								is_artifact_equipped = yes
								has_flag = dragonslayer
							}
						}
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				
				# Combat rating - checks up to 500 in case someone has some insane bloodline stacking or the like
				if = {
					limit = {
						combat_rating = 500
					}
					change_variable = {
						which = d20
						value = 50
					}
				}
				else_if = {
					limit = {
						combat_rating = 490
					}
					change_variable = {
						which = d20
						value = 49
					}
				}
				else_if = {
					limit = {
						combat_rating = 480
					}
					change_variable = {
						which = d20
						value = 48
					}
				}
				else_if = {
					limit = {
						combat_rating = 470
					}
					change_variable = {
						which = d20
						value = 47
					}
				}
				else_if = {
					limit = {
						combat_rating = 460
					}
					change_variable = {
						which = d20
						value = 46
					}
				}
				else_if = {
					limit = {
						combat_rating = 450
					}
					change_variable = {
						which = d20
						value = 45
					}
				}
				else_if = {
					limit = {
						combat_rating = 440
					}
					change_variable = {
						which = d20
						value = 44
					}
				}
				else_if = {
					limit = {
						combat_rating = 430
					}
					change_variable = {
						which = d20
						value = 43
					}
				}
				else_if = {
					limit = {
						combat_rating = 420
					}
					change_variable = {
						which = d20
						value = 42
					}
				}
				else_if = {
					limit = {
						combat_rating = 410
					}
					change_variable = {
						which = d20
						value = 41
					}
				}
				else_if = {
					limit = {
						combat_rating = 400
					}
					change_variable = {
						which = d20
						value = 40
					}
				}
				else_if = {
					limit = {
						combat_rating = 390
					}
					change_variable = {
						which = d20
						value = 39
					}
				}
				else_if = {
					limit = {
						combat_rating = 380
					}
					change_variable = {
						which = d20
						value = 38
					}
				}
				else_if = {
					limit = {
						combat_rating = 370
					}
					change_variable = {
						which = d20
						value = 37
					}
				}
				else_if = {
					limit = {
						combat_rating = 360
					}
					change_variable = {
						which = d20
						value = 36
					}
				}
				else_if = {
					limit = {
						combat_rating = 350
					}
					change_variable = {
						which = d20
						value = 35
					}
				}
				else_if = {
					limit = {
						combat_rating = 340
					}
					change_variable = {
						which = d20
						value = 34
					}
				}
				else_if = {
					limit = {
						combat_rating = 330
					}
					change_variable = {
						which = d20
						value = 33
					}
				}
				else_if = {
					limit = {
						combat_rating = 320
					}
					change_variable = {
						which = d20
						value = 32
					}
				}
				else_if = {
					limit = {
						combat_rating = 310
					}
					change_variable = {
						which = d20
						value = 31
					}
				}
				else_if = {
					limit = {
						combat_rating = 300
					}
					change_variable = {
						which = d20
						value = 30
					}
				}
				else_if = {
					limit = {
						combat_rating = 290
					}
					change_variable = {
						which = d20
						value = 29
					}
				}
				else_if = {
					limit = {
						combat_rating = 280
					}
					change_variable = {
						which = d20
						value = 28
					}
				}
				else_if = {
					limit = {
						combat_rating = 270
					}
					change_variable = {
						which = d20
						value = 27
					}
				}
				else_if = {
					limit = {
						combat_rating = 260
					}
					change_variable = {
						which = d20
						value = 26
					}
				}
				else_if = {
					limit = {
						combat_rating = 250
					}
					change_variable = {
						which = d20
						value = 25
					}
				}
				else_if = {
					limit = {
						combat_rating = 240
					}
					change_variable = {
						which = d20
						value = 24
					}
				}
				else_if = {
					limit = {
						combat_rating = 230
					}
					change_variable = {
						which = d20
						value = 23
					}
				}
				else_if = {
					limit = {
						combat_rating = 220
					}
					change_variable = {
						which = d20
						value = 22
					}
				}
				else_if = {
					limit = {
						combat_rating = 210
					}
					change_variable = {
						which = d20
						value = 21
					}
				}
				else_if = {
					limit = {
						combat_rating = 200
					}
					change_variable = {
						which = d20
						value = 20
					}
				}
				else_if = {
					limit = {
						combat_rating = 190
					}
					change_variable = {
						which = d20
						value = 19
					}
				}
				else_if = {
					limit = {
						combat_rating = 180
					}
					change_variable = {
						which = d20
						value = 18
					}
				}
				else_if = {
					limit = {
						combat_rating = 170
					}
					change_variable = {
						which = d20
						value = 17
					}
				}
				else_if = {
					limit = {
						combat_rating = 160
					}
					change_variable = {
						which = d20
						value = 16
					}
				}
				else_if = {
					limit = {
						combat_rating = 150
					}
					change_variable = {
						which = d20
						value = 15
					}
				}
				else_if = {
					limit = {
						combat_rating = 140
					}
					change_variable = {
						which = d20
						value = 14
					}
				}
				else_if = {
					limit = {
						combat_rating = 130
					}
					change_variable = {
						which = d20
						value = 13
					}
				}
				else_if = {
					limit = {
						combat_rating = 120
					}
					change_variable = {
						which = d20
						value = 12
					}
				}
				else_if = {
					limit = {
						combat_rating = 110
					}
					change_variable = {
						which = d20
						value = 11
					}
				}
				else_if = {
					limit = {
						combat_rating = 100
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				else_if = {
					limit = {
						combat_rating = 90
					}
					change_variable = {
						which = d20
						value = 9
					}
				}
				else_if = {
					limit = {
						combat_rating = 80
					}
					change_variable = {
						which = d20
						value = 8
					}
				}
				else_if = {
					limit = {
						combat_rating = 70
					}
					change_variable = {
						which = d20
						value = 7
					}
				}
				else_if = {
					limit = {
						combat_rating = 60
					}
					change_variable = {
						which = d20
						value = 6
					}
				}
				else_if = {
					limit = {
						combat_rating = 50
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				else_if = {
					limit = {
						combat_rating = 40
					}
					change_variable = {
						which = d20
						value = 4
					}
				}
				else_if = {
					limit = {
						combat_rating = 30
					}
					change_variable = {
						which = d20
						value = 3
					}
				}
				else_if = {
					limit = {
						combat_rating = 20
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				else_if = {
					limit = {
						combat_rating = 10
					}
					change_variable = {
						which = d20
						value = 1
					}
				}
				any_courtier = {
					limit = {
						has_character_flag = dragonslayer_wannabe
						is_inaccessible_or_incapable_trigger = no
					}
					ROOT = {
						change_variable = {
							which = d20
							value = 5
						}
					}
				}
				any_vassal = {
					limit = {
						has_character_flag = coming_to_lny
						has_character_flag = helping_with_dragon
					}
					ROOT = {
						change_variable = {
							which = d20
							value = 1 # Much, much worse than a dedicated dragonslayer
						}
					}
				}
				if = {
					limit = {
						has_character_flag = lny_extra_dragon_guards
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				if = {
					limit = {
						has_character_flag = small_fireworks
					}
					change_variable = {
						which = d20
						value = 1
					}
				}
				else_if = {
					limit = {
						has_character_flag = normal_fireworks
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				else_if = {
					limit = {
						has_character_flag = large_fireworks
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				else_if = {
					limit = {
						has_character_flag = massive_fireworks
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						has_character_flag = lny_zodiac_match
						NOT = {
							has_character_flag = lny_element_match
						}
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				else_if = {
					limit = {
						NOT = {
							has_character_flag = lny_zodiac_match
						}
						has_character_flag = lny_element_match
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				else_if = {
					limit = {
						has_character_flag = lny_zodiac_match
						has_character_flag = lny_element_match
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						tier = duke
					}
					change_variable = {
						which = d20
						value = 1
					}
				}
				else_if = {
					limit = {
						tier = king
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				else_if = {
					limit = {
						tier = emperor
					}
					change_variable = {
						which = d20
						value = 3
					}
				}
			
				# Calculate outcome - due to plot armor, the dragon is unkillable the first time
				if = {
					limit = {
						#NOT = { 
						#	check_variable = {
						#		which = d20
						#		value = 75
						#	}
						#}
						check_variable = {
							which = d20
							value = 30
						}
					}
					narrative_event = { id = LNY.155 } # Dragon driven off and wounded
				}
				else = {
					narrative_event = { id = LNY.159 } # Defeat
				}
			}
		}
	}
}

# Dragon wounded and driven off
narrative_event = {
	id = LNY.155
	title = EVTTITLE_LNY_155
	desc = EVTDESC_LNY_155
	picture = GFX_evt_chinese_bureaucrat
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_155 # BE GONE!
		
		prestige = 500
		piety = 500
		
		set_global_flag = dragon_injured
		
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					any_realm_province = {
						has_province_flag = dragons_lair_province
					}
				}
				any_realm_province = {
					limit = {
						has_province_flag = dragons_lair_province
					}
					province_event = { id = dragon.1 days = 180 random = 365 } # The dragon recovers from its wounds
				}
			}
		}
		
		hidden_tooltip = {
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
				}
				if = {
					limit = {
						has_character_flag = helping_with_dragon
					}
					if = {
						limit = {
							ai = no
						}
						narrative_event = { id = LNY.156 } # Inform vassals
					}
					else = {
						prestige = 500
						piety = 500
						random_list = {
							80 = {}
							15 = {
								modifier = {
									factor = 0
									combat_rating = 80
								}
								modifier = {
									factor = 0.5
									combat_rating = 40
								}
								add_trait = wounded
							}
							5 = {
								modifier = {
									factor = 0
									combat_rating = 40
								}
								modifier = {
									factor = 0.5
									combat_rating = 20
								}
								add_maimed_trait_effect = yes
							}
						}
					}
				}
				else = {
					if = {
						limit = {
							ai = no
						}
						character_event = { id = LNY.157 } # Inform vassals
					}
				}
			}
			any_courtier = {
				limit = {
					has_character_flag = dragonslayer_wannabe
					is_inaccessible_or_incapable_trigger = no
				}
				prestige = 100
				piety = 100
				random_list = {
					80 = {}
					15 = {
						modifier = {
							factor = 0
							combat_rating = 80
						}
						modifier = {
							factor = 0.5
							combat_rating = 40
						}
						add_trait = wounded
					}
					5 = {
						modifier = {
							factor = 0
							combat_rating = 40
						}
						modifier = {
							factor = 0.5
							combat_rating = 20
						}
						add_maimed_trait_effect = yes
					}
				}
			}
		}
		any_playable_ruler = {
			limit = {
				ai = no
				NOR = {
					character = ROOT
					AND = {
						has_character_flag = coming_to_lny
						liege = {
							character = ROOT
						}
					}
				}
			}
			character_event = { id = LNY.158 days = 30 } # Inform the world
		}
	}
	
	after = {
		clr_global_flag = ongoing_dragon_attack
	}
}

# Inform vassals that fought
narrative_event = {
	id = LNY.156
	title = EVTTITLE_LNY_156
	desc = EVTDESC_LNY_156
	picture = GFX_evt_chinese_bureaucrat
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_156 # BE GONE!
		
		piety = 100
		prestige = 100
		
		random_list = {
			80 = {}
			15 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_trait = wounded
			}
			5 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				add_maimed_trait_effect = yes
			}
		}
	}
}

# Inform vassals that didn't fight
character_event = {
	id = LNY.157
	desc = EVTDESC_LNY_157
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_157 # Go Team Fellow Humans!
	}
}

# Inform the world
character_event = {
	id = LNY.158
	desc = EVTDESC_LNY_158
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_158 # Maybe the time to kill the beast is now...
	}
}

# Dragon wins and razes the capital
narrative_event = {
	id = LNY.159
	title = EVTTITLE_LNY_159
	desc = EVTDESC_LNY_159
	picture = GFX_evt_irminsul_burning
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_159 # NOOOO!
		
		capital_scope = {
			custom_tooltip = {
				text = is_burninated_with_extreme_prejudice
				burninate_with_extreme_prejudice_effect = yes
			}
		}
		
		random_list = {
			40 = {
				add_trait = wounded
			}
			30 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_maimed_trait_effect = yes
			}
			30 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				death = {
					death_reason = death_evil_dragon
				}
			}
		}
		
		hidden_tooltip = {
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
				}
				if = {
					limit = {
						has_character_flag = helping_with_dragon
					}
					if = {
						limit = {
							ai = no
						}
						narrative_event = { id = LNY.160 } # Inform vassals
					}
					else = {
						random_list = {
							40 = {
								add_trait = wounded
							}
							30 = {
								modifier = {
									factor = 0
									combat_rating = 80
								}
								modifier = {
									factor = 0.5
									combat_rating = 40
								}
								add_maimed_trait_effect = yes
							}
							30 = {
								modifier = {
									factor = 0
									combat_rating = 40
								}
								modifier = {
									factor = 0.5
									combat_rating = 20
								}
								death = {
									death_reason = death_evil_dragon
								}
							}
						}
					}
				}
				else = {
					if = {
						limit = {
							ai = no
						}
						character_event = { id = LNY.161 } # Inform vassals
					}
				}
			}
			any_courtier = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
				}
				random_list = {
					40 = {
						add_trait = wounded
					}
					30 = {
						modifier = {
							factor = 0
							combat_rating = 80
						}
						modifier = {
							factor = 0.5
							combat_rating = 40
						}
						add_maimed_trait_effect = yes
					}
					30 = {
						modifier = {
							factor = 0
							combat_rating = 40
						}
						modifier = {
							factor = 0.5
							combat_rating = 20
						}
						death = {
							death_reason = death_evil_dragon
						}
					}
				}
			}
			hidden_tooltip = {
				any_independent_ruler = {
					limit = {
						any_realm_province = {
							has_province_flag = dragons_lair_province
						}
					}
					any_realm_province = {
						limit = {
							has_province_flag = dragons_lair_province
						}
						change_variable = {
							which = dragons_hoard
							value = 5000
						}
					}
				}
			}
		}
		any_playable_ruler = {
			limit = {
				ai = no
				NOR = {
					character = ROOT
					AND = {
						has_character_flag = coming_to_lny
						liege = {
							character = ROOT
						}
					}
				}
			}
			character_event = { id = LNY.162 days = 5 } # Inform the world
		}
	}
	
	after = {
		clr_global_flag = ongoing_dragon_attack
	}
}

# Inform vassals that fought
narrative_event = {
	id = LNY.160
	title = EVTTITLE_LNY_160
	desc = EVTDESC_LNY_160
	picture = GFX_evt_irminsul_burning
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_160 # NO!
		
		random_list = {
			40 = {
				add_trait = wounded
			}
			30 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_maimed_trait_effect = yes
			}
			30 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				death = {
					death_reason = death_evil_dragon
				}
			}
		}
	}
}

# Inform vassals that didn't fight
character_event = {
	id = LNY.161
	desc = EVTDESC_LNY_161
	picture = GFX_evt_irminsul_burning
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_161 # How terrible!
		
		random_list = {
			20 = {}
			60 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_trait = wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				add_maimed_trait_effect = yes
			}
		}
	}
}

# Inform the world
character_event = {
	id = LNY.162
	desc = EVTDESC_LNY_162
	picture = GFX_evt_irminsul_burning
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_162 # How terrible!
	}
}

# Red dragon arrives
narrative_event = {
	id = LNY.163
	title = EVTTITLE_LNY_163
	desc = EVTDESC_LNY_163
	picture = GFX_evt_burning_house # If there's an option between this and the Irminsul picture, that'd be nice...
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	immediate = {
		capital_scope = {
			save_event_target_as = dragon_attack_capital
		}
		any_vassal = {
			limit = {
				ai = no
				has_character_flag = coming_to_lny
			}
			narrative_event = { id = LNY.164 } # Inform vassals
		}
	}
	
	
	option = {
		name = EVTOPTA_LNY_163 # Grovel
		
		character_event = { id = LNY.165 days = 1 } # Accepted
		
		if = {
			limit = {
				has_dlc = "Reapers"
			}
			capital_scope = {
				if = {
					limit = {
						OR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					decrease_prosperity_effect = yes
				}
				else_if = {
					limit = {
						NOR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					if = {
						limit = {
							has_province_modifier = depopulated_1
						}
						remove_province_modifier = depopulated_1
						add_province_modifier = {
							name = depopulated_2
							duration = -1
						}
					}
					else_if = {
						limit = {
							has_province_modifier = depopulated_2
						}
						remove_province_modifier = depopulated_2
						add_province_modifier = {
							name = depopulated_3
							duration = -1
						}
					}
					else = {
						capital_holding = {
							destroy_random_building = yes
						}
					}
				}
			}
		}
		
		ai_chance = {
			factor = 1000
			modifier = {
				factor = 0.1
				trait = brave
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.001
				has_character_flag = dragonslayer_wannabe
			}
			modifier = {
				factor = 0.1
				any_artifact = {
					has_flag = dragonslayer
				}
			}
		}
	}
	
	option = {
		trigger = {
			is_adult = yes
			OR = {
				ai = no
				AND = {
					is_ill_trigger = no
					NOT = {
						trait = pregnant
					}
					is_maimed_trigger = no
				}
			}
		}
		
		name = EVTOPTB_LNY_163 # Begone, foul beast!
		
		if = {
			limit = {
				has_dlc = "Reapers"
			}
			capital_scope = {
				if = {
					limit = {
						OR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					decrease_prosperity_effect = yes
				}
				else_if = {
					limit = {
						NOR = {
							has_province_modifier = prosperity_modifier_3
							has_province_modifier = prosperity_modifier_2
							has_province_modifier = prosperity_modifier_1
						}
					}
					if = {
						limit = {
							has_province_modifier = depopulated_1
						}
						remove_province_modifier = depopulated_1
						add_province_modifier = {
							name = depopulated_2
							duration = -1
						}
					}
					else_if = {
						limit = {
							has_province_modifier = depopulated_2
						}
						remove_province_modifier = depopulated_2
						add_province_modifier = {
							name = depopulated_3
							duration = -1
						}
					}
					else = {
						capital_holding = {
							destroy_random_building = yes
						}
					}
				}
			}
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
			}
			character_event = { id = LNY.167 days = 1 } # Inform vassals
		}
		character_event = { id = LNY.168 days = 2 } # Calculate outcome
		
		ai_chance = {
			factor = 1000
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 0.1
				trait = wounded
			}
			modifier = {
				factor = 0.01
				NOT = {
					combat_rating = 50
				}
			}
		}
	}
}

# Inform vassals at the LNY of the dragon's arrival
narrative_event = {
	id = LNY.164
	title = EVTTITLE_LNY_164
	desc = EVTDESC_LNY_164
	picture = GFX_evt_burning_house # If there's an option between this and the Irminsul picture, that'd be nice...
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_164 # This is going to be bad...
	}
}

# Grovel accepted
character_event = {
	id = LNY.165
	desc = EVTDESC_LNY_165
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_165 # At least I'm alive...
		
		scaled_wealth = {
			value = -10
			min = 1000
		}
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					any_realm_province = {
						has_province_flag = dragons_lair_province
					}
				}
				any_realm_province = {
					limit = {
						has_province_flag = dragons_lair_province
					}
					change_variable = {
						which = dragons_hoard
						value = 1000
					}
				}
			}
		}
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
			}
			character_event = { id = LNY.166 } # Inform vassals
		}
	}
	
	after = {
		clr_global_flag = ongoing_dragon_attack
	}
}

# Inform vassals that they, too, should grovel
character_event = {
	id = LNY.166
	desc = EVTDESC_LNY_166
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_166 # At least I'm alive...
		
		scaled_wealth = {
			value = -1
			min = 100
		}
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					any_realm_province = {
						has_province_flag = dragons_lair_province
					}
				}
				any_realm_province = {
					limit = {
						has_province_flag = dragons_lair_province
					}
					change_variable = {
						which = dragons_hoard
						value = 100
					}
				}
			}
		}
	}
}

# Fight about to happen - join?
character_event = {
	id = LNY.167
	desc = EVTDESC_LNY_167
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_167 # I'll leave this to FROM...
		
		ai_chance = {
			factor = 1000
			modifier = {
				factor = 0.1
				trait = brave
			}
			modifier = {
				factor = 0.1
				trait = proud
			}
			modifier = {
				factor = 0.001
				has_character_flag = dragonslayer_wannabe
			}
			modifier = {
				factor = 0.1
				any_artifact = {
					has_flag = dragonslayer
				}
			}
		}
	}
	
	option = {
		trigger = {
			is_adult = yes
			OR = {
				ai = no
				AND = {
					is_ill_trigger = no
					NOT = {
						trait = pregnant
					}
					is_maimed_trigger = no
				}
			}
		}
		name = EVTOPTB_LNY_167 # I'll help fight the dragon!
		
		set_character_flag = helping_with_dragon
		
		ai_chance = {
			factor = 1000
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 10
				any_friend = {
					character = FROM
				}
			}
			modifier = {
				factor = 10
				any_lover = {
					character = FROM
				}
			}
			modifier = {
				factor = 0
				any_rival = {
					character = FROM
				}
			}
			modifier = {
				factor = 0.1
				NOT = {
					opinion = {
						who = FROM
						value = 0
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = FROM
						value = -50
					}
				}
			}
			modifier = {
				factor = 0.1
				trait = wounded
			}
			modifier = {
				factor = 0.01
				NOT = {
					combat_rating = 50
				}
			}
			modifier = {
				factor = 0.01
				is_female = yes
				# If women are not expected to fight, don't do it unnecessarily...
				NOR = {
					is_member_of_any_warrior_lodge_trigger = yes
					trait = shieldmaiden
					has_character_flag = special_marshal
					has_religion_feature = religion_equal
					has_religion_feature = religion_matriarchal
				}
			}
			modifier = {
				factor = 0.01
				# If men are not expected to fight, don't do it unnecessarily...
				NOR = {
					is_member_of_any_warrior_lodge_trigger = yes
					has_character_flag = special_marshal
					NOT = {
						has_religion_feature = religion_matriarchal
					}
				}
			}
		}
	}
}

# Determine how the fight goes
character_event = {
	id = LNY.168
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		hidden_tooltip = {
			random_list = {
				19 = {
					set_character_flag = dragon_combat_undecided
					random_list = {
						1 = {
							set_variable = {
								which = d20
								value = 25 # Due to plot armor, a crit is only +5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 19
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 18
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 17
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 16
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 15
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 14
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 13
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 12
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 11
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 10
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 9
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 8
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 7
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 6
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 4
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 3
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 2
							}
						}
					}
				}
				1 = {  # Critical failure
					narrative_event = { id = LNY.159 } # Defeat
				}
			}
			
			if = {
				limit = {
					has_character_flag = dragon_combat_undecided
				}
				if = {
					limit = {
						ai = yes
					}
					change_variable = {
						which = d20
						value = -10 # Protection from AI - it is more fun if the player gets to kill Fredak
					}
				}
				if = {
					limit = {
						OR = {
							AND = {
								ai = yes
								any_artifact = {
									has_flag = dragonslayer
								}
							}
							any_artifact = {
								is_artifact_equipped = yes
								has_flag = dragonslayer
							}
						}
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				# Combat rating - checks up to 500 in case someone has some insane bloodline stacking or the like
				if = {
					limit = {
						combat_rating = 500
					}
					change_variable = {
						which = d20
						value = 50
					}
				}
				else_if = {
					limit = {
						combat_rating = 490
					}
					change_variable = {
						which = d20
						value = 49
					}
				}
				else_if = {
					limit = {
						combat_rating = 480
					}
					change_variable = {
						which = d20
						value = 48
					}
				}
				else_if = {
					limit = {
						combat_rating = 470
					}
					change_variable = {
						which = d20
						value = 47
					}
				}
				else_if = {
					limit = {
						combat_rating = 460
					}
					change_variable = {
						which = d20
						value = 46
					}
				}
				else_if = {
					limit = {
						combat_rating = 450
					}
					change_variable = {
						which = d20
						value = 45
					}
				}
				else_if = {
					limit = {
						combat_rating = 440
					}
					change_variable = {
						which = d20
						value = 44
					}
				}
				else_if = {
					limit = {
						combat_rating = 430
					}
					change_variable = {
						which = d20
						value = 43
					}
				}
				else_if = {
					limit = {
						combat_rating = 420
					}
					change_variable = {
						which = d20
						value = 42
					}
				}
				else_if = {
					limit = {
						combat_rating = 410
					}
					change_variable = {
						which = d20
						value = 41
					}
				}
				else_if = {
					limit = {
						combat_rating = 400
					}
					change_variable = {
						which = d20
						value = 40
					}
				}
				else_if = {
					limit = {
						combat_rating = 390
					}
					change_variable = {
						which = d20
						value = 39
					}
				}
				else_if = {
					limit = {
						combat_rating = 380
					}
					change_variable = {
						which = d20
						value = 38
					}
				}
				else_if = {
					limit = {
						combat_rating = 370
					}
					change_variable = {
						which = d20
						value = 37
					}
				}
				else_if = {
					limit = {
						combat_rating = 360
					}
					change_variable = {
						which = d20
						value = 36
					}
				}
				else_if = {
					limit = {
						combat_rating = 350
					}
					change_variable = {
						which = d20
						value = 35
					}
				}
				else_if = {
					limit = {
						combat_rating = 340
					}
					change_variable = {
						which = d20
						value = 34
					}
				}
				else_if = {
					limit = {
						combat_rating = 330
					}
					change_variable = {
						which = d20
						value = 33
					}
				}
				else_if = {
					limit = {
						combat_rating = 320
					}
					change_variable = {
						which = d20
						value = 32
					}
				}
				else_if = {
					limit = {
						combat_rating = 310
					}
					change_variable = {
						which = d20
						value = 31
					}
				}
				else_if = {
					limit = {
						combat_rating = 300
					}
					change_variable = {
						which = d20
						value = 30
					}
				}
				else_if = {
					limit = {
						combat_rating = 290
					}
					change_variable = {
						which = d20
						value = 29
					}
				}
				else_if = {
					limit = {
						combat_rating = 280
					}
					change_variable = {
						which = d20
						value = 28
					}
				}
				else_if = {
					limit = {
						combat_rating = 270
					}
					change_variable = {
						which = d20
						value = 27
					}
				}
				else_if = {
					limit = {
						combat_rating = 260
					}
					change_variable = {
						which = d20
						value = 26
					}
				}
				else_if = {
					limit = {
						combat_rating = 250
					}
					change_variable = {
						which = d20
						value = 25
					}
				}
				else_if = {
					limit = {
						combat_rating = 240
					}
					change_variable = {
						which = d20
						value = 24
					}
				}
				else_if = {
					limit = {
						combat_rating = 230
					}
					change_variable = {
						which = d20
						value = 23
					}
				}
				else_if = {
					limit = {
						combat_rating = 220
					}
					change_variable = {
						which = d20
						value = 22
					}
				}
				else_if = {
					limit = {
						combat_rating = 210
					}
					change_variable = {
						which = d20
						value = 21
					}
				}
				else_if = {
					limit = {
						combat_rating = 200
					}
					change_variable = {
						which = d20
						value = 20
					}
				}
				else_if = {
					limit = {
						combat_rating = 190
					}
					change_variable = {
						which = d20
						value = 19
					}
				}
				else_if = {
					limit = {
						combat_rating = 180
					}
					change_variable = {
						which = d20
						value = 18
					}
				}
				else_if = {
					limit = {
						combat_rating = 170
					}
					change_variable = {
						which = d20
						value = 17
					}
				}
				else_if = {
					limit = {
						combat_rating = 160
					}
					change_variable = {
						which = d20
						value = 16
					}
				}
				else_if = {
					limit = {
						combat_rating = 150
					}
					change_variable = {
						which = d20
						value = 15
					}
				}
				else_if = {
					limit = {
						combat_rating = 140
					}
					change_variable = {
						which = d20
						value = 14
					}
				}
				else_if = {
					limit = {
						combat_rating = 130
					}
					change_variable = {
						which = d20
						value = 13
					}
				}
				else_if = {
					limit = {
						combat_rating = 120
					}
					change_variable = {
						which = d20
						value = 12
					}
				}
				else_if = {
					limit = {
						combat_rating = 110
					}
					change_variable = {
						which = d20
						value = 11
					}
				}
				else_if = {
					limit = {
						combat_rating = 100
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				else_if = {
					limit = {
						combat_rating = 90
					}
					change_variable = {
						which = d20
						value = 9
					}
				}
				else_if = {
					limit = {
						combat_rating = 80
					}
					change_variable = {
						which = d20
						value = 8
					}
				}
				else_if = {
					limit = {
						combat_rating = 70
					}
					change_variable = {
						which = d20
						value = 7
					}
				}
				else_if = {
					limit = {
						combat_rating = 60
					}
					change_variable = {
						which = d20
						value = 6
					}
				}
				else_if = {
					limit = {
						combat_rating = 50
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				else_if = {
					limit = {
						combat_rating = 40
					}
					change_variable = {
						which = d20
						value = 4
					}
				}
				else_if = {
					limit = {
						combat_rating = 30
					}
					change_variable = {
						which = d20
						value = 3
					}
				}
				else_if = {
					limit = {
						combat_rating = 20
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				else_if = {
					limit = {
						combat_rating = 10
					}
					change_variable = {
						which = d20
						value = 1
					}
				}
				any_courtier = {
					limit = {
						has_character_flag = dragonslayer_wannabe
						is_inaccessible_or_incapable_trigger = no
					}
					ROOT = {
						change_variable = {
							which = d20
							value = 5
						}
					}
				}
				any_vassal = {
					limit = {
						has_character_flag = coming_to_lny
						has_character_flag = helping_with_dragon
					}
					ROOT = {
						change_variable = {
							which = d20
							value = 1 # Much, much worse than a dedicated dragonslayer
						}
					}
				}
				if = {
					limit = {
						has_character_flag = lny_extra_dragon_guards
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				if = {
					limit = {
						has_character_flag = small_fireworks
					}
					change_variable = {
						which = d20
						value = 1
					}
				}
				else_if = {
					limit = {
						has_character_flag = normal_fireworks
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				else_if = {
					limit = {
						has_character_flag = large_fireworks
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				else_if = {
					limit = {
						has_character_flag = massive_fireworks
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						has_character_flag = lny_zodiac_match
						NOT = {
							has_character_flag = lny_element_match
						}
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				else_if = {
					limit = {
						NOT = {
							has_character_flag = lny_zodiac_match
						}
						has_character_flag = lny_element_match
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				else_if = {
					limit = {
						has_character_flag = lny_zodiac_match
						has_character_flag = lny_element_match
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						tier = duke
					}
					change_variable = {
						which = d20
						value = 1
					}
				}
				else_if = {
					limit = {
						tier = king
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				else_if = {
					limit = {
						tier = emperor
					}
					change_variable = {
						which = d20
						value = 3
					}
				}
				
				# Calculate outcome
				if = {
					limit = {
						check_variable = {
							which = d20
							value = 75
						}
					}
					narrative_event = { id = LNY.177 } # Dragon killed
				}
				else_if = {
					limit = {
						NOT = { 
							check_variable = {
								which = d20
								value = 75
							}
						}
						check_variable = {
							which = d20
							value = 30
						}
					}
					narrative_event = { id = LNY.169 } # Dragon driven off and wounded
				}
				else = {
					narrative_event = { id = LNY.173 } # Defeat
				}
			}
		}
	}
}

# Dragon wounded and driven off
narrative_event = {
	id = LNY.169
	title = EVTTITLE_LNY_169
	desc = EVTDESC_LNY_169
	picture = GFX_evt_chinese_bureaucrat
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_169 # BE GONE!
		
		prestige = 500
		piety = 500
		
		set_global_flag = dragon_injured
		
		hidden_tooltip = {
			any_independent_ruler = {
				limit = {
					any_realm_province = {
						has_province_flag = dragons_lair_province
					}
				}
				any_realm_province = {
					limit = {
						has_province_flag = dragons_lair_province
					}
					province_event = { id = dragon.1 days = 180 random = 365 } # The dragon recovers from its wounds
				}
			}
		}
		
		hidden_tooltip = {
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
				}
				if = {
					limit = {
						has_character_flag = helping_with_dragon
					}
					if = {
						limit = {
							ai = no
						}
						narrative_event = { id = LNY.170 } # Inform vassals
					}
					else = {
						prestige = 500
						piety = 500
						random_list = {
							80 = {}
							15 = {
								modifier = {
									factor = 0
									combat_rating = 80
								}
								modifier = {
									factor = 0.5
									combat_rating = 40
								}
								add_trait = wounded
							}
							5 = {
								modifier = {
									factor = 0
									combat_rating = 40
								}
								modifier = {
									factor = 0.5
									combat_rating = 20
								}
								add_maimed_trait_effect = yes
							}
						}
					}
				}
				else = {
					if = {
						limit = {
							ai = no
						}
						character_event = { id = LNY.171 } # Inform vassals
					}
				}
			}
			any_courtier = {
				limit = {
					has_character_flag = dragonslayer_wannabe
					is_inaccessible_or_incapable_trigger = no
				}
				prestige = 500
				piety = 500
				random_list = {
					80 = {}
					15 = {
						modifier = {
							factor = 0
							combat_rating = 80
						}
						modifier = {
							factor = 0.5
							combat_rating = 40
						}
						add_trait = wounded
					}
					5 = {
						modifier = {
							factor = 0
							combat_rating = 40
						}
						modifier = {
							factor = 0.5
							combat_rating = 20
						}
						add_maimed_trait_effect = yes
					}
				}
			}
		}
		any_playable_ruler = {
			limit = {
				ai = no
				NOR = {
					character = ROOT
					AND = {
						has_character_flag = coming_to_lny
						liege = {
							character = ROOT
						}
					}
				}
			}
			character_event = { id = LNY.172 days = 30 } # Inform the world
		}
	}
	
	after = {
		clr_global_flag = ongoing_dragon_attack
	}
}

# Inform vassals that fought
narrative_event = {
	id = LNY.170
	title = EVTTITLE_LNY_170
	desc = EVTDESC_LNY_170
	picture = GFX_evt_chinese_bureaucrat
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_170 # BE GONE!
		
		piety = 500
		prestige = 500
		
		random_list = {
			80 = {}
			15 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_trait = wounded
			}
			5 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				add_maimed_trait_effect = yes
			}
		}
	}
}

# Inform vassals that didn't fight
character_event = {
	id = LNY.171
	desc = EVTDESC_LNY_171
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_171 # Go Team Fellow Humans!
	}
}

# Inform the world
character_event = {
	id = LNY.172
	desc = EVTDESC_LNY_172
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_172 # Maybe the time to kill the beast is now...
	}
}

# Dragon wins and razes the capital
narrative_event = {
	id = LNY.173
	title = EVTTITLE_LNY_173
	desc = EVTDESC_LNY_173
	picture = GFX_evt_irminsul_burning
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_173 # NOOOO!
		
		capital_scope = {
			custom_tooltip = {
				text = is_burninated_with_extreme_prejudice
				burninate_with_extreme_prejudice_effect = yes
			}
		}
		
		random_list = {
			40 = {
				add_trait = wounded
			}
			30 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_maimed_trait_effect = yes
			}
			30 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				death = {
					death_reason = death_evil_dragon
				}
			}
		}
		
		hidden_tooltip = {
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
				}
				if = {
					limit = {
						has_character_flag = helping_with_dragon
					}
					if = {
						limit = {
							ai = no
						}
						narrative_event = { id = LNY.174 } # Inform vassals
					}
					else = {
						random_list = {
							40 = {
								add_trait = wounded
							}
							30 = {
								modifier = {
									factor = 0
									combat_rating = 80
								}
								modifier = {
									factor = 0.5
									combat_rating = 40
								}
								add_maimed_trait_effect = yes
							}
							30 = {
								modifier = {
									factor = 0
									combat_rating = 40
								}
								modifier = {
									factor = 0.5
									combat_rating = 20
								}
								death = {
									death_reason = death_evil_dragon
								}
							}
						}
					}
				}
				else = {
					if = {
						limit = {
							ai = no
						}
						character_event = { id = LNY.175 } # Inform vassals
					}
				}
			}
			any_courtier = {
				limit = {
					is_inaccessible_or_incapable_trigger = no
				}
				random_list = {
					40 = {
						add_trait = wounded
					}
					30 = {
						modifier = {
							factor = 0
							combat_rating = 80
						}
						modifier = {
							factor = 0.5
							combat_rating = 40
						}
						add_maimed_trait_effect = yes
					}
					30 = {
						modifier = {
							factor = 0
							combat_rating = 40
						}
						modifier = {
							factor = 0.5
							combat_rating = 20
						}
						death = {
							death_reason = death_evil_dragon
						}
					}
				}
			}
			hidden_tooltip = {
				any_independent_ruler = {
					limit = {
						any_realm_province = {
							has_province_flag = dragons_lair_province
						}
					}
					any_realm_province = {
						limit = {
							has_province_flag = dragons_lair_province
						}
						change_variable = {
							which = dragons_hoard
							value = 5000
						}
					}
				}
			}
		}
		any_playable_ruler = {
			limit = {
				ai = no
				NOR = {
					character = ROOT
					AND = {
						has_character_flag = coming_to_lny
						liege = {
							character = ROOT
						}
					}
				}
			}
			character_event = { id = LNY.176 days = 5 } # Inform the world
		}
	}
	
	after = {
		clr_global_flag = ongoing_dragon_attack
	}
}

# Inform vassals that fought
narrative_event = {
	id = LNY.174
	title = EVTTITLE_LNY_174
	desc = EVTDESC_LNY_174
	picture = GFX_evt_irminsul_burning
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_174 # NO!
		
		random_list = {
			40 = {
				add_trait = wounded
			}
			30 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_maimed_trait_effect = yes
			}
			30 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				death = {
					death_reason = death_evil_dragon
				}
			}
		}
	}
}

# Inform vassals that didn't fight
character_event = {
	id = LNY.175
	desc = EVTDESC_LNY_175
	picture = GFX_evt_irminsul_burning
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_175 # How terrible!
		
		random_list = {
			20 = {}
			60 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_trait = wounded
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				add_maimed_trait_effect = yes
			}
		}
	}
}

# Inform the world
character_event = {
	id = LNY.176
	desc = EVTDESC_LNY_176
	picture = GFX_evt_irminsul_burning
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_176 # How terrible!
	}
}

# You have slain the dragon
narrative_event = {
	id = LNY.177
	title = EVTTITLE_LNY_177
	desc = EVTDESC_LNY_177
	picture = GFX_evt_china_expansionist
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	immediate = {
		log = "Fredak, the Emperor of Embers, has been slain! [Root.GetBestName] is now the Dragonslayer."
		# Chance to get an artifact, or several
		
		# Joke artifacts
		random_list = {
			5 = {
				set_character_flag = got_incomplete_deck_of_cards
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = talking_wand_exists
				}
				set_character_flag = got_talking_wand
				set_global_flag = talking_wand_exists
			}
			5 = {
				set_character_flag = got_book_of_burninating
			}
			5 = {
				set_character_flag = got_shiny_bauble
			}
			#5 = {
			#	set_character_flag = got_dragon_eggshell # Only in the lair
			#}
			5 = {
				set_character_flag = got_fantasy_world_map
			}
			5 = {
				set_character_flag = got_princess_doll
			}
			5 = {
				set_character_flag = got_hammer_of_banning
			}
			# You always get a joke artifact
		}
		
		# Less powerful artifacts
		random_list = {
			5 = {
				modifier = {
					factor = 0
					has_global_flag = the_plus_one_ring_exists
				}
				set_character_flag = got_the_plus_one_ring
				set_global_flag = the_plus_one_ring_exists
			}
			5 = {
				set_character_flag = got_draught_of_healing
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = dragonscale_shield_exists
				}
				set_character_flag = got_dragonscale_shield
				set_global_flag = dragonscale_shield_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = sword_of_two_minds_exists
				}
				set_character_flag = got_sword_of_two_minds
				set_global_flag = sword_of_two_minds_exists
			}
			5 = {
				set_character_flag = got_draconic_lineages
			}
			5 = {
				set_character_flag = got_ornate_holy_symbol
			}
			5 = {
				set_character_flag = got_prestigious_ring
			}
			20 = {} # Nothing
		}
		
		# Very powerful artifacts
		random_list = {
			5 = {
				modifier = {
					factor = 0
					has_global_flag = sanitys_demise_exists
				}
				set_character_flag = got_sanitys_demise
				set_global_flag = sanitys_demise_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = vial_of_immortality_exists
				}
				set_character_flag = got_vial_of_immortality
				set_global_flag = vial_of_immortality_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = living_flame_exists
				}
				set_character_flag = got_living_flame
				set_global_flag = living_flame_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = hungering_blade_exists
				}
				set_character_flag = got_hungering_blade
				set_global_flag = hungering_blade_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = deed_to_the_dragon_throne_exists
				}
				set_character_flag = got_deed_to_the_dragon_throne
				set_global_flag = deed_to_the_dragon_throne_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = diplomacy_ring_exists
				}
				set_character_flag = got_diplomacy_ring
				set_global_flag = diplomacy_ring_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = martial_ring_exists
				}
				set_character_flag = got_martial_ring
				set_global_flag = martial_ring_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = stewardship_ring_exists
				}
				set_character_flag = got_stewardship_ring
				set_global_flag = stewardship_ring_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = intrigue_ring_exists
				}
				set_character_flag = got_intrigue_ring
				set_global_flag = intrigue_ring_exists
			}
			5 = {
				modifier = {
					factor = 0
					has_global_flag = learning_ring_exists
				}
				set_character_flag = got_learning_ring
				set_global_flag = learning_ring_exists
			}
			50 = {} # Nothing
		}
	}
	
	option = {
		name = EVTOPTA_LNY_177 # Was that all?
		
		# These rewards are supposed to be very good, considering that it is difficult to pull off
		give_nickname = nick_the_dragonslayer
		
		set_global_flag = dragon_slain
		
		prestige = 10000
		piety = 10000
		
		if = {
			limit = {
				is_female = no
			}
			create_bloodline = {
				type = dragonslayer_bloodline
			}
		}
		else = {
			create_bloodline = {
				type = dragonslayer_bloodline
				inheritance = matrilineal
			}
		}
		
		random_list = {
			95 = {}
			4 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_trait = wounded
			}
			1 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				add_maimed_trait_effect = yes
			}
		}
		
		# Joke artifact
		if = {
			limit = {
				has_character_flag = got_incomplete_deck_of_cards
			}
			add_artifact = incomplete_deck_of_cards
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_talking_wand
			}
			add_artifact = talking_wand
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_book_of_burninating
			}
			add_artifact = book_of_burninating
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_shiny_bauble
			}
			add_artifact = shiny_bauble
			# Actually created at this date
		}
		else_if = {
			limit = {
				has_character_flag = got_fantasy_world_map
			}
			add_artifact = fantasy_world_map
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_princess_doll
			}
			add_artifact = princess_doll
			# Actually created at this date
		}
		else_if = {
			limit = {
				has_character_flag = got_hammer_of_banning
			}
			add_artifact = hammer_of_banning
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		
		# Less powerful artifact
		if = {
			limit = {
				has_character_flag = got_the_plus_one_ring
			}
			add_artifact = the_plus_one_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_draught_of_healing
			}
			add_artifact = draught_of_healing
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_dragonscale_shield
			}
			add_artifact = dragonscale_shield
			# Actually created at this date
		}
		else_if = {
			limit = {
				has_character_flag = got_sword_of_two_minds
			}
			add_artifact = sword_of_two_minds
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_draconic_lineages
			}
			add_artifact = draconic_lineages
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_ornate_holy_symbol
			}
			add_artifact = ornate_holy_symbol
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_prestigious_ring
			}
			add_artifact = prestigious_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		
		# Very powerful artifact
		if = {
			limit = {
				has_character_flag = got_sanitys_demise
			}
			add_artifact = sanitys_demise
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_vial_of_immortality
			}
			add_artifact = vial_of_immortality
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_living_flame
			}
			add_artifact = living_flame
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_hungering_blade
			}
			add_artifact = hungering_blade
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_deed_to_the_dragon_throne
			}
			add_artifact = deed_to_the_dragon_throne
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_diplomacy_ring
			}
			add_artifact = diplomacy_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_martial_ring
			}
			add_artifact = martial_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_stewardship_ring
			}
			add_artifact = stewardship_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_intrigue_ring
			}
			add_artifact = intrigue_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_learning_ring
			}
			add_artifact = learning_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		
		hidden_tooltip = {
			any_vassal = {
				limit = {
					has_character_flag = coming_to_lny
				}
				if = {
					limit = {
						has_character_flag = helping_with_dragon
					}
					if = {
						limit = {
							ai = no
						}
						narrative_event = { id = LNY.178 } # Inform vassals
					}
					else = {
						prestige = 500
						piety = 500
						random_list = {
							95 = {}
							4 = {
								modifier = {
									factor = 0
									combat_rating = 80
								}
								modifier = {
									factor = 0.5
									combat_rating = 40
								}
								add_trait = wounded
							}
							1 = {
								modifier = {
									factor = 0
									combat_rating = 40
								}
								modifier = {
									factor = 0.5
									combat_rating = 20
								}
								add_maimed_trait_effect = yes
							}
						}
					}
				}
				else = {
					if = {
						limit = {
							ai = no
						}
						character_event = { id = LNY.179 } # Inform vassals
					}
				}
			}
			any_courtier = {
				limit = {
					has_character_flag = dragonslayer_wannabe
					is_inaccessible_or_incapable_trigger = no
				}
				prestige = 1000
				piety = 1000
				random_list = {
					95 = {}
					4 = {
						modifier = {
							factor = 0
							combat_rating = 80
						}
						modifier = {
							factor = 0.5
							combat_rating = 40
						}
						add_trait = wounded
					}
					1 = {
						modifier = {
							factor = 0
							combat_rating = 40
						}
						modifier = {
							factor = 0.5
							combat_rating = 20
						}
						add_maimed_trait_effect = yes
					}
				}
			}
		}
		any_playable_ruler = {
			limit = {
				ai = no
				NOR = {
					character = ROOT
					AND = {
						has_character_flag = coming_to_lny
						liege = {
							character = ROOT
						}
					}
				}
			}
			character_event = { id = LNY.180 } # Inform the world
		}
	}
	
	after = {
		clr_global_flag = ongoing_dragon_attack
		clr_character_flag = got_incomplete_deck_of_cards
		clr_character_flag = got_talking_wand
		clr_character_flag = got_book_of_burninating
		clr_character_flag = got_shiny_bauble
		clr_character_flag = got_fantasy_world_map
		clr_character_flag = got_princess_doll
		clr_character_flag = got_hammer_of_banning
		clr_character_flag = got_the_plus_one_ring
		clr_character_flag = got_draught_of_healing
		clr_character_flag = got_dragonscale_shield
		clr_character_flag = got_sword_of_two_minds
		clr_character_flag = got_draconic_lineages
		clr_character_flag = got_ornate_holy_symbol
		clr_character_flag = got_prestigious_ring
		clr_character_flag = got_sanitys_demise
		clr_character_flag = got_vial_of_immortality
		clr_character_flag = got_living_flame
		clr_character_flag = got_hungering_blade
		clr_character_flag = got_deed_to_the_dragon_throne
		clr_character_flag = got_diplomacy_ring
		clr_character_flag = got_martial_ring
		clr_character_flag = got_stewardship_ring
		clr_character_flag = got_intrigue_ring
		clr_character_flag = got_learning_ring
	}
}

# Inform vassals that fought
narrative_event = {
	id = LNY.178
	title = EVTTITLE_LNY_178
	desc = EVTDESC_LNY_178
	picture = GFX_evt_china_expansionist
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_178 # We killed the dragon!
		
		piety = 1000
		prestige = 1000
		
		random_list = {
			95 = {}
			4 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_trait = wounded
			}
			1 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				add_maimed_trait_effect = yes
			}
		}
	}
}

# Inform vassals that didn't fight
character_event = {
	id = LNY.179
	desc = EVTDESC_LNY_179
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_179 # I totally helped!
	}
}

# Inform the world
character_event = {
	id = LNY.180
	desc = EVTDESC_LNY_180
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_180 # That means the lair is unguarded...
	}
}

##### Third event group (181-209)

### Dragon dance (181-200)

# Vassal notices very poor dragon dance
character_event = {
	id = LNY.181
	desc = EVTDESC_LNY_181
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_181 # Most inauspicious!
		FROM = {
			character_event = { id = LNY.182 }
			any_vassal = {
				limit = {
					NOT = {
						character = ROOT
					}
					has_character_flag = coming_to_lny
				}
				character_event = { id = LNY.183 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 25
				}
				NOT = {
					trait = zealous
				}
			}
			modifier = {
				factor = 0.1
				OR = {
					trait = humble
					trait = content
					trait = cynical
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_181 # Who cares?
		
		piety = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					NOT = {
						opinion = {
							who = FROM
							value = 25
						}
					}
					trait = zealous
				}
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Liege informed of vassal's comments
character_event = {
	id = LNY.182
	desc = EVTDESC_LNY_182
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
		
	option = {
		name = EVTOPTA_LNY_182 # Most unfortunate
		
		prestige = -50
		piety = -50
		
		opinion = {
			who = FROM
			modifier = troublesome_guest
			months = 12
		}
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
			}
			opinion = {
				who = ROOT
				modifier = disapproves_of_lny_dragon_dance
				months = 12
			}
		}
	}
}

# Other vassals informed
character_event = {
	id = LNY.183
	desc = EVTDESC_LNY_183
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_183 # Most inauspicious!
	}
}

# Dragon dance is good
character_event = {
	id = LNY.184
	desc = EVTDESC_LNY_184
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_184 # This is rather nice
		
		prestige = 25
		piety = 25
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.185 } # Inform vassals
		}
	}
}

# Dragon dance is good - vassals
character_event = {
	id = LNY.185
	desc = EVTDESC_LNY_185
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_185 # This is rather nice
	}
}

# Dragons get tangled up
character_event = {
	id = LNY.186
	desc = EVTDESC_LNY_186
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_186 # How inauspicious!
		
		prestige = -25
		piety = -25
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.187 } # Inform vassals
		}
	}
}

# Dragons get tangled up - vassals
character_event = {
	id = LNY.187
	desc = EVTDESC_LNY_187
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_187 # How inauspicious!
	}
}

# Multiple dragons are nice
character_event = {
	id = LNY.188
	desc = EVTDESC_LNY_188
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_188 # Auspicious!
		
		prestige = 25
		piety = 25
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.189 } # Inform vassals
		}
	}
}

# Multiple dragons are nice - vassals
character_event = {
	id = LNY.189
	desc = EVTDESC_LNY_189
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_189 # Auspicious!
	}
}

# Nine dragons
narrative_event = {
	id = LNY.190
	title = EVTTITLE_LNY_190
	desc = EVTDESC_LNY_190
	picture = GFX_evt_chinese_mythology
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_190 # Most auspicious!
		
		prestige = 50
		piety = 50
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			narrative_event = { id = LNY.191 } # Inform vassals
		}
	}
}

# Nine dragons - vassals
narrative_event = {
	id = LNY.191
	title = EVTTITLE_LNY_191
	desc = EVTDESC_LNY_191
	picture = GFX_evt_chinese_mythology
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_191 # Most auspicious!
	}
}

# Bandits disguised as dragon dancers
narrative_event = {
	id = LNY.192
	title = EVTTITLE_LNY_192
	desc = EVTDESC_LNY_192
	picture = GFX_evt_china_unrest
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	immediate = {
		create_character = {
			culture = ROOT
			religion = ROOT
			age = 19
			female = yes
			attributes = {
				diplomacy = 3
				martial = 10
				stewardship = 5
				intrigue = 8
				learning = 6
			}
			trait = brave
			trait = skilled_tactician
			trait = kind
			trait = deceitful
			trait = fair
			trait = ambitious
		}
		new_character = {
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			save_event_target_as = a_girl_worth_fighting_alongside
		}
	}
	
	option = {
		name = EVTOPTA_LNY_192 # I trust her to handle this
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			narrative_event = { id = LNY.193 } # Let the player opt in to helping out (if an adult)
		}
		any_vassal = {
			limit = { 
				has_character_flag = coming_to_lny
				war = no
				ai = yes
				is_adult = yes
			}
			score_value = { #Prioritizes selecting an interesting courtier...
				value = 10
				interesting_courtier_selection_score = yes
			}
			narrative_event = { id = LNY.193 } # Let an interesting AI vassal help out, if they want to
		}
		hidden_tooltip = {
			random_list = {
				75 = {
					narrative_event = { id = LNY.194 days = 2 random = 1 } # Success
				}
				25 = {
					narrative_event = { id = LNY.197 days = 2 random = 1 } # Failure
				}
			}
		}
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 10
				is_female = yes
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_192 # Just send in the guards
		
		event_target:a_girl_worth_fighting_alongside = {
			leave_court_and_die_effect = yes
		}
		
		ai_chance = {
			factor = 75
		}
		
		character_event = { id = LNY.200 } # The guards handle matters
	}
}

# Help the peasant girl?
narrative_event = {
	id = LNY.193
	title = EVTTITLE_LNY_193
	desc = EVTDESC_LNY_193
	picture = GFX_evt_china_unrest
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			is_adult = yes
			is_female = no
		}
		name = EVTOPTA_LNY_193 # I'll help her!
		
		prestige = 25
		set_character_flag = helping_with_bandits
		
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		trigger = {
			is_adult = yes
			is_female = yes
		}
		name = EVTOPTA_LNY_193 # I'll help her!
		
		prestige = 50
		set_character_flag = helping_with_bandits
		
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		trigger = {
			is_female = no
		}
		
		name = EVTOPTB_LNY_193 # A girl fighting? She'll fail for sure!
		
		if = {
			limit = {
				is_adult = yes
			}
			prestige = -10
		}
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
	
	option = {
		trigger = {
			is_female = yes
		}
		
		name = EVTOPTC_LNY_193 # Fighting is not for me...
		
		if = {
			limit = {
				is_adult = yes
			}
			prestige = -5
		}
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Peasant girl rescues the hostages - liege
narrative_event = {
	id = LNY.194
	desc = EVTDESC_LNY_194
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_194 # I knew she could do it!
		
		prestige = 50
		
		event_target:a_girl_worth_fighting_alongside = {
			clr_character_flag = ai_flag_refuse_concubinage
			clr_character_flag = ai_flag_refuse_marriage
			set_character_flag = special_marshal
			add_friend = ROOT
		}
		
		any_vassal = {
			limit = {
				has_character_flag = helping_with_bandits
			}
			narrative_event = { id = LNY.195 }
		}
		any_vassal = {
			limit = {
				ai = no
				has_character_flag = coming_to_lny
				NOT = {
					has_character_flag = helping_with_bandits
				}
			}
			narrative_event = { id = LNY.196 }
		}
	}
}

# Peasant girl rescues the hostages - vassals that joined
narrative_event = {
	id = LNY.195
	desc = EVTDESC_LNY_195
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_195 # I knew she could do it!
		
		prestige = 50
		
		event_target:a_girl_worth_fighting_alongside = {
			add_friend = ROOT
		}
	}
}

# Peasant girl rescues the hostages - vassals that didn't join
narrative_event = {
	id = LNY.196
	desc = EVTDESC_LNY_196
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_196 # Well, that happened...
	}
}

# Peasant girl fails to rescue the hostages - liege
narrative_event = {
	id = LNY.197
	desc = EVTDESC_LNY_197
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_197 # She has failed me!
		
		prestige = -50
		
		event_target:a_girl_worth_fighting_alongside = {
			random_list = {
				50 = {
					add_trait = wounded
				}
				50 = {
					add_maimed_trait_effect = yes
				}
			}
			clr_character_flag = ai_flag_refuse_concubinage
			clr_character_flag = ai_flag_refuse_marriage
			imprison = yes
		}
		
		any_vassal = {
			limit = {
				has_character_flag = helping_with_bandits
			}
			narrative_event = { id = LNY.198 }
		}
		any_vassal = {
			limit = {
				ai = no
				has_character_flag = coming_to_lny
				NOT = {
					has_character_flag = helping_with_bandits
				}
			}
			narrative_event = { id = LNY.199 }
		}
	}
}

# Peasant girl rescues the hostages - vassals that joined
narrative_event = {
	id = LNY.198
	desc = EVTDESC_LNY_198
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_198 # It's her fault!
		
		prestige = -25
		
		random = {
			chance = 25
			add_trait = wounded
		}
	}
}

# Peasant girl rescues the hostages - vassals that didn't join
narrative_event = {
	id = LNY.199
	desc = EVTDESC_LNY_199
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_199 # Apparently she didn't know how to fight...
	}
}

# Liege sent in the guards
character_event = {
	id = LNY.200
	desc = EVTDESC_LNY_200
	picture = GFX_evt_china_invades
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_200 # The guards had it under control
	}
}

### Fireworks (201-209)

# Unimpressive fireworks - vassal might complain
character_event = {
	id = LNY.201
	desc = EVTDESC_LNY_201
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_201 # Most inauspicious!
		FROM = {
			character_event = { id = LNY.202 }
			any_vassal = {
				limit = {
					NOT = {
						character = ROOT
					}
					ai = no
					has_character_flag = coming_to_lny
				}
				character_event = { id = LNY.203 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				opinion = {
					who = FROM
					value = 25
				}
				NOT = {
					trait = zealous
				}
			}
			modifier = {
				factor = 0.1
				OR = {
					trait = humble
					trait = content
					trait = cynical
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_LNY_201 # Who cares?
		
		piety = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					NOT = {
						opinion = {
							who = FROM
							value = 25
						}
					}
					trait = zealous
				}
			}
			modifier = {
				factor = 10
				trait = shy
			}
		}
	}
}

# Unimpressive fireworks - liege
character_event = {
	id = LNY.202
	desc = EVTDESC_LNY_202
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
		
	option = {
		name = EVTOPTA_LNY_202 # Most unfortunate
		
		prestige = -50
		piety = -50
		
		opinion = {
			who = FROM
			modifier = troublesome_guest
			months = 12
		}
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
			}
			opinion = {
				who = ROOT
				modifier = disapproves_of_lny_fireworks
				months = 12
			}
		}
	}
}

# Unimpressive fireworks - other vassals
character_event = {
	id = LNY.203
	desc = EVTDESC_LNY_203
	picture =GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_203 # Most inauspicious!
	}
}

# Acceptable fireworks - liege
character_event = {
	id = LNY.204
	desc = EVTDESC_LNY_204
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_204 # This is rather nice
		
		prestige = 25
		piety = 25
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.205 } # Inform vassals
		}
	}
}

# Acceptable fireworks - vassals
character_event = {
	id = LNY.205
	desc = EVTDESC_LNY_205
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_205 # This is rather nice
	}
}

# Good fireworks - liege
character_event = {
	id = LNY.206
	desc = EVTDESC_LNY_206
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_206 # Auspicious!
		
		prestige = 25
		piety = 25
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			character_event = { id = LNY.207 } # Inform vassals
		}
	}
}

# Good fireworks - vassals
character_event = {
	id = LNY.207
	desc = EVTDESC_LNY_207
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_207 # Auspicious!
	}
}

# Great fireworks - liege
narrative_event = {
	id = LNY.208
	title = EVTTITLE_LNY_208
	desc = EVTDESC_LNY_208
	picture = GFX_evt_china_stable
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		FROM = {
			has_character_modifier = lny_in_progress
		}
	}
	
	option = {
		name = EVTOPTA_LNY_208 # Most auspicious!
		
		prestige = 50
		piety = 50
		
		any_vassal = {
			limit = {
				has_character_flag = coming_to_lny
				ai = no
			}
			narrative_event = { id = LNY.209 } # Inform vassals
		}
	}
}

# Great fireworks - vassals
narrative_event = {
	id = LNY.209
	title = EVTTITLE_LNY_209
	desc = EVTDESC_LNY_209
	picture = GFX_evt_china_stable
	window = EventWindowOffmap
	background = GFX_event_window_news_from_china
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_LNY_209 # Most auspicious!
	}
}

##### End + cleanup events (210-214)

# Normal end
character_event = {
	id = LNY.210
	desc = EVTDESC_LNY_210
	picture = GFX_evt_feast

	capable_only = yes
	prisoner = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = lny_in_progress
	}

	option = {
		name = EVTOPTA_LNY_210 # Wishing you prosperity!
		prestige = 10
		piety = 10
		set_character_flag = recent_lny
		
		hidden_tooltip = {
			remove_character_modifier = lny_in_progress
			clr_character_flag = acrobats_hired
			clr_character_flag = coming_to_lny
			clr_character_flag = dragon_boon_fertility
			clr_character_flag = dragon_boon_health
			clr_character_flag = dragon_boon_intelligence
			clr_character_flag = dragon_boon_martial
			clr_character_flag = dragon_boon_prosperity
			clr_character_flag = dragon_boon_rulership
			clr_character_flag = dragon_boon_strength
			clr_character_flag = dragon_boon_wisdom
			clr_character_flag = dragon_combat_undecided
			clr_character_flag = guest_lny_started
			clr_character_flag = helping_with_bandits
			clr_character_flag = helping_with_dragon
			clr_character_flag = host_lny_started
			clr_character_flag = large_fireworks
			clr_character_flag = lavishly_food
			clr_character_flag = lion_dance
			clr_character_flag = lny_artifact_theft
			clr_character_flag = lny_cleaned_a_little
			clr_character_flag = lny_cleaned_properly
			clr_character_flag = lny_did_not_clean
			clr_character_flag = lny_element_match
			clr_character_flag = lny_extra_dragon_guards
			clr_character_flag = lny_extravagant_decorations
			clr_character_flag = lny_no_decorations
			clr_character_flag = lny_normal_decorations
			clr_character_flag = lny_zodiac_match
			clr_character_flag = low_food
			clr_character_flag = massive_fireworks
			clr_character_flag = medium_food
			clr_character_flag = musicians_hired
			clr_character_flag = nine_dragon_dance
			clr_character_flag = no_lion_dance
			clr_character_flag = normal_dragon_dance
			clr_character_flag = normal_fireworks
			clr_character_flag = ongoing_dragon_attack
			clr_character_flag = red_envelopes
			clr_character_flag = sent_invitations
			clr_character_flag = small_dragon_dance
			clr_character_flag = small_fireworks
			clr_character_flag = two_dragon_dance
			clr_character_flag = do_not_disturb
			any_vassal = {
				limit = {
					has_character_flag = guest_lny_started
				}
				character_event = { id = LNY.211 }
				remove_opinion = {
					modifier = opinion_enjoyed_lny
					who = ROOT
				}
				opinion = {
					modifier = opinion_enjoyed_lny
					who = ROOT
					years = 2
				}
				clr_character_flag = acrobats_hired
				clr_character_flag = coming_to_lny
				clr_character_flag = dragon_boon_fertility
				clr_character_flag = dragon_boon_health
				clr_character_flag = dragon_boon_intelligence
				clr_character_flag = dragon_boon_martial
				clr_character_flag = dragon_boon_prosperity
				clr_character_flag = dragon_boon_rulership
				clr_character_flag = dragon_boon_strength
				clr_character_flag = dragon_boon_wisdom
				clr_character_flag = dragon_combat_undecided
				clr_character_flag = guest_lny_started
				clr_character_flag = helping_with_bandits
				clr_character_flag = helping_with_dragon
				clr_character_flag = host_lny_started
				clr_character_flag = large_fireworks
				clr_character_flag = lavishly_food
				clr_character_flag = lion_dance
				clr_character_flag = lny_artifact_theft
				clr_character_flag = lny_cleaned_a_little
				clr_character_flag = lny_cleaned_properly
				clr_character_flag = lny_did_not_clean
				clr_character_flag = lny_element_match
				clr_character_flag = lny_extra_dragon_guards
				clr_character_flag = lny_extravagant_decorations
				clr_character_flag = lny_no_decorations
				clr_character_flag = lny_normal_decorations
				clr_character_flag = lny_zodiac_match
				clr_character_flag = low_food
				clr_character_flag = massive_fireworks
				clr_character_flag = medium_food
				clr_character_flag = musicians_hired
				clr_character_flag = nine_dragon_dance
				clr_character_flag = no_lion_dance
				clr_character_flag = normal_dragon_dance
				clr_character_flag = normal_fireworks
				clr_character_flag = ongoing_dragon_attack
				clr_character_flag = red_envelopes
				clr_character_flag = sent_invitations
				clr_character_flag = small_dragon_dance
				clr_character_flag = small_fireworks
				clr_character_flag = two_dragon_dance
				clr_character_flag = do_not_disturb
			}
			any_courtier = {
				clr_character_flag = acrobats_hired
				clr_character_flag = coming_to_lny
				clr_character_flag = dragon_boon_fertility
				clr_character_flag = dragon_boon_health
				clr_character_flag = dragon_boon_intelligence
				clr_character_flag = dragon_boon_martial
				clr_character_flag = dragon_boon_prosperity
				clr_character_flag = dragon_boon_rulership
				clr_character_flag = dragon_boon_strength
				clr_character_flag = dragon_boon_wisdom
				clr_character_flag = dragon_combat_undecided
				clr_character_flag = guest_lny_started
				clr_character_flag = helping_with_bandits
				clr_character_flag = helping_with_dragon
				clr_character_flag = host_lny_started
				clr_character_flag = large_fireworks
				clr_character_flag = lavishly_food
				clr_character_flag = lion_dance
				clr_character_flag = lny_artifact_theft
				clr_character_flag = lny_cleaned_a_little
				clr_character_flag = lny_cleaned_properly
				clr_character_flag = lny_did_not_clean
				clr_character_flag = lny_element_match
				clr_character_flag = lny_extra_dragon_guards
				clr_character_flag = lny_extravagant_decorations
				clr_character_flag = lny_no_decorations
				clr_character_flag = lny_normal_decorations
				clr_character_flag = lny_zodiac_match
				clr_character_flag = low_food
				clr_character_flag = massive_fireworks
				clr_character_flag = medium_food
				clr_character_flag = musicians_hired
				clr_character_flag = nine_dragon_dance
				clr_character_flag = no_lion_dance
				clr_character_flag = normal_dragon_dance
				clr_character_flag = normal_fireworks
				clr_character_flag = ongoing_dragon_attack
				clr_character_flag = red_envelopes
				clr_character_flag = sent_invitations
				clr_character_flag = small_dragon_dance
				clr_character_flag = small_fireworks
				clr_character_flag = two_dragon_dance
				clr_character_flag = do_not_disturb
			}
		}
	}
}

# Normal end - vassals
character_event = {
	id = LNY.211
	desc = EVTDESC_LNY_211
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = EVTOPTA_LNY_211  # Wishing you prosperity!
		prestige = 5
		piety = 5
	}
}

# LNY cancelled
character_event = {
	id = LNY.212
	desc = EVTDESC_LNY_212
	picture = GFX_evt_china_isolationist

	only_rulers = yes
	war = yes

	mean_time_to_happen = {
		days = 1
	}

	trigger = {
		has_character_modifier = lny_in_progress
	}

	option = {
		name = EVTOPTA_LNY_212 # I see...
		hidden_tooltip = {
			remove_character_modifier = lny_in_progress
			clr_character_flag = acrobats_hired
			clr_character_flag = coming_to_lny
			clr_character_flag = dragon_boon_fertility
			clr_character_flag = dragon_boon_health
			clr_character_flag = dragon_boon_intelligence
			clr_character_flag = dragon_boon_martial
			clr_character_flag = dragon_boon_prosperity
			clr_character_flag = dragon_boon_rulership
			clr_character_flag = dragon_boon_strength
			clr_character_flag = dragon_boon_wisdom
			clr_character_flag = dragon_combat_undecided
			clr_character_flag = guest_lny_started
			clr_character_flag = helping_with_bandits
			clr_character_flag = helping_with_dragon
			clr_character_flag = host_lny_started
			clr_character_flag = large_fireworks
			clr_character_flag = lavishly_food
			clr_character_flag = lion_dance
			clr_character_flag = lny_artifact_theft
			clr_character_flag = lny_cleaned_a_little
			clr_character_flag = lny_cleaned_properly
			clr_character_flag = lny_did_not_clean
			clr_character_flag = lny_element_match
			clr_character_flag = lny_extra_dragon_guards
			clr_character_flag = lny_extravagant_decorations
			clr_character_flag = lny_no_decorations
			clr_character_flag = lny_normal_decorations
			clr_character_flag = lny_zodiac_match
			clr_character_flag = low_food
			clr_character_flag = massive_fireworks
			clr_character_flag = medium_food
			clr_character_flag = musicians_hired
			clr_character_flag = nine_dragon_dance
			clr_character_flag = no_lion_dance
			clr_character_flag = normal_dragon_dance
			clr_character_flag = normal_fireworks
			clr_character_flag = ongoing_dragon_attack
			clr_character_flag = red_envelopes
			clr_character_flag = sent_invitations
			clr_character_flag = small_dragon_dance
			clr_character_flag = small_fireworks
			clr_character_flag = two_dragon_dance
			clr_character_flag = do_not_disturb
			any_vassal = {
				limit = {
					has_character_flag = guest_lny_started
				}
				letter_event = { id = LNY.213 }
				clr_character_flag = acrobats_hired
				clr_character_flag = coming_to_lny
				clr_character_flag = dragon_boon_fertility
				clr_character_flag = dragon_boon_health
				clr_character_flag = dragon_boon_intelligence
				clr_character_flag = dragon_boon_martial
				clr_character_flag = dragon_boon_prosperity
				clr_character_flag = dragon_boon_rulership
				clr_character_flag = dragon_boon_strength
				clr_character_flag = dragon_boon_wisdom
				clr_character_flag = dragon_combat_undecided
				clr_character_flag = guest_lny_started
				clr_character_flag = helping_with_bandits
				clr_character_flag = helping_with_dragon
				clr_character_flag = host_lny_started
				clr_character_flag = large_fireworks
				clr_character_flag = lavishly_food
				clr_character_flag = lion_dance
				clr_character_flag = lny_artifact_theft
				clr_character_flag = lny_cleaned_a_little
				clr_character_flag = lny_cleaned_properly
				clr_character_flag = lny_did_not_clean
				clr_character_flag = lny_element_match
				clr_character_flag = lny_extra_dragon_guards
				clr_character_flag = lny_extravagant_decorations
				clr_character_flag = lny_no_decorations
				clr_character_flag = lny_normal_decorations
				clr_character_flag = lny_zodiac_match
				clr_character_flag = low_food
				clr_character_flag = massive_fireworks
				clr_character_flag = medium_food
				clr_character_flag = musicians_hired
				clr_character_flag = nine_dragon_dance
				clr_character_flag = no_lion_dance
				clr_character_flag = normal_dragon_dance
				clr_character_flag = normal_fireworks
				clr_character_flag = ongoing_dragon_attack
				clr_character_flag = red_envelopes
				clr_character_flag = sent_invitations
				clr_character_flag = small_dragon_dance
				clr_character_flag = small_fireworks
				clr_character_flag = two_dragon_dance
				clr_character_flag = do_not_disturb
			}
			any_courtier = {
				clr_character_flag = acrobats_hired
				clr_character_flag = coming_to_lny
				clr_character_flag = dragon_boon_fertility
				clr_character_flag = dragon_boon_health
				clr_character_flag = dragon_boon_intelligence
				clr_character_flag = dragon_boon_martial
				clr_character_flag = dragon_boon_prosperity
				clr_character_flag = dragon_boon_rulership
				clr_character_flag = dragon_boon_strength
				clr_character_flag = dragon_boon_wisdom
				clr_character_flag = dragon_combat_undecided
				clr_character_flag = guest_lny_started
				clr_character_flag = helping_with_bandits
				clr_character_flag = helping_with_dragon
				clr_character_flag = host_lny_started
				clr_character_flag = large_fireworks
				clr_character_flag = lavishly_food
				clr_character_flag = lion_dance
				clr_character_flag = lny_artifact_theft
				clr_character_flag = lny_cleaned_a_little
				clr_character_flag = lny_cleaned_properly
				clr_character_flag = lny_did_not_clean
				clr_character_flag = lny_element_match
				clr_character_flag = lny_extra_dragon_guards
				clr_character_flag = lny_extravagant_decorations
				clr_character_flag = lny_no_decorations
				clr_character_flag = lny_normal_decorations
				clr_character_flag = lny_zodiac_match
				clr_character_flag = low_food
				clr_character_flag = massive_fireworks
				clr_character_flag = medium_food
				clr_character_flag = musicians_hired
				clr_character_flag = nine_dragon_dance
				clr_character_flag = no_lion_dance
				clr_character_flag = normal_dragon_dance
				clr_character_flag = normal_fireworks
				clr_character_flag = ongoing_dragon_attack
				clr_character_flag = red_envelopes
				clr_character_flag = sent_invitations
				clr_character_flag = small_dragon_dance
				clr_character_flag = small_fireworks
				clr_character_flag = two_dragon_dance
				clr_character_flag = do_not_disturb
			}
		}
	}
}

# LNY cancelled - vassals
letter_event = {
	id = LNY.213
	desc = EVTDESC_LNY_213

	is_triggered_only = yes

	option = {
		name = EVTOPTA_LNY_213 # I see...
	}
}

# Flag cleanup
character_event = {
	id = LNY.214
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = acrobats_hired
		clr_character_flag = coming_to_lny
		clr_character_flag = dragon_boon_fertility
		clr_character_flag = dragon_boon_health
		clr_character_flag = dragon_boon_intelligence
		clr_character_flag = dragon_boon_martial
		clr_character_flag = dragon_boon_prosperity
		clr_character_flag = dragon_boon_rulership
		clr_character_flag = dragon_boon_strength
		clr_character_flag = dragon_boon_wisdom
		clr_character_flag = dragon_combat_undecided
		clr_character_flag = guest_lny_started
		clr_character_flag = helping_with_bandits
		clr_character_flag = helping_with_dragon
		clr_character_flag = host_lny_started
		clr_character_flag = large_fireworks
		clr_character_flag = lavishly_food
		clr_character_flag = lion_dance
		clr_character_flag = lny_artifact_theft
		clr_character_flag = lny_cleaned_a_little
		clr_character_flag = lny_cleaned_properly
		clr_character_flag = lny_did_not_clean
		clr_character_flag = lny_element_match
		clr_character_flag = lny_extra_dragon_guards
		clr_character_flag = lny_extravagant_decorations
		clr_character_flag = lny_no_decorations
		clr_character_flag = lny_normal_decorations
		clr_character_flag = lny_zodiac_match
		clr_character_flag = low_food
		clr_character_flag = massive_fireworks
		clr_character_flag = medium_food
		clr_character_flag = musicians_hired
		clr_character_flag = nine_dragon_dance
		clr_character_flag = no_lion_dance
		clr_character_flag = normal_dragon_dance
		clr_character_flag = normal_fireworks
		clr_character_flag = ongoing_dragon_attack
		clr_character_flag = red_envelopes
		clr_character_flag = sent_invitations
		clr_character_flag = small_dragon_dance
		clr_character_flag = small_fireworks
		clr_character_flag = two_dragon_dance
		clr_character_flag = do_not_disturb
		any_courtier = {
			limit = {
				has_character_flag = guest_lny_started
			}
			clr_character_flag = acrobats_hired
			clr_character_flag = coming_to_lny
			clr_character_flag = dragon_boon_fertility
			clr_character_flag = dragon_boon_health
			clr_character_flag = dragon_boon_intelligence
			clr_character_flag = dragon_boon_martial
			clr_character_flag = dragon_boon_prosperity
			clr_character_flag = dragon_boon_rulership
			clr_character_flag = dragon_boon_strength
			clr_character_flag = dragon_boon_wisdom
			clr_character_flag = dragon_combat_undecided
			clr_character_flag = guest_lny_started
			clr_character_flag = helping_with_bandits
			clr_character_flag = helping_with_dragon
			clr_character_flag = host_lny_started
			clr_character_flag = large_fireworks
			clr_character_flag = lavishly_food
			clr_character_flag = lion_dance
			clr_character_flag = lny_artifact_theft
			clr_character_flag = lny_cleaned_a_little
			clr_character_flag = lny_cleaned_properly
			clr_character_flag = lny_did_not_clean
			clr_character_flag = lny_element_match
			clr_character_flag = lny_extra_dragon_guards
			clr_character_flag = lny_extravagant_decorations
			clr_character_flag = lny_no_decorations
			clr_character_flag = lny_normal_decorations
			clr_character_flag = lny_zodiac_match
			clr_character_flag = low_food
			clr_character_flag = massive_fireworks
			clr_character_flag = medium_food
			clr_character_flag = musicians_hired
			clr_character_flag = nine_dragon_dance
			clr_character_flag = no_lion_dance
			clr_character_flag = normal_dragon_dance
			clr_character_flag = normal_fireworks
			clr_character_flag = ongoing_dragon_attack
			clr_character_flag = red_envelopes
			clr_character_flag = sent_invitations
			clr_character_flag = small_dragon_dance
			clr_character_flag = small_fireworks
			clr_character_flag = two_dragon_dance
			clr_character_flag = do_not_disturb
		}
		any_vassal = {
			limit = {
				has_character_flag = guest_lny_started
			}
			clr_character_flag = acrobats_hired
			clr_character_flag = coming_to_lny
			clr_character_flag = dragon_boon_fertility
			clr_character_flag = dragon_boon_health
			clr_character_flag = dragon_boon_intelligence
			clr_character_flag = dragon_boon_martial
			clr_character_flag = dragon_boon_prosperity
			clr_character_flag = dragon_boon_rulership
			clr_character_flag = dragon_boon_strength
			clr_character_flag = dragon_boon_wisdom
			clr_character_flag = dragon_combat_undecided
			clr_character_flag = guest_lny_started
			clr_character_flag = helping_with_bandits
			clr_character_flag = helping_with_dragon
			clr_character_flag = host_lny_started
			clr_character_flag = large_fireworks
			clr_character_flag = lavishly_food
			clr_character_flag = lion_dance
			clr_character_flag = lny_artifact_theft
			clr_character_flag = lny_cleaned_a_little
			clr_character_flag = lny_cleaned_properly
			clr_character_flag = lny_did_not_clean
			clr_character_flag = lny_element_match
			clr_character_flag = lny_extra_dragon_guards
			clr_character_flag = lny_extravagant_decorations
			clr_character_flag = lny_no_decorations
			clr_character_flag = lny_normal_decorations
			clr_character_flag = lny_zodiac_match
			clr_character_flag = low_food
			clr_character_flag = massive_fireworks
			clr_character_flag = medium_food
			clr_character_flag = musicians_hired
			clr_character_flag = nine_dragon_dance
			clr_character_flag = no_lion_dance
			clr_character_flag = normal_dragon_dance
			clr_character_flag = normal_fireworks
			clr_character_flag = ongoing_dragon_attack
			clr_character_flag = red_envelopes
			clr_character_flag = sent_invitations
			clr_character_flag = small_dragon_dance
			clr_character_flag = small_fireworks
			clr_character_flag = two_dragon_dance
			clr_character_flag = do_not_disturb
		}
	}
}