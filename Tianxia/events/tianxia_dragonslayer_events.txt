# Dragonslayer events
# by Silverswee(e)per

# This all relates to a supernatural event you can get during the LNY if western dragons show up

namespace = dragon

##### Clean up the dragon flags

### dragon_injured (1-2)

# Check if we can clear up the flag and do so, otherwise repeat if the dragon lives
province_event = {
	id = dragon.1
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		NOT = {
			has_global_flag = dragon_slain
		}
		has_global_flag = dragon_injured
	}
	
	immediate = {
		if = {
			limit = {
				NOT = {
					has_global_flag = ongoing_dragonslaying_attempt
				}
				NOT =  {
					any_character = {
						has_character_flag = in_dragons_lair_queue
					}
				}
			}
			random_list = {
				75 = {
					clr_global_flag = dragon_injured
					burninate_with_extreme_prejudice_effect = yes
					any_player = {
						character_event = { id = dragon.2 } # Inform all players that the dragon no longer is injured
					}
					change_variable = {
						which = dragons_hoard
						value = 1000
					}
				}
				25 = {
					repeat_event = { id = dragon.2 days = 183 } # Longer recovery; try again
				}
			}
		}
		else = {
			repeat_event = { id = dragon.2 days = 30 } # Fire the event again, hopefully after all ongoing dragonslayer attemps
		}
	}
}

# Inform the world
character_event = {
	id = dragon.2
	desc = EVTDESC_DRAGON_2
	picture = GFX_evt_burning_house
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_2 # Terrible news!
	}
}

### silver_dragon_active (3)

# Clean up the flag if something weird happened
character_event = {
	id = dragon.3
	hide_window = yes
	is_triggered_only = yes
	
	only_playable = yes
	religion = catholic
	min_age = 16
	
	trigger = {
		has_global_flag = silver_dragon_active
		controls_religion = yes # The Pope
	}
	
	immediate = {
		if = {
			limit = {
				month = 3 # April or later; all LNY celebrations should be over
			}
			clr_global_flag = silver_dragon_active
		}
		else = {
			repeat_event = { id = dragon.3 days = 30 } # If the event fired in March or earlier, repeat it after roughly a month
		}
	}
}

##### Dragonslaying event chain - the journey (4-130)

# Setting out
character_event = {
	id = dragon.4
	desc = EVTDESC_DRAGON_4
    picture = GFX_evt_pilgrims_epic_journey
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_4 # I'm going on an adventure!
		
		add_trait = hunting_dragons # Will need a regent
		
		any_courtier = {
			limit = {
				is_landed = no
				prisoner = no
				is_inaccessible_or_incapable_trigger = no
				has_character_flag = dragonslayer_wannabe
			}
			add_trait = hunting_dragons # Will need a regent
			opinion = {
				who = ROOT
				modifier = hunting_dragons_together
			}
		}
		
		hidden_tooltip = {
			log = "[Root.GetBestName] has set off to slay Fredak, the Emperor of Embers!"
			set_variable = {
				which = dragons_lair_travel_progress
				value = 0
			}
			if = {
				limit = {
					capital_scope = {
						any_province = {
							has_province_flag = dragons_lair_province
							NOT = {
								distance = {
									where = prev
									value = 100
								}
							}
						}
					}
				}
				set_variable = {
					which = dragons_lair_travel_distance
					value = 2
				}
			}
			else_if = {
				limit = {
					capital_scope = {
						any_province = {
							has_province_flag = dragons_lair_province
							NOT = {
								distance = {
									where = prev
									value = 200
								}
							}
						}
					}
				}
				set_variable = {
					which = dragons_lair_travel_distance
					value = 4
				}
			}
			else_if = {
				limit = {
					capital_scope = {
						any_province = {
							has_province_flag = dragons_lair_province
							NOT = {
								distance = {
									where = prev
									value = 300
								}
							}
						}
					}
				}
				set_variable = {
					which = dragons_lair_travel_distance
					value = 6
				}
			}
			else_if = {
				limit = {
					capital_scope = {
						any_province = {
							has_province_flag = dragons_lair_province
							NOT = {
								distance = {
									where = prev
									value = 400
								}
							}
						}
					}
				}
				set_variable = {
					which = dragons_lair_travel_distance
					value = 8
				}
			}
			else_if = {
				limit = {
					capital_scope = {
						any_province = {
							has_province_flag = dragons_lair_province
							NOT = {
								distance = {
									where = prev
									value = 500
								}
							}
						}
					}
				}
				set_variable = {
					which = dragons_lair_travel_distance
					value = 10
				}
			}
			else = {
				set_variable = {
					which = dragons_lair_travel_distance
					value = 12
				}
			}
			character_event = { id = dragon.5 days = 60 random  = 30 }
			
			character_event = { id = dragon.184 } # Clean up flags
			character_event = { id = dragon.187 years = 5 } # If stuck after this long, return home...
		}
	}
	
	option = {
		trigger = {
			ai = no
		}
		name = EVTOPTB_DRAGON_4 # On second thought, let's not...
		remove_character_modifier = recent_dragon_hunt
	}
}


# Travel progress and sub-chain selection
character_event = {
	id = dragon.5
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		if = {
			limit = {
				OR = {
					is_landed = no
					is_incapable = yes
					prisoner = yes
				}
			}
			remove_trait = hunting_dragons
			any_opinion_modifier_target = {
				limit = {
					has_opinion_modifier = {
						who = ROOT
						modifier = hunting_dragons_together
					}
				}
				remove_trait = hunting_dragons
				remove_opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
			
			character_event = { id = dragon.184 } # Flag cleanup
			character_event = { id = dragon.185 } # Return home
		}
		else = {
			if = {
				limit = {
					is_variable_equal = {
						which = dragons_lair_travel_progress
						which = dragons_lair_travel_distance
					}
				}
				if = {
					limit = {
						NOT = {
							has_global_flag = dragons_lair_looted # In this case, go directly to the end
						}
					}
					character_event = { id = dragon.131 } # Go to the queue
				}
				else = {
					character_event = { id = dragon.132 } # You are too late!
				}
			}
			else = {
				# Sub-chain selection
				random_list = {
					5 = {
						modifier = {
							factor = 0
							NOT = {
								any_playable_ruler = {
									NOR = {
										character = ROOT
										any_friend = {
											character = ROOT
										}
										any_lover = {
											character = ROOT
										}
									}
								}
							}
						}
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_rival_dragonslayer
						}
						set_character_flag = dragonslaying_rival_dragonslayer
						random_playable_ruler = {
							limit = {
								NOR = {
									character = ROOT
									any_friend = {
										character = ROOT
									}
									any_lover = {
										character = ROOT
									}
									has_character_flag = dragonslaying_rival_dragonslayer
								}
							}
							preferred_limit = {
								any_rival = {
									character = ROOT
								}
							}
							save_event_target_as = rival_dragonslayer
						}
						character_event = { id = dragon.6 } # Spot rival party; attack them openly, attack them under the cover of darkness, or simply try to travel faster than them
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_prayed_at_shrine
						}
						modifier = {
							factor = 0
							has_secret_religion = yes
						}
						set_character_flag = dragonslaying_prayed_at_shrine
						character_event = { id = dragon.23 } # Pray at shrine?
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_tumbling_villagers
						}
						modifier = {
							factor = 0
							trait = celibate
						}
						modifier = {
							factor = 0
							is_pregnant = yes
						}
						set_character_flag = dragonslaying_tumbling_villagers
						character_event = { id = dragon.28 } # Spot someone attractive in a village - tumble them?
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_bandits
						}
						set_character_flag = dragonslaying_bandits
						character_event = { id = dragon.30 } # Spot bandits about to attack a village - help the village?
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_legend
						}
						set_character_flag = dragonslaying_legend
						character_event = { id = dragon.38 } # Storyteller speaks of legendary dragonslayers - listen?
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_disagreement
						}
						modifier = {
							factor = 0
							NOT = {
								any_opinion_modifier_target = {
									has_opinion_modifier = {
										who = ROOT
										modifier = hunting_dragons_together
									}
									NOT = {
										any_rival = {
											character = ROOT
										}
									}
								}
							}
						}
						random_opinion_modifier_target = {
							limit = {
								has_opinion_modifier = {
									who = ROOT
									modifier = hunting_dragons_together
								}
								NOT = {
									any_rival = {
										character = ROOT
									}
								}
							}
							save_event_target_as = disagreement_target
						}
						set_character_flag = dragonslaying_disagreement
						character_event = { id = dragon.44 } # Disagreement with companion, what now?
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_friendship
						}
						modifier = {
							factor = 0
							NOT = {
								any_opinion_modifier_target = {
									has_opinion_modifier = {
										who = ROOT
										modifier = hunting_dragons_together
									}
									NOT = {
										any_friend = {
											character = ROOT
										}
									}
								}
							}
						}
						random_opinion_modifier_target = {
							limit = {
								has_opinion_modifier = {
									who = ROOT
									modifier = hunting_dragons_together
								}
								NOT = {
									any_friend = {
										character = ROOT
									}
								}
							}
							save_event_target_as = friendship_target
						}
						set_character_flag = dragonslaying_friendship
						character_event = { id = dragon.48 } # Budding friendship?
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_lover
						}
						modifier = {
							factor = 0
							NOT = {
								any_opinion_modifier_target = {
									has_opinion_modifier = {
										who = ROOT
										modifier = hunting_dragons_together
									}
									NOR = {
										any_lover = {
											character = ROOT
										}
										trait = celibate
										is_pregnant = yes
									}
									attacted_to_root_trigger = yes # Vanilla typo!
									ROOT = {
										attacted_to_prev_trigger = yes # Vanilla typo!
									}
								}
							}
						}
						modifier = {
							factor = 0
							trait = celibate
						}
						modifier = {
							factor = 0
							is_pregnant = yes
						}
						set_character_flag = dragonslaying_lover
						random_opinion_modifier_target = {
							limit = {
								has_opinion_modifier = {
									who = ROOT
									modifier = hunting_dragons_together
								}
								NOR = {
									any_lover = {
										character = ROOT
									}
									trait = celibate
									is_pregnant = yes
								}
								attacted_to_root_trigger = yes # Vanilla typo!
								ROOT = {
									attacted_to_prev_trigger = yes # Vanilla typo!
								}
							}
							save_event_target_as = lover_target
						}
						character_event = { id = dragon.49 } # Tumble travelling companion?
					}
					10 = { # A bit more common than other stuff since it is power at a price...
						# Supernatural events will be on if Fredak has been spawned, and the AI will only get this chain if the AI can get supernatural stuff
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_mabs_offer
						}
						modifier = {
							factor = 0
							#NAND = {
							#	AND = { # After the summer solstice
							#		#month = 5
							#		#day = 20
							#	}
							#	NAND = { # ... and before the winter solstice
							#		month = 12
							#		day = 21
							#	}
							#}
							NOT = {
								month = 6 # "day" does not appear to be a thing...
							}
						}
						#modifier = {
						#	factor = 0
						#	# Halloween is a dangerous date...
						#	AND = {
						#		month = 9
						#		day = 29
						#	}
						#	NAND = {
						#		month = 10
						#		day = 1
						#	}
						#}
						set_character_flag = dragonslaying_mabs_offer
						narrative_event = { id = dragon.55 } # The Queen of Air and Darkness has an offer to make...
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_devastation
						}
						set_character_flag = dragonslaying_devastation
						character_event = { id = dragon.61 } # Devastation might make people have second thoughts
					}
					1 = { # Extremely good if successful, thus rarer...
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_dodecahedron
						}
						set_character_flag = dragonslaying_dodecahedron
						character_event = { id = dragon.62 } # Spot the dodecahedron
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_assassin
						}
						modifier = {
							factor = 0
							NOT = {
								any_rival = {
									is_adult = yes
									prisoner = no
									is_inaccessible_or_incapable_trigger = no
								}
							}
						}
						random_rival = {
							limit = {
								is_adult = yes
								prisoner = no
								is_inaccessible_or_incapable_trigger = no
							}
							preferred_limit = {
								is_landed = yes
							}
							save_event_target_as = dragonslayer_assassin_sender
						}
						set_character_flag = dragonslaying_assassin
						event_target:dragonslayer_assassin_sender = {
							character_event = { id = dragon.73 } # Send an assassin?
						}
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_old_ruins
						}
						set_character_flag = dragonslaying_old_ruins
						character_event = { id = dragon.87 } # Old ruins discovered by the road
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_merchant
						}
						set_character_flag = dragonslaying_merchant
						character_event = { id = dragon.119 } # Merchant selling advice - buy some?
					}
					5 = {
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_preacher
						}
						set_character_flag = dragonslaying_preacher
						character_event = { id = dragon.130 } # Preacher suggests conversion
					}
					50 = { # High chance of happening as we ideally want there to be at least one dragonslayer around
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_recruited_dragonslayer
						}
						set_character_flag = dragonslaying_recruited_dragonslayer
						character_event = { id = dragon.189 } # Dragonslayer selection - located after the lair stuff so that everything will be together if more options are added
					}
					25 = { # High chance of happening as we ideally want there to be multiple dragonslayers around
						modifier = {
							factor = 0
							has_character_flag = dragonslaying_recruited_dragonslayer_2
						}
						modifier = {
							factor = 0
							NOT = {
								has_character_flag = dragonslaying_recruited_dragonslayer
							}
						}
						set_character_flag = dragonslaying_recruited_dragonslayer_2
						character_event = { id = dragon.189 } # Dragonslayer selection - located after the lair stuff so that everything will be together if more options are added
					}
					10 = {
						# Just keep on going
						hidden_tooltip = {
							change_variable = {
								which = dragons_lair_travel_progress
								value = 1
							}
							character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
						}
					}
				}
			}
		}
	}
}

### Rival party

# Spot the rival party - fight or not?
character_event = {
	id = dragon.6
	desc = EVTDESC_DRAGON_6
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_6 # Challenge the leader!
		
		event_target:rival_dragonslayer = {
			set_character_flag = dragonslaying_rival_dragonslayer
			character_event = { id = dragon.7 } # Dragonslayer is challenged
		}
		
		ai_chance = {
			factor = 0.01
			modifier = {
				factor = 0
				OR = {
					trait = craven
					trait = deceitful
				}
			}
			modifier = {
				factor = 0
				event_target:rival_dragonslayer = {
					OR = {
						any_lover = {
							character = ROOT
						}
						any_friend = {
							character = ROOT
						}
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_6 # Sneak into their camp and attempt an assassination
		
		event_target:rival_dragonslayer = {
			set_character_flag = dragonslaying_rival_dragonslayer
			random_list = {
				10 = {
					modifier = {
						factor = 0
						ai = no
					}
					modifier = {
						factor = 0
						intrigue = 10
					}
					character_event = { id = dragon.13 } # Target is killed in their sleep
				}
				25 = {
					modifier = {
						factor = 0
						intrigue = 10
					}
					character_event = { id = dragon.15 } # Target is wounded by initial strike
				}
				50 = {
					character_event = { id = dragon.17 } # Target wakes up early
				}
				10 = {
					modifier = {
						factor = 0
						NOT = {
							intrigue = 15
						}
					}
					character_event = { id = dragon.19 } # Target set a counter-ambush
				}
				5 = {
					modifier = {
						factor = 0
						ROOT = {
							ai = no
						}
					}
					modifier = {
						factor = 0
						NOT = {
							intrigue = 15
						}
					}
					character_event = { id = dragon.21 } # Counter-ambush critically succeeds
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				OR = {
					trait = brave
					trait = honest
				}
			}
			modifier = {
				factor = 0
				event_target:rival_dragonslayer = {
					OR = {
						any_lover = {
							character = ROOT
						}
						any_friend = {
							character = ROOT
						}
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTC_DRAGON_6 # Just keep on travelling
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 30 random = 15 } # Back to main travel event; you get a speed boost
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				event_target:rival_dragonslayer = {
					any_rival = {
						character = ROOT
					}
				}
			}
		}
	}
}

# Rival is challenged - fight or flight?
character_event = {
	id = dragon.7
	desc = EVTDESC_DRAGON_7
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_7 # A challenge? I accept!
		
		character_event = { id = dragon.12 } # Fight!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_7 # Discretion is the better part of valor...
		
		
		# It is still attempted murder...
		if = {
			limit = {
				FROM = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
			}
			if = {
				limit = {
					is_chinese_emperor_trigger = yes
				}
				FROM = {
					detract_grace_super_huge_effect = yes
				}
			}
			else_if = {
				limit = {
					any_close_relative = {
						dynasty = PREV
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_massive_effect = yes
				}
			}
			else_if = {
				limit = {
					any_dynasty_member = {
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_major_effect = yes
				}
			}
		}
		
		hidden_tooltip = {
			if = {
				limit = {
					any_artifact = {
						has_flag = dragonslayer
					}
				}
				character_event = { id = dragon.8 } # Left something behind...
			}
			else = {
				character_event = { id = dragon.10 } # Ran away, but lost some time hiding
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Rival flees but forgot something - rival
character_event = {
	id = dragon.8
	desc = EVTDESC_DRAGON_8
	picture = GFX_evt_hiding_from_pursuers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_artifact = {
			limit = {
				has_flag = dragonslayer
			}
			save_event_target_as = lost_artifact
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_8 # Curses!
		FROMFROM = {
			character_event = { id = dragon.9 } # FROMFROM discovers the artifact
		}
		if = {
			limit = {
				NOT = {
					any_rival = {
						character = FROMFROM
					}
				}
			}
			add_rival = FROMFROM
		}
	}
}

# Artifact found
character_event = {
	id = dragon.9
	desc = EVTDESC_DRAGON_9
	picture = GFX_evt_relic_box
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_9 # This was a great idea!
		event_target:lost_artifact = {
			transfer_artifact = {
				from = FROM
				to = ROOT
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Rival fled - rival
character_event = {
	id = dragon.10
	desc = EVTDESC_DRAGON_10
	picture = GFX_evt_hiding_from_pursuers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_10 # At least I'm alive...
		FROMFROM = {
			character_event = { id = dragon.11 } # FROMFROM is unable to find ROOT
		}
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = -1
			}
		}
		
		if = {
			limit = {
				NOT = {
					any_rival = {
						character = FROMFROM
					}
				}
			}
			add_rival = FROMFROM
		}
		
		if = {
			limit = {
				NOT = {
					trait = brave
				}
			}
			random = {
				chance = 33
				add_trait = craven
			}
		}
		else = {
			random = {
				chance = 33
				remove_trait = brave
			}
		}
	}
}

# FROM fled
character_event = {
	id = dragon.11
	desc = EVTDESC_DRAGON_11
	picture = GFX_evt_hiding_from_pursuers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_11 # Hopefully this means FROM won't reach the lair ahead of me!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Duel
character_event = {
	id = dragon.12
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = combatant_1
		set_character_flag = flag_duel_no_draws # To the death!
		FROM = {
			save_event_target_as = combatant_2
		}
		character_event = {	id = HFP.10100 } # The duel is fought!
		clr_character_flag = flag_duel_no_draws
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Assassinated in your sleep - target
character_event = {
	id = dragon.13
	desc = EVTDESC_DRAGON_13
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_13 # Do not want!
		death = {
			death_reason = death_murder_unknown
			killer = FROM
		}
		FROM = {
			character_event = { id = dragon.14 } # Inform FROM
		}
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = Root
					modifier = hunting_dragons_together
				}
			}
			death = {
				death_reason = death_murder_unknown
				killer = FROM
			}
		}
	}
}

# Assassinated them in their sleep - attacker
character_event = {
	id = dragon.14
	desc = EVTDESC_DRAGON_14
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_14 # Got you!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Target wounded non-fatally - target!
character_event = {
	id = dragon.15
	desc = EVTDESC_DRAGON_15
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_15 # You'll pay for this!
		add_trait = wounded
		
		if = {
			limit = {
				FROM = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
			}
			if = {
				limit = {
					is_chinese_emperor_trigger = yes
				}
				FROM = {
					detract_grace_super_huge_effect = yes
				}
			}
			else_if = {
				limit = {
					any_close_relative = {
						dynasty = PREV
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_massive_effect = yes
				}
			}
			else_if = {
				limit = {
					any_dynasty_member = {
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_major_effect = yes
				}
			}
		}
		FROM = {
			character_event = { id = dragon.16 }
		}
	}
}

# Target wounded non-fatally - attacker!
character_event = {
	id = dragon.16
	desc = EVTDESC_DRAGON_16
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_16 # You're already bleeding!
		
		character_event = { id = dragon.12 } # Duel!
	}
}

# Target woke up early - target
character_event = {
	id = dragon.17
	desc = EVTDESC_DRAGON_17
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_17 # I am a light sleeper!
		
		if = {
			limit = {
				FROM = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
			}
			if = {
				limit = {
					is_chinese_emperor_trigger = yes
				}
				FROM = {
					detract_grace_super_huge_effect = yes
				}
			}
			else_if = {
				limit = {
					any_close_relative = {
						dynasty = PREV
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_massive_effect = yes
				}
			}
			else_if = {
				limit = {
					any_dynasty_member = {
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_major_effect = yes
				}
			}
		}
		FROM = {
			character_event = { id = dragon.18 }
		}
	}
}

# Target woke up early - attacker!
character_event = {
	id = dragon.18
	desc = EVTDESC_DRAGON_18
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_18 # I will still kill you!
		
		character_event = { id = dragon.12 } # Duel!
	}
}

# Target set a counter-ambush - target
character_event = {
	id = dragon.19
	desc = EVTDESC_DRAGON_19
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_19 # I knew I heard something!
		
		if = {
			limit = {
				FROM = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
			}
			if = {
				limit = {
					is_chinese_emperor_trigger = yes
				}
				FROM = {
					detract_grace_super_huge_effect = yes
				}
			}
			else_if = {
				limit = {
					any_close_relative = {
						dynasty = PREV
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_massive_effect = yes
				}
			}
			else_if = {
				limit = {
					any_dynasty_member = {
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_major_effect = yes
				}
			}
		}
		FROM = {
			character_event = { id = dragon.20 }
		}
	}
}

# Target set a counter-ambush - attacker!
character_event = {
	id = dragon.20
	desc = EVTDESC_DRAGON_20
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_20 # I can still fight!
		add_trait = wounded
		character_event = { id = dragon.12 } # Duel!
	}
}

# Critical success on counter-ambush - target
character_event = {
	id = dragon.21
	desc = EVTDESC_DRAGON_21
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_21 # And so you die!
		
		if = {
			limit = {
				FROM = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
			}
			if = {
				limit = {
					is_chinese_emperor_trigger = yes
				}
				FROM = {
					detract_grace_super_huge_effect = yes
				}
			}
			else_if = {
				limit = {
					any_close_relative = {
						dynasty = PREV
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_massive_effect = yes
				}
			}
			else_if = {
				limit = {
					any_dynasty_member = {
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_major_effect = yes
				}
			}
		}
		FROM = {
			character_event = { id = dragon.22 }
		}
	}
}

# Critical success on counter-ambush - attacker!
character_event = {
	id = dragon.22
	desc = EVTDESC_DRAGON_22
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_22 # Do not want!
		death = {
			death_reason = death_battle
			killer = FROM
		}
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = Root
					modifier = hunting_dragons_together
				}
			}
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
		
		if = {
			limit = {
				FROM = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
			}
			if = {
				limit = {
					is_chinese_emperor_trigger = yes
				}
				FROM = {
					detract_grace_super_huge_effect = yes
				}
			}
			else_if = {
				limit = {
					any_close_relative = {
						dynasty = PREV
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_massive_effect = yes
				}
			}
			else_if = {
				limit = {
					any_dynasty_member = {
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_major_effect = yes
				}
			}
		}
	}
}

### Pray at shrine?

# Hear of a nearby shrine - head to it to pray?
character_event = {
	id = dragon.23
	desc = EVTDESC_DRAGON_23
	picture = GFX_evt_tribal_shrine
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_23 # Yes!
		
		random_list = {
			25 = {
				character_event = { id = dragon.24 days = 1 } # Praying goes well - gain Zealous or a lot of piety
			}
			25 = {
				character_event = { id = dragon.25 days = 1 } # Praying goes well - gain some piety
			}
			25 = {
				character_event = { id = dragon.26 days = 1 } # Praying goes poorly - lose some piety
			}
			25 = {
				character_event = { id = dragon.27 days = 1 } # Praying goes poorly - gain Cynical or lose a lot of piety
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = cynical
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_23 # No!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = zealous
			}
		}
	}
}

# Praying goes extremely well
character_event = {
	id = dragon.24
	desc = EVTDESC_DRAGON_24
	picture = GFX_evt_tribal_shrine
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_24 # I will kill the dragon for Highgod!
		
		random_list = {
			50 = {
				piety = 50
			}
			50 = {
				modifier = {
					factor = 0
					trait = zealous
				}
				if = {
					limit = {
						NOT = {
							trait = cynical
						}
					}
					random = {
						chance = 50
						add_trait = zealous
					}
				}
				else = {
					random = {
						chance = 50
						remove_trait = zealous
					}
				}
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Praying goes well
character_event = {
	id = dragon.25
	desc = EVTDESC_DRAGON_25
	picture = GFX_evt_tribal_shrine
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_25 # That made me feel better
		
		piety = 15
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Praying goes poorly
character_event = {
	id = dragon.26
	desc = EVTDESC_DRAGON_26
	picture = GFX_evt_tribal_shrine
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_26 # This was a waste of time...
		
		piety = -15
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Praying goes extremely poorly
character_event = {
	id = dragon.27
	desc = EVTDESC_DRAGON_27
	picture = GFX_evt_tribal_shrine
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_26 # Highgod is dead!
		
		random_list = {
			50 = {
				piety = -50
			}
			50 = {
				modifier = {
					factor = 0
					trait = cynical
				}
				if = {
					limit = {
						NOT = {
							trait = zealous
						}
					}
					random = {
						chance = 50
						add_trait = cynical
					}
				}
				else = {
					random = {
						chance = 50
						remove_trait = zealous
					}
				}
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

### Tumbling opportunity

# Spot someone good-looking in a village - tumble?
character_event = {
	id = dragon.28
	desc = EVTDESC_DRAGON_28
	picture = GFX_evt_market
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		any_province = {
			limit = {
				has_province_flag = dragons_lair_province
			}
			random_province = {
				limit = {
					has_owner = yes
					NOT = {
						distance = {
							where = PREV
							value = 250
						}
					}
				}
				save_event_target_as = lover_province
			}
		}
		if = {
			limit = {
				is_female = no
				NOT = {
					trait = homosexual
				}
			}
			create_character = {
				age = 17
				female = yes
				dynasty = none
				culture = event_target:lover_province
				religion = event_target:lover_province
				random_traits = yes
				trait = fair
				trait = lustful
				trait = kind
				trait = charismatic_negotiator
				attributes = {
					intrigue = 5
					stewardship = 3
					learning = 1
					martial = 2
					diplomacy = 4
				}
			}
			new_character = {
				remove_trait = homosexual
			}
		}
		else_if = {
			limit = {
				is_female = yes
				trait = homosexual
			}
			create_character = {
				age = 17
				female = yes
				dynasty = none
				culture = event_target:lover_province
				religion = event_target:lover_province
				random_traits = yes
				trait = fair
				trait = lustful
				trait = kind
				trait = charismatic_negotiator
				trait = homosexual
				attributes = {
					intrigue = 5
					stewardship = 3
					learning = 1
					martial = 2
					diplomacy = 4
				}
			}
		}
		else_if = {
			limit = {
				is_female = yes
				trait = homosexual
			}
			create_character = {
				age = 17
				female = no
				dynasty = none
				culture = event_target:lover_province
				religion = event_target:lover_province
				random_traits = yes
				trait = fair
				trait = lustful
				trait = kind
				trait = charismatic_negotiator
				attributes = {
					intrigue = 5
					stewardship = 3
					learning = 1
					martial = 2
					diplomacy = 4
				}
			}
			new_character = {
				remove_trait = homosexual
			}
		}
		else_if = {
			limit = {
				is_female = no
				NOT = {
					trait = homosexual
				}
			}
			create_character = {
				age = 17
				female = no
				dynasty = none
				culture = event_target:lover_province
				religion = event_target:lover_province
				random_traits = yes
				trait = fair
				trait = lustful
				trait = kind
				trait = charismatic_negotiator
				trait = homosexual
				attributes = {
					intrigue = 5
					stewardship = 3
					learning = 1
					martial = 2
					diplomacy = 4
				}
			}
		}
		new_character = {
			save_event_target_as = potential_lover
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_28 # How about you and I...?
		character_event = { id = dragon.29 days = 1 }
		event_target:potential_lover = {
			save_event_target_as = sex_partner
			hidden_tooltip = {
				random = {
					chance = 5
					add_trait = lovers_pox # Hidden so that the player can't check it beforehand
				}
			}
		}
		unprotected_sex_effect_event_target = yes
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = chaste
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				any_spouse = {
					any_lover = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0
				any_consort = {
					any_lover = {
						character = ROOT
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_28 # I'll just be on my way...
		
		event_target:potential_lover = {
			leave_court_and_die_effect = yes
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Post-tumbling - recruit them as a dragonslayer, send them to your court, or send them away?
character_event = {
	id = dragon.29
	desc = EVTDESC_DRAGON_29
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_29 # You should come with me!
		
		event_target:potential_lover = {
			add_lover = ROOT
			add_trait = hunting_dragons
			opinion = {
				who = ROOT
				modifier = hunting_dragons_together
			}
			set_character_flag = dragonslayer_wannabe
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				event_target:potential_lover = {
					is_female = yes
				}
				ROOT = {
					NOR = {
						is_female = yes
						primary_title = {
							has_law = status_of_women_4
						}
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_equal
					}
				}
			}
			modifier = {
				factor = 0
				event_target:potential_lover = {
					is_female = no
				}
				ROOT = {
					NAND = {
						is_female = yes
						has_religion_feature = religion_matriarchal
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_29 # There's a place for you at in court
		
		event_target:potential_lover = {
			add_lover = ROOT
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				event_target:potential_lover = {
					is_female = no
				}
				ROOT = {
					is_female = yes
					has_religion_feature = religion_matriarchal
				}
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
	
	option = {
		name = EVTOPTC_DRAGON_29 # Silly boy/girl; this was just a one-time thing!
		
		event_target:potential_lover = {
			add_rival = ROOT
			hidden_tooltip = {
				remove_trait = kind
				add_trait = deceitful
				add_trait = cynical
			}
			leave_court_effect = yes
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
			modifier = {
				factor = 100
				trait = cruel
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

### Bandit attack

# Spot bandits - stop them, leave the area, or join them?
character_event = {
	id = dragon.30
	desc = EVTDESC_DRAGON_30
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_30 # Begone, foul knaves!
		
		random_list = {
			33 = {
				modifier = {
					factor = 0
					NOT = {
						martial = 8
					}
				}
				character_event = { id = dragon.31 days = 1 } # Fight goes well
			}
			34 = {
				character_event = { id = dragon.32 days = 1 } # Wounded
			}
			34 = {
				modifier = {
					factor = 0
					martial = 16
				}
				character_event = { id = dragon.33 days = 1 } # Maimed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 0
				trait = cruel # There's another, more fun, option...
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_30 # Time for me to leave...
		
		prestige = -25
		piety = -25
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
	
	option = {
		name = EVTOPTC_DRAGON_30 # I know a thing or two about raiding villages...
		
		random_list = {
			25 = {
				modifier = {
					factor = 0
					NOT = {
						martial = 8
					}
				}
				character_event = { id = dragon.34 days = 1 } # Fight goes well
			}
			25 = {
				character_event = { id = dragon.35 days = 1 } # Wounded
			}
			25 = {
				modifier = {
					factor = 0
					martial = 16
				}
				character_event = { id = dragon.36 days = 1 } # Maimed
			}
			25 = {
				modifier = {
					factor = 0
					martial = 12
				}
				character_event = { id = dragon.37 days = 1 } # Killed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 0
				NOT = {
					trait = cruel
				}
			}
			modifier = {
				factor = 0.1
				NOT = {
					trait = deceitful
				}
			}
		}
	}
}

# Fight bandits - everything goes well
character_event = {
	id = dragon.31
	desc = EVTDESC_DRAGON_31
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_31 # We sure showed them!
		
		prestige = 50
		piety = 50
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Fight bandits - wounded
character_event = {
	id = dragon.32
	desc = EVTDESC_DRAGON_32
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_32 # A difficult battle, to be sure, but we still won...
		
		prestige = 20
		piety = 20
		
		add_trait = wounded
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Fight bandits - maimed
character_event = {
	id = dragon.33
	desc = EVTDESC_DRAGON_33
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_33 # Ow!
		
		prestige = 10
		piety = 10
		
		add_maimed_trait_effect = yes
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Join bandits - everything goes well
character_event = {
	id = dragon.34
	desc = EVTDESC_DRAGON_34
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_34 # Look at them burn!
		
		prestige = 50
		piety = -50
		wealth = 50
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Join bandits - wounded
character_event = {
	id = dragon.35
	desc = EVTDESC_DRAGON_35
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_35 # Those wretched peasants dared to fight back?
		
		prestige = 25
		piety = -50
		wealth = 50
		
		add_trait = wounded
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Join bandits - maimed
character_event = {
	id = dragon.36
	desc = EVTDESC_DRAGON_36
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_36 # They dared to hurt ME?
		
		prestige = -25
		piety = -50
		wealth = 50
		
		add_maimed_trait_effect = yes
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Join bandits - killed
character_event = {
	id = dragon.37
	desc = EVTDESC_DRAGON_37
	picture = GFX_evt_bandits
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_37 # Not like this?
		
		prestige = -100
		piety = -50
		
		death = {
			death_reason = death_battle
		}
	}
}

### Legend - stay a while and listen?

# A wild storyteller appeared!
character_event = {
	id = dragon.38
	desc = EVTDESC_DRAGON_38
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_38 # Stay a while and listen
		
		random_list = {
			20 = {
				modifier = {
					factor = 0
					NOT = {
						learning = 8
					}
				}
				character_event = { id = dragon.39 days = 1 } # Actually good advice, and you know how to act on it!
			}
			20 = {
				modifier = {
					factor = 0
					learning = 12
				}
				character_event = { id = dragon.40 days = 1  } # Actually good advice, but you don't quite know how to act on it!
			}
			20 = {
				character_event = { id = dragon.41 days = 1  } # Just an interesting story
			}
			20 = {
				modifier = {
					factor = 0
					NOT = {
						learning = 4
					}
				}
				character_event = { id = dragon.42 days = 1  } # Terrible advice, and you catch on!
			}
			20 = {
				modifier = {
					factor = 0
					learning = 16
				}
				character_event = { id = dragon.43 days = 1  } # Terrible advice, and you don't catch on!
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					trait = patient
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_38 # Boring!
		
		prestige = -5
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = patient
			}
		}
	}
}

# Good advice - you know how to act on it!
character_event = {
	id = dragon.39
	desc = EVTDESC_DRAGON_39
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_39 # "Dont stand in the fire!"? Well, that seems simple enough...
		
		set_character_flag = dragonslayer_legend_great_advice
		prestige = 100
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Good advince - you don't know how to act on it!
character_event = {
	id = dragon.40
	desc = EVTDESC_DRAGON_40
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_40 # What do you mean, "Don't stand in the fire!"?
		
		set_character_flag = dragonslayer_legend_good_advice
		prestige = 25
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Just an interesting story
character_event = {
	id = dragon.41
	desc = EVTDESC_DRAGON_41
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_41 # Well, at least it wasn't boring...
		
		prestige = 10
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Bad advince - you catch on!
character_event = {
	id = dragon.42
	desc = EVTDESC_DRAGON_42
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_42 # I don't think "Stand in the fire!" is the right plan...
		
		set_character_flag = dragonslayer_legend_bad_advice
		prestige = -25
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Bad advice - you don't catch on!
character_event = {
	id = dragon.43
	desc = EVTDESC_DRAGON_43
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_43 # "Stand in the fire!"? Seems legit!
		
		set_character_flag = dragonslayer_legend_terrible_advice
		prestige = -100
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

### Disagreement with recruited dragonslayer

# You and one of your companions disagree about something - what do you do?
character_event = {
	id = dragon.44
	desc = EVTDESC_DRAGON_44
	picture = GFX_evt_poke_king_in_chest
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			diplomacy = 16
		}
		name = EVTOPTA_DRAGON_44 # Luckily I knew just what to say!
		
		prestige = 25
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
		}
	}
	
	option = {
		trigger = {
			NOT = {
				diplomacy = 16
			}
		}
		name = EVTOPTB_DRAGON_44 # Perhaps I phrased that poorly...
		
		random_list = {
			25 = {
				character_event = { id = dragon.45 days = 1 } # Smooth over the misunderstanding
			}
			50 = {
				character_event = { id = dragon.46 days = 1 } # Dragonslayer remains upset
			}
			25 = {
				character_event = { id = dragon.47 days = 1 } # Rivalry/end of friendship/stop being lovers
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = stubborn
			}
			modifier = {
				factor = 0
				trait = proud
			}
			modifier = {
				factor = 0
				trait = cruel
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				diplomacy = 16
			}
		}
		name = EVTOPTC_DRAGON_44 # Why don't you just leave?
		
		event_target:disagreement_target = {
			leave_court_effect = yes
			remove_trait = hunting_dragons
			remove_opinion = {
				who = ROOT
				modifier = hunting_dragons_together
			}
			if = {
				limit = {
					any_friend = {
						character = ROOT
					}
				}
				remove_friend = ROOT
			}
			if = {
				limit = {
					any_lover = {
						character = ROOT
					}
				}
				remove_lover = ROOT
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = humble
			}
		}
	}
}

# You smooth things over
character_event = {
	id = dragon.45
	desc = EVTDESC_DRAGON_45
	picture = GFX_evt_rider_adventure # Might be worth replacing if there are better options
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_45 # Good enough...
		
		prestige = 10
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Things get a little better
character_event = {
	id = dragon.46
	desc = EVTDESC_DRAGON_46
	picture = GFX_evt_bad_news
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_46 # Let's just put this behind us...
		
		prestige = -10
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Things don't go exactly as planned
character_event = {
	id = dragon.47
	desc = EVTDESC_DRAGON_47
	picture = GFX_evt_poke_king_in_chest
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_47 # I hate you too!
		
		prestige = -25
		if = {
			limit = {
				event_target:disagreement_target = {
					NOR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
			event_target:disagreement_target = {
				add_rival = ROOT
			}
		}
		else_if = {
			limit = {
				event_target:disagreement_target = {
					any_friend = {
						character = ROOT
					}
				}
			}
			event_target:disagreement_target = {
				remove_friend = ROOT
			}
		}
		else = {
			event_target:disagreement_target = {
				remove_lover = ROOT
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

### Budding friendship

# You and one of your companions are becoming friends
character_event = {
	id = dragon.48
	desc = EVTDESC_DRAGON_48
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_48 # We shall fight side by side!
		
		prestige = 10
		
		event_target:friendship_target = {
			add_friend = ROOT
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

### Tumbling (and potential romance)

# Attracted to a companion - attempt to tumble?
character_event = {
	id = dragon.49
	desc = EVTDESC_DRAGON_49
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_49 # How about you sleep in my tent tonight?
		
		event_target:lover_target = {
			character_event = { id = dragon.50 } # Potential tumble target gets to respond
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = chaste
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				any_spouse = {
					any_lover = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0
				any_consort = {
					any_lover = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0
				event_target:lover_target = {
					is_unattractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_49 # Best not to risk it...
		
		piety = 10
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
			modifier = {
				factor = 0.1
				event_target:lover_target = {
					is_attractive_trigger = yes
				}
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Potential tumble target gets notified
character_event = {
	id = dragon.50
	desc = EVTDESC_DRAGON_50
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_50 # I don't see either of us doing a lot of sleeping...
		
		event_target:potential_lover = {
			save_event_target_as = sex_partner
		}
		unprotected_sex_effect_event_target = yes
		
		FROM = {
			character_event = { id = dragon.51 days = 1 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = chaste
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				any_spouse = {
					any_lover = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0
				any_consort = {
					any_lover = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					is_unattractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_50 # I don't think so...
		
		piety = 10
		
		FROM = {
			character_event = { id = dragon.54 days = 1 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = lustful
			}
			modifier = {
				factor = 0.1
				FROM = {
					is_attractive_trigger = yes
				}
			}
		}
	}
}

# Tumbling - what's next?
character_event = {
	id = dragon.51
	desc = EVTDESC_DRAGON_51
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_51 # This must be love!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		add_lover = FROM
		
		FROM = {
			character_event = { id = dragon.52 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = proud
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_51 # I don't think it'll happen again...
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		FROM = {
			character_event = { id = dragon.53 } # Inform FROM
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = humble
			}
			modifier = {
				factor = 10
				trait = cruel
			}
		}
	}
}

# Tumbled - lovers
character_event = {
	id = dragon.52
	desc = EVTDESC_DRAGON_52
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_52 # This must be love!
		
		add_lover = FROM
	}
}

# Tumbled - not lovers
character_event = {
	id = dragon.53
	desc = EVTDESC_DRAGON_53
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_53 # If you change your mind, you know where to find me...
	}
}

# Rebuffed
character_event = {
	id = dragon.54
	desc = EVTDESC_DRAGON_54
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_54 # Women!/Men!
		
		prestige = -25
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

### An offer from the Queen of Air and Darkness

# The offer is made
narrative_event = {
	id = dragon.55
	title = EVTTITLE_DRAGON_55
	picture = GFX_evt_campfire_hf
	border = GFX_event_narrative_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		# Set up the price
		random_list = {
			20 = {
				# Memories
				modifier = {
					factor = 0
					OR = {
						trait = naive_appeaser
						trait = misguided_warrior
						trait = indulgent_wastrel
						trait = amateurish_plotter
						trait = detached_priest
					}
				}
				set_character_flag = mabs_price_memories
			}
			20 = {
				# An artifact
				modifier = {
					factor = 0
					NOT = {
						any_artifact = {
							NOT = {
								has_flag = dragonslayer
							}
							is_indestructible = no
						}
					}
				}
				random_artifact = {
					limit = {
						NOT = {
							has_flag = dragonslayer
						}
						is_indestructible = no
					}
					save_event_target_as = mabs_price_artifact
				}
				set_character_flag = mabs_price_artifact
			}
			20 = {
				# Your firstborn
				modifier = {
					factor = 0
					NOT = {
						any_character = {
							ai = yes
							is_adult = no
							is_alive = yes
							OR = {
								mother = {
									character = ROOT
								}
								real_father = {
									character = ROOT
								}
							}
						}
					}
				}
				random_character = {
					limit = {
						ai = yes
						is_adult = no
						is_alive = yes
						OR = {
							mother = {
								character = ROOT
							}
							real_father = {
								character = ROOT
							}
						}
						NOT = {
							any_character = {
								is_older_than = PREV
								is_alive = yes
								OR = {
									mother = {
										character = ROOT
									}
									real_father = {
										character = ROOT
									}
								}
							}
						}
					}
					save_event_target_as = mabs_price_firstborn
				}
				set_character_flag = mabs_price_firstborn
			}
			20 = {
				# A few years off of your life
				modifier = {
					factor = 0
					NOT = {
						health = 5
					}
				}
				set_character_flag = mabs_price_health
			}
			20 = {
				# A lover
				modifier = {
					factor = 0
					NOT = {
						any_lover = {
							ai = yes
						}
					}
				}
				random_lover = {
					limit = {
						ai = yes
					}
					save_event_target_as = mabs_price_lover
				}
				set_character_flag = mabs_price_lover
			}
		}
	}
	
	desc = {
		trigger = {
			has_character_flag = mabs_price_memories
		}
		text = EVTDESC_DRAGON_55_A
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_artifact
		}
		text = EVTDESC_DRAGON_55_B
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_firstborn
		}
		text = EVTDESC_DRAGON_55_C
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_health
		}
		text = EVTDESC_DRAGON_55_D
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_lover
		}
		text = EVTDESC_DRAGON_55_E
	}
	
	option = {
		name = EVTOPTA_DRAGON_55 # No, thank you!
		
		character_event = { id = dragon.56 } # Again I will ask...
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					has_character_flag = mabs_price_firstborn
					has_character_flag = mabs_price_lover
				}
				OR = {
					trait = cruel
					trait = deceitful
				}
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_artifact
				trait = charitable
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_memories
				trait = scholar
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_health
				trait = physician
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_55 # This seems like a good deal!
		
		character_event = { id = dragon.59 } # Done, done, and done!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				has_global_flag = dragon_slain # You don't need any power...
			}
			modifier = {
				factor = 0
				OR = {
					has_character_flag = mabs_price_firstborn
					has_character_flag = mabs_price_lover
				}
				NOR = {
					trait = cruel
					trait = deceitful
				}
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_artifact
				trait = greedy
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_memories
				is_dumb_trigger = yes
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_health
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		name = EVTOPTC_DRAGON_55 # BE GONE!
		
		custom_tooltip = {
			text = DRAW_STEEL
		}
		
		character_event = { id = dragon.60 } # You would wield cold iron (or steel) against MAB? FOOL!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					trait = wroth
				}
			}
		}
	}
}

# Again I will ask...
character_event = {
	id = dragon.56
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	desc = {
		trigger = {
			has_character_flag = mabs_price_memories
		}
		text = EVTDESC_DRAGON_56_A
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_artifact
		}
		text = EVTDESC_DRAGON_56_B
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_firstborn
		}
		text = EVTDESC_DRAGON_56_C
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_health
		}
		text = EVTDESC_DRAGON_56_D
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_lover
		}
		text = EVTDESC_DRAGON_56_E
	}
	
	option = {
		name = EVTOPTA_DRAGON_56 # Still not interested!
		
		character_event = { id = dragon.57 } # Thrice I ask and done...
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					has_character_flag = mabs_price_firstborn
					has_character_flag = mabs_price_lover
				}
				OR = {
					trait = cruel
					trait = deceitful
				}
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_artifact
				trait = charitable
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_memories
				trait = scholar
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_health
				trait = physician
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_55 # On second thought...
		
		character_event = { id = dragon.59 } # Done, done, and done!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				has_global_flag = dragon_slain # You don't need any power...
			}
			modifier = {
				factor = 0
				OR = {
					has_character_flag = mabs_price_firstborn
					has_character_flag = mabs_price_lover
				}
				NOR = {
					trait = cruel
					trait = deceitful
				}
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_artifact
				trait = greedy
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_memories
				is_dumb_trigger = yes
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_health
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		name = EVTOPTC_DRAGON_55 # BE GONE!
		
		custom_tooltip = {
			text = DRAW_STEEL
		}
		
		character_event = { id = dragon.60 } # You would wield cold iron (or steel) against MAB? FOOL!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					trait = wroth
				}
			}
		}
	}
}

# Thrice I ask and done...
character_event = {
	id = dragon.57
	picture = GFX_evt_campfire_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	desc = {
		trigger = {
			has_character_flag = mabs_price_memories
		}
		text = EVTDESC_DRAGON_57_A
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_artifact
		}
		text = EVTDESC_DRAGON_57_B
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_firstborn
		}
		text = EVTDESC_DRAGON_57_C
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_health
		}
		text = EVTDESC_DRAGON_57_D
	}
	desc = {
		trigger = {
			has_character_flag = mabs_price_lover
		}
		text = EVTDESC_DRAGON_57_E
	}
	
	option = {
		name = EVTOPTA_DRAGON_57 # And thrice I shall refuse!
		
		character_event = { id = dragon.58 } # You have treated fairly; good luck on your journey!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					has_character_flag = mabs_price_firstborn
					has_character_flag = mabs_price_lover
				}
				OR = {
					trait = cruel
					trait = deceitful
				}
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_artifact
				trait = charitable
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_memories
				trait = scholar
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_health
				trait = physician
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_57 # Well, if you insist...
		
		character_event = { id = dragon.59 } # Done, done, and done!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				has_global_flag = dragon_slain # You don't need any power...
			}
			modifier = {
				factor = 0
				OR = {
					has_character_flag = mabs_price_firstborn
					has_character_flag = mabs_price_lover
				}
				NOR = {
					trait = cruel
					trait = deceitful
				}
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_artifact
				trait = greedy
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_memories
				is_dumb_trigger = yes
			}
			modifier = {
				factor = 0
				has_character_flag = mabs_price_health
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		name = EVTOPTC_DRAGON_55 # BE GONE!
		
		custom_tooltip = {
			text = DRAW_STEEL
		}
		
		character_event = { id = dragon.60 } # You would wield cold iron (or steel) against MAB? FOOL!
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					trait = wroth
				}
			}
		}
	}
}

# Refused thrice
character_event = {
	id = dragon.58
	desc = EVTDESC_DRAGON_58
	picture = GFX_evt_matriarchy_throne_room
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_58 # I hope she won't return tomorrow...
		
		prestige = 100
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# The price is paid
character_event = {
	id = dragon.59
	desc = EVTDESC_DRAGON_59
	picture = GFX_evt_matriarchy_throne_room
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_59 # This had better be worth it!
		
		set_character_flag = mabs_boon
		if = {
			limit = {
				has_character_flag = mabs_price_memories
			}
			# Diplomacy
			if = {
				limit = {
					trait = grey_eminence
				}
				remove_trait = grey_eminence
				add_trait = charismatic_negotiator
			}
			else_if = {
				limit = {
					trait = charismatic_negotiator
				}
				remove_trait = charismatic_negotiator
				add_trait = underhanded_rogue
			}
			else_if = {
				limit = {
					trait = underhanded_rogue
				}
				remove_trait = underhanded_rogue
				add_trait = naive_appeaser
			}
			# Martial
			else_if = {
				limit = {
					trait = brilliant_strategist
				}
				remove_trait = brilliant_strategist
				add_trait = skilled_tactician
			}
			else_if = {
				limit = {
					trait = skilled_tactician
				}
				remove_trait = skilled_tactician
				add_trait = tough_soldier
			}
			else_if = {
				limit = {
					trait = tough_soldier
				}
				remove_trait = tough_soldier
				add_trait = misguided_warrior
			}
			# Stewardship
			else_if = {
				limit = {
					trait = midas_touched
				}
				remove_trait = midas_touched
				add_trait = fortune_builder
			}
			else_if = {
				limit = {
					trait = fortune_builder
				}
				remove_trait = fortune_builder
				add_trait = thrifty_clerk
			}
			else_if = {
				limit = {
					trait = thrifty_clerk
				}
				remove_trait = thrifty_clerk
				add_trait = indulgent_wastrel
			}
			# Intrigue
			else_if = {
				limit = {
					trait = elusive_shadow
				}
				remove_trait = elusive_shadow
				add_trait = intricate_webweaver
			}
			else_if = {
				limit = {
					trait = intricate_webweaver
				}
				remove_trait = intricate_webweaver
				add_trait = flamboyant_schemer
			}
			else_if = {
				limit = {
					trait = flamboyant_schemer
				}
				remove_trait = flamboyant_schemer
				add_trait = amateurish_plotter
			}
			# Learning
			else_if = {
				limit = {
					trait = mastermind_theologian
				}
				remove_trait = mastermind_theologian
				add_trait = scholarly_theologian
			}
			else_if = {
				limit = {
					trait = scholarly_theologian
				}
				remove_trait = scholarly_theologian
				add_trait = martial_cleric
			}
			else_if = {
				limit = {
					trait = martial_cleric
				}
				remove_trait = martial_cleric
				add_trait = detached_priest
			}
		}
		else_if = {
			limit = {
				has_character_flag = mabs_price_artifact
			}
			event_target:mabs_price_artifact = {
				destroy_artifact = yes
			}
		}
		else_if = {
			limit = {
				has_character_flag = mabs_price_firstborn
			}
			event_target:mabs_price_firstborn = {
				death = {
					death_reason = death_missing
				}
			}
		}
		else_if = {
			limit = {
				has_character_flag = mabs_price_health
			}
			health = -2
		}
		else_if = {
			limit = {
				has_character_flag = mabs_price_lover
			}
			event_target:mabs_price_lover = {
				death = {
					death_reason = death_missing
				}
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Steel is drawn
character_event = {
	id = dragon.60
	desc = EVTDESC_DRAGON_60
	picture = GFX_evt_matriarchy_throne_room
	border = GFX_event_normal_frame_intrigue

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_60 # That felt... odd...
		
		set_character_flag = mabs_curse
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

### Devastation

# Is it time to turn around?
character_event = {
	id = dragon.61
	desc = EVTDESC_DRAGON_61
	picture = GFX_evt_burning_house
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_61 # I must continue!
		
		prestige = 50
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					trait = brave
				}
			}
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_61 # I should turn back...
		
		prestige = -50
		
		custom_tooltip = {
			text = RETURN_HOME
		}
		
		character_event = { id = dragon.184 } # Flag cleanup
		character_event = { id = dragon.185 days = 90 random = 30 } # Return home
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					trait = craven
				}
			}
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

### Dodecahedron

# Spot the dodecahedron - approach or leave
character_event = {
	id = dragon.62
	desc = EVTDESC_DRAGON_62
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_62 # Approach it!
		
		random_list = {
			25 = {
				modifier = {
					factor = 0
					intrigue = 16
				}
				modifier = {
					factor = 0.5
					trait = gamer
				}
				character_event = { id = dragon.63 days = 1 } # Step on something triangular
			}
			50 = {
				character_event = { id = dragon.64 days = 1 } # Hooded stranger
			}
			25 = {
				modifier = {
					factor = 2
					trait = gamer
				}
				character_event = { id = dragon.72 days = 1 } # Dodecahedron is unattended
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = craven
			}
			modifier = {
				factor = 0
				trait = paranoid
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_62 # This could be a trap of some kind...
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = scholar
			}
			modifier = {
				factor = 0
				trait = gamer
			}
		}
	}
}

# Take 1d4 damage to your foot!
character_event = {
	id = dragon.63
	desc = EVTDESC_DRAGON_63
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_63 # Ow!
		
		add_trait = wounded
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Hooded stranger - reason with them, fight them, or leave?
character_event = {
	id = dragon.64
	desc = EVTDESC_DRAGON_64
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_64 # Surely a quick look couldn't hurt?
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						diplomacy = 16
					}
				}
				modifier = {
					factor = 0.1
					NOT = {
						diplomacy = 20
					}
				}
				character_event = { id = dragon.65 days = 1 }
			}
			50 = {
				character_event = { id = dragon.66 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = gregarious
			}
			modifier = {
				factor = 0
				trait = shy
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_64 # You shall not stop me!
		
		random_list = {
			25 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 50 # What are you even doing on here?
					}
				}
				character_event = { id = dragon.67 days = 1 } # Win, and get the dodecahedron
			}
			25 = {
				modifier = {
					factor = 0.1
					NOT = {
						combat_rating = 25 # What are you even doing on here?
					}
				}
				character_event = { id = dragon.69 days = 1 } # Wounded, no dodecahedron
			}
			25 = {
				modifier = {
					factor = 0.1
					combat_rating = 50
				}
				character_event = { id = dragon.70 days = 1 } # Maimed, no dodecahedron
			}
			25 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 50 # What are you even doing on here?
					}
				}
				character_event = { id = dragon.71 days = 1 } # Killed, obviously no dodecahedron
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = wroth
			}
			modifier = {
				factor = 0
				trait = kind
			}
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTC_DRAGON_64 # Sorry to have bothered you!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# You convince them
character_event = {
	id = dragon.65
	desc = EVTDESC_DRAGON_65
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_65 # Such power!
		
		prestige = 25
		
		set_character_flag = fragment_of_possibility # Extremely good!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
	}
}

# They insist that you leave - comply or fight?
character_event = {
	id = dragon.66
	desc = EVTDESC_DRAGON_66
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_66 # You shall not stop me!
		
		random_list = {
			25 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 50 # What are you even doing on here?
					}
				}
				character_event = { id = dragon.68 days = 1 } # Win, but no dodecahedron
			}
			25 = {
				modifier = {
					factor = 0.1
					NOT = {
						combat_rating = 25 # What are you even doing on here?
					}
				}
				character_event = { id = dragon.69 days = 1 } # Wounded, no dodecahedron
			}
			25 = {
				modifier = {
					factor = 0.1
					combat_rating = 50
				}
				character_event = { id = dragon.70 days = 1 } # Maimed, no dodecahedron
			}
			25 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 50 # What are you even doing on here?
					}
				}
				character_event = { id = dragon.71 days = 1 } # Killed, obviously no dodecahedron
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 10
				trait = wroth
			}
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_66 # Sorry to have bothered you!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Fight goes well
character_event = {
	id = dragon.67
	desc = EVTDESC_DRAGON_67
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_67 # Such power!
		
		prestige = 50
		
		set_character_flag = fragment_of_possibility # Extremely good!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
	}
}

# Fight goes well, but no dodecahedron
character_event = {
	id = dragon.68
	desc = EVTDESC_DRAGON_68
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_68 # At least I prevailed...
		
		prestige = 25
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
	}
}

# Fight goes poorly - wounded
character_event = {
	id = dragon.69
	desc = EVTDESC_DRAGON_69
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_69 # Ow!
		
		prestige = -10
		add_trait = wounded
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
	}
}

# Fight goes poorly - maimed
character_event = {
	id = dragon.70
	desc = EVTDESC_DRAGON_70
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_70 # Curses!
		
		prestige = -25
		add_maimed_trait_effect = yes
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
	}
}

# Fight goes poorly - killed
character_event = {
	id = dragon.71
	desc = EVTDESC_DRAGON_71
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_71 # This encounter was poorly designed!
		
		prestige = -50
		
		death = {
			death_reason = death_battle
		}
	}
}

# Dodecahedron unattended
character_event = {
	id = dragon.72
	desc = EVTDESC_DRAGON_72
	picture = GFX_evt_powerful_tower
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_72 # Such power!
		
		prestige = 25
		
		set_character_flag = fragment_of_possibility # Extremely good!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
	}
}

### Assassin

# Attempt to assassinate FROM?
character_event = {
	id = dragon.73
	desc = EVTDESC_DRAGON_73
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_73 # Yes!		
		
		piety = -50
		wealth = -100
		
		random_list = {
			33 = {
				modifier = {
					factor = 0
					FROM = {
						intrigue = 24
					}
				}
				modifier = {
					factor = 0.1
					FROM = {
						intrigue = 20
					}
				}
				modifier = {
					factor = 0.5
					FROM = {
						intrigue = 16
					}
				}
				modifier = {
					factor = 2
					FROM = {
						NOT = {
							intrigue = 8
						}
					}
				}
				modifier = {
					factor = 2
					FROM = {
						NOT = {
							intrigue = 4
						}
					}
				}
				random_list = {
					50 = {
						FROM = {
							character_event = { id = dragon.74 days = 1 } # Killed by assassin, unknown sender
						}
					}
					50 = {
						FROM = {
							character_event = { id = dragon.75 days = 1 } # Killed by assassin, known sender
						}
					}
				}
			}
			34 = {
				random_list = {
					33 = {
						FROM = {
							character_event = { id = dragon.77 days = 1 } # Wounded by assassin, assassin escapes
						}
					}
					34 = {
						FROM = {
							character_event = { id = dragon.79 days = 1 } # Wounded by assassin, assassin dies
						}
					}
					33 = {
						FROM = {
							character_event = { id = dragon.81 days = 1 } # Wounded by assassin, assassin talks before dying
						}
					}
				}
			}
			33 = {
				modifier = {
					factor = 5
					FROM = {
						intrigue = 20
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 20
					}
				}
				modifier = {
					factor = 2
					FROM = {
						intrigue = 16
					}
				}
				modifier = {
					factor = 0.5
					FROM = {
						NOT = {
							intrigue = 8
						}
					}
				}
				modifier = {
					factor = 0
					FROM = {
						NOT = {
							intrigue = 4
						}
					}
				}
				random_list = {
					50 = {
						FROM = {
							character_event = { id = dragon.83 days = 1 } # Kills assassin, no clue about sender
						}
					}
					50 = {
						FROM = {
							character_event = { id = dragon.85 days = 1 } # Kills assassin, discovers sender
						}
					}
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = honest
					trait = kind
					trait = just
				}
				NOR = {
					trait = deceitful
					trait = cruel
					trait = arbitrary
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_73 # No!
		
		piety = 50
		prestige = -50
		
		FROM = {
			hidden_tooltip = {
				change_variable = {
					which = dragons_lair_travel_progress
					value = 1
				}
				character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = honest
					trait = kind
					trait = just
				}
				OR = {
					trait = deceitful
					trait = cruel
					trait = arbitrary
				}
			}
		}
	}
}

# Attacked by assassin - killed
character_event = {
	id = dragon.74
	desc = EVTDESC_DRAGON_74
	picture = GFX_evt_slit_throat_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_74 # So it ends...
		
		death = {
			death_reason = death_murder_unknown
			killer = FROM
		}
		
		FROM = {
			character_event = { id = dragon.76 } # Inform the sender
		}
	}
}

# Killed by assassin - assassin reveals the sender
character_event = {
	id = dragon.75
	desc = EVTDESC_DRAGON_75
	picture = GFX_evt_slit_throat_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_75 # Avenge me!
		
		death = {
			death_reason = death_murder
			killer = FROM
		}
		
		if = {
			limit = {
				FROM = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
			}
			if = {
				limit = {
					is_chinese_emperor_trigger = yes
				}
				FROM = {
					detract_grace_super_huge_effect = yes
				}
			}
			else_if = {
				limit = {
					any_close_relative = {
						dynasty = PREV
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_massive_effect = yes
				}
			}
			else_if = {
				limit = {
					any_dynasty_member = {
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_major_effect = yes
				}
			}
		}
		
		FROM = {
			character_event = { id = dragon.76 } # Inform the sender
		}
	}
}

# FROM died - inform the sender - clean up loose ends?
character_event = {
	id = dragon.76
	desc = EVTDESC_DRAGON_76
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_76 # You've served your purpose!
		
		prestige = -50
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = deceitful
					trait = arbitrary
					trait = cruel
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_76 # And here's the second half!
		
		prestige = 50
		wealth = -100
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = deceitful
					trait = arbitrary
					trait = cruel
				}
			}
		}
	}
}

# Attacked by assassin - wounded, assassin escapes
character_event = {
	id = dragon.77
	desc = EVTDESC_DRAGON_77
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_77 # Who could have sent them?
		
		add_trait = wounded
		
		FROM = {
			character_event = { id = dragon.78 } # Inform the sender
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Assassin reports back - clean up loose ends?
character_event = {
	id = dragon.78
	desc = EVTDESC_DRAGON_78
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_78 # You've failed me for the last time!
		
		prestige = 25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOR = {
					trait = deceitful
					trait = arbitrary
					trait = cruel
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_78 # You disappoint me!
		
		prestige = -25
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = deceitful
					trait = arbitrary
					trait = cruel
				}
			}
		}
	}
}

# Attacked by assasin - wounded, assassin dies without talking
character_event = {
	id = dragon.79
	desc = EVTDESC_DRAGON_79
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_79 # Who could have sent them?
		
		add_trait = wounded
		
		FROM = {
			character_event = { id = dragon.80 } # Inform the sender
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Assassin fails to report back, learn that FROM was wounded
character_event = {
	id = dragon.80
	desc = EVTDESC_DRAGON_80
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_80 # At least my involvement remains secret!
	}
}

# Attacked by assassin - wounded, assassin talks
character_event = {
	id = dragon.81
	desc = EVTDESC_DRAGON_81
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_81 # It was YOU!
		
		add_trait = wounded
		
		opinion = {
			who = FROM
			modifier = attempted_murder
		}
		
		if = {
			limit = {
				FROM = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
			}
			if = {
				limit = {
					is_chinese_emperor_trigger = yes
				}
				FROM = {
					detract_grace_super_huge_effect = yes
				}
			}
			else_if = {
				limit = {
					any_close_relative = {
						dynasty = PREV
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_massive_effect = yes
				}
			}
			else_if = {
				limit = {
					any_dynasty_member = {
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_major_effect = yes
				}
			}
		}
		
		FROM = {
			character_event = { id = dragon.82 } # Inform the sender
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Assassin fails to report back, learn that FROM was wounded and learned who sent the assassin
character_event = {
	id = dragon.82
	desc = EVTDESC_DRAGON_82
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_82 # Incompetent fool!
		
		prestige = -50
	}
}

# Assassin killed - unclear sender
character_event = {
	id = dragon.83
	desc = EVTDESC_DRAGON_83
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_83 # Who could have sent them?
		
		FROM = {
			character_event = { id = dragon.84 } # Inform the sender
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Assassin fails to report back, learn that FROM wasn't wounded
character_event = {
	id = dragon.84
	desc = EVTDESC_DRAGON_84
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_84 # At least my involvement remains secret!
	}
}

# Assassin killed - reveals who sent them
character_event = {
	id = dragon.85
	desc = EVTDESC_DRAGON_85
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_85 # It was YOU!
		
		opinion = {
			who = FROM
			modifier = attempted_murder
		}
		
		if = {
			limit = {
				FROM = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
			}
			if = {
				limit = {
					is_chinese_emperor_trigger = yes
				}
				FROM = {
					detract_grace_super_huge_effect = yes
				}
			}
			else_if = {
				limit = {
					any_close_relative = {
						dynasty = PREV
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_massive_effect = yes
				}
			}
			else_if = {
				limit = {
					any_dynasty_member = {
						is_chinese_emperor_trigger = yes
					}
				}
				FROM = {
					detract_grace_major_effect = yes
				}
			}
		}
		
		FROM = {
			character_event = { id = dragon.86 } # Inform the sender
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Assassin fails to report back, learn that FROM wasn't wounded and learned who sent the assassin
character_event = {
	id = dragon.86
	desc = EVTDESC_DRAGON_86
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_86 # Incompetent fool!
		
		prestige = -50
	}
}

### Old ruins

# Discovers entrance to old ruins - enter them?
character_event = {
	id = dragon.87
	desc = EVTDESC_DRAGON_87
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_87 # Investigate the ruins
		
		character_event = { id = dragon.88 } # Select first obstacle
	}
	
	option = {
		name = EVTOPTB_DRAGON_87 # This is an unnecessary delay...
		
		prestige = -10
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = patient
			}
			modifier = {
				factor = 0.1
				trait = scholar
			}
		}
	}
}

# First obstacle selection
character_event = {
	id = dragon.88
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			33 = {
				character_event = { id = dragon.89 days = 1 } # Puzzle door
			}
			34 = {
				character_event = { id = dragon.93 days = 1 } # Bandits
			}
			33 = {
				character_event = { id = dragon.98 days = 1 } # Rock fall trap
			}
		}
	}
}

# Ruins - puzzle door (learning)
character_event = {
	id = dragon.89
	desc = EVTDESC_DRAGON_89
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_89 # Pick a random configuration and hope for the best
		
		random_list = {
			10 = {
				character_event = { id = dragon.90 days = 1 }
				modifier = {
					factor = 2
					learning = 12
				}
				modifier = {
					factor = 2
					learning = 16
				}
			}
			90 = {
				character_event = { id = dragon.92 days = 1 }
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				learning = 15
			}
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		trigger = {
			learning = 20
		}
		
		name = EVTOPTB_DRAGON_89 # Inspect the key
		
		character_event = { id = dragon.91 days = 1 }
	}
	
	option = {
		name = EVTOPTC_DRAGON_89 # Leave the ruins
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				learning = 15
			}
			modifier = {
				factor = 0.1
				trait = ambitious
			}
			modifier = {
				factor = 0.1
				trait = brave
			}
		}
	}
}

# Got past the door
character_event = {
	id = dragon.90
	desc = EVTDESC_DRAGON_90
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_90 # A lucky guess, but it worked!
		
		prestige = 10
		
		character_event = { id = dragon.103 } # Second obstacle selection
	}
}
	
# Got past the door - high learning
character_event = {
	id = dragon.91
	desc = EVTDESC_DRAGON_91
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_91 # Who puts the solution on the key?
		
		prestige = 50
		
		character_event = { id = dragon.103 } # Second obstacle selection
	}
}

# Wounded, time to withdraw
character_event = {
	id = dragon.92
	desc = EVTDESC_DRAGON_92
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_92 # I can't risk getting injured again...
		
		add_trait = wounded
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Ruins - bandits (combat_rating)
character_event = {
	id = dragon.93
	desc = EVTDESC_DRAGON_93
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_93 # I can deal with some bandits!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25 # Why are you even here?
					}
				}
				character_event = { id = dragon.94 days = 1 } # Deafeated the bandits with ease
			}
			25 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = dragon.95 days = 1 } # Deafeated the bandits but got wounded
			}
			10 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = dragon.96 days = 1 } # Defeated the bandits but got maimed - can't continue
			}
			5 = {
				modifier = {
					factor = 0
					combat_rating = 25
				}
				character_event = { id = dragon.97 days = 1 } # Killed by the bandits
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_93 # This is too risky...
		
		prestige = -10
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}	
}

# Got past the bandits
character_event = {
	id = dragon.94
	desc = EVTDESC_DRAGON_94
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_94 # Victory is mine!
		
		prestige = 50
		
		character_event = { id = dragon.103 } # Second obstacle selection
	}
}

# Wounded, but can continue
character_event = {
	id = dragon.95
	desc = EVTDESC_DRAGON_95
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_95 # A difficult battle, but I still won!
		
		prestige = 25
		
		add_trait = wounded
		
		character_event = { id = dragon.103 } # Second obstacle selection
	}
}

# Maimed, time to withdraw
character_event = {
	id = dragon.96
	desc = EVTDESC_DRAGON_96
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_96 # I must withdraw...
		
		prestige = -5
		
		add_maimed_trait_effect = yes
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Killed
character_event = {
	id = dragon.97
	desc = EVTDESC_DRAGON_97
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_97 # Not like this!
		
		prestige = -50
		
		death = {
			death_reason = death_battle
		}
	}
}

# Ruins - rock fall trap (intrigue)
character_event = {
	id = dragon.98
	desc = EVTDESC_DRAGON_98
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_98 # Onwards!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						intrigue = 12
					}
				}
				character_event = { id = dragon.99 days = 1 } # Spot the trap
			}
			25 = {
				modifier = {
					factor = 0
					intrigue = 20
				}
				character_event = { id = dragon.100 days = 1 } # Wounded by trap
			}
			10 = {
				modifier = {
					factor = 0
					intrigue = 12
				}
				character_event = { id = dragon.101 days = 1 } # Maimed by trap - can't continue
			}
			5 = {
				modifier = {
					factor = 0
					intrigue = 16
				}
				character_event = { id = dragon.102 days = 1 } # Killed by trap
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_98 # This is too risky...
		
		prestige = -10
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}	
}

# Got past the trap
character_event = {
	id = dragon.99
	desc = EVTDESC_DRAGON_99
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_99 # Child's play!
		
		prestige = 50
		
		character_event = { id = dragon.103 } # Second obstacle selection
	}
}

# Wounded, but can continue
character_event = {
	id = dragon.100
	desc = EVTDESC_DRAGON_100
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_100 # Clever, but not clever enough!
		
		prestige = 25
		
		add_trait = wounded
		
		character_event = { id = dragon.103 } # Second obstacle selection
	}
}

# Maimed, time to withdraw
character_event = {
	id = dragon.101
	desc = EVTDESC_DRAGON_101
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_101 # I must withdraw...
		
		prestige = -5
		
		add_maimed_trait_effect = yes
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Killed
character_event = {
	id = dragon.102
	desc = EVTDESC_DRAGON_102
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_102 # Not like this!
		
		prestige = -50
		
		death = {
			death_reason = death_accident
		}
	}
}

# Second obstacle selection
character_event = {
	id = dragon.103
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			33 = {
				character_event = { id = dragon.104 days = 1 } # Rotating symbols
			}
			34 = {
				character_event = { id = dragon.108 days = 1 } # Swinging blades
			}
			33 = {
				character_event = { id = dragon.112 days = 1 } # Safe spots
			}
		}
	}
}

# Ruins - rotating symbols (learning)
character_event = {
	id = dragon.104
	desc = EVTDESC_DRAGON_104
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_104 # Pick a random configuration and hope for the best
		
		random_list = {
			10 = {
				character_event = { id = dragon.105 days = 1 } # It works
				modifier = {
					factor = 2
					learning = 12
				}
				modifier = {
					factor = 2
					learning = 16
				}
			}
			90 = {
				character_event = { id = dragon.107 days = 1 } # It doesn't work
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				learning = 15
			}
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		trigger = {
			learning = 20
		}
		
		name = EVTOPTB_DRAGON_104 # Inspect the walls
		
		character_event = { id = dragon.106 days = 1 } # You spot the solution
	}
	
	option = {
		name = EVTOPTC_DRAGON_104 # Leave the ruins
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				learning = 15
			}
			modifier = {
				factor = 0.1
				trait = ambitious
			}
			modifier = {
				factor = 0.1
				trait = brave
			}
		}
	}
}

# Got past the door
character_event = {
	id = dragon.105
	desc = EVTDESC_DRAGON_105
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_105 # A lucky guess!
		
		prestige = 10
		
		character_event = { id = dragon.115 days = 1 } # The final room
	}
}

# Got past the door - high learning
character_event = {
	id = dragon.106
	desc = EVTDESC_DRAGON_106
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_106 # These people need to work on their puzzles...
		
		prestige = 50
		
		character_event = { id = dragon.115 days = 1 } # The final room
	}
}

# Wounded, time to withdraw
character_event = {
	id = dragon.107
	desc = EVTDESC_DRAGON_107
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_107 # I can't risk getting injured again...
		
		add_trait = wounded
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Ruins - swinging blades (combat rating)
character_event = {
	id = dragon.108
	desc = EVTDESC_DRAGON_108
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_108 # I think I see the way through!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25 # Why are you even here?
					}
				}
				character_event = { id = dragon.109 days = 1 } # Got past the trap with ease
			}
			30 = {
				modifier = {
					factor = 0
					combat_rating = 50
				}
				character_event = { id = dragon.110 days = 1 } # Maimed - time to withdraw
			}
			20 = {
				modifier = {
					factor = 0
					combat_rating = 25
				}
				modifier = {
					factor = 2
					trait = patient # Stuided the pattern carefully
				}
				character_event = { id = dragon.111 days = 1 } # Killed by the trap
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_108 # This is too risky...
		
		prestige = -10
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}	
}

# Got past the blades
character_event = {
	id = dragon.109
	desc = EVTDESC_DRAGON_109
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_109 # That wasn't so bad!
		
		prestige = 50
		
		character_event = { id = dragon.115 days = 1 } # The final room
	}
}

# Maimed, time to withdraw
character_event = {
	id = dragon.110
	desc = EVTDESC_DRAGON_110
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_100 # I must withdraw...
		
		prestige = -5
		
		add_maimed_trait_effect = yes
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Killed
character_event = {
	id = dragon.111
	desc = EVTDESC_DRAGON_111
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_111 # Not like this!
		
		prestige = -50
		
		death = {
			death_reason = death_accident
		}
	}
}

# Ruins - safe spots (intrigue)
character_event = {
	id = dragon.112
	desc = EVTDESC_DRAGON_112
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_112 # I think I can see the pattern...
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						intrigue = 12
					}
				}
				character_event = { id = dragon.113 days = 1 } # Spot the trap
			}
			50 = {
				modifier = {
					factor = 0
					intrigue = 20
				}
				character_event = { id = dragon.114 days = 1 } # Killed by trap
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_112 # This is too risky...
		
		prestige = -10
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}	
}

# Stepped in the right places
character_event = {
	id = dragon.113
	desc = EVTDESC_DRAGON_113
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_113 # That wasn't so bad!
		
		prestige = 50
		
		character_event = { id = dragon.115 days = 1 } # The final room
	}
}

# Killed
character_event = {
	id = dragon.114
	desc = EVTDESC_DRAGON_114
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_114 # Not like this!
		
		prestige = -50
		
		death = {
			death_reason = death_accident
		}
	}
}

# Final room - investigate glowing wall?
character_event = {
	id = dragon.115
	desc = EVTDESC_DRAGON_115
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_115 # Investigate the wall
		
		random_list = {
			80 = {
				character_event = { id = dragon.116 days = 1 } # Dragon secret
			}
			10 = {
				character_event = { id = dragon.117 days = 1 } # Interesting symbols
			}
			10 = {
				character_event = { id = dragon.118 days = 1 } # Gemstones
			}
		}
		
		ai_chance = {
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_115 # This must be another death trap...
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 0
		}
	}	
}

# Glowing wall reveals dragon secret
character_event = {
	id = dragon.116
	desc = EVTDESC_DRAGON_116
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_116 # This was well worth it!
		
		prestige = 50
		
		set_character_flag = secret_of_the_ruins
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Glowing wall reveals strange words
character_event = {
	id = dragon.117
	desc = EVTDESC_DRAGON_117
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_117 # Interesting...
		
		prestige = 100
		change_learning = 1
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
	
	option = {
		trigger = {
			NOT = {
				lifestyle_traits = 1
			}
		}
		name = EVTOPTB_DRAGON_117 # I must look for similar symbols!
		
		add_trait = mystic
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Glowing wall contains gemstones
character_event = {
	id = dragon.118
	desc = EVTDESC_DRAGON_118
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_118 # This was well worth it!
		
		prestige = 50
		
		wealth = 1000
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

### Merchant selling advice - buy some?

# Merchant makes an offer
character_event = {
	id = dragon.119
	desc = EVTDESC_DRAGON_119
	picture = GFX_evt_market
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_119 # Give me one of those books!
		
		wealth = -25
		
		random_list = {
			10 = {
				character_event = { id = dragon.120 days = 1 } # Children's stories
			}
			10 = {
				character_event = { id = dragon.121 days = 1 } # Highermost Darkstone Pinnacle
			}
			10 = {
				character_event = { id = dragon.122 days = 1 } # Fire bad! Fire very bad!
			}
			10 = {
				character_event = { id = dragon.123 days = 1 } # Tip 1: Don't fight dragons!
			}
			10 = {
				character_event = { id = dragon.124 days = 1 } # Never tickle a sleeping dragon
			}
			10 = {
				character_event = { id = dragon.125 days = 1 } # Just Shout at it!
			}
			10 = {
				character_event = { id = dragon.126 days = 1 } # Watch out for the tail!
			}
			10 = {
				character_event = { id = dragon.127 days = 1 } # Known Weaknesses of the Celestial Dragon
			}
			10 = {
				character_event = { id = dragon.128 days = 1 } # If it breathes deeply, move away!
			}
			10 = {
				character_event = { id = dragon.129 days = 1 } # Dragon or Lizard - how to tell the difference
			}
		}
	}
		
	option = {
		name = EVTOPTB_DRAGON_119 # No thanks!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Children's stories
character_event = {
	id = dragon.120
	desc = EVTDESC_DRAGON_120
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_120 # This was a waste of time...
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Highermost Darkstone Pinnacle
character_event = {
	id = dragon.121
	desc = EVTDESC_DRAGON_121
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				trait = gluttonous
			}
		}
		name = EVTOPTA_DRAGON_121 # What an odd story...
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
	
	option = {
		trigger = {
			trait = gluttonous
		}
		name = EVTOPTB_DRAGON_121 # I wish I had chicken...
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Fire bad!
character_event = {
	id = dragon.122
	desc = EVTDESC_DRAGON_122
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_122 # "Fire bad!"? Huh...
		
		set_character_flag = minor_dragon_advice
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Don't fight dragons, you fool!
character_event = {
	id = dragon.123
	desc = EVTDESC_DRAGON_123
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_123 # I don't have a choice, do I?
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Don't tickle the dragon!
character_event = {
	id = dragon.124
	desc = EVTDESC_DRAGON_124
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_124 # It wasn't the plan...
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Shout at it!
character_event = {
	id = dragon.125
	desc = EVTDESC_DRAGON_125
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_125 # Just a battlecry, right?
		
		set_character_flag = minor_dragon_advice
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Mind the tail
character_event = {
	id = dragon.126
	desc = EVTDESC_DRAGON_126
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_126 # I suppose that's solid advice...
		
		set_character_flag = medium_dragon_advice
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Known Weaknesses of the Celestial Dragon
character_event = {
	id = dragon.127
	desc = EVTDESC_DRAGON_127
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_127 # Not quite what I was looking for...
		
		set_character_flag = minor_dragon_advice
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Deep breath = bad!
character_event = {
	id = dragon.128
	desc = EVTDESC_DRAGON_128
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_128 # I wonder how often that happens...
		
		set_character_flag = medium_dragon_advice
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

# Dragon or Lizard
character_event = {
	id = dragon.129
	desc = EVTDESC_DRAGON_129
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_129 # I would think "Dragons can fly" would be enough...
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
	}
}

### Preacher

# Preacher suggests conversion because their god(s) surely would help
character_event = {
	id = dragon.130
	desc = EVTDESC_DRAGON_130
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_province = {
			limit = {
				has_owner = yes
				NOT = {
					any_province = {
						has_province_flag = dragons_lair_province
						distance = {
							where = PREV
							value = 500
						}
					}
				}
				NOT = {
					religion = ROOT
				}
			}
			save_event_target_as = conversion_province
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_130 # You make a compelling argument!
		
		religion = event_target:conversion_province
		
		# No actual effect!
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				NOT = {
					trait = cynical
				}
			}
			modifier = {
				factor = 0.1
				NOT = {
					event_target:conversion_province = {
						religion_group = ROOT
					}
				}
			}
			modifier = {
				factor = 0
				trait = zealous
			}
			modifier = {
				factor = 0
				event_target:conversion_province = {
					religion_group = pagan_group
					is_reformed_religion = yes
				}
				NOT = {
					religion_group = pagan_group
					is_reformed_religion = no
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_130 # I don't think so!
		
		piety = 50
		
		hidden_tooltip = {
			change_variable = {
				which = dragons_lair_travel_progress
				value = 1
			}
			character_event = { id = dragon.5 days = 60 random = 30 } # Back to main travel event
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.1
				trait = cynical
			}
		}
	}
}

##### At the lair (131-183)

# Queue handling event
character_event = {
	id = dragon.131
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				month = 3 # April; all LNY celebrations are over
			}
			if = {
				limit = {
					NOR = {
						has_global_flag = dragons_lair_looted
						has_global_flag = dragon_slain
					}
				}
				if = {
					limit = {
						NOT = {
							has_global_flag = ongoing_dragonslaying_attempt
						}
						OR = { # The human player gets to jump ahead
							ai = no
							NOT = {
								any_playable_ruler = {
									ai = no
									has_character_flag = in_dragons_lair_queue
								}
							}
						}
					}
					set_global_flag = ongoing_dragonslaying_attempt
					clr_character_flag = in_dragons_lair_queue
					narrative_event = { id = dragon.133 } # Arrived at the lair
					any_province = {
						limit = {
							has_province_flag = dragons_lair_province
						}
						province_event = { id = dragon.188 days = 30 } # If the ongoing_dragonslaying_attempt flag sticks around after it should be cleaned up, remove it!
					}
				}
				else = {
					set_character_flag = in_dragons_lair_queue
					repeat_event = { id = dragon.131 days = 10 } # If someone else is at the lair, wait for your turn
				}
			}
			else_if = {
				limit = {
					has_global_flag = dragons_lair_looted
				}
				character_event = { id = dragon.132 } # You are too late!
			}
			else = {
				set_global_flag = dragons_lair_looted
				character_event = { id = dragon.182 } # Loot the unattended treasures
			}
		}
		else = {
			repeat_event = { id = dragon.131 days = 30 } # Try again later!
		}
	}
}

# Lair already looted - time to go home...
character_event = {
	id = dragon.132
	desc = EVTDESC_DRAGON_132
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_132 # I am too late...
		
		prestige = -50
		
		character_event = { id = dragon.184 } # Flag cleanup
		character_event = { id = dragon.185 days = 90 random = 30 } # Return home
	}
}

# Arrival at the lair - last chance to quit
narrative_event = {
	id = dragon.133
	title = EVTTITLE_DRAGON_133
	desc = EVTDESC_DRAGON_133
	picture = GFX_evt_pagan
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		log = "[Root.GetBestName] has arrived at the lair of Fredak, the Emperor of Embers!"
	}
	
	option = {
		name = EVTOPTA_DRAGON_133 # We should sneak in!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.25
					has_global_flag = dragon_injured
				}
				modifier = {
					factor = 0.8
					intrigue = 16
				}
				modifier = {
					factor = 0.8
					intrigue = 20
				}
				modifier = {
					factor = 0.8
					intrigue = 24
				}
				character_event = { id = dragon.134 days = 1 } # Sneaking fails
			}
			50 = {
				modifier = {
					factor = 0.8
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 0.8
					intrigue = 20
				}
				modifier = {
					factor = 0.8
					intrigue = 24
				}
				character_event = { id = dragon.135 days = 1 } # Sneaking succeeds - treasure room
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_133 # The direct approach is best!
		
		character_event = { id = dragon.142 days = 1 } # Combat begins
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					trait = brave
				}
			}
		}
	}
	
	option = {
		name = EVTOPTC_DRAGON_133 # I'm having second thoughts...
		
		clr_global_flag = ongoing_dragonslaying_attempt
		
		character_event = { id = dragon.184 } # Flag cleanup
		character_event = { id = dragon.185 days = 90 random = 30 } # Return home
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = {
					trait = craven
				}
			}
		}
	}
}

### Sneaking

# Sneaking in - got discovered - Fredak gets a bonus!
character_event = {
	id = dragon.134
	desc = EVTDESC_DRAGON_134
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_134 # Face me, foul beast!
		
		character_event = { id = dragon.143 days = 1 } # Combat event 1
		
		hidden_tooltip = {
			set_variable = { # Shouldn't ever be set prior to this point, but best to be sure...
				which = dragon_combat_bonus
				value = -2
			}
		}
	}
}

# Sneaking in - treasures spotted - steal something?
character_event = {
	id = dragon.135
	desc = EVTDESC_DRAGON_135
	picture = GFX_evt_pagan_artifacts
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_135 # Grab what you can!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.25
					has_global_flag = dragon_injured
				}
				modifier = {
					factor = 0.8
					intrigue = 16
				}
				modifier = {
					factor = 0.8
					intrigue = 20
				}
				modifier = {
					factor = 0.8
					intrigue = 24
				}
				character_event = { id = dragon.136 days = 1 } # Got discovered in treasure chamber
			}
			50 = {
				modifier = {
					factor = 0.8
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 0.8
					intrigue = 20
				}
				modifier = {
					factor = 0.8
					intrigue = 24
				}
				random_list = {
					# Joke artifacts
					10 = {
						set_character_flag = got_incomplete_deck_of_cards
					}
					10 = {
						set_character_flag = got_talking_wand
						set_global_flag = talking_wand_exists
					}
					10 = {
						set_character_flag = got_book_of_burninating
					}
					10 = {
						set_character_flag = got_shiny_bauble
					}
					10 = {
						set_character_flag = got_dragon_eggshell # Only in the lair
					}
					10 = {
						set_character_flag = got_fantasy_world_map
					}
					10 = {
						set_character_flag = got_princess_doll
					}
					10 = {
						set_character_flag = got_hammer_of_banning
					}
					# Less powerful artifacts
					5 = {
						set_character_flag = got_the_plus_one_ring
						set_global_flag = the_plus_one_ring_exists
					}
					5 = {
						set_character_flag = got_draught_of_healing
					}
					#5 = { # Only if Fredak is dead!
					#	set_character_flag = got_dragonscale_shield
					#	set_global_flag = dragonscale_shield_exists
					#}
					5 = {
						set_character_flag = got_sword_of_two_minds
						set_global_flag = sword_of_two_minds_exists
					}
					5 = {
						set_character_flag = got_draconic_lineages
					}
					5 = {
						set_character_flag = got_ornate_holy_symbol
					}
					5 = {
						set_character_flag = got_prestigious_ring
					}
					20 = {
						set_character_flag = got_gold
					}
				}
				character_event = { id = dragon.137 days = 1 } # Stole something
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = just # Stealing is wrong!
				NOT = {
					trait = greedy
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_135 # Just keep sneaking
		
		random_list = {
			50 = {
				modifier = {
					factor = 0.25
					has_global_flag = dragon_injured
				}
				modifier = {
					factor = 0.8
					intrigue = 16
				}
				modifier = {
					factor = 0.8
					intrigue = 20
				}
				modifier = {
					factor = 0.8
					intrigue = 24
				}
				character_event = { id = dragon.138 days = 1 } # Got discovered sneaking
			}
			50 = {
				modifier = {
					factor = 0.8
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 0.8
					intrigue = 20
				}
				modifier = {
					factor = 0.8
					intrigue = 24
				}
				character_event = { id = dragon.139 days = 1 } # Sneaking goes well
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = greedy
			}
		}
	}
}

# Treasure chamber - got discovered - Fredak gets a bonus!
character_event = {
	id = dragon.136
	desc = EVTDESC_DRAGON_136
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_136 # Face me, foul beast!
		
		character_event = { id = dragon.143 days = 1 } # Combat event 1
		
		hidden_tooltip = {
			set_variable = { # Shouldn't ever be set prior to this point, but best to be sure...
				which = dragon_combat_bonus
				value = -2
			}
		}
	}
}

# Treasure chamber - got a tresure/some gold - leave the lair?
character_event = {
	id = dragon.137
	desc = EVTDESC_DRAGON_137
	picture = GFX_evt_pagan_artifacts
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_137 # A nice treasure, but we must continue!
		
		# Joke artifact
		if = {
			limit = {
				has_character_flag = got_incomplete_deck_of_cards
			}
			add_artifact = incomplete_deck_of_cards
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_talking_wand
			}
			add_artifact = talking_wand
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_book_of_burninating
			}
			add_artifact = book_of_burninating
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_shiny_bauble
			}
			add_artifact = shiny_bauble
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_fantasy_world_map
			}
			add_artifact = fantasy_world_map
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_princess_doll
			}
			add_artifact = princess_doll
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_hammer_of_banning
			}
			add_artifact = hammer_of_banning
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		# Less powerful artifact
		else_if = {
			limit = {
				has_character_flag = got_the_plus_one_ring
			}
			add_artifact = the_plus_one_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_draught_of_healing
			}
			add_artifact = draught_of_healing
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		#else_if = { # Impossible
		#	limit = {
		#		has_character_flag = got_dragonscale_shield
		#	}
		#	add_artifact = dragonscale_shield
		#	# Actually created at this date
		#}
		else_if = {
			limit = {
				has_character_flag = got_sword_of_two_minds
			}
			add_artifact = sword_of_two_minds
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_draconic_lineages
			}
			add_artifact = draconic_lineages
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_ornate_holy_symbol
			}
			add_artifact = ornate_holy_symbol
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_prestigious_ring
			}
			add_artifact = prestigious_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_gold
			}
			wealth = 1000
		}
		
		random_list = {
			75 = {
				modifier = {
					factor = 0.25
					has_global_flag = dragon_injured
				}
				modifier = {
					factor = 0.8
					intrigue = 16
				}
				modifier = {
					factor = 0.8
					intrigue = 20
				}
				modifier = {
					factor = 0.8
					intrigue = 24
				}
				character_event = { id = dragon.138 days = 1 } # Got discovered sneaking
			}
			25 = {
				modifier = {
					factor = 0.8
					NOT = {
						intrigue = 12
					}
				}
				modifier = {
					factor = 0.8
					intrigue = 20
				}
				modifier = {
					factor = 0.8
					intrigue = 24
				}
				character_event = { id = dragon.139 days = 1 } # Sneaking goes well
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_137 # I think we'll leave now...
		
		# Joke artifact
		if = {
			limit = {
				has_character_flag = got_incomplete_deck_of_cards
			}
			add_artifact = incomplete_deck_of_cards
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_talking_wand
			}
			add_artifact = talking_wand
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_book_of_burninating
			}
			add_artifact = book_of_burninating
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_shiny_bauble
			}
			add_artifact = shiny_bauble
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_fantasy_world_map
			}
			add_artifact = fantasy_world_map
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_princess_doll
			}
			add_artifact = princess_doll
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_hammer_of_banning
			}
			add_artifact = hammer_of_banning
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		# Less powerful artifact
		else_if = {
			limit = {
				has_character_flag = got_the_plus_one_ring
			}
			add_artifact = the_plus_one_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_draught_of_healing
			}
			add_artifact = draught_of_healing
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		#else_if = { # Impossible
		#	limit = {
		#		has_character_flag = got_dragonscale_shield
		#	}
		#	add_artifact = dragonscale_shield
		#	# Actually created at this date
		#}
		else_if = {
			limit = {
				has_character_flag = got_sword_of_two_minds
			}
			add_artifact = sword_of_two_minds
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_draconic_lineages
			}
			add_artifact = draconic_lineages
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_ornate_holy_symbol
			}
			add_artifact = ornate_holy_symbol
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_prestigious_ring
			}
			add_artifact = prestigious_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
				set_artifact_flag = dragon_loot
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_gold
			}
			wealth = 1000
		}
		
		clr_global_flag = ongoing_dragonslaying_attempt
		
		character_event = { id = dragon.184 } # Flag cleanup
		character_event = { id = dragon.185 days = 90 random = 30 } # Return home
	}
}

# Post-treasure chamber sneaking - got discovered (greater chance if you stole something) - Fredak gets a bonus!
character_event = {
	id = dragon.138
	desc = EVTDESC_DRAGON_138
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_138 # Face me, foul beast!
		
		character_event = { id = dragon.143 days = 1 } # Combat event 1
		
		hidden_tooltip = {
			set_variable = { # Shouldn't ever be set prior to this point, but best to be sure...
				which = dragon_combat_bonus
				value = -2
			}
		}
	}
}

# Come across an unsuspecting Fredak - attack!
character_event = {
	id = dragon.139
	desc = EVTDESC_DRAGON_139
	picture = GFX_evt_shadow
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_139 # Sneak attack! (Obviously you call your attacks even when sneak attacking!)
		
		random_list = {
			50 = {
				character_event = { id = dragon.140 days = 1 } # Sneak attack fails
			}
			50 = {
				modifier = {
					factor = 2
					any_artifact = {
						has_flag = dragonslayer
					}
				}
				character_event = { id = dragon.141 days = 1 } # Sneak attack works
			}
		}
	}
}

# First strike fails - no bonus
character_event = {
	id = dragon.140
	desc = EVTDESC_DRAGON_140
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_140 # Face me, foul beast!
		
		character_event = { id = dragon.143 days = 1 } # Combat event 1
		
		hidden_tooltip = {
			set_variable = { # Shouldn't ever be set prior to this point, but best to be sure...
				which = dragon_combat_bonus
				value = 0
			}
		}
	}
}

# First strike succeeds - you get a bonus
character_event = {
	id = dragon.141
	desc = EVTDESC_DRAGON_141
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_141 # Face me, foul beast!
		
		character_event = { id = dragon.143 days = 1 } # Combat event 1
		
		hidden_tooltip = {
			set_variable = { # Shouldn't ever be set prior to this point, but best to be sure...
				which = dragon_combat_bonus
				value = 2
			}
		}
	}
}

# Rest of combat handled with non-sneaking events

### Direct approach

# Reach Fredak - fight starts!
character_event = {
	id = dragon.142
	desc = EVTDESC_DRAGON_142
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_142 # Face me, foul beast!
		
		character_event = { id = dragon.143 days = 1 } # Combat event 1
		
		hidden_tooltip = {
			set_variable = { # Shouldn't ever be set prior to this point, but best to be sure...
				which = dragon_combat_bonus
				value = 0
			}
		}
	}
}

# Combat event 1 selection
character_event = {
	id = dragon.143
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						any_opinion_modifier_target = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
						}
					}
				}
				random_opinion_modifier_target = {
					limit = {
						has_opinion_modifier = {
							who = ROOT
							modifier = hunting_dragons_together
						}
					}
					save_event_target_as = live_bait
				}
				character_event = { id = dragon.144 } # Dragonslayer in danger
			}
			25 = {
				character_event = { id = dragon.150 } # Tail swipe
			}
			25 = {
				character_event = { id = dragon.153 } # Intimidate
			}
		}
	}
}

# Dragonslayer in danger - save them or use them as bait?
character_event = {
	id = dragon.144
	desc = EVTDESC_DRAGON_144
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_144 # I must help them!
		
		random_list = {
			33 = {
				character_event = { id = dragon.145 days = 1 } # Saved them
			}
			34 = {
				character_event = { id = dragon.146 days = 1 } # Saved them but got wounded
			}
			33 = {
				character_event = { id = dragon.147 days = 1 } # Saved them but got maimed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				event_target:live_bait = {
					any_rival = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0.01
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_144 # Live bait is good!
		
		random_list = {
			50 = {
				character_event = { id = dragon.148 days = 1 } # They die - gain a bonus
			}
			50 = {
				character_event = { id = dragon.149 days = 1 } # They live and hate you
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				event_target:live_bait = {
					OR = {
						any_friend = {
							character = ROOT
						}
						any_lover = {
							character = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 0.01
				trait = brave
			}
		}
	}
}

# Saved dragonslayer - all is well
character_event = {
	id = dragon.145
	desc = EVTDESC_DRAGON_145
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_145 # Think nothing of it!
		
		if = {
			limit = {
				event_target:live_bait = {
					any_rival = {
						character = ROOT
					}
				}
			}
			event_target:live_bait = {
				remove_rival = ROOT
			}
		}
		else_if = {
			limit = {
				event_target:live_bait = {
					NOT = {
						any_friend = {
							character = ROOT
						}
					}
				}
			}
			event_target:live_bait = {
				add_friend = ROOT
			}
		}
		else = {
			prestige = 100
			character_event = { id = dragon.156 days = 1 } # Combat event 2
		}
	}
}

# Saved dragonslayer - wounded
character_event = {
	id = dragon.146
	desc = EVTDESC_DRAGON_146
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_146 # Think nothing of it!
		
		add_trait = wounded
		
		if = {
			limit = {
				event_target:live_bait = {
					any_rival = {
						character  =ROOT
					}
				}
			}
			event_target:live_bait = {
				remove_rival = ROOT
			}
		}
		else_if = {
			limit = {
				event_target:live_bait = {
					NOT = {
						any_friend = {
							character  =ROOT
						}
					}
				}
			}
			event_target:live_bait = {
				add_friend = ROOT
			}
		}
		else = {
			prestige = 100
			character_event = { id = dragon.156 days = 1 } # Combat event 2
		}
	}
}

# Saved dragonslayer - maimed
character_event = {
	id = dragon.147
	desc = EVTDESC_DRAGON_147
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_147 # Think nothing of it!
		
		add_maimed_trait_effect = yes
		
		if = {
			limit = {
				event_target:live_bait = {
					any_rival = {
						character  =ROOT
					}
				}
			}
			event_target:live_bait = {
				remove_rival = ROOT
			}
		}
		else_if = {
			limit = {
				event_target:live_bait = {
					NOT = {
						any_friend = {
							character  =ROOT
						}
					}
				}
			}
			event_target:live_bait = {
				add_friend = ROOT
			}
		}
		else = {
			prestige = 100
			character_event = { id = dragon.156 days = 1 } # Combat event 2
		}
	}
}

# Dragonslayer used as bait and dies - you get a bonus
character_event = {
	id = dragon.148
	desc = EVTDESC_DRAGON_148
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_148 # Nothing personal!
		
		event_target:live_bait = {
			if = {
				limit = {
					has_character_flag = dragonslayer_the_old_crusader
					ROOT = {
						any_opinion_modifier_target = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							has_character_flag = dragonslayer_the_squire
						}
					}
				}
				ROOT = {
					any_opinion_modifier_target = {
						limit = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							has_character_flag = dragonslayer_the_squire
						}
						add_rival = ROOT
					}
				}
			}
			else_if = {
				limit = {
					has_character_flag = dragonslayer_the_squire
					ROOT = {
						any_opinion_modifier_target = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							has_character_flag = dragonslayer_the_old_crusader
						}
					}
				}
				ROOT = {
					any_opinion_modifier_target = {
						limit = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							has_character_flag = dragonslayer_the_old_crusader
						}
						add_rival = ROOT
					}
				}
			}
			death = {
				death_reason = death_evil_dragon
			}
		}
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = 7 # Counters the penalty for losing a dragonslayer, plus two
			}
		}
		
		if = {
			limit = {
				trait = kind
			}
			remove_trait = kind
		}
		else = {
			add_trait = cruel
		}
		
		character_event = { id = dragon.156 days = 1 } # Combat event 2
	}
}

# Dragonslayer used as bait and survives - gain their enmity
character_event = {
	id = dragon.149
	desc = EVTDESC_DRAGON_149
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_149 # Nothing personal!
		
		event_target:live_bait = {
			if = {
				limit = {
					any_friend = {
						character = ROOT
					}
				}
				remove_friend = ROOT
			}
			if = {
				limit = {
					any_lover = {
						character = ROOT
					}
				}
				remove_lover = ROOT
			}
			if = {
				limit = {
					NOT = {
						any_rival = {
							character = ROOT
						}
					}
				}
				add_rival = ROOT
			}
			if = {
				limit = {
					has_character_flag = dragonslayer_the_old_crusader
					ROOT = {
						any_opinion_modifier_target = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							has_character_flag = dragonslayer_the_squire
						}
					}
				}
				ROOT = {
					any_opinion_modifier_target = {
						limit = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							has_character_flag = dragonslayer_the_squire
						}
						add_rival = ROOT
					}
				}
			}
			else_if = {
				limit = {
					has_character_flag = dragonslayer_the_squire
					ROOT = {
						any_opinion_modifier_target = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							has_character_flag = dragonslayer_the_old_crusader
						}
					}
				}
				ROOT = {
					any_opinion_modifier_target = {
						limit = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							has_character_flag = dragonslayer_the_old_crusader
						}
						add_rival = ROOT
					}
				}
			}
			opinion = {
				who = ROOT
				modifier = attempted_murder
			}
		}
		
		if = {
			limit = {
				trait = kind
			}
			remove_trait = kind
		}
		else = {
			add_trait = cruel
		}
		
		character_event = { id = dragon.156 days = 1 } # Combat event 2
	}
}


# Tail swipe - dodge left or right?
character_event = {
	id = dragon.150
	desc = EVTDESC_DRAGON_150
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_150 # Dodge left!
		random_list = {
			50 = {
				character_event = { id = dragon.151 days = 1 } # Dodged
			}
			50 = {
				character_event = { id = dragon.152 days = 1 } # Did not dodge
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_150 # Dodge right!
		random_list = {
			50 = {
				character_event = { id = dragon.151 days = 1 } # Dodged
			}
			50 = {
				character_event = { id = dragon.152 days = 1 } # Did not dodge
			}
		}
	}
}
	
# Dodge succeeds - you get a bonus
character_event = {
	id = dragon.151
	desc = EVTDESC_DRAGON_151
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_151 # I avoided the tail!
		
		character_event = { id = dragon.156 days = 1 } # Combat event 2
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = 1
			}
		}
	}
}

# Dodge fails - wounded - Fredak gets a bonus
character_event = {
	id = dragon.152
	desc = EVTDESC_DRAGON_152
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_152 # I did not avoid the tail...
		
		add_trait = wounded
		
		character_event = { id = dragon.156 days = 1 } # Combat event 2
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = -1
			}
		}
	}
}

# Fredak used Intimidate!
character_event = {
	id = dragon.153
	desc = EVTDESC_DRAGON_153
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_153 # He lies!
		random_list = {
			50 = {
				modifier = {
					factor = 10
					trait = brave
				}
				modifier = {
					factor = 2
					trait = stubborn
				}
				modifier = {
					factor = 5
					trait = proud
				}
				character_event = { id = dragon.154 days = 1 } # Not intimidated
			}
			50 = {
				modifier = {
					factor = 10
					trait = craven
				}
				modifier = {
					factor = 2
					trait = paranoid
				}
				modifier = {
					factor = 5
					trait = cynical
				}
				character_event = { id = dragon.155 days = 1 } # Intimidated
			}
		}
	}
}

# Intimidation fails - you get a bonus
character_event = {
	id = dragon.154
	desc = EVTDESC_DRAGON_154
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_154 # I have heard scarier threats from children!
		
		character_event = { id = dragon.156 days = 1 } # Combat event 2
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = 2
			}
		}
	}
}

# Intimidation succeeds - Fredak gets a bonus
character_event = {
	id = dragon.155
	desc = EVTDESC_DRAGON_155
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_155 # I don't want to die!
		
		character_event = { id = dragon.156 days = 1 } # Combat event 2
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = -2
			}
		}
	}
}

# Combat event 2 selection
character_event = {
	id = dragon.156
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						any_opinion_modifier_target = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							any_rival = {
								character = ROOT
							}
						}
					}
				}
				random_opinion_modifier_target = {
					limit = {
						has_opinion_modifier = {
							who = ROOT
							modifier = hunting_dragons_together
						}
						any_rival = {
							character = ROOT
						}
					}
					save_event_target_as = would_be_traitor
				}
				character_event = { id = dragon.157 } # Tripped by rival
			}
			25 = {
				modifier = {
					factor = 0
					NOT = {
						any_opinion_modifier_target = {
							has_opinion_modifier = {
								who = ROOT
								modifier = hunting_dragons_together
							}
							OR = {
								any_friend = {
									character = ROOT
								}
								any_lover = {
									character = ROOT
								}
							}
						}
					}
				}
				random_opinion_modifier_target = {
					limit = {
						has_opinion_modifier = {
							who = ROOT
							modifier = hunting_dragons_together
						}
						OR = {
							any_friend = {
								character = ROOT
							}
							any_lover = {
								character = ROOT
							}
						}
					}
					save_event_target_as = died_for_you
				}
				character_event = { id = dragon.162 } # Friend or lover sacrifices themself
			}
			25 = {
				character_event = { id = dragon.163 } # Tripped by rival
			}
		}
	}
}

# Rival dragonslayer trips you - focus on standing up or on making them pay?
character_event = {
	id = dragon.157
	desc = EVTDESC_DRAGON_157
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_157 # How dare you!
		
		character_event = { id = dragon.158 days = 1 } # Stood up
		
		event_target:would_be_traitor = {
			reverse_opinion = {
				who = ROOT
				modifier = attempted_murder
			}
		
			if = {
				limit = {
					has_dlc = "Jade Dragon"
					is_chinese_emperor_trigger = no
				}
				if = {
					limit = {
						ROOT = {
							is_chinese_emperor_trigger = yes
						}
					}
					detract_grace_super_huge_effect = yes
				}
				else_if = {
					limit = {
						ROOT = {
							any_close_relative = {
								dynasty = PREV
								is_chinese_emperor_trigger = yes
							}
						}
					}
					detract_grace_massive_effect = yes
				}
				else_if = {
					limit = {
						ROOT = {
							any_dynasty_member = {
								is_chinese_emperor_trigger = yes
							}
						}
					}
					detract_grace_major_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					trait = wroth
					trait = cruel
					trait = deceitful
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_157 # I can trip you too!
		
		random_list = {
			33 = {
				character_event = { id = dragon.159 days = 1 } # Trip them, they get maimed
			}
			34 = {
				character_event = { id = dragon.160 days = 1 } # Trip them, both get maimed
			}
			33 = {
				character_event = { id = dragon.161 days = 1 } # Fail to trip them, you get maimed
			}
		}
		
		event_target:would_be_traitor = {
			reverse_opinion = {
				who = ROOT
				modifier = attempted_murder
			}
			opinion = {
				who = ROOT
				modifier = attempted_murder
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = kind
			}
		}
	}
}

# Stood up - no penalty
character_event = {
	id = dragon.158
	desc = EVTDESC_DRAGON_158
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_158 # I will deal with YOU later...
		
		character_event = { id = dragon.166 days = 1 } # Combat event 3
	}
}

# Failed to drag them down - you get maimed - Fredak gets a bonus
character_event = {
	id = dragon.159
	desc = EVTDESC_DRAGON_159
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_159 # Curse you!
		
		add_maimed_trait_effect = yes
		
		character_event = { id = dragon.166 days = 1 } # Combat event 3
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = -2
			}
		}
	}
}

# Dragged them down - both maimed - Fredak gets a big bonus
character_event = {
	id = dragon.160
	desc = EVTDESC_DRAGON_160
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_160 # At least they also got hurt...
		
		add_maimed_trait_effect = yes
		
		event_target:would_be_traitor = {
			add_maimed_trait_effect = yes
		}
		
		character_event = { id = dragon.166 days = 1 } # Combat event 3
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = -5
			}
		}
	}
}

# Dragged them down - they get maimed - Fredak gets a bonus
character_event = {
	id = dragon.161
	desc = EVTDESC_DRAGON_161
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_161 # That's what you get!
		
		event_target:would_be_traitor = {
			add_maimed_trait_effect = yes
		}
		
		character_event = { id = dragon.166 days = 1 } # Combat event 3
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = -2
			}
		}
	}
}

# Friend or lover dragonslayer sacrifices themself to protect you - you get a bonus
character_event = {
	id = dragon.162
	desc = EVTDESC_DRAGON_162
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_162 # I will avenge you!
		
		event_target:died_for_you = {
			death = {
				death_reason = death_evil_dragon
			}
		}
		
		character_event = { id = dragon.166 days = 1 } # Combat event 3
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = 7 # Counters the fact that you've lost a dragonslayer, plus 2 extra
			}
		}
	}
}

# Lair shakes and rocks fall from the ceiling - dodge
character_event = {
	id = dragon.163
	desc = EVTDESC_DRAGON_163
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_163 # Take cover!
		random_list = {
			50 = {
				character_event = { id = dragon.164 days = 1 } # Dodged
			}
			50 = {
				character_event = { id = dragon.165 days = 1 } # Did not dodge
			}
		}
	}
}
	
# Dodge succeeds
character_event = {
	id = dragon.164
	desc = EVTDESC_DRAGON_164
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_164 # I avoided the rocks!
		
		character_event = { id = dragon.166 days = 1 } # Combat event 3
	}
}

# Dodge fails - wounded
character_event = {
	id = dragon.165
	desc = EVTDESC_DRAGON_165
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_165 # I did not avoid the rocks...
		
		add_trait = wounded
		
		character_event = { id = dragon.166 days = 1 } # Combat event 3
	}
}

# Combat event 3 selection
character_event = {
	id = dragon.166
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			25 = {
				character_event = { id = dragon.167 } # Distraction?
			}
			50 = {
				character_event = { id = dragon.170 } # Deep breath
			}
			25 = {
				modifier = {
					factor = 10
					has_global_flag = dragon_injured
				}
				character_event = { id = dragon.173 } # Spot potential weak spot
			}
		}
	}
}

# Attempt to distract Fredak?
character_event = {
	id = dragon.167
	desc = EVTDESC_DRAGON_167
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_167 # Look behind you!
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						intrigue = 12
					}
				}
				character_event = { id = dragon.168 days = 1 } # Fredak is tricked
			}
			50 = {
				modifier = {
					factor = 0
					intrigue = 24
				}
				character_event = { id = dragon.169 days = 1 } # Fredak is not tricked
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = honest
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_167 # It wouldn't work...
		
		character_event = { id = dragon.176 days = 1 } # Final combat outcome is decided
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = deceitful
			}
		}
	}
}

# Distraction works - you get a bonus
character_event = {
	id = dragon.168
	desc = EVTDESC_DRAGON_168
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_168 # I tricked him!
		
		character_event = { id = dragon.176 days = 1 } # Final combat outcome is decided
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = 2
			}
		}
	}
}

# Distraction backfires - Fredak gets a bonus
character_event = {
	id = dragon.169
	desc = EVTDESC_DRAGON_169
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_169 # Worth a shot
		
		character_event = { id = dragon.176 days = 1 } # Final combat outcome is decided
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = -2
			}
		}
	}
}

# Fredak takes a deep breath - attempt to strike before he can breathe out or hide?
character_event = {
	id = dragon.170
	desc = EVTDESC_DRAGON_170
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_170 # Strike at him
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25 # Why are you even here?
					}
				}
				character_event = { id = dragon.171 days = 1 } # You succeeded
			}
			50 = {
				modifier = {
					factor = 0
					combat_rating = 75
				}
				character_event = { id = dragon.172 days = 1 } # You failed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_170 # It wouldn't work...
		
		character_event = { id = dragon.176 days = 1 } # Final combat outcome is decided
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Attacked Fredak - you get a bonus
character_event = {
	id = dragon.171
	desc = EVTDESC_DRAGON_171
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_171 # So predictable!
		
		character_event = { id = dragon.176 days = 1 } # Final combat outcome is decided
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = 2
			}
		}
	}
}

# Attacked Fredak and got wounded
character_event = {
	id = dragon.172
	desc = EVTDESC_DRAGON_172
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_172 # That didn't work...
		
		add_trait = wounded
		
		character_event = { id = dragon.176 days = 1 } # Final combat outcome is decided
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = -2
			}
		}
	}
}

# You see an old wound - strike at it?
character_event = {
	id = dragon.173
	desc = EVTDESC_DRAGON_173
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_173 # Strike at the wound
		
		random_list = {
			50 = {
				modifier = {
					factor = 0
					NOT = {
						combat_rating = 25 # Why are you even here?
					}
				}
				character_event = { id = dragon.174 days = 1 } # You succeeded
			}
			50 = {
				modifier = {
					factor = 2
					has_global_flag = dragon_injured # Not-so-old wound
				}
				modifier = {
					factor = 0
					combat_rating = 75
				}
				modifier = {
					factor = 0
					combat_rating = 50
					has_global_flag = dragon_injured
				}
				character_event = { id = dragon.175 days = 1 } # You failed
			}
		}
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_173 # It wouldn't work...
		
		character_event = { id = dragon.176 days = 1 } # Final combat outcome is decided
		
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				trait = brave
			}
		}
	}
}

# Blow succeeds - you get a bonus
character_event = {
	id = dragon.174
	desc = EVTDESC_DRAGON_174
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_174 # It ws super effective!
		
		character_event = { id = dragon.176 days = 1 } # Final combat outcome is decided
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = 5
			}
		}
	}
}

# Blow fails - Fredak gets a bonus
character_event = {
	id = dragon.175
	desc = EVTDESC_DRAGON_175
	picture = GFX_evt_burning_man_hf
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_175 # It wasn't a wound!
		
		character_event = { id = dragon.176 days = 1 } # Final combat outcome is decided
		
		hidden_tooltip = {
			change_variable = {
				which = dragon_combat_bonus
				value = -5
			}
		}
	}
}

# Final combat calculation (LNY calculation minus LNY modifiers, plus new modifiers) - you either WIN or DIE!
character_event = {
	id = dragon.176
	hide_window = yes
	is_triggered_only = yes
	
	immediate = { # Note: It is supposed to be VERY difficult to win if you're not a great warrior AND roll well, because the rewards are VERY good!
		hidden_tooltip = {
			random_list = {
				19 = {
					set_character_flag = dragon_combat_undecided
					random_list = {
						1 = {
							set_variable = {
								which = d20
								value = 25 # Due to plot armor, a crit is only +5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 19
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 18
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 17
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 16
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 15
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 14
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 13
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 12
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 11
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 10
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 9
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 8
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 7
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 6
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 5
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 4
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 3
							}
						}
						1 = {
							set_variable = {
								which = d20
								value = 2
							}
						}
					}
				}
				1 = {  # Critical failure
					set_variable = {
						which = d20
						value = 1
					}
				}
			}
			if = {
				limit = {
					has_character_flag = fragment_of_possibility
				}
				random_list = {
					1 = {
						set_variable = {
							which = d20_2
							value = 25 # Due to plot armor, a crit is only +5
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 19
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 18
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 17
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 16
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 15
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 14
						}
					}
					1 = {
						set_variable = {
							which = d20
							value = 13
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 12
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 11
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 10
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 9
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 8
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 7
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 6
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 5
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 4
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 3
						}
					}
					1 = {
						set_variable = {
							which = d20_2
							value = 2
						}
					}
				}
				1 = {  # Critical failure
					set_variable = {
						which = d20_2
						value = 1
					}
				}
			}
			
			if = {
				limit = {
					check_variable = {
						which = d20_2
						which = d20
					}
				}
				set_variable = {
					which = d20
					which = d20_2
				}
			}
			
			if = {
				limit = {
					is_variable_equal = {
						which = d20
						value = 1
					}
				}
				clr_character_flag = dragon_combat_undecided
				narrative_event = { id = dragon.178 } # You have died!
			}
			
			if = {
				limit = {
					has_character_flag = dragon_combat_undecided
				}
				if = {
					limit = {
						ai = yes
					}
					change_variable = {
						which = d20
						value = -10 # Protection from AI - it is more fun if the player gets to kill Fredak
					}
				}
				if = {
					limit = {
						OR = {
							AND = {
								ai = yes
								any_artifact = {
									has_flag = dragonslayer
								}
							}
							any_artifact = {
								is_artifact_equipped = yes
								has_flag = dragonslayer
							}
						}
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				# Combat rating - checks up to 500 in case someone has some insane bloodline stacking or the like
				if = {
					limit = {
						combat_rating = 500
					}
					change_variable = {
						which = d20
						value = 50
					}
				}
				else_if = {
					limit = {
						combat_rating = 490
					}
					change_variable = {
						which = d20
						value = 49
					}
				}
				else_if = {
					limit = {
						combat_rating = 480
					}
					change_variable = {
						which = d20
						value = 48
					}
				}
				else_if = {
					limit = {
						combat_rating = 470
					}
					change_variable = {
						which = d20
						value = 47
					}
				}
				else_if = {
					limit = {
						combat_rating = 460
					}
					change_variable = {
						which = d20
						value = 46
					}
				}
				else_if = {
					limit = {
						combat_rating = 450
					}
					change_variable = {
						which = d20
						value = 45
					}
				}
				else_if = {
					limit = {
						combat_rating = 440
					}
					change_variable = {
						which = d20
						value = 44
					}
				}
				else_if = {
					limit = {
						combat_rating = 430
					}
					change_variable = {
						which = d20
						value = 43
					}
				}
				else_if = {
					limit = {
						combat_rating = 420
					}
					change_variable = {
						which = d20
						value = 42
					}
				}
				else_if = {
					limit = {
						combat_rating = 410
					}
					change_variable = {
						which = d20
						value = 41
					}
				}
				else_if = {
					limit = {
						combat_rating = 400
					}
					change_variable = {
						which = d20
						value = 40
					}
				}
				else_if = {
					limit = {
						combat_rating = 390
					}
					change_variable = {
						which = d20
						value = 39
					}
				}
				else_if = {
					limit = {
						combat_rating = 380
					}
					change_variable = {
						which = d20
						value = 38
					}
				}
				else_if = {
					limit = {
						combat_rating = 370
					}
					change_variable = {
						which = d20
						value = 37
					}
				}
				else_if = {
					limit = {
						combat_rating = 360
					}
					change_variable = {
						which = d20
						value = 36
					}
				}
				else_if = {
					limit = {
						combat_rating = 350
					}
					change_variable = {
						which = d20
						value = 35
					}
				}
				else_if = {
					limit = {
						combat_rating = 340
					}
					change_variable = {
						which = d20
						value = 34
					}
				}
				else_if = {
					limit = {
						combat_rating = 330
					}
					change_variable = {
						which = d20
						value = 33
					}
				}
				else_if = {
					limit = {
						combat_rating = 320
					}
					change_variable = {
						which = d20
						value = 32
					}
				}
				else_if = {
					limit = {
						combat_rating = 310
					}
					change_variable = {
						which = d20
						value = 31
					}
				}
				else_if = {
					limit = {
						combat_rating = 300
					}
					change_variable = {
						which = d20
						value = 30
					}
				}
				else_if = {
					limit = {
						combat_rating = 290
					}
					change_variable = {
						which = d20
						value = 29
					}
				}
				else_if = {
					limit = {
						combat_rating = 280
					}
					change_variable = {
						which = d20
						value = 28
					}
				}
				else_if = {
					limit = {
						combat_rating = 270
					}
					change_variable = {
						which = d20
						value = 27
					}
				}
				else_if = {
					limit = {
						combat_rating = 260
					}
					change_variable = {
						which = d20
						value = 26
					}
				}
				else_if = {
					limit = {
						combat_rating = 250
					}
					change_variable = {
						which = d20
						value = 25
					}
				}
				else_if = {
					limit = {
						combat_rating = 240
					}
					change_variable = {
						which = d20
						value = 24
					}
				}
				else_if = {
					limit = {
						combat_rating = 230
					}
					change_variable = {
						which = d20
						value = 23
					}
				}
				else_if = {
					limit = {
						combat_rating = 220
					}
					change_variable = {
						which = d20
						value = 22
					}
				}
				else_if = {
					limit = {
						combat_rating = 210
					}
					change_variable = {
						which = d20
						value = 21
					}
				}
				else_if = {
					limit = {
						combat_rating = 200
					}
					change_variable = {
						which = d20
						value = 20
					}
				}
				else_if = {
					limit = {
						combat_rating = 190
					}
					change_variable = {
						which = d20
						value = 19
					}
				}
				else_if = {
					limit = {
						combat_rating = 180
					}
					change_variable = {
						which = d20
						value = 18
					}
				}
				else_if = {
					limit = {
						combat_rating = 170
					}
					change_variable = {
						which = d20
						value = 17
					}
				}
				else_if = {
					limit = {
						combat_rating = 160
					}
					change_variable = {
						which = d20
						value = 16
					}
				}
				else_if = {
					limit = {
						combat_rating = 150
					}
					change_variable = {
						which = d20
						value = 15
					}
				}
				else_if = {
					limit = {
						combat_rating = 140
					}
					change_variable = {
						which = d20
						value = 14
					}
				}
				else_if = {
					limit = {
						combat_rating = 130
					}
					change_variable = {
						which = d20
						value = 13
					}
				}
				else_if = {
					limit = {
						combat_rating = 120
					}
					change_variable = {
						which = d20
						value = 12
					}
				}
				else_if = {
					limit = {
						combat_rating = 110
					}
					change_variable = {
						which = d20
						value = 11
					}
				}
				else_if = {
					limit = {
						combat_rating = 100
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				else_if = {
					limit = {
						combat_rating = 90
					}
					change_variable = {
						which = d20
						value = 9
					}
				}
				else_if = {
					limit = {
						combat_rating = 80
					}
					change_variable = {
						which = d20
						value = 8
					}
				}
				else_if = {
					limit = {
						combat_rating = 70
					}
					change_variable = {
						which = d20
						value = 7
					}
				}
				else_if = {
					limit = {
						combat_rating = 60
					}
					change_variable = {
						which = d20
						value = 6
					}
				}
				else_if = {
					limit = {
						combat_rating = 50
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				else_if = {
					limit = {
						combat_rating = 40
					}
					change_variable = {
						which = d20
						value = 4
					}
				}
				else_if = {
					limit = {
						combat_rating = 30
					}
					change_variable = {
						which = d20
						value = 3
					}
				}
				else_if = {
					limit = {
						combat_rating = 20
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				else_if = {
					limit = {
						combat_rating = 10
					}
					change_variable = {
						which = d20
						value = 1
					}
				}
				any_opinion_modifier_target = {
					limit = {
						has_character_flag = dragonslayer_wannabe
						has_opinion_modifier = {
							who = ROOT
							modifier = hunting_dragons_together
						}
					}
					ROOT = {
						change_variable = {
							which = d20
							value = 10 # Higher than for the LNY; they are caught unawares during the LNY...
						}
					}
				}
				if = {
					limit = {
						tier = duke
					}
					change_variable = {
						which = d20
						value = 1
					}
				}
				else_if = {
					limit = {
						tier = king
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				else_if = {
					limit = {
						tier = emperor
					}
					change_variable = {
						which = d20
						value = 3
					}
				}
				
				set_this_chinese_year_of_birth = yes
				set_this_chinese_zodiac_effect = yes
				
				if = {
					limit = {
						has_character_flag = my_chinese_zodiac_dragon # There's one they fear; the one born in the Year of the Dragon!
					}
					change_variable = {
						which = d20
						value = 3
					}
				}
				
				if = {
					limit = {
						has_global_flag = dragon_injured
					}
					change_variable = {
						which = d20
						value = 25
					}
				}
				
				# Misc bonuses from the journey
				if = {
					limit = {
						has_character_flag = dragonslayer_legend_great_advice
					}
					change_variable = {
						which = d20
						value = 5
					}
				}
				if = {
					limit = {
						has_character_flag = dragonslayer_legend_good_advice
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				if = {
					limit = {
						has_character_flag = dragonslayer_legend_bad_advice
					}
					change_variable = {
						which = d20
						value = -2
					}
				}
				if = {
					limit = {
						has_character_flag = dragonslayer_legend_terrible_advice
					}
					change_variable = {
						which = d20
						value = -5
					}
				}
				if = {
					limit = {
						has_character_flag = mabs_boon
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						has_character_flag = mabs_curse
					}
					change_variable = {
						which = d20
						value = -10
					}
				}
				if = {
					limit = {
						has_character_flag = secret_of_the_ruins
					}
					change_variable = {
						which = d20
						value = 10
					}
				}
				if = {
					limit = {
						has_character_flag = minor_dragon_advice
					}
					change_variable = {
						which = d20
						value = 1
					}
				}
				if = {
					limit = {
						has_character_flag = medium_dragon_advice
					}
					change_variable = {
						which = d20
						value = 2
					}
				}
				
				# Misc bonuses from the lair
				change_variable = {
					which = d20
					which = dragon_combat_bonus
				}
				
				# Calculate outcome
				if = {
					limit = {
						check_variable = {
							which = d20
							value = 75
						}
					}
					narrative_event = { id = dragon.180 } # Dragon killed
				}
				else_if = {
					limit = {
						NOT = {
							has_global_flag = dragon_injured
						}
						NOT = { 
							check_variable = {
								which = d20
								value = 75
							}
						}
						check_variable = {
							which = d20
							value = 30
						}
					}
					set_global_flag = dragon_injured
					narrative_event = { id = dragon.179 } # You have died, but you left a wound...!
				}
				else = {
					narrative_event = { id = dragon.178 } # You have died!
				}
			}
		}
	}
}

# You have died!
narrative_event = {
	id = dragon.178
	title = EVTTITLE_DRAGON_178
	desc = EVTDESC_DRAGON_178
	picture = GFX_evt_burning_man_hf
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		log = "[Root.GetBestName] was killed by Fredak, the Emperor of Embers!"
	}
	
	option = {
		name = EVTOPTA_DRAGON_178 # NOOO!
		
		death = {
			death_reason = death_evil_dragon
		}
		
		any_opinion_modifier_target = {
			limit = {
				has_character_flag = dragonslayer_wannabe
				has_opinion_modifier = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
			death = {
				death_reason = death_evil_dragon
			}
		}
		
		# If you looted something, you can't keep it
		if = {
			limit = {
				OR = {
					has_character_flag = got_incomplete_deck_of_cards
					has_character_flag = got_talking_wand
					has_character_flag = got_book_of_burninating
					has_character_flag = got_shiny_bauble
					has_character_flag = got_fantasy_world_map
					has_character_flag = got_princess_doll
					has_character_flag = got_hammer_of_banning
					has_character_flag = got_the_plus_one_ring
					has_character_flag = got_draught_of_healing
					has_character_flag = got_sword_of_two_minds
					has_character_flag = got_draconic_lineages
					has_character_flag = got_ornate_holy_symbol
					has_character_flag = got_prestigious_ring
				}
			}
			if = {
				limit = {
					has_character_flag = got_talking_wand
				}
				clr_global_flag = talking_wand_exists
			}
			if = {
				limit = {
					has_character_flag = got_the_plus_one_ring
				}
				clr_global_flag = the_plus_one_ring_exists
			}
			if = {
				limit = {
					has_character_flag = got_sword_of_two_minds
				}
				clr_global_flag = sword_of_two_minds_exists
			}
			any_artifact = {
				limit = {
					has_flag = dragon_loot
				}
				unsafe_destroy_artifact = yes
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_gold
			}
			wealth = -1000
		}
		
		clr_global_flag = ongoing_dragonslaying_attempt
	}
}

# Died, but wounded the dragon
narrative_event = {
	id = dragon.179
	title = EVTTITLE_DRAGON_179
	desc = EVTDESC_DRAGON_179
	picture = GFX_evt_burning_man_hf
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		log = "[Root.GetBestName] was killed by Fredak, the Emperor of Embers, but wounded the dragon!"
		any_province = {
			limit = {
				has_province_flag = dragons_lair_province
			}
			province_event = { id = dragon.1 days = 365 random = 183 } # Fredak recovers
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_179 # Avenge me!
		
		death = {
			death_reason = death_evil_dragon
		}
		
		any_opinion_modifier_target = {
			limit = {
				has_character_flag = dragonslayer_wannabe
				has_opinion_modifier = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
			death = {
				death_reason = death_evil_dragon
			}
		}
		
		# If you looted something, you can't keep it
		if = {
			limit = {
				OR = {
					has_character_flag = got_incomplete_deck_of_cards
					has_character_flag = got_talking_wand
					has_character_flag = got_book_of_burninating
					has_character_flag = got_shiny_bauble
					has_character_flag = got_fantasy_world_map
					has_character_flag = got_princess_doll
					has_character_flag = got_hammer_of_banning
					has_character_flag = got_the_plus_one_ring
					has_character_flag = got_draught_of_healing
					has_character_flag = got_sword_of_two_minds
					has_character_flag = got_draconic_lineages
					has_character_flag = got_ornate_holy_symbol
					has_character_flag = got_prestigious_ring
				}
			}
			if = {
				limit = {
					has_character_flag = got_talking_wand
				}
				clr_global_flag = talking_wand_exists
			}
			if = {
				limit = {
					has_character_flag = got_the_plus_one_ring
				}
				clr_global_flag = the_plus_one_ring_exists
			}
			if = {
				limit = {
					has_character_flag = got_sword_of_two_minds
				}
				clr_global_flag = sword_of_two_minds_exists
			}
			any_artifact = {
				limit = {
					has_flag = dragon_loot
				}
				unsafe_destroy_artifact = yes
			}
		}
		else_if = {
			limit = {
				has_character_flag = got_gold
			}
			wealth = -1000
		}
		
		clr_global_flag = ongoing_dragonslaying_attempt
	}
}

# Victory is yours
narrative_event = {
	id = dragon.180
	title = EVTTITLE_DRAGON_180
	desc = EVTDESC_DRAGON_180
	picture = GFX_evt_society_joining
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		log = "Fredak, the Emperor of Embers, has been slain! [Root.GetBestName] is now the Dragonslayer."
		
		clr_character_flag = got_incomplete_deck_of_cards
		clr_character_flag = got_talking_wand
		clr_character_flag = got_book_of_burninating
		clr_character_flag = got_shiny_bauble
		clr_character_flag = got_fantasy_world_map
		clr_character_flag = got_princess_doll
		clr_character_flag = got_hammer_of_banning
		clr_character_flag = got_the_plus_one_ring
		clr_character_flag = got_draught_of_healing
		clr_character_flag = got_sword_of_two_minds
		clr_character_flag = got_draconic_lineages
		clr_character_flag = got_ornate_holy_symbol
		clr_character_flag = got_prestigious_ring
	}
	
	option = {
		name = EVTOPTA_DRAGON_180 # Now bring me a REAL challenge!
		
		# These rewards are supposed to be very good, considering that it is difficult to pull off
		give_nickname = nick_the_dragonslayer
		
		set_global_flag = dragon_slain
		set_character_flag = killed_the_dragon
		
		prestige = 10000
		piety = 10000
		
		if = {
			limit = {
				is_female = no
			}
			create_bloodline = {
				type = dragonslayer_bloodline
			}
		}
		else = {
			create_bloodline = {
				type = dragonslayer_bloodline
				inheritance = matrilineal
			}
		}
		
		random_list = {
			95 = {}
			4 = {
				modifier = {
					factor = 0
					combat_rating = 80
				}
				modifier = {
					factor = 0.5
					combat_rating = 40
				}
				add_trait = wounded
			}
			1 = {
				modifier = {
					factor = 0
					combat_rating = 40
				}
				modifier = {
					factor = 0.5
					combat_rating = 20
				}
				add_maimed_trait_effect = yes
			}
		}
		
		any_playable_ruler = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			character_event = { id = dragon.181 days = 2 } # Inform the world
		}
		
		set_global_flag = dragons_lair_looted # Prevents others from looting the lair
		character_event = { id = dragon.182 days = 1 }
		clr_global_flag = ongoing_dragonslaying_attempt
	}
}

### To the victor, the spoils

# Inform the world and send other dragonslayers home right away
character_event = {
	id = dragon.181
	desc = EVTDESC_DRAGON_181
	picture = GFX_evt_society_joining
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				trait = hunting_dragons
			}
		}
		name = EVTOPTA_DRAGON_181 # At last the dragon is dead!
	}
	
	option = {
		trigger = {
			trait = hunting_dragons
		}
		name = EVTOPTB_DRAGON_181 # Time to go home...
		
		character_event = { id = dragon.184 }
		character_event = { id = dragon.185 days = 90 random = 30 }
	}
}

# Loot the lair - get treasures based on the hoard value
character_event = {
	id = dragon.182
	desc = EVTDESC_DRAGON_182
	picture = GFX_evt_treasure_chamber
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	immediate = {
		log = "[Root.GetBestName] is looting the lair of Fredak, the Emperor of Embers!"
		
		set_variable = {
			which = T5
			value = 0
		}
		set_variable = {
			which = T3
			value = 0
		}
		set_variable = {
			which = T1
			value = 0
		}
		set_variable = {
			which = gold_tier
			value = 0
		}
		
		# Determine how many artifacts and how much gold you get
		while = {
			limit = {
				NOR = {
					check_variable = {
						which = dragons_hoard
						value = 0
					}
					AND = {
						is_variable_equal = {
							which = T5
							value = 3
						}
						is_variable_equal = {
							which = T3
							value = 4
						}
						is_variable_equal = {
							which = T1
							value = 5
						}
						is_variable_equal = {
							which = gold_tier
							value = 10
						}
					}
				}
			}
			change_variable = {
				which = dragons_hoard
				value = -10000
			}
			if = {
				limit = {
					NOT = {
						is_variable_equal = {
							which = T5
							value = 3
						}
					}
				}
				if = {
					limit = {
						is_variable_equal = {
							which = T5
							value = 0
						}
					}
					change_variable = {
						which = T5
						value = 1
					}
				}
				else = {
					random = {
						chance = 50
						change_variable = {
							which = T5
							value = 1
						}
					}
				}
			}
			if = {
				limit = {
					NOT = {
						is_variable_equal = {
							which = T3
							value = 4
						}
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = T3
								value = 2
							}
						}
					}
					change_variable = {
						which = T3
						value = 1
					}
				}
				else = {
					random = {
						chance = 50
						change_variable = {
							which = T3
							value = 1
						}
					}
				}
			}
			if = {
				limit = {
					NOT = {
						is_variable_equal = {
							which = T1
							value = 5
						}
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = T1
								value = 3
							}
						}
					}
					change_variable = {
						which = T1
						value = 1
					}
				}
				else = {
					random = {
						chance = 50
						change_variable = {
							which = T1
							value = 1
						}
					}
				}
			}
			if = {
				limit = {
					NOT = {
						is_variable_equal = {
							which = gold_tier
							value = 10
						}
					}
				}
				if = {
					limit = {
						NOT = {
							check_variable = {
								which = gold_tier
								value = 5
							}
						}
					}
					change_variable = {
						which = gold_tier
						value = 1
					}
				}
				else = {
					random = {
						chance = 50
						change_variable = {
							which = gold_tier
							value = 1
						}
					}
				}
			}
		}
		
		# Joke artifacts - up to 5
		while = {
			limit = {
				check_variable = {
					which = T1
					value = 1
				}
			}
			change_variable = {
				which = T1
				value = -1
			}
			random_list = {
				5 = {
					set_character_flag = got_incomplete_deck_of_cards
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = talking_wand_exists
					}
					set_character_flag = got_talking_wand
					set_global_flag = talking_wand_exists
				}
				5 = {
					set_character_flag = got_book_of_burninating
				}
				5 = {
					set_character_flag = got_shiny_bauble
				}
				#5 = {
				#	set_character_flag = got_dragon_eggshell # Only in the lair
				#}
				5 = {
					set_character_flag = got_fantasy_world_map
				}
				5 = {
					set_character_flag = got_princess_doll
				}
				5 = {
					set_character_flag = got_hammer_of_banning
				}
			}
		}
		
		# Less powerful artifacts - up to 4
		while = {
			limit = {
				check_variable = {
					which = T3
					value = 1
				}
			}
			change_variable = {
				which = T3
				value = -1
			}
			random_list = {
				5 = {
					modifier = {
						factor = 0
						has_global_flag = the_plus_one_ring_exists
					}
					set_character_flag = got_the_plus_one_ring
					set_global_flag = the_plus_one_ring_exists
				}
				5 = {
					set_character_flag = got_draught_of_healing
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = dragonscale_shield_exists
					}
					modifier = {
						factor = 0
						NOT = {
							has_character_flag = killed_the_dragon
						}
					}
					set_character_flag = got_dragonscale_shield
					set_global_flag = dragonscale_shield_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = sword_of_two_minds_exists
					}
					set_character_flag = got_sword_of_two_minds
					set_global_flag = sword_of_two_minds_exists
				}
				5 = {
					set_character_flag = got_draconic_lineages
				}
				5 = {
					set_character_flag = got_ornate_holy_symbol
				}
				5 = {
					set_character_flag = got_prestigious_ring
				}
			}
		}
		
		# Very powerful artifacts - up to 3
		while = {
			limit = {
				check_variable = {
					which = T5
					value = 1
				}
			}
			change_variable = {
				which = T5
				value = -1
			}
			random_list = {
				5 = {
					modifier = {
						factor = 0
						has_global_flag = sanitys_demise_exists
					}
					set_character_flag = got_sanitys_demise
					set_global_flag = sanitys_demise_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = vial_of_immortality_exists
					}
					set_character_flag = got_vial_of_immortality
					set_global_flag = vial_of_immortality_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = living_flame_exists
					}
					set_character_flag = got_living_flame
					set_global_flag = living_flame_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = hungering_blade_exists
					}
					set_character_flag = got_hungering_blade
					set_global_flag = hungering_blade_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = deed_to_the_dragon_throne_exists
					}
					set_character_flag = got_deed_to_the_dragon_throne
					set_global_flag = deed_to_the_dragon_throne_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = diplomacy_ring_exists
					}
					set_character_flag = got_diplomacy_ring
					set_global_flag = diplomacy_ring_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = martial_ring_exists
					}
					set_character_flag = got_martial_ring
					set_global_flag = martial_ring_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = stewardship_ring_exists
					}
					set_character_flag = got_stewardship_ring
					set_global_flag = stewardship_ring_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = intrigue_ring_exists
					}
					set_character_flag = got_intrigue_ring
					set_global_flag = intrigue_ring_exists
				}
				5 = {
					modifier = {
						factor = 0
						has_global_flag = learning_ring_exists
					}
					set_character_flag = got_learning_ring
					set_global_flag = learning_ring_exists
				}
			}
		}
		
		any_province = {
			limit = {
				has_province_flag = dragons_lair_province
			}
			province_event = { id = dragon.183 days = 1 } # Remove the lair modifier
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_182 # This will be put to good use!
		
		# Gold
		if = {
			limit = {
				check_variable = {
					which = gold_tier
					value = 10
				}
			}
			wealth = 50000
		}
		else_if = {
			limit = {
				check_variable = {
					which = gold_tier
					value = 9
				}
			}
			wealth = 45000
		}
		else_if = {
			limit = {
				check_variable = {
					which = gold_tier
					value = 8
				}
			}
			wealth = 40000
		}
		else_if = {
			limit = {
				check_variable = {
					which = gold_tier
					value = 7
				}
			}
			wealth = 35000
		}
		else_if = {
			limit = {
				check_variable = {
					which = gold_tier
					value = 6
				}
			}
			wealth = 30000
		}
		else_if = {
			limit = {
				check_variable = {
					which = gold_tier
					value = 5
				}
			}
			wealth = 25000
		}
		else_if = {
			limit = {
				check_variable = {
					which = gold_tier
					value = 4
				}
			}
			wealth = 20000
		}
		else_if = {
			limit = {
				check_variable = {
					which = gold_tier
					value = 3
				}
			}
			wealth = 15000
		}
		else_if = {
			limit = {
				check_variable = {
					which = gold_tier
					value = 2
				}
			}
			wealth = 10000
		}
		else = {
			wealth = 5000
		}
		
		# Joke artifact
		if = {
			limit = {
				has_character_flag = got_incomplete_deck_of_cards
			}
			add_artifact = incomplete_deck_of_cards
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_talking_wand
			}
			add_artifact = talking_wand
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_book_of_burninating
			}
			add_artifact = book_of_burninating
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_shiny_bauble
			}
			add_artifact = shiny_bauble
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_fantasy_world_map
			}
			add_artifact = fantasy_world_map
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_princess_doll
			}
			add_artifact = princess_doll
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_hammer_of_banning
			}
			add_artifact = hammer_of_banning
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		
		# Less powerful artifact
		if = {
			limit = {
				has_character_flag = got_the_plus_one_ring
			}
			add_artifact = the_plus_one_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_draught_of_healing
			}
			add_artifact = draught_of_healing
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_dragonscale_shield
			}
			add_artifact = dragonscale_shield
			# Actually created at this date
		}
		if = {
			limit = {
				has_character_flag = got_sword_of_two_minds
			}
			add_artifact = sword_of_two_minds
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_draconic_lineages
			}
			add_artifact = draconic_lineages
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_ornate_holy_symbol
			}
			add_artifact = ornate_holy_symbol
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_prestigious_ring
			}
			add_artifact = prestigious_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		
		# Very powerful artifact
		if = {
			limit = {
				has_character_flag = got_sanitys_demise
			}
			add_artifact = sanitys_demise
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_vial_of_immortality
			}
			add_artifact = vial_of_immortality
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_living_flame
			}
			add_artifact = living_flame
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_hungering_blade
			}
			add_artifact = hungering_blade
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_deed_to_the_dragon_throne
			}
			add_artifact = deed_to_the_dragon_throne
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_diplomacy_ring
			}
			add_artifact = diplomacy_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_martial_ring
			}
			add_artifact = martial_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_stewardship_ring
			}
			add_artifact = stewardship_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_intrigue_ring
			}
			add_artifact = intrigue_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		if = {
			limit = {
				has_character_flag = got_learning_ring
			}
			add_artifact = learning_ring
			new_artifact = {
				set_creation_date = "-1.1.1"
			}
		}
		
		character_event = { id = dragon.185 days = 180 random = 90 } # Cleanup
	}
}

# Clean up the lair modifier on the province
province_event = {
	id = dragon.183
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		remove_province_modifier = dragons_lair
	}
}

##### Cleanup events (184-188)

# Clean up flags - start and end
character_event = {
	id = dragon.184
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		# Clear all flags!
		clr_character_flag = dragonslaying_rival_dragonslayer
		clr_character_flag = dragonslaying_prayed_at_shrine
		clr_character_flag = dragonslaying_tumbling_villagers
		clr_character_flag = dragonslaying_bandits
		clr_character_flag = dragonslaying_legend
		clr_character_flag = dragonslaying_disagreement
		clr_character_flag = dragonslaying_friendship
		clr_character_flag = dragonslaying_lover
		clr_character_flag = dragonslaying_mabs_offer
		clr_character_flag = dragonslaying_devastation
		clr_character_flag = dragonslaying_dodecahedron
		clr_character_flag = dragonslaying_assassin
		clr_character_flag = dragonslaying_old_ruins
		clr_character_flag = dragonslaying_merchant
		clr_character_flag = dragonslaying_preacher
		clr_character_flag = dragonslaying_recruited_dragonslayer
		clr_character_flag = dragonslaying_recruited_dragonslayer_2

		clr_character_flag = dragonslayer_legend_great_advice
		clr_character_flag = dragonslayer_legend_good_advice
		clr_character_flag = dragonslayer_legend_bad_advice
		clr_character_flag = dragonslayer_legend_terrible_advice

		clr_character_flag = mabs_price_memories
		clr_character_flag = mabs_price_artifact
		clr_character_flag = mabs_price_firstborn
		clr_character_flag = mabs_price_health
		clr_character_flag = mabs_price_lover

		clr_character_flag = mabs_boon
		clr_character_flag = mabs_curse

		clr_character_flag = fragment_of_possibility

		clr_character_flag = secret_of_the_ruins

		clr_character_flag = minor_dragon_advice
		clr_character_flag = medium_dragon_advice

		clr_character_flag = in_dragons_lair_queue

		clr_character_flag = got_incomplete_deck_of_cards
		clr_character_flag = got_talking_wand
		clr_character_flag = got_book_of_burninating
		clr_character_flag = got_shiny_bauble
		clr_character_flag = got_dragon_eggshell
		clr_character_flag = got_fantasy_world_map
		clr_character_flag = got_princess_doll
		clr_character_flag = got_hammer_of_banning

		clr_character_flag = got_the_plus_one_ring
		clr_character_flag = got_draught_of_healing
		clr_character_flag = got_dragonscale_shield
		clr_character_flag = got_sword_of_two_minds
		clr_character_flag = got_draconic_lineages
		clr_character_flag = got_ornate_holy_symbol
		clr_character_flag = got_prestigious_ring
		clr_character_flag = got_gold

		clr_character_flag = dragon_combat_undecided
		clr_character_flag = killed_the_dragon

		clr_character_flag = got_sanitys_demise
		clr_character_flag = got_vial_of_immortality
		clr_character_flag = got_living_flame
		clr_character_flag = got_hungering_blade
		clr_character_flag = got_deed_to_the_dragon_throne
		clr_character_flag = got_diplomacy_ring
		clr_character_flag = got_martial_ring
		clr_character_flag = got_stewardship_ring
		clr_character_flag = got_intrigue_ring
		clr_character_flag = got_learning_ring
		
		# Clear the generic dragonslayers, not the rest
		clr_character_flag = got_sir_genericus
		clr_character_flag = got_dame_generica
	}
}

# Clean up traits and opinions - end
character_event = {
	id = dragon.185
	desc = EVTDESC_DRAGON_185
	picture = GFX_evt_relaxed_ruler
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_DRAGON_185 # Home at last!
		
		remove_trait = hunting_dragons
		character_event = { id = dragon.184 } # Flag cleanup
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
			remove_trait = hunting_dragons
			remove_opinion = {
				who = ROOT
				modifier = hunting_dragons_together
			}
		}
	}
}

# Clean up people stuck hunting dragons that get landed on_new_holder
character_event = {
	id = dragon.186
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		any_opinion_modifier_target = {
			reverse_has_opinion_modifier = {
				who = ROOT
				modifier = hunting_dragons_together
			}
		}
	}
	
	immediate = {
		remove_trait = hunting_dragons
		any_opinion_modifier_target = {
			limit = {
				reverse_has_opinion_modifier = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
			reverse_remove_opinion = {
				who = ROOT
				modifier = hunting_dragons_together
			}
		}
	}
}


# Clean up people stuck hunting dragons if 5 years have passed (should not be possible under normal circumstances unless there's a long queue at the lair, which the player gets to jump ahead in...)
character_event = {
	id = dragon.187
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		remove_trait = hunting_dragons
		any_opinion_modifier_target = {
			limit = {
				reverse_has_opinion_modifier = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
			reverse_remove_opinion = {
				who = ROOT
				modifier = hunting_dragons_together
			}
		}
	}
}

# Clean up ongoing_dragonslaying_attempt after a month, in case something weird happens
province_event = {
	id = dragon.188
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				had_global_flag = { flag = ongoing_dragonslaying_attempt days = 30 }
			}
			clr_global_flag = ongoing_dragonslaying_attempt
		}
	}
}

##### Dragonslayer recruitment (189-203)

# Select a dragonslayer - note: these character flags are NOT to be cleared except for the generic ones!
character_event = {
	id = dragon.189
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			# Generic knights
			10 = {
				modifier = {
					factor = 0
					has_character_flag = got_sir_genericus
				}
				modifier = {
					factor = 0.1
					has_religion_feature = religion_matriarchal
				}
				set_character_flag = got_sir_genericus
				character_event = { id = dragon.190 }
			}
			2 = {
				modifier = {
					factor = 0
					has_character_flag = got_dame_generica
				}
				modifier = {
					factor = 5
					has_religion_feature = religion_matriarchal
				}
				modifier = {
					factor = 0
					has_religion_feature = religion_patriarchal
				}
				set_character_flag = got_dame_generica
				character_event = { id = dragon.191 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_young_crusader
				}
				modifier = {
					factor = 0
					NOT = {
						has_global_flag = christian_crusades_unlocked
					}
				}
				set_character_flag = got_young_crusader
				character_event = { id = dragon.192 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_old_crusader_and_squire
				}
				modifier = {
					factor = 0
					NOT = {
						has_global_flag = christian_crusades_unlocked
					}
				}
				set_character_flag = got_old_crusader_and_squire
				character_event = { id = dragon.193 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_the_huntress
				}
				set_character_flag = got_the_huntress
				character_event = { id = dragon.194 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_the_goliath
				}
				set_character_flag = got_the_goliath
				character_event = { id = dragon.195 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_the_saint
				}
				modifier = {
					factor = 0
					NOT = {
						religion_group = christian
					}
				}
				set_character_flag = got_the_saint
				character_event = { id = dragon.196 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_the_glorious
				}
				set_character_flag = got_the_glorious
				character_event = { id = dragon.197 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_oakenshield
				}
				set_character_flag = got_oakenshield
				character_event = { id = dragon.198 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_the_charming
				}
				set_character_flag = got_the_charming
				character_event = { id = dragon.199 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_the_wyld
				}
				set_character_flag = got_the_wyld
				character_event = { id = dragon.200 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_the_black_arrow
				}
				set_character_flag = got_the_black_arrow
				character_event = { id = dragon.201 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_the_blade
				}
				set_character_flag = got_the_blade
				character_event = { id = dragon.202 }
			}
			1 = {
				modifier = {
					factor = 0
					has_character_flag = got_the_white_lotus
				}
				set_character_flag = got_the_white_lotus
				character_event = { id = dragon.203 }
			}
			
			# Add your own dragonslayers, if you wish!
		}
	}
}

# Sir Genericus, at your service!
character_event = {
	id = dragon.190
	desc = EVTDESC_DRAGON_190
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		any_province = {
			limit = {
				has_province_flag = dragons_lair_province
			}
			random_province = {
				limit = {
					has_owner = yes
					NOT = {
						distance = {
							where = PREV
							value = 250
						}
					}
				}
				save_event_target_as = dragonslayer_province
			}
		}
		create_character = {
			age = 35
			female = no
			dynasty = none
			culture = event_target:dragonslayer_province
			religion = event_target:dragonslayer_province
			attributes = {
				diplomacy = 5
				martial = 7
				stewardship = 4
				intrigue = 2
				learning = 3
			}
			random_traits = yes
			trait = skilled_tactician
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			set_character_flag = dragonslayer_sir_genericus
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_190 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_190 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# Dame Generica, at your service!
character_event = {
	id = dragon.191
	desc = EVTDESC_DRAGON_191
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		any_province = {
			limit = {
				has_province_flag = dragons_lair_province
			}
			random_province = {
				limit = {
					has_owner = yes
					NOT = {
						distance = {
							where = PREV
							value = 250
						}
					}
				}
				save_event_target_as = dragonslayer_province
			}
		}
		create_character = {
			age = 35
			female = yes
			dynasty = none
			culture = event_target:dragonslayer_province
			religion = event_target:dragonslayer_province
			attributes = {
				diplomacy = 5
				martial = 7
				stewardship = 4
				intrigue = 2
				learning = 3
			}
			random_traits = yes
			trait = skilled_tactician
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			set_character_flag = special_marshal
			set_character_flag = dragonslayer_dame_generica
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_191 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_191 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Young Crusader, at your service!
character_event = {
	id = dragon.192
	desc = EVTDESC_DRAGON_192
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 30
			female = no
			dynasty = none
			culture = german
			religion = catholic
			attributes = {
				diplomacy = 7
				martial = 5
				stewardship = 4
				intrigue = 1
				learning = 3
			}
			random_traits = no
			trait = tough_soldier
			trait = brave
			trait = giant
			trait = proud
			trait = strong
			trait = heavy_infantry_leader
			trait = aggressive_leader
			trait = drunkard
			trait = crusader
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			give_nickname = nick_the_crusader_special
			set_character_flag = dragonslayer_the_young_crusader
			set_character_flag = ai_flag_refuse_conversion # We don't want him to lose the Crusader trait
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_192 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_192 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Old Crusader and his squire, at your service!
character_event = {
	id = dragon.193
	desc = EVTDESC_DRAGON_193
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 61
			female = no
			dynasty = none
			culture = german
			religion = catholic
			attributes = {
				diplomacy = 7
				martial = 5
				stewardship = 4
				intrigue = 1
				learning = 3
			}
			random_traits = no
			trait = skilled_tactician
			trait = brave
			trait = giant
			trait = proud
			trait = strong
			trait = heavy_infantry_leader
			trait = unyielding_leader
			trait = crusader
			trait = one_eyed
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			give_nickname = nick_the_crusader_special
			set_character_flag = dragonslayer_the_old_crusader
			set_character_flag = ai_flag_refuse_conversion # We don't want him to lose the Crusader trait
			add_scarred_medium_effect = yes
		}
		create_character = {
			age = 23
			female = yes
			dynasty = none
			culture = swedish
			religion = norse_pagan
			attributes = {
				diplomacy = 7
				martial = 4
				stewardship = 4
				intrigue = 1
				learning = 5
			}
			random_traits = no
			trait = tough_soldier
			trait = brave
			trait = humble
			trait = strong
			trait = inspiring_leader
			trait = kind
			trait = shieldmaiden
		}
		new_character = {
			if = {
				limit = {
					has_global_flag = norse_reformation
				}
				religion = norse_pagan_reformed
			}
			save_event_target_as = new_dragonslayer_2
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			set_character_flag = special_marshal
			give_nickname = nick_the_squire
			add_friend = event_target:new_dragonslayer
			set_character_flag = dragonslayer_the_squire
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_193 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYERS_JOIN_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
			event_target:new_dragonslayer_2 = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_193 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		event_target:new_dragonslayer_2 = {
			random_list = {
				50 = {
					modifier = {
						factor = 0
						event_target:new_dragonslayer = {
							is_alive = no
						}
					}
					leave_court_effect = yes
				}
				50 = {
					modifier = {
						factor = 0
						event_target:new_dragonslayer = {
							is_alive = yes
						}
					}
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Huntress, at your service!
character_event = {
	id = dragon.194
	desc = EVTDESC_DRAGON_194
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 30
			female = yes
			dynasty = none
			culture = norse
			religion = norse_pagan
			attributes = {
				diplomacy = 5
				martial = 7
				stewardship = 3
				intrigue = 4
				learning = 1
			}
			random_traits = no
			trait = skilled_tactician
			trait = brave
			trait = hunter
			trait = proud
			trait = ambitious
			trait = wroth
		}
		new_character = {
			if = {
				limit = {
					has_global_flag = norse_reformation
				}
				religion = norse_pagan_reformed
			}
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			set_character_flag = special_marshal
			give_nickname = nick_the_huntress
			set_character_flag = dragonslayer_the_huntress
			if = {
				limit = {
					has_dlc = "Holy Fury"
				}
				add_random_tattoo_effect = yes
				join_society = warrior_lodge_norse
			}
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_194 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_194 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Goliath, at your service!
character_event = {
	id = dragon.195
	desc = EVTDESC_DRAGON_195
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 40
			female = no
			dynasty = none
			culture = ROOT
			religion = ROOT
			attributes = {
				diplomacy = 3
				martial = 9
				stewardship = 1
				intrigue = 1
				learning = 1
			}
			random_traits = no
			trait = tough_soldier
			trait = brave
			trait = giant
			trait = strong
			trait = dull
			trait = wroth
			trait = lustful
			trait = drunkard
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			give_nickname = nick_the_goliath
			set_character_flag = dragonslayer_the_goliath
			add_trait = berserker # Needs to be added here since it can't be set without the character flag
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_195 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_195 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Saint, at your service!
character_event = {
	id = dragon.196
	desc = EVTDESC_DRAGON_196
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			10 = {
				create_character = {
					age = 25
					female = no
					dynasty = none
					culture = english
					religion = catholic
					attributes = {
						diplomacy = 7
						martial = 9
						stewardship = 4
						intrigue = 1
						learning = 3
					}
					random_traits = no
					trait = skilled_tactician
					trait = brave
					trait = zealous
					trait = just
				}
			}
			10 = {
				create_character = {
					age = 25
					female = yes
					dynasty = none
					culture = english
					religion = catholic
					attributes = {
						diplomacy = 7
						martial = 9
						stewardship = 4
						intrigue = 1
						learning = 3
					}
					random_traits = no
					trait = skilled_tactician
					trait = brave
					trait = zealous
					trait = just
				}
			}
			10 = {
				create_character = {
					age = 25
					female = no
					dynasty = none
					culture = georgian
					religion = miaphysite
					attributes = {
						diplomacy = 7
						martial = 9
						stewardship = 4
						intrigue = 1
						learning = 3
					}
					random_traits = no
					trait = skilled_tactician
					trait = brave
					trait = zealous
					trait = just
				}
			}
			10 = {
				create_character = {
					age = 25
					female = yes
					dynasty = none
					culture = georgian
					religion = miaphysite
					attributes = {
						diplomacy = 7
						martial = 9
						stewardship = 4
						intrigue = 1
						learning = 3
					}
					random_traits = no
					trait = skilled_tactician
					trait = brave
					trait = zealous
					trait = just
				}
			}
			5 = {
				create_character = {
					age = 25
					female = no
					dynasty = none
					culture = ethiopian
					religion = miaphysite
					attributes = {
						diplomacy = 7
						martial = 9
						stewardship = 4
						intrigue = 1
						learning = 3
					}
					random_traits = no
					trait = skilled_tactician
					trait = brave
					trait = zealous
					trait = just
				}
			}
			5 = {
				create_character = {
					age = 25
					female = yes
					dynasty = none
					culture = ethiopian
					religion = miaphysite
					attributes = {
						diplomacy = 7
						martial = 9
						stewardship = 4
						intrigue = 1
						learning = 3
					}
					random_traits = no
					trait = skilled_tactician
					trait = brave
					trait = zealous
					trait = just
				}
			}
			5 = {
				create_character = {
					age = 25
					female = no
					dynasty = none
					culture = ethiopian
					religion = monophysite
					attributes = {
						diplomacy = 7
						martial = 9
						stewardship = 4
						intrigue = 1
						learning = 3
					}
					random_traits = no
					trait = skilled_tactician
					trait = brave
					trait = zealous
					trait = just
				}
			}
			5 = {
				create_character = {
					age = 25
					female = yes
					dynasty = none
					culture = ethiopian
					religion = monophysite
					attributes = {
						diplomacy = 7
						martial = 9
						stewardship = 4
						intrigue = 1
						learning = 3
					}
					random_traits = no
					trait = skilled_tactician
					trait = brave
					trait = zealous
					trait = just
				}
			}
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			if = {
				limit = {
					is_female = yes
				}
				set_character_flag = special_marshal
			}
			give_nickname = nick_of_lydda
			set_character_flag = dragonslayer_the_saint
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_196 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_196 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Glorious, at your service!
character_event = {
	id = dragon.197
	desc = EVTDESC_DRAGON_197
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 38
			female = no
			dynasty = none
			culture = levantine_arabic
			religion = ROOT
			attributes = {
				diplomacy = 3
				martial = 2
				stewardship = 1
				intrigue = 1
				learning = 9
			}
			random_traits = no
			trait = fair
			trait = homosexual
			trait = kind
			trait = gregarious
			trait = midas_touched
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			give_nickname = nick_of_the_glorious_goods
			set_character_flag = dragonslayer_the_glorious
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_197 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_197 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# Oakenshield, at your service!
character_event = {
	id = dragon.198
	desc = EVTDESC_DRAGON_198
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 40 # Actually much older, but that'd make him drop dead...
			female = no
			dynasty = none
			culture = norse
			religion = norse_pagan
			attributes = {
				diplomacy = 1
				martial = 6
				stewardship = 5
				intrigue = 2
				learning = 3
			}
			random_traits = no
			trait = dwarf
			trait = stubborn
			trait = proud
			trait = tough_soldier
		}
		new_character = {
			if = {
				limit = {
					has_global_flag = norse_reformation
				}
				religion = norse_pagan_reformed
			}
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refu
			set_character_flag = dragonslayer_oakenshield
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_198 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_198 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Charming, at your service!
character_event = {
	id = dragon.199
	desc = EVTDESC_DRAGON_199
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 25
			female = no
			dynasty = none
			culture = ROOT
			religion = ROOT
			attributes = {
				diplomacy = 6
				martial = 1
				stewardship = 1
				intrigue = 6
				learning = 1
			}
			random_traits = no
			trait = fair
			trait = misguided_warrior
			trait = slow
			trait = lustful
			trait = proud
			trait = deceitful
			trait = duelist
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			give_nickname = nick_the_charming
			set_character_flag = dragonslayer_the_charming
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_199 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_199 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Wyld, "at your service" (HA!)!
character_event = {
	id = dragon.200
	desc = EVTDESC_DRAGON_200
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 40 # Not really...
			female = no
			dynasty = none
			culture = ROOT
			religion = ROOT
			attributes = {
				diplomacy = 1
				martial = 6
				stewardship = 1
				intrigue = 9
				learning = 1
			}
			random_traits = no
			trait = brilliant_strategist
			trait = genius
			trait = duelist
			trait = patient
			trait = envious
			trait = proud
			trait = deceitful
			trait = organizer
			trait = trickster
		}
		new_character = {
			remove_trait = master_of_flame # Way of the Dragon; he'd HATE that trait!
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			give_nickname = nick_the_wyld
			set_character_flag = dragonslayer_the_wyld
			
			# If possible, he becomes a DW
			if = {
				limit = {
					has_dlc = "Mystics"
					has_game_rule = {
						name = devil_worshipers
						value = default
					}
				}
				if = {
					limit = {
						has_satanists_prerequisites = yes
					}
					join_society = the_satanists
				}
				if = {
					limit = {
						has_cold_ones_prerequisites = yes
					}
					join_society = the_cold_ones
				}
				if = {
					limit = {
						has_plaguebringers_prerequisites = yes
					}
					join_society = the_plaguebringers
				}
				if = {
					limit = {
						has_cult_of_kali_prerequisites = yes
					}
					join_society = the_cult_of_kali
				}
				if = {
					limit = {
						has_trollcrafters_prerequisites = yes
					}
					join_society = the_trollcrafters
				}
				if = {
					limit = {
						has_vodouns_prerequisites = yes
					}
					join_society = the_bacchants
				}
				if = {
					limit = {
						has_cult_of_kali_prerequisites = yes
					}
					join_society = the_vodouns
				}
				if = {
					limit = {
						has_ghost_gatherers_prerequisites = yes
					}
					join_society = the_ghost_gatherers
				}
				if = {
					limit = {
						has_underworld_triad_prerequisites = yes
					}
					join_society = the_underworld_triad
				}
				if = {
					limit = {
						has_sacrificers_prerequisites = yes
					}
					join_society = the_sacrificers
				}
				if = {
					limit = {
						has_procession_of_pox_prerequisites = yes
					}
					join_society = the_procession_of_pox
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_200 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_200 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Black Arrow, at your service!
character_event = {
	id = dragon.201
	desc = EVTDESC_DRAGON_201
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 45
			female = no
			dynasty = none
			culture = ROOT
			religion = ROOT
			attributes = {
				diplomacy = 7
				martial = 2
				stewardship = 2
				intrigue = 1
				learning = 2
			}
			random_traits = no
			trait = peasant_leader
			trait = poet
			trait = tough_soldier
			trait = hunter
			trait = gregarious
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			give_nickname = nick_the_of_the_black_arrow
			set_character_flag = dragonslayer_of_the_black_arrow
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_201 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_201 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The Blade, at your service!
character_event = {
	id = dragon.202
	desc = EVTDESC_DRAGON_202
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 55
			female = yes
			dynasty = none
			culture = breton
			religion = ROOT
			attributes = {
				diplomacy = 1
				martial = 5
				stewardship = 3
				intrigue = 7
				learning = 3
			}
			random_traits = no
			trait = paranoid
			trait = intricate_webweaver
			trait = stubborn
			trait = brave
			trait = proud
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			set_character_flag = special_marshal
			give_nickname = nick_the_blade
			set_character_flag = dragonslayer_the_blade
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_202 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_202 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}

# The White Lotus, at your service!
character_event = {
	id = dragon.203
	desc = EVTDESC_DRAGON_203
	picture = GFX_evt_rider_adventure
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			age = 60
			female = no
			dynasty = none
			culture = han
			religion = taoist
			attributes = {
				diplomacy = 5
				martial = 2
				stewardship = 4
				intrigue = 1
				learning = 9
			}
			random_traits = no
			trait = patient
			trait = humble
			trait = kind
			trait = gregarious
			trait = content
			trait = scholarly_theologian
		}
		new_character = {
			save_event_target_as = new_dragonslayer
			set_character_flag = ai_flag_refuse_concubinage
			set_character_flag = ai_flag_refuse_marriage
			give_nickname = nick_of_the_white_lotus
			set_character_flag = dragonslayer_of_the_white_lotus
		}
	}
	
	option = {
		name = EVTOPTA_DRAGON_203 # Welcome aboard!
		
		custom_tooltip = {
			text = DRAGONSLAYER_JOINS_THE_PARTY
			event_target:new_dragonslayer = {
				add_trait = hunting_dragons
				opinion = {
					who = ROOT
					modifier = hunting_dragons_together
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_DRAGON_203 # Get lost!
		
		event_target:new_dragonslayer = {
			random_list = {
				50 = {
					leave_court_effect = yes
				}
				50 = {
					leave_court_and_die_effect = yes
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
	}
}