# Treasure Fleet port events for locals
# by Silverswee(e)per

namespace = soh

# IDs 8601-8800 reserved

##### Port events setup

# Main setup event
province_event = {
	id = soh.8601
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		treasure_fleet_epidemic_flag_effect = yes # Figure out which epidemics might be present
		
		any_playable_ruler = {
			limit = {
				can_interact_with_treasure_fleet_trigger = yes
			}
			
			character_event = { id = soh.8602 } # Actual setup
		}
	}
}

# Local ruler event setup
character_event = {
	id = soh.8602
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			1 = {
				trigger = {
					is_tribal = no
					treasure_fleet_has_immigrants_trigger = yes
				}
				
				mult_modifier = {
					factor = 5
					has_dlc = "Jade Dragon" # Modifiers
				}
				
				# Influx of Chinese people
				character_event = { id = soh.8603 days = 5 random = 10 }
			}
			
			5 = {
				trigger = {
					independent = yes
					NOR = {
						suzerain = {
							is_chinese_emperor_trigger = yes
						}
						has_global_flag = treasure_fleet_sabotage_opportunity
						e_china = {
							holder_scope = {
								OR = {
									is_friend = ROOT
									is_lover = ROOT
								}
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					e_china = {
						holder_scope = {
							is_rival = ROOT
						}
					}
				}
				
				# Sabotage opportunity
				set_global_flag = treasure_fleet_sabotage_opportunity
				character_event = { id = soh.8613 }
			}
			
			10 = {
				trigger = {
					independent = yes
					is_tributary = no
				}
				
				# Offer to become tributary?
				character_event = { id = soh.8637 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					independent = yes
					suzerain = {
						is_chinese_emperor_trigger = yes
					}
					NOT = {
						is_tributary = {
							type = chinese_client_state
						}
					}
				}
				
				# Offer to increase tributary tier if beneath Client State tier
				character_event = { id = soh.8641 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					has_dlc = "Jade Dragon"
					wealth >= 100
				}
				
				# Gold for Grace?
				character_event = { id = soh.8645 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					has_dlc = "Jade Dragon"
					wealth >= 100
				}
				
				# Supplies for Grace?
				character_event = { id = soh.8649 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					has_dlc = "Jade Dragon"
					ai = yes
				}
				
				# Artifact for Grace? - AI only!
				character_event = { id = soh.8653 days = 5 random = 10 }
			}
			
			25 = {
				trigger = {
					NOT = {
						trait = zealous
					}
					e_china = {
						holder_scope = {
							any_realm_province = {
								NOT = {
									religion_group = ROOT
								}
							}
						}
					}
				}
				
				# Sympathy
				character_event = { id = soh.8657 days = 5 random = 10 }
			}
			
			10 = {
				# Random (non-JD) courtier
				character_event = { id = soh.8658 days = 5 random = 10 }
			}
			
			2 = {
				trigger = {
					has_dlc = "Jade Dragon"
				}
				
				# Random JD courtier
				character_event = { id = soh.8664 days = 5 random = 10 }
			}
			
			1 = {
				trigger = {
					any_demesne_province = {
						port = yes
						is_in_active_treasure_fleet_region_trigger = yes
						treasure_fleet_tech_can_spread_here_trigger = yes
					}
				}
				
				# Tech spread
				character_event = { id = soh.8670 days = 5 random = 10 }
			}
			
			10 = {
				# Tech points (small amount)
				character_event = { id = soh.8689 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					has_dlc = "Reapers"
					any_demesne_province = {
						port = yes
						is_in_active_treasure_fleet_region_trigger = yes
						NOT = {
							has_province_modifier = prosperity_modifier_3
						}
					}
				}
				
				# Prosperity increase
				character_event = { id = soh.8690 days = 5 random = 10 }
			}
			
			10 = {
				# Fireworks are nice
				character_event = { id = soh.8691 days = 5 random = 10 }
			}
			
			10 = {
				# Fireworks are stressful
				character_event = { id = soh.8692 days = 5 random = 10 }
			}
			
			25 = {
				trigger = {
					is_adult = yes
					e_china = {
						any_realm_character = {
							trait = treasure_fleet_voyage
							has_epidemic = no
							NOR = {
								has_any_opinion_modifier = opinion_tf_guest
								has_character_flag = left_treasure_fleet_voyage
							}
						}
					}
				}
				
				# Invite guests?
				character_event = { id = soh.8693 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					is_adult = yes
				}
				
				mult_modifier = {
					factor = 2
					trait = drunkard
				}
				
				# Drinking with TF sailors
				character_event = { id = soh.8741 days = 5 random = 10 }
			}
			
			5 = {
				trigger = {
					is_adult = yes
					OR = {
						trait = attractive
						trait = groomed
					}
					NOT = {
						trait = disfigured
					}
					is_ill = no
				}
				
				mult_modifier = {
					factor = 0.1
					is_maimed_trigger = yes
				}
				
				mult_modifier = {
					factor = 0.1
					OR = {
						trait = ugly
						trait = uncouth
					}
				}
				
				mult_modifier = {
					factor = 2
					OR = {
						trait = master_seducer
						trait = master_seductress
					}
				}
				
				mult_modifier = {
					factor = 0.1
					OR = {
						trait = clubfooted
						trait = dwarf
						trait = harelip
						trait = hunchback
						trait = inbred
					}
				}
				
				# Attractive/Groomed character might get tumble opportunity
				character_event = { id = soh.8749 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					trait = duelist
				}
				
				# Duelist gets to duel
				character_event = { id = soh.8750 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					trait = game_master
				}
				
				# Game master tries new games
				character_event = { id = soh.8754 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					trait = game_master
				}
				
				# Game master shows off local games
				character_event = { id = soh.8757 days = 5 random = 10 }
			}
			
			25 = {
				trigger = {
					trait = scholar
				}
				
				# Scholar learns something
				character_event = { id = soh.8760 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					trait = humble
				}
				
				# Humble character impresses Chinese visitors
				character_event = { id = soh.8766 days = 5 random = 10 }
			}
			
			10 = {
				mult_modifier = {
					factor = 2
					trait = gluttonous
				}
				
				# Trying new food - become more Gluttonous
				character_event = { id = soh.8767 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					NOT = {
						trait = temperate
					}
				}
				mult_modifier = {
					factor = 2
					trait = gluttonous
				}
				
				# Trying new food - become fatter
				character_event = { id = soh.8768 days = 5 random = 10 }
			}
			
			10 = {
				mult_modifier = {
					factor = 2
					trait = greedy
				}
				
				# Trade deals - become less Charitable
				character_event = { id = soh.8769 days = 5 random = 10 }
			}
			
			10 = {
				mult_modifier = {
					factor = 2
					trait = envious
				}
				
				# Become more envious due to hearing about China
				character_event = { id = soh.8770 days = 5 random = 10 }
			}
			
			25 = {
				trigger = {
					trait = proud
				}
				
				# Proud character looks down on Chinese characters
				character_event = { id = soh.8771 days = 5 random = 10 }
			}
			
			10 = {
				mult_modifier = {
					factor = 2
					trait = just
				}
				
				# Sailors break the law - punish them or let them go?
				character_event = { id = soh.8772 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					e_china = {
						holder_scope = {
							relative_power = {
								who = ROOT
								power >= 1
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					trait = craven
				}
				
				# Fear of China
				character_event = { id = soh.8773 days = 5 random = 10 }
			}
			
			10 = {
				mult_modifier = {
					factor = 10
					trait = paranoid
				}
				
				# Paranoid character fears an invasion being planned
				character_event = { id = soh.8774 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					trait = shy
				}
				
				# Shy character might decide to interact with Treasure Fleet
				character_event = { id = soh.8775 days = 5 random = 10 }
			}
			
			10 = {
				trigger = {
					can_have_chinese_imperial_trigger = no
				}
				
				mult_modifier = {
					factor = 0.1
					can_have_confucian_bureaucracy_and_eastern_imperial_trigger = yes
				}
				
				mult_modifier = {
					factor = 5
					trait = zealous
				}
				
				# Foreign religions are too weird - become more Zealous
				character_event = { id = soh.8776 days = 5 random = 10 }
			}
			
			25 = {
				trigger = {
					trait = faqih
				}
				
				# Faqih impresses sailors
				character_event = { id = soh.8777 days = 5 random = 10 }
			}
			
			100 = {
				mult_modifier = {
					factor = 2
					ai = yes
				}
				
				# Nothing
			}
		}
	}
}



##### Port events - non-trait events

### Influx of Chinese people

# Welcome settlers?
character_event = {
	id = soh.8603
	desc = EVTDESC_SOH_8603
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		random_demesne_province = {
			limit = {
				port = yes
				is_in_active_treasure_fleet_region_trigger = yes
			}
			
			save_event_target_as = tf_settler_province
		}
		
		e_china = {
			holder_scope = {
				random_realm_province = {
					limit = {
						is_connected_to = {
							sub_realm = no
							target = c_hangzhou
							land_gap = no
							naval_distance = yes
						}
					}
					
					preferred_limit = {
						port = yes
					}
					
					save_event_target_as = tf_settler_origin
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8603 # Yes!
		
		hidden_tooltip = {
			decrease_treasure_fleet_immigrants_small_effect = yes
			
			if = {
				limit = {
					has_dlc = "Reapers"
				}
				
				hidden_tooltip = {
					event_target:tf_settler_province = {
						change_variable = { which = prosperity_value value = 6 }
					}
				}
			}
		}
		
		hidden_tooltip = {
			random_list = {
				10 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					
					character_event = { id = soh.8604 days = 7 random = 7 } # Got paper mill
				}
				
				10 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					
					character_event = { id = soh.8605 days = 7 random = 7 } # Got fireworks guild
				}
				
				10 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					
					character_event = { id = soh.8606 days = 7 random = 7 } # Got dry docks
				}
				
				10 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					
					character_event = { id = soh.8607 days = 7 random = 7 } # Got administrative outpost
				}
				
				10 = {
					trigger = {
						has_dlc = "Jade Dragon"
					}
					
					character_event = { id = soh.8608 days = 7 random = 7 } # Got blast furnace
				}
				
				10 = {
					character_event = { id = soh.8609 days = 7 random = 7 } # Rowdy newcomers
				}
				
				1 = {
					trigger = {
						NOT = {
							event_target:tf_settler_origin = {
								religion = event_target:tf_settler_province
							}
						}
					}
					
					mult_modifier = {
						factor = 0.1
						NOT = {
							event_target:tf_settler_origin = {
								religion_group = event_target:tf_settler_province
							}
						}
					}
					
					character_event = { id = soh.8610 days = 7 random = 7 } # Province converts religion
				}
				
				1 = {
					trigger = {
						NOT = {
							event_target:tf_settler_origin = {
								culture = event_target:tf_settler_province
							}
						}
					}
					
					mult_modifier = {
						factor = 0.1
						NOT = {
							event_target:tf_settler_origin = {
								culture_group = event_target:tf_settler_province
							}
						}
					}
					
					character_event = { id = soh.8611 days = 7 random = 7 } # Province converts culture
				}
				
				10 = {
					character_event = { id = soh.8612 days = 7 random = 7 } # Nothing of note
				}
			}
		}
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = paranoid
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8603 # No!
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				NOT = {
					trait = paranoid
				}
			}
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = trusting
			}
		}
	}
}

# Got a paper mill
character_event = {
	id = soh.8604
	desc = EVTDESC_SOH_8604
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8604 # That's great!
		
		event_target:tf_settler_province = {
			add_province_modifier = {
				name = jd_paper_mill
				years = 20
			}
		}
	}
}

# Got a fireworks guild
character_event = {
	id = soh.8605
	desc = EVTDESC_SOH_8605
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8605 # That's great!
		
		event_target:tf_settler_province = {
			add_province_modifier = {
				name = jd_fireworks_guild
				years = 20
			}
		}
	}
}

# Got dry docks
character_event = {
	id = soh.8606
	desc = EVTDESC_SOH_8606
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8606 # That's great!
		
		event_target:tf_settler_province = {
			add_province_modifier = {
				name = jd_dry_docks
				years = 20
			}
		}
	}
}

# Got an administrative outpost
character_event = {
	id = soh.8607
	desc = EVTDESC_SOH_8607
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8607 # That's great!
		
		event_target:tf_settler_province = {
			add_province_modifier = {
				name = jd_administrative_outpost
				years = 20
			}
		}
	}
}

# Got a blast furnace
character_event = {
	id = soh.8608
	desc = EVTDESC_SOH_8608
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8608 # That's great!
		
		event_target:tf_settler_province = {
			add_province_modifier = {
				name = jd_blast_furnace
				years = 20
			}
		}
	}
}

# Rowdy newcomers - revolt risk
character_event = {
	id = soh.8609
	desc = EVTDESC_SOH_8609
	picture = GFX_evt_china_unrest
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8609 # They'd better behave!
		
		event_target:tf_settler_province = {
			add_province_modifier = {
				name = peasant_unrest
				years = 10
			}
		}
	}
}

# Province converts religion
character_event = {
	id = soh.8610
	desc = EVTDESC_SOH_8610
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			true_religion = event_target:tf_settler_origin
		}
		
		name = EVTOPTA_SOH_8610 # That's great!
		
		event_target:tf_settler_province = {
			religion = event_target:tf_settler_origin
		}
	}
	
	option = {
		trigger = {
			NOT = {
				true_religion = event_target:tf_settler_origin
			}
		}
		
		name = EVTOPTB_SOH_8610 # That's not good!
		
		event_target:tf_settler_province = {
			religion = event_target:tf_settler_origin
		}
	}
}

# Province converts culture
character_event = {
	id = soh.8611
	desc = EVTDESC_SOH_8611
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			culture = event_target:tf_settler_origin
		}
		
		name = EVTOPTA_SOH_8611 # That's great!
		
		event_target:tf_settler_province = {
			culture = event_target:tf_settler_origin
		}
	}
	
	option = {
		trigger = {
			NOT = {
				culture = event_target:tf_settler_origin
			}
		}
		
		name = EVTOPTB_SOH_8611 # That's not good!
		
		event_target:tf_settler_province = {
			culture = event_target:tf_settler_origin
		}
	}
}

# Nothing of note
character_event = {
	id = soh.8612
	desc = EVTDESC_SOH_8612
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8612 # They seem to be fitting in...
	}
}

### Sabotage of TF

# Do you want to attempt to sabotage the TF?
character_event = {
	id = soh.8613
	desc = EVTDESC_SOH_8613
	picture = GFX_evt_war_planning
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8613 # Yes!
		
		pacifists_lose_piety_effect = yes
		
		save_event_target_as = saboteur
		
		FROMFROM = {
			province_event = { id = soh.8614 days = 1 } # Check outcome
		}
		
		ai_chance = {
			trigger = {
				NOR = {
					trait = content
					trait = craven
					trait = kind
				}
				root_hates_china_trigger = yes
			}
			
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8613 # No!
		
		if = {
			limit = {
				root_hates_china_trigger = yes
			}
			
			prestige = -100
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 0.1
				trait = brave
			}
			
			mult_modifier = {
				factor = 0.1
				trait = wroth
			}
			
			mult_modifier = {
				factor = 0.1
				trait = cruel
			}
		}
	}
}

# Calculate outcome
province_event = {
	id = soh.8614
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# Determine how the fight goes
		set_variable = {
			which = tf_fight_difficulty
			value = 0
		}
		
		FROM = {
			export_to_variable = {
				which = tf_fight_difficulty
				value = martial
			}
		}
		
		change_variable = {
			which = tf_fight_difficulty
			which = FROM
		}
		
		FROM = {
			export_to_variable = {
				which = tf_fight_difficulty
				value = intrigue
			}
			
			divide_variable = {
				which = tf_fight_difficulty
				value = 2
			}
		}
		
		change_variable = {
			which = tf_fight_difficulty
			which = FROM
		}
		
		set_variable = {
			which = tf_fighting_value
			which = treasure_fleet_ship_strength
		}
		
		divide_variable = {
			which = tf_fighting_value
			value = 2
		}
		
		change_variable = {
			which = tf_fighting_value
			which = treasure_fleet_army_strength
		}
		
		d_treasure_fleet = {
			holder_scope = {
				export_to_variable = {
					which = tf_fighting_value
					value = martial
				}
				
				ROOT = {
					change_variable = {
						which = tf_fighting_value
						which = PREV
					}
				}
			}
		}
		
		subtract_variable = {
			which = tf_fighting_value
			which = tf_fight_difficulty
		}
		
		random_list = {
			5 = {
				trigger = {
					check_variable = {
						which = tf_fighting_value
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = tf_fighting_value
						value >= 25
					}
				}
				
				# No damage
				event_target:saboteur = {
					character_event = { id = soh.8615 }
				}
			}
			
			10 = {
				trigger = {
					check_variable = {
						which = treasure_fleet_ship_strength
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = tf_fighting_value
						value >= 10
					}
				}
				
				decrease_treasure_fleet_ship_strength_small_effect = yes
				
				decrease_treasure_fleet_army_strength_small_effect = yes
				
				# Minor damage
				event_target:saboteur = {
					character_event = { id = soh.8619 }
				}
			}
			
			50 = {
				mult_modifier = {
					factor = 2
					check_variable = {
						which = treasure_fleet_ship_strength
						value < 10
					}
				}
				
				decrease_treasure_fleet_ship_strength_medium_effect = yes
				
				decrease_treasure_fleet_army_strength_medium_effect = yes
				
				decrease_treasure_fleet_supplies_small_effect = yes
				
				decrease_treasure_fleet_artifacts_small_effect = yes
				
				decrease_treasure_fleet_wealth_small_effect = yes
				
				decrease_treasure_fleet_courtiers_small_effect = yes
				
				decrease_treasure_fleet_modifiers_small_effect = yes
				
				decrease_treasure_fleet_immigrants_small_effect = yes
				
				# Medium damage
				event_target:saboteur = {
					character_event = { id = soh.8623 }
				}
			}
			
			10 = {
				trigger = {
					check_variable = {
						which = tf_fighting_value
						value < 0
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = treasure_fleet_ship_strength
						value = 10
					}
				}
				
				decrease_treasure_fleet_ship_strength_large_effect = yes
				
				decrease_treasure_fleet_army_strength_large_effect = yes
				
				decrease_treasure_fleet_supplies_medium_effect = yes
				
				decrease_treasure_fleet_artifacts_medium_effect = yes
				
				decrease_treasure_fleet_wealth_medium_effect = yes
				
				decrease_treasure_fleet_courtiers_medium_effect = yes
				
				decrease_treasure_fleet_modifiers_medium_effect = yes
				
				decrease_treasure_fleet_immigrants_medium_effect = yes
				
				# Major damage
				event_target:saboteur = {
					character_event = { id = soh.8627 }
				}
			}
			
			5 = {
				trigger = {
					check_variable = {
						which = tf_fighting_value
						value < 0
					}
					check_variable = {
						which = treasure_fleet_army_strength
						value < 10
					}
					check_variable = {
						which = treasure_fleet_ship_strength
						value < 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = tf_fighting_value
						value < 0
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = tf_fighting_value
						value < -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = treasure_fleet_army_strength
						value < 5
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = treasure_fleet_ship_strength
						value < 5
					}
				}
				
				# Treasure Fleet destroyed
				set_global_flag = treasure_fleet_destroyed
				
				event_target:saboteur = {
					character_event = { id = soh.8631 }
				}
			}
		}
	}
}

# TF sabotage - no damage - saboteur
character_event = {
	id = soh.8615
	desc = EVTDESC_SOH_8615
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8615 # Curses!
		
		prestige = -100
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			detract_grace_super_huge_effect = yes
			
			e_china = {
				holder_scope = {
					character_event = { id = soh.8618 } # Inform EoC
				}
			}
		}
		
		d_treasure_fleet = {
			holder_scope = {
				character_event = { id = soh.8616 } # Inform commander
			}
		}
		
		e_china = {
			holder_scope = {
				any_realm_lord = {
					limit = {
						ai = yes
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					character_event = { id = soh.8617 } # Inform those aboard the TF
				}
			}
		}
	}
}

# TF sabotage - no damage - commander
character_event = {
	id = soh.8616
	desc = EVTDESC_SOH_8616
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROMFROM = {
				check_variable = {
					which = treasure_fleet_army_strength
					value = 20
				}
			}
		}
		
		name = EVTOPTA_SOH_8616 # FROM will pay for this!
		
		add_rival = FROM
		
		FROM = {
			save_event_target_as = treasure_fleet_attacker
			
			random_realm_province = {
				limit = {
					is_in_active_treasure_fleet_region_trigger = yes
				}
				
				save_event_target_as = treasure_fleet_beachhead
			}
		}
		
		create_new_court_eunuch_effect = yes
		
		new_character = {
			set_defacto_liege = THIS
			create_title = {
				tier = DUKE
				landless = yes
				adventurer = yes
				culture = ROOT
				name = "PUNITIVE_EXPEDITION"
				holder = THIS
				base_title = THIS
			}
			
			save_event_target_as = treasure_fleet_punitive_expedition_leader
			
			disembark_regiments_until_stronger_or_unable_to_continue_effect = yes
			
			war = {
				target = event_target:treasure_fleet_attacker
				casus_belli = treasure_fleet_punitive_expedition
			}
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8616 # I can't do anything about this...
		
		add_rival = FROM
		
		prestige = -100
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				trait = brave
			}
		}
	}
}

# TF sabotage - no damage - other members
character_event = {
	id = soh.8617
	desc = EVTDESC_SOH_8617
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8617 # Not even a scratch!
	}
}

# TF sabotage - no damage - EoC
character_event = {
	id = soh.8618
	desc = EVTDESC_SOH_8618
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8618 # This will not be forgotten!
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			add_rival = event_target:saboteur
		}
		
		opinion = {
			who = FROM
			modifier = opinion_attacked_treasure_fleet
		}
	}
}

# TF sabotage - minor damage - saboteur
character_event = {
	id = soh.8619
	desc = EVTDESC_SOH_8619
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8619 # Better than nothing...
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			detract_grace_super_huge_effect = yes
			
			e_china = {
				holder_scope = {
					character_event = { id = soh.8622 } # Inform EoC
				}
			}
		}
		
		d_treasure_fleet = {
			holder_scope = {
				character_event = { id = soh.8620 } # Inform commander
			}
		}
		
		e_china = {
			holder_scope = {
				any_realm_lord = {
					limit = {
						ai = yes
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					character_event = { id = soh.8621 } # Inform those aboard the TF
				}
			}
		}
	}
}

# TF sabotage - minor damage - commander
character_event = {
	id = soh.8620
	desc = EVTDESC_SOH_8620
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROMFROM = {
				check_variable = {
					which = treasure_fleet_army_strength
					value = 20
				}
			}
		}
		
		name = EVTOPTA_SOH_8620 # FROM will pay for this!
		
		add_rival = FROM
		
		FROM = {
			save_event_target_as = treasure_fleet_attacker
			
			random_realm_province = {
				limit = {
					is_in_active_treasure_fleet_region_trigger = yes
				}
				
				save_event_target_as = treasure_fleet_beachhead
			}
		}
		
		create_new_court_eunuch_effect = yes
		
		new_character = {
			set_defacto_liege = THIS
			create_title = {
				tier = DUKE
				landless = yes
				adventurer = yes
				culture = ROOT
				name = "PUNITIVE_EXPEDITION"
				holder = THIS
				base_title = THIS
			}
			
			save_event_target_as = treasure_fleet_punitive_expedition_leader
			
			disembark_regiments_until_stronger_or_unable_to_continue_effect = yes
			
			war = {
				target = event_target:treasure_fleet_attacker
				casus_belli = treasure_fleet_punitive_expedition
			}
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8620 # I can't do anything about this...
		
		add_rival = FROM
		
		prestige = -100
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = brave
			}
		}
	}
}

# TF sabotage - minor damage - other members
character_event = {
	id = soh.8621
	desc = EVTDESC_SOH_8621
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8621 # All that for a drop of blood...
	}
}

# TF sabotage - minor damage - EoC
character_event = {
	id = soh.8622
	desc = EVTDESC_SOH_8622
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8622 # This will not be forgotten!
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			add_rival = event_target:saboteur
		}
		
		opinion = {
			who = FROM
			modifier = opinion_attacked_treasure_fleet
		}
	}
}

# TF sabotage - medium damage - saboteur
character_event = {
	id = soh.8623
	desc = EVTDESC_SOH_8623
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8623 # That probably hurt them...
		
		prestige = 100
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			detract_grace_super_huge_effect = yes
			
			e_china = {
				holder_scope = {
					character_event = { id = soh.8626 } # Inform EoC
				}
			}
		}
		
		d_treasure_fleet = {
			holder_scope = {
				character_event = { id = soh.8624 } # Inform commander
			}
		}
		
		e_china = {
			holder_scope = {
				any_realm_lord = {
					limit = {
						ai = yes
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					character_event = { id = soh.8625 } # Inform those aboard the TF
				}
			}
		}
	}
}

# TF sabotage - medium damage - commander
character_event = {
	id = soh.8624
	desc = EVTDESC_SOH_8624
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROMFROM = {
				check_variable = {
					which = treasure_fleet_army_strength
					value = 20
				}
			}
		}
		
		name = EVTOPTA_SOH_8624 # FROM will pay for this!
		
		add_rival = FROM
		
		FROM = {
			save_event_target_as = treasure_fleet_attacker
			
			random_realm_province = {
				limit = {
					is_in_active_treasure_fleet_region_trigger = yes
				}
				
				save_event_target_as = treasure_fleet_beachhead
			}
		}
		
		create_new_court_eunuch_effect = yes
		
		new_character = {
			set_defacto_liege = THIS
			create_title = {
				tier = DUKE
				landless = yes
				adventurer = yes
				culture = ROOT
				name = "PUNITIVE_EXPEDITION"
				holder = THIS
				base_title = THIS
			}
			
			save_event_target_as = treasure_fleet_punitive_expedition_leader
			
			disembark_regiments_until_stronger_or_unable_to_continue_effect = yes
			
			war = {
				target = event_target:treasure_fleet_attacker
				casus_belli = treasure_fleet_punitive_expedition
			}
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8624 # I can't do anything about this...
		
		add_rival = FROM
		
		prestige = -100
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				trait = brave
			}
		}
	}
}

# TF sabotage - medium damage - other members
character_event = {
	id = soh.8625
	desc = EVTDESC_SOH_8625
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8625 # Could have been a lot worse...
	}
}

# TF sabotage - medium damage - EoC
character_event = {
	id = soh.8626
	desc = EVTDESC_SOH_8626
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8626 # This will not be forgotten!
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			add_rival = event_target:saboteur
		}
		
		opinion = {
			who = FROM
			modifier = opinion_attacked_treasure_fleet
		}
	}
}

# TF sabotage - major damage - saboteur
character_event = {
	id = soh.8627
	desc = EVTDESC_SOH_8627
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8627 # They felt that!
		
		prestige = 200
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			detract_grace_super_huge_effect = yes
			
			e_china = {
				holder_scope = {
					character_event = { id = soh.8630 } # Inform EoC
				}
			}
		}
		
		d_treasure_fleet = {
			holder_scope = {
				character_event = { id = soh.8628 } # Inform commander
			}
		}
		
		e_china = {
			holder_scope = {
				any_realm_lord = {
					limit = {
						ai = yes
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					character_event = { id = soh.8629 } # Inform those aboard the TF
				}
			}
		}
	}
}

# TF sabotage - major damage - commander
character_event = {
	id = soh.8628
	desc = EVTDESC_SOH_8628
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROMFROM = {
				check_variable = {
					which = treasure_fleet_army_strength
					value = 20
				}
			}
		}
		
		name = EVTOPTA_SOH_8628 # FROM will pay for this!
		
		add_rival = FROM
		
		FROM = {
			save_event_target_as = treasure_fleet_attacker
			
			random_realm_province = {
				limit = {
					is_in_active_treasure_fleet_region_trigger = yes
				}
				
				save_event_target_as = treasure_fleet_beachhead
			}
		}
		
		create_new_court_eunuch_effect = yes
		
		new_character = {
			set_defacto_liege = THIS
			create_title = {
				tier = DUKE
				landless = yes
				adventurer = yes
				culture = ROOT
				name = "PUNITIVE_EXPEDITION"
				holder = THIS
				base_title = THIS
			}
			
			save_event_target_as = treasure_fleet_punitive_expedition_leader
			
			disembark_regiments_until_stronger_or_unable_to_continue_effect = yes
			
			war = {
				target = event_target:treasure_fleet_attacker
				casus_belli = treasure_fleet_punitive_expedition
			}
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				trait = craven
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8628 # I can't do anything about this...
		
		add_rival = FROM
		
		prestige = -100
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = brave
			}
		}
	}
}

# TF sabotage - major damage - other members
character_event = {
	id = soh.8629
	desc = EVTDESC_SOH_8629
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8629 # FROM almost sank the Treasure Fleet!
		
		random = {
			chance = 25
			add_trait_wounded_effect = yes
		}
	}
}

# TF sabotage - major damage - EoC
character_event = {
	id = soh.8630
	desc = EVTDESC_SOH_8630
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8630 # This will not be forgotten!
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
				
			add_rival = FROM
		}
		
		opinion = {
			who = FROM
			modifier = opinion_attacked_treasure_fleet
		}
	}
}

# TF sabotage - TF destroyed - saboteur
character_event = {
	id = soh.8631
	desc = EVTDESC_SOH_8631
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = tf_saboteur_killed_everyone
	}
	
	option = {
		name = EVTOPTA_SOH_8631 # Excellent!
		
		prestige = 1000
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			#detract_grace_super_huge_effect = yes
		}
		
		e_china = {
			holder_scope = {
				character_event = { id = soh.8633 } # Inform EoC
			}
		}
		
		d_treasure_fleet = {
			holder_scope = {
				character_event = { id = soh.8632 } # Inform commander
			}
		}
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOT = {
					trait = cruel
				}
			}
		}
	}
	
	option = {
		trigger = {
			trait = cruel
		}
		
		name = EVTOPTB_SOH_8631 # What survivours?
		
		pacifists_lose_piety_effect = yes
		
		set_character_flag = tf_saboteur_killed_everyone
		
		prestige = 1000
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			detract_grace_super_huge_effect = yes
		}
		
		e_china = {
			holder_scope = {
				character_event = { id = soh.8633 } # Inform EoC
			}
		}
		
		d_treasure_fleet = {
			holder_scope = {
				character_event = { id = soh.8632 } # Inform commander
			}
		}
	}
}

# TF sabotage - TF destroyed - commander
character_event = {
	id = soh.8632
	desc = EVTDESC_SOH_8632
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8632 # You'll pay for this!
		
		add_rival = FROM
		
		any_courtier = {
			character_event = { id = soh.8634 } # Others imprisoned
		}
		
		d_treasure_fleet = {
			unsafe_destroy_landed_title = THIS
		}
		
		if = {
			limit = {
				FROM = {
					NOT = {
						has_character_flag = tf_saboteur_killed_everyone
					}
				}
			}
		
			random_list = {
				75 = {
					add_trait_wounded_effect = yes
				}
				25 = {
					add_maimed_trait_effect = yes
				}
			}
			
			FROM = {
				reverse_imprison = ROOT
			}
		}
		
		else = {
			FROM = {
				ROOT = { save_event_target_as = kinslayer_target }
				add_kinslayer_trait_effect = yes
			}
			
			death = {
				death_reason = death_execution_beheading
				killer = FROM
			}
		}
	}
}

# TF sabotage - TF destroyed - EoC
character_event = {
	id = soh.8633
	desc = EVTDESC_SOH_8633
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8633 # This will not be forgotten!
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
				
			add_rival = FROM
		
			prestige = -1000
			
			hidden_tooltip = {
				mandate_penalty_massive_effect = yes
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_attacked_treasure_fleet
		}
		
		any_realm_lord = {
			limit = {
				NAND = {
					trait = treasure_fleet_voyage
					NOT = {
						has_character_flag = left_treasure_fleet_voyage
					}
				}
				ai = no
			}
			
			character_event = { id = soh.8635 } # Inform vassals
		}
		
		any_realm_lord = {
			if = {
				limit = {
					trait = treasure_fleet_voyage
					NOT = {
						has_character_flag = left_treasure_fleet_voyage
					}
				}
				
				character_event = { id = soh.8634 } # Inform those on the TF
			}
			
			any_courtier = {
				limit = {
					trait = treasure_fleet_voyage
					NOT = {
						has_character_flag = left_treasure_fleet_voyage
					}
					is_landed = no
				}
				
				character_event = { id = soh.8634 } # Inform those on the TF
			}
		}
		
		any_playable_ruler = {
			limit = {
				OR = {
					ai = no
					government = chinese_imperial_government
				}
				NOR = {
					top_liege = {
						character = ROOT
					}
					character = event_target:saboteur
				}
			}
			
			character_event = { id = soh.8636 } # Inform the world
		}
	}
}

# TF sabotage - TF destroyed - other members
character_event = {
	id = soh.8634
	desc = EVTDESC_SOH_8634
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8634 # I must swim to safety!
		
		random_list = {
			50 = {}
			
			40 = {
				add_trait_wounded_effect = yes
			}
			
			10 = {
				add_maimed_trait_effect = yes
			}
			
			1 = {
				event_target:saboteur = {
					ROOT = { save_event_target_as = kinslayer_target }
					add_kinslayer_trait_effect = yes
				}
				
				if = {
					limit = {
						has_dlc = "Jade Dragon"
						e_china = {
							holder_scope = {
								is_chinese_emperor_trigger = yes
								is_close_relative = ROOT
								dynasty = ROOT
							}
						}
					}
					
					event_target:saboteur = {
						detract_grace_massive_effect = yes
					}
				}
				
				death = {
					death_reason = death_battle
					killer = event_target:saboteur
				}
			}
		}
		
		random_list = {
			50 = {
				mult_modifier = {
					factor = 5
					is_weak_trigger = yes
				}
				
				mult_modifier = {
					factor = 5
					is_maimed_trigger = yes
				}
				
				mult_modifier = {
					factor = 2
					is_adult = no
				}
				
				if = {
					limit = {
						has_dlc = "Jade Dragon"
						e_china = {
							holder_scope = {
								is_chinese_emperor_trigger = yes
								is_close_relative = ROOT
								dynasty = ROOT
							}
						}
					}
					
					event_target:saboteur = {
						detract_grace_massive_effect = yes
					}
				}
				
				death = {
					death_reason = death_accident_drowning
				}
			}
			
			50 = {
				mult_modifier = {
					factor = 5
					is_strong_trigger = yes
				}
		
				if = {
					limit = {
						FROM = {
							NOT = {
								has_character_flag = tf_saboteur_killed_everyone
							}
						}
					}
				
					if = {
						limit = {
							has_dlc = "Jade Dragon"
							e_china = {
								holder_scope = {
									is_chinese_emperor_trigger = yes
									is_close_relative = ROOT
									dynasty = ROOT
								}
							}
						}
						
						event_target:saboteur = {
							detract_grace_medium_effect = yes
						}
					}
					
					event_target:saboteur = {
						reverse_imprison = ROOT
					}
				}
				
				else = {
					event_target:saboteur = {
						ROOT = { save_event_target_as = kinslayer_target }
						add_kinslayer_trait_effect = yes
					}
				
					if = {
						limit = {
							has_dlc = "Jade Dragon"
							e_china = {
								holder_scope = {
									is_chinese_emperor_trigger = yes
									is_close_relative = ROOT
									dynasty = ROOT
								}
							}
						}
						
						event_target:saboteur = {
							detract_grace_massive_effect = yes
						}
					}
					
					death = {
						death_reason = death_execution_beheading
						killer = event_target:saboteur
					}
				}
			}
		}
	}
}

# TF sabotage - TF destroyed - other vassals
character_event = {
	id = soh.8635
	desc = EVTDESC_SOH_8635
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8635 # How inauspicious
	}
}

# TF sabotage - TF destroyed - the rest of the world
character_event = {
	id = soh.8636
	desc = EVTDESC_SOH_8636
	picture = GFX_evt_kraken
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				government = chinese_imperial_government
			}
		}
		
		name = EVTOPTA_SOH_8636 # So much for that...
	}
	
	option = {
		trigger = {
			government = chinese_imperial_government
		}
		
		name = EVTOPTB_SOH_8636 # How auspicious!
		
		hidden_tooltip = {
			mandate_boost_small_effect = yes
		}
	}
}

### Tributary opportunity

# Local might make offer
character_event = {
	id = soh.8637
	desc = EVTDESC_SOH_8637
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOR = {
			has_global_flag = treasure_fleet_destroyed
			has_global_flag = abort_treasure_fleet_asap
		}
	}
	
	immediate = {
		e_china = {
			holder_scope = {
				save_event_target_as = eoc
			}
		}
		
		e_china = {
			holder_scope = {
				random_realm_character = {
					limit = {
						is_adult = yes
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					save_event_target_as = tf_negotiator
				}
			}
		}
		
		if = {
			limit = {
				event_target:tf_negotiator = {
					always = no
				}
			}
			
			d_treasure_fleet = {
				holder_scope = {
					save_event_target_as = tf_negotiator
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8637 # Yes!
		
		event_target:tf_negotiator = {	
			character_event = { id = soh.8638 days = 1 } # Someone gets to respond
		}
		
		ai_chance = {
			trigger = {
				root_hates_china_trigger = no
				lower_real_tier_than = king
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 0.01
				trait = proud
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8637 # No!
		
		ai_chance = {
			factor = 100
		}
	}
}

# Offer is made
character_event = {
	id = soh.8638
	desc = EVTDESC_SOH_8638
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8638 # Yes!
		
		FROM = {
			character_event = { id = soh.8639 }
		}
		
		e_china = {
			holder_scope = {
				make_tributary = {
					who = ROOT
					tributary_type = chinese_peripheral_tributary
				}
			}
		}
		
		ai_chance = {
			trigger = {
				opinion = {
					who = event_target:eoc
					value > -25
				}
			}
			
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8638 # No!
		
		FROM = {
			character_event = { id = soh.8640 }
		}
		
		ai_chance = {
			trigger = {
				opinion = {
					who = event_target:eoc
					value < 25
				}
			}
			
			factor = 100
		}
	}
}

# Offer accepted
character_event = {
	id = soh.8639
	desc = EVTDESC_SOH_8639
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8639 # Great!
	}
}

# Offer refused
character_event = {
	id = soh.8640
	desc = EVTDESC_SOH_8640
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8640 # Huh...
	}
}

### Tributary tier increase opportunity

# Local might make offer
character_event = {
	id = soh.8641
	desc = EVTDESC_SOH_8641
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOR = {
			has_global_flag = treasure_fleet_destroyed
			has_global_flag = abort_treasure_fleet_asap
		}
	}
	
	immediate = {
		e_china = {
			holder_scope = {
				save_event_target_as = eoc
			}
		}
		
		e_china = {
			holder_scope = {
				random_realm_character = {
					limit = {
						is_adult = yes
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					save_event_target_as = tf_negotiator
				}
			}
		}
		
		if = {
			limit = {
				event_target:tf_negotiator = {
					always = no
				}
			}
			
			d_treasure_fleet = {
				holder_scope = {
					save_event_target_as = tf_negotiator
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8641 # Yes!
		
		event_target:tf_negotiator = {
			character_event = { id = soh.8642 days = 1 } # Someone gets to respond
		}
		
		ai_chance = {
			trigger = {
				root_hates_china_trigger = no
				lower_real_tier_than = king
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 0.01
				trait = proud
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8641 # No!
		
		ai_chance = {
			factor = 100
		}
	}
}

# Offer is made
character_event = {
	id = soh.8642
	desc = EVTDESC_SOH_8642
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_sender = {
				save_event_target_as = treasure_fleet_sender
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8642 # Yes!
		
		FROM = {
			character_event = { id = soh.8643 }
		}
		
		increase_tributary_tier_or_vassalize_effect = yes
		
		ai_chance = {
			trigger = {
				opinion = {
					who = event_target:eoc
					value > -25
				}
			}
			
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8642 # No!
		
		FROM = {
			character_event = { id = soh.8644 }
		}
		
		ai_chance = {
			trigger = {
				opinion = {
					who = event_target:eoc
					value < 25
				}
			}
			
			factor = 100
		}
	}
}

# Offer accepted
character_event = {
	id = soh.8643
	desc = EVTDESC_SOH_8643
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8643 # Great!
	}
}

# Offer refused
character_event = {
	id = soh.8644
	desc = EVTDESC_SOH_8644
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8644 # Huh...
	}
}

### Gold for Grace

# Local might make offer
character_event = {
	id = soh.8645
	desc = EVTDESC_SOH_8645
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		e_china = {
			holder_scope = {
				save_event_target_as = eoc
			}
		}
		
		e_china = {
			holder_scope = {
				random_realm_character = {
					limit = {
						is_adult = yes
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					save_event_target_as = tf_negotiator
				}
			}
		}
		
		if = {
			limit = {
				event_target:tf_negotiator = {
					always = no
				}
			}
			
			d_treasure_fleet = {
				holder_scope = {
					save_event_target_as = tf_negotiator
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8645 # Yes!
		
		wealth = -100
		
		event_target:tf_negotiator = {
			character_event = { id = soh.8646 days = 1 } # Someone gets to respond
		}
		
		ai_chance = {
			trigger = {
				root_hates_china_trigger = no
				NOT = {
					trait = greedy
				}
			}
			
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8645 # No!
		
		ai_chance = {
			factor = 100
		}
	}
}

# Offer is made
character_event = {
	id = soh.8646
	desc = EVTDESC_SOH_8646
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8646 # Yes; for the EoC!
		
		hidden_tooltip = {
			increase_treasure_fleet_wealth_small_effect = yes
		}
		
		FROM = {
			character_event = { id = soh.8647 }
		}
		
		ai_chance = {
			trigger = {
				opinion = {
					who = event_target:eoc
					value > -25
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = greedy
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8646 # Yes; for myself!
		
		wealth = 100
		
		FROM = {
			character_event = { id = soh.8647 }
		}
		
		ai_chance = {
			trigger = {
				OR = {
					opinion = {
						who = event_target:eoc
						value < 25
					}
					trait = greedy
				}
				NOT = {
					trait = charitable
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		name = EVTOPTC_SOH_8646 # No!
		
		FROM = {
			character_event = { id = soh.8648 }
		}
		
		ai_chance = {
			trigger = {
				opinion = {
					who = event_target:eoc
					value < 25
				}
				NOT = {
					trait = greedy
				}
			}
			
			factor = 100
		}
	}
}

# Offer accepted
character_event = {
	id = soh.8647
	desc = EVTDESC_SOH_8647
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8647 # Great!
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			add_grace_major_effect = yes
		}
	}
}

# Offer refused
character_event = {
	id = soh.8648
	desc = EVTDESC_SOH_8648
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8648 # Huh...
		
		wealth = 100
	}
}

### Supplies for Grace

# Local might make offer
character_event = {
	id = soh.8649
	desc = EVTDESC_SOH_8649
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_sender = {
				save_event_target_as = treasure_fleet_sender
			}
		}
		
		e_china = {
			holder_scope = {
				random_realm_character = {
					limit = {
						is_adult = yes
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					save_event_target_as = tf_negotiator
				}
			}
		}
		
		if = {
			limit = {
				event_target:tf_negotiator = {
					always = no
				}
			}
			
			d_treasure_fleet = {
				holder_scope = {
					save_event_target_as = tf_negotiator
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8649 # Yes!
		
		event_target:tf_negotiator = {
			character_event = { id = soh.8650 days = 1 } # Someone gets to respond
		}
		
		ai_chance = {
			trigger = {
				root_hates_china_trigger = no
				NOT = {
					trait = greedy
				}
			}
			
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8649 # No!
		
		ai_chance = {
			factor = 100
		}
	}
}

# Offer is made
character_event = {
	id = soh.8650
	desc = EVTDESC_SOH_8650
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8650 # We need it!
		
		hidden_tooltip = {
			increase_treasure_fleet_supplies_small_effect = yes
		}
		
		FROM = {
			character_event = { id = soh.8651 }
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = temperate
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8650 # No!
		
		FROM = {
			character_event = { id = soh.8652 }
		}
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = gluttonous
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
		}
	}
}

# Offer accepted
character_event = {
	id = soh.8651
	desc = EVTDESC_SOH_8651
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8651 # Great!
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			add_grace_major_effect = yes
		}
	}
}

# Offer refused
character_event = {
	id = soh.8652
	desc = EVTDESC_SOH_8652
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8652 # Huh...
	}
}

### Artifact for Grace

# Do you wish to offer an artifact?
character_event = {
	id = soh.8653
	desc = EVTDESC_SOH_8653
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		clr_character_flag = offering_amber_crown
		clr_character_flag = offering_armor_tier_1
		clr_character_flag = offering_armor_tier_2
		clr_character_flag = offering_armor_tier_3_champion
		clr_character_flag = offering_armor_tier_3_guardian
		clr_character_flag = offering_armor_tier_3_warden
		clr_character_flag = offering_axe_of_the_ancestors
		clr_character_flag = offering_axe_tier_1_new
		clr_character_flag = offering_axe_tier_2_new
		clr_character_flag = offering_axe_tier_3_cleaver
		clr_character_flag = offering_axe_tier_3_marauder
		clr_character_flag = offering_axe_tier_3_ravager
		clr_character_flag = offering_balanced_blade
		clr_character_flag = offering_bejeweled_dagger
		clr_character_flag = offering_bow_tier_1_new
		clr_character_flag = offering_bow_tier_2_new
		clr_character_flag = offering_bow_tier_3_eagle
		clr_character_flag = offering_bow_tier_3_lightning
		clr_character_flag = offering_bow_tier_3_silent_wind
		clr_character_flag = offering_celestial_blade
		clr_character_flag = offering_celestial_necklace
		clr_character_flag = offering_ceremonial_axe
		clr_character_flag = offering_circlet_of_the_heavens
		clr_character_flag = offering_circlet_of_the_sun
		clr_character_flag = offering_circlet_of_twilight
		clr_character_flag = offering_collar_of_pearls
		clr_character_flag = offering_crown_of_crows
		clr_character_flag = offering_crown_of_majesty
		clr_character_flag = offering_crown_of_pearls
		clr_character_flag = offering_crown_of_the_sea
		clr_character_flag = offering_dagger_of_glory
		clr_character_flag = offering_dao
		clr_character_flag = offering_dadao
		clr_character_flag = offering_destroyer
		clr_character_flag = offering_dragon
		clr_character_flag = offering_emerald_scepter
		clr_character_flag = offering_engraved_crown
		clr_character_flag = offering_engraved_dagger
		clr_character_flag = offering_engraved_sword
		clr_character_flag = offering_golden_bracelets
		clr_character_flag = offering_golden_staff
		clr_character_flag = offering_golden_sword
		clr_character_flag = offering_heavenly_sword
		clr_character_flag = offering_heros_crown
		clr_character_flag = offering_honor
		clr_character_flag = offering_iron_crown
		clr_character_flag = offering_khanda
		clr_character_flag = offering_lance_tier_1_new
		clr_character_flag = offering_lance_tier_2_new
		clr_character_flag = offering_lance_tier_3_impaler
		clr_character_flag = offering_lance_tier_3_piercer
		clr_character_flag = offering_lance_tier_3_trident
		clr_character_flag = offering_mace_tier_1_new
		clr_character_flag = offering_mace_tier_2_new
		clr_character_flag = offering_mace_tier_3_bone_breaker
		clr_character_flag = offering_mace_tier_3_foe_hammer
		clr_character_flag = offering_mace_tier_3_shatterer
		clr_character_flag = offering_necklace_of_radiance
		clr_character_flag = offering_noble_scepter
		clr_character_flag = offering_obsidian_axe
		clr_character_flag = offering_odachi
		clr_character_flag = offering_random_world_armor
		clr_character_flag = offering_random_world_sword
		clr_character_flag = offering_retribution
		clr_character_flag = offering_rising_sun
		clr_character_flag = offering_ruby_bracelets
		clr_character_flag = offering_ruby_scepter
		clr_character_flag = offering_scimitar_tier_1_new
		clr_character_flag = offering_scimitar_tier_2_new
		clr_character_flag = offering_scimitar_tier_3_conquest
		clr_character_flag = offering_scimitar_tier_3_fortune
		clr_character_flag = offering_scimitar_tier_3_golden
		clr_character_flag = offering_silver_bracelets
		clr_character_flag = offering_silver_staff
		clr_character_flag = offering_staff_of_majesty
		clr_character_flag = offering_sword_of_heroes
		clr_character_flag = offering_sword_tier_1_new
		clr_character_flag = offering_sword_tier_2_new
		clr_character_flag = offering_sword_tier_3_fury
		clr_character_flag = offering_sword_tier_3_heartseeker
		clr_character_flag = offering_sword_tier_3_vengeance
		clr_character_flag = offering_tachi
		clr_character_flag = offering_talwar
		clr_character_flag = offering_the_lily_crown
		clr_character_flag = offering_wrath
		
		e_china = {
			holder_scope = {
				random_realm_character = {
					limit = {
						is_adult = yes
						trait = treasure_fleet_voyage
						NOT = {
							has_character_flag = left_treasure_fleet_voyage
						}
					}
					
					save_event_target_as = tf_negotiator
				}
			}
		}
		
		if = {
			limit = {
				event_target:tf_negotiator = {
					always = no
				}
			}
			
			d_treasure_fleet = {
				holder_scope = {
					save_event_target_as = tf_negotiator
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8653 # Yes!
		
		wealth = -100
		
		hidden_tooltip = {
			random_list = {
				# Crown jewels
				25 = {
					random_list = {
						75 = {
							# Tier 1
							random_list = {
								25 = {
									trigger = {
										can_get_crowns_trigger = yes
									}
									
									if = {
										limit = {
											gets_christian_goldsmith_artifact_set_trigger = yes
										}
										
										set_character_flag = offering_the_lily_crown
									}
									
									else_if = {
										limit = {
											gets_zoroastrian_goldsmith_artifact_set_trigger = yes
										}
										
										set_character_flag = offering_circlet_of_twilight
									}
									
									else_if = {
										limit = {
											religion_openly_norse_or_reformed_trigger = yes
										}
										
										set_character_flag = offering_iron_crown
									}
									
									else = {
										set_character_flag = offering_engraved_crown
									}
								}
								
								25 = {
									trigger = {
										can_get_scepters_trigger = yes
									}
									
									if = {
										limit = {
											gets_christian_goldsmith_artifact_set_trigger = yes
										}
										
										set_character_flag = offering_noble_scepter
									}
									
									else = {
										set_character_flag = offering_silver_staff
									}
								}
								
								25 = {
									trigger = {
										can_get_ceremonial_swords_trigger = yes
									}
									
									set_character_flag = offering_engraved_sword
								}
								
								25 = {
									trigger = {
										can_get_ceremonial_daggers_trigger = yes
									}
									
									set_character_flag = offering_engraved_dagger
								}
								
								25 = {
									trigger = {
										can_get_ceremonial_axes_trigger = yes
									}
									
									set_character_flag = offering_ceremonial_axe
								}
								
								25 = {
									trigger = {
										can_get_bracelets_trigger = yes
									}
									
									set_character_flag = offering_silver_bracelets
								}
								
								25 = {
									trigger = {
										can_get_necklaces_trigger = yes
									}
									
									set_character_flag = offering_collar_of_pearls
								}
							}
						}
						
						20 = {
							trigger = {
								higher_real_tier_than = count
							}
							
							# Tier 2
							random_list = {
								25 = {
									trigger = {
										can_get_crowns_trigger = yes
									}
									
									if = {
										limit = {
											gets_christian_goldsmith_artifact_set_trigger = yes
										}
										
										set_character_flag = offering_crown_of_pearls
									}
									
									else_if = {
										limit = {
											gets_zoroastrian_goldsmith_artifact_set_trigger = yes
										}
										
										set_character_flag = offering_circlet_of_the_sun
									}
									
									else_if = {
										limit = {
											religion_openly_norse_or_reformed_trigger = yes
										}
										
										set_character_flag = offering_crown_of_the_sea
									}
									
									else = {
										set_character_flag = offering_amber_crown
									}
								}
								
								25 = {
									trigger = {
										can_get_scepters_trigger = yes
									}
									
									if = {
										limit = {
											gets_christian_goldsmith_artifact_set_trigger = yes
										}
										
										set_character_flag = offering_ruby_scepter
									}
									
									else = {
										set_character_flag = offering_golden_staff
									}
								}
								
								25 = {
									trigger = {
										can_get_ceremonial_swords_trigger = yes
									}
									
									set_character_flag = offering_golden_sword
								}
								
								25 = {
									trigger = {
										can_get_ceremonial_daggers_trigger = yes
									}
									
									# Ceremonial dagger
									set_character_flag = offering_bejeweled_dagger
								}
								
								25 = {
									trigger = {
										can_get_ceremonial_axes_trigger = yes
									}
									
									set_character_flag = offering_obsidian_axe
								}
								
								25 = {
									trigger = {
										can_get_bracelets_trigger = yes
									}
									
									set_character_flag = offering_golden_bracelets
								}
								25 = {
									trigger = {
										can_get_necklaces_trigger = yes
									}
									
									set_character_flag = offering_necklace_of_radiance
								}
							}
						}
						
						5 = {
							trigger = {
								higher_real_tier_than = duke
							}
							
							# Tier 3
							random_list = {
								25 = {
									trigger = {
										can_get_crowns_trigger = yes
									}
									
									if = {
										limit = {
											gets_christian_goldsmith_artifact_set_trigger = yes
										}
										
										set_character_flag = offering_crown_of_majesty
									}
									
									else_if = {
										limit = {
											gets_zoroastrian_goldsmith_artifact_set_trigger = yes
										}
										
										set_character_flag = offering_circlet_of_the_heavens
									}
									
									else_if = {
										limit = {
											religion_openly_norse_or_reformed_trigger = yes
										}
										
										set_character_flag = offering_crown_of_crows
									}
									
									else = {
										set_character_flag = offering_heros_crown
									}
								}
								
								25 = {
									trigger = {
										can_get_scepters_trigger = yes
									}
									
									if = {
										limit = {
											gets_christian_goldsmith_artifact_set_trigger = yes
										}
										
										set_character_flag = offering_emerald_scepter
									}
									
									else = {
										set_character_flag = offering_staff_of_majesty
									}
								}
								
								25 = {
									trigger = {
										can_get_ceremonial_swords_trigger = yes
									}
									
									set_character_flag = offering_sword_of_heroes
								}
								
								25 = {
									trigger = {
										can_get_ceremonial_daggers_trigger = yes
									}
									
									set_character_flag = offering_dagger_of_glory
								}
								
								25 = {
									trigger = {
										can_get_ceremonial_axes_trigger = yes
									}
									
									set_character_flag = offering_axe_of_the_ancestors
								}
								
								25 = {
									trigger = {
										can_get_bracelets_trigger = yes
									}
									
									set_character_flag = offering_ruby_bracelets
								}
								
								25 = {
									trigger = {
										can_get_necklaces_trigger = yes
									}
									
									set_character_flag = offering_celestial_necklace
								}
							}
						}
					}
				}
				
				# Armor
				25 = {
					random_list = {
						75 = {
							# Tier 1
							set_character_flag = offering_armor_tier_1
						}
						
						20 = {
							trigger = {
								higher_real_tier_than = count
							}
							
							# Tier 2
							set_character_flag = offering_armor_tier_2
						}
						
						5 = {
							trigger = {
								higher_real_tier_than = duke
							}
							
							# Tier 3
							random_list = {
								33 = {
									set_character_flag = offering_armor_tier_3_guardian
								}
								
								33 = {
									set_character_flag = offering_armor_tier_3_champion
								}
								
								33 = {
									set_character_flag = offering_armor_tier_3_warden
								}
							}
						}
					}
				}
				
				# Weapons
				50 = {
					random_list = {
						75 = {
							# Tier 1
							random_list = {
								50 = {
									if = {
										limit = {
											should_get_japanese_swords_trigger = yes
										}
										
										set_character_flag = offering_tachi
									}
									
									else_if = {
										limit = {
											should_get_chinese_swords_trigger = yes
										}
										
										set_character_flag = offering_dao
									}
									
									else_if = {
										limit = {
											should_get_indian_swords_trigger = yes
										}
										
										set_character_flag = offering_khanda
									}
									
									else_if = {
										limit = {
											religion_group = muslim
										}
										
										set_character_flag = offering_scimitar_tier_1_new
									}
									
									else = {
										set_character_flag = offering_sword_tier_1_new
									}
								}
								
								25 = {
									set_character_flag = offering_lance_tier_1_new
								}
								
								25 = {
									trigger = {
										sees_axes_option_trigger = yes
									}
									
									set_character_flag = offering_axe_tier_1_new
								}
								
								25 = {
									trigger = {
										sees_maces_option_trigger = yes
									}
									
									set_character_flag = offering_mace_tier_1_new
								}
								
								25 = {
									trigger = {
										sees_bows_option_trigger = yes
									}
									
									set_character_flag = offering_bow_tier_1_new
								}
							}
						}
						
						20 = {
							trigger = {
								higher_real_tier_than = count
							}
							
							# Tier 2
							random_list = {
								50 = {
									# Sword
									if = {
										limit = {
											should_get_japanese_swords_trigger = yes
										}
										
										set_character_flag = offering_odachi
									}
									
									else_if = {
										limit = {
											should_get_chinese_swords_trigger = yes
										}
										
										set_character_flag = offering_dadao
									}
									
									else_if = {
										limit = {
											should_get_indian_swords_trigger = yes
										}
										
										set_character_flag = offering_talwar
									}
									
									else_if = {
										limit = {
											religion_group = muslim
										}
										
										set_character_flag = offering_scimitar_tier_2_new
									}
									
									else = {
										set_character_flag = offering_sword_tier_2_new
									}
								}
								
								25 = {
									set_character_flag = offering_lance_tier_2_new
								}
								
								25 = {
									trigger = {
										sees_axes_option_trigger = yes
									}
									
									set_character_flag = offering_axe_tier_2_new
								}
								
								25 = {
									trigger = {
										sees_maces_option_trigger = yes
									}
									
									set_character_flag = offering_mace_tier_2_new
								}
								
								25 = {
									trigger = {
										sees_bows_option_trigger = yes
									}
									
									set_character_flag = offering_bow_tier_2_new
								}
							}
						}
						
						5 = {
							trigger = {
								higher_real_tier_than = duke
							}
							
							# Tier 3
							random_list = {
								50 = {
									# Sword
									if = {
										limit = {
											should_get_japanese_swords_trigger = yes
										}
										
										random_list = {
											33 = {
												set_character_flag = offering_rising_sun
											}
											
											33 = {
												set_character_flag = offering_dragon
											}
											
											33 = {
												set_character_flag = offering_honor
											}
										}
									}
									
									else_if = {
										limit = {
											should_get_chinese_swords_trigger = yes
										}
										
										random_list = {
											33 = {
												set_character_flag = offering_celestial_blade
											}
											
											33 = {
												set_character_flag = offering_balanced_blade
											}
											
											33 = {
												set_character_flag = offering_heavenly_sword
											}
										}
									}
									
									else_if = {
										limit = {
											should_get_indian_swords_trigger = yes
										}
										
										random_list = {
											33 = {
												set_character_flag = offering_destroyer
											}
											
											33 = {
												set_character_flag = offering_retribution
											}
											
											33 = {
												set_character_flag = offering_wrath
											}
										}
									}
									
									else_if = {
										limit = {
											religion_group = muslim
										}
										
										random_list = {
											33 = {
												set_character_flag = offering_scimitar_tier_3_golden
											}
											
											33 = {
												set_character_flag = offering_scimitar_tier_3_fortune
											}
											
											33 = {
												set_character_flag = offering_scimitar_tier_3_conquest
											}
										}
									}
									
									else = {
										random_list = {
											33 = {
												set_character_flag = offering_sword_tier_3_heartseeker
											}
											
											33 = {
												set_character_flag = offering_sword_tier_3_vengeance
											}
											
											33 = {
												set_character_flag = offering_sword_tier_3_fury
											}
										}
									}
								}
								
								25 = {
									random_list = {
										33 = {
											set_character_flag = offering_lance_tier_3_trident
										}
										
										33 = {
											set_character_flag = offering_lance_tier_3_piercer
										}
										
										33 = {
											set_character_flag = offering_lance_tier_3_impaler
										}
									}
								}
								
								25 = {
									trigger = {
										sees_axes_option_trigger = yes
									}
									
									random_list = {
										33 = {
											set_character_flag = offering_axe_tier_3_cleaver
										}
										
										33 = {
											set_character_flag = offering_axe_tier_3_ravager
										}
										
										33 = {
											set_character_flag = offering_axe_tier_3_marauder
										}
									}
								}
								
								25 = {
									trigger = {
										sees_maces_option_trigger = yes
									}
									
									random_list = {
										33 = {
											set_character_flag = offering_mace_tier_3_foe_hammer
										}
										
										33 = {
											set_character_flag = offering_mace_tier_3_bone_breaker
										}
										
										33 = {
											set_character_flag = offering_mace_tier_3_shatterer
										}
									}
								}
								
								25 = {
									trigger = {
										sees_bows_option_trigger = yes
									}
									
									random_list = {
										33 = {
											set_character_flag = offering_bow_tier_3_silent_wind
										}
										
										33 = {
											set_character_flag = offering_bow_tier_3_eagle
										}
										
										33 = {
											set_character_flag = offering_bow_tier_3_lightning
										}
									}
								}
							}
						}
					}
				}
				
				# HF
				1 = {
					trigger = {
						has_dlc = "Holy Fury"
					}
					
					random_list = {
						1 = {
							set_character_flag = offering_random_world_sword
						}
						
						1 = {
							set_character_flag = offering_random_world_armor
						}
					}
				}
			}
		}
		
		event_target:tf_negotiator = {
			character_event = { id = soh.8654 } # Someone gets to respond
		}
		
		ai_chance = {
			trigger = {
				root_hates_china_trigger = no
				NOT = {
					trait = greedy
				}
			}
			
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8653 # No!
		
		ai_chance = {
			factor = 100
		}
	}
}

# Offer is made
character_event = {
	id = soh.8654
	desc = EVTDESC_SOH_8654
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8654 # Yes!
		
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				offering_amber_crown = {
					ROOT = {
						add_artifact = amber_crown
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_amber_crown
				}
				
				offering_armor_tier_1 = {
					ROOT = {
						add_artifact = armor_tier_1
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_armor_tier_1
				}
				
				offering_armor_tier_2 = {
					ROOT = {
						add_artifact = armor_tier_2
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_armor_tier_2
				}
				
				offering_armor_tier_3_champion = {
					ROOT = {
						add_artifact = armor_tier_3_champion
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_armor_tier_3_champion
				}
				
				offering_armor_tier_3_guardian = {
					ROOT = {
						add_artifact = armor_tier_3_guardian
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_armor_tier_3_guardian
				}
				
				offering_armor_tier_3_warden = {
					ROOT = {
						add_artifact = armor_tier_3_warden
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_armor_tier_3_warden
				}
				
				offering_axe_of_the_ancestors = {
					ROOT = {
						add_artifact = axe_of_the_ancestors
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_axe_of_the_ancestors
				}
				
				offering_axe_tier_1_new = {
					ROOT = {
						add_artifact = axe_tier_1_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_axe_tier_1_new
				}
				
				offering_axe_tier_2_new = {
					ROOT = {
						add_artifact = axe_tier_2_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_axe_tier_2_new
				}
				
				offering_axe_tier_3_cleaver = {
					ROOT = {
						add_artifact = axe_tier_3_cleaver
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_axe_tier_3_cleaver
				}
				
				offering_axe_tier_3_marauder = {
					ROOT = {
						add_artifact = axe_tier_3_marauder
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_axe_tier_3_marauder
				}
				
				offering_axe_tier_3_ravager = {
					ROOT = {
						add_artifact = axe_tier_3_ravager
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_axe_tier_3_ravager
				}
				
				offering_balanced_blade = {
					ROOT = {
						add_artifact = balanced_blade
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_balanced_blade
				}
				
				offering_bejeweled_dagger = {
					ROOT = {
						add_artifact = bejeweled_dagger
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_bejeweled_dagger
				}
				
				offering_bow_tier_1_new = {
					ROOT = {
						add_artifact = bow_tier_1_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_bow_tier_1_new
				}
				
				offering_bow_tier_2_new = {
					ROOT = {
						add_artifact = bow_tier_2_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_bow_tier_2_new
				}
				
				offering_bow_tier_3_eagle = {
					ROOT = {
						add_artifact = bow_tier_3_eagle
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_bow_tier_3_eagle
				}
				
				offering_bow_tier_3_lightning = {
					ROOT = {
						add_artifact = bow_tier_3_lightning
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_bow_tier_3_lightning
				}
				
				offering_bow_tier_3_silent_wind = {
					ROOT = {
						add_artifact = bow_tier_3_silent_wind
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_bow_tier_3_silent_wind
				}
				
				offering_celestial_blade = {
					ROOT = {
						add_artifact = celestial_blade
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_celestial_blade
				}
				
				offering_celestial_necklace = {
					ROOT = {
						add_artifact = celestial_necklace
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_celestial_necklace
				}
				
				offering_ceremonial_axe = {
					ROOT = {
						add_artifact = ceremonial_axe
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_ceremonial_axe
				}
				
				offering_circlet_of_the_heavens = {
					ROOT = {
						add_artifact = circlet_of_the_heavens
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_circlet_of_the_heavens
				}
				
				offering_circlet_of_the_sun = {
					ROOT = {
						add_artifact = circlet_of_the_sun
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_circlet_of_the_sun
				}
				
				offering_circlet_of_twilight = {
					ROOT = {
						add_artifact = circlet_of_twilight
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_circlet_of_twilight
				}
				
				offering_collar_of_pearls = {
					ROOT = {
						add_artifact = collar_of_pearls
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_collar_of_pearls
				}
				
				offering_crown_of_crows = {
					ROOT = {
						add_artifact = crown_of_crows
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_crown_of_crows
				}
				
				offering_crown_of_majesty = {
					ROOT = {
						add_artifact = crown_of_majesty
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_crown_of_majesty
				}
				
				offering_crown_of_pearls = {
					ROOT = {
						add_artifact = crown_of_pearls
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_crown_of_pearls
				}
				
				offering_crown_of_the_sea = {
					ROOT = {
						add_artifact = crown_of_the_sea
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_crown_of_the_sea
				}
				
				offering_dagger_of_glory = {
					ROOT = {
						add_artifact = dagger_of_glory
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_dagger_of_glory
				}
				
				offering_dao = {
					ROOT = {
						add_artifact = dao
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_dao
				}
				
				offering_dadao = {
					ROOT = {
						add_artifact = dadao
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_dadao
				}
				
				offering_destroyer = {
					ROOT = {
						add_artifact = destroyer
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_destroyer
				}
				
				offering_dragon = {
					ROOT = {
						add_artifact = dragon
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_dragon
				}
				
				offering_emerald_scepter = {
					ROOT = {
						add_artifact = emerald_scepter
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_emerald_scepter
				}
				
				offering_engraved_crown = {
					ROOT = {
						add_artifact = engraved_crown
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_engraved_crown
				}
				
				offering_engraved_dagger = {
					ROOT = {
						add_artifact = engraved_dagger
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_engraved_dagger
				}
				
				offering_engraved_sword = {
					ROOT = {
						add_artifact = engraved_sword
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_engraved_sword
				}
				
				offering_golden_bracelets = {
					ROOT = {
						add_artifact = golden_bracelets
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_golden_bracelets
				}
				
				offering_golden_staff = {
					ROOT = {
						add_artifact = golden_staff
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_golden_staff
				}
				
				offering_golden_sword = {
					ROOT = {
						add_artifact = golden_sword
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_golden_sword
				}
				
				offering_heavenly_sword = {
					ROOT = {
						add_artifact = heavenly_sword
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_heavenly_sword
				}
				
				offering_heros_crown = {
					ROOT = {
						add_artifact = heros_crown
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_heros_crown
				}
				
				offering_honor = {
					ROOT = {
						add_artifact = honor
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_honor
				}
				
				offering_iron_crown = {
					ROOT = {
						add_artifact = iron_crown
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_iron_crown
				}
				
				offering_khanda = {
					ROOT = {
						add_artifact = khanda
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_khanda
				}
				
				offering_lance_tier_1_new = {
					ROOT = {
						add_artifact = lance_tier_1_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_lance_tier_1_new
				}
				
				offering_lance_tier_2_new = {
					ROOT = {
						add_artifact = lance_tier_2_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_lance_tier_2_new
				}
				
				offering_lance_tier_3_impaler = {
					ROOT = {
						add_artifact = lance_tier_3_impaler
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_lance_tier_3_impaler
				}
				
				offering_lance_tier_3_piercer = {
					ROOT = {
						add_artifact = lance_tier_3_piercer
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_lance_tier_3_piercer
				}
				
				offering_lance_tier_3_trident = {
					ROOT = {
						add_artifact = lance_tier_3_trident
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_lance_tier_3_trident
				}
				
				offering_mace_tier_1_new = {
					ROOT = {
						add_artifact = mace_tier_1_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_mace_tier_1_new
				}
				
				offering_mace_tier_2_new = {
					ROOT = {
						add_artifact = mace_tier_2_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_mace_tier_2_new
				}
				
				offering_mace_tier_3_bone_breaker = {
					ROOT = {
						add_artifact = mace_tier_3_bone_breaker
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_mace_tier_3_bone_breaker
				}
				
				offering_mace_tier_3_foe_hammer = {
					ROOT = {
						add_artifact = mace_tier_3_foe_hammer
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_mace_tier_3_foe_hammer
				}
				
				offering_mace_tier_3_shatterer = {
					ROOT = {
						add_artifact = mace_tier_3_shatterer
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_mace_tier_3_shatterer
				}
				
				offering_necklace_of_radiance = {
					ROOT = {
						add_artifact = necklace_of_radiance
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_necklace_of_radiance
				}
				
				offering_noble_scepter = {
					ROOT = {
						add_artifact = noble_scepter
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_noble_scepter
				}
				
				offering_obsidian_axe = {
					ROOT = {
						add_artifact = obsidian_axe
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_obsidian_axe
				}
				
				offering_odachi = {
					ROOT = {
						add_artifact = odachi
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_odachi
				}
				
				offering_retribution = {
					ROOT = {
						add_artifact = retribution
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_retribution
				}
				
				offering_rising_sun = {
					ROOT = {
						add_artifact = rising_sun
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_rising_sun
				}
				
				offering_ruby_bracelets = {
					ROOT = {
						add_artifact = ruby_bracelets
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_ruby_bracelets
				}
				
				offering_ruby_scepter = {
					ROOT = {
						add_artifact = ruby_scepter
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_ruby_scepter
				}
				
				offering_scimitar_tier_1_new = {
					ROOT = {
						add_artifact = scimitar_tier_1_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_scimitar_tier_1_new
				}
				
				offering_scimitar_tier_2_new = {
					ROOT = {
						add_artifact = scimitar_tier_2_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_scimitar_tier_2_new
				}
				
				offering_scimitar_tier_3_conquest = {
					ROOT = {
						add_artifact = scimitar_tier_3_conquest
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_scimitar_tier_3_conquest
				}
				
				offering_scimitar_tier_3_fortune = {
					ROOT = {
						add_artifact = scimitar_tier_3_fortune
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_scimitar_tier_3_fortune
				}
				
				offering_scimitar_tier_3_golden = {
					ROOT = {
						add_artifact = scimitar_tier_3_golden
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_scimitar_tier_3_golden
				}
				
				offering_silver_bracelets = {
					ROOT = {
						add_artifact = silver_bracelets
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_silver_bracelets
				}
				
				offering_silver_staff = {
					ROOT = {
						add_artifact = silver_staff
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_silver_staff
				}
				
				offering_staff_of_majesty = {
					ROOT = {
						add_artifact = staff_of_majesty
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_staff_of_majesty
				}
				
				offering_sword_of_heroes = {
					ROOT = {
						add_artifact = sword_of_heroes
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_sword_of_heroes
				}
				
				offering_sword_tier_1_new = {
					ROOT = {
						add_artifact = sword_tier_1_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_sword_tier_1_new
				}
				
				offering_sword_tier_2_new = {
					ROOT = {
						add_artifact = sword_tier_2_new
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_sword_tier_2_new
				}
				
				offering_sword_tier_3_fury = {
					ROOT = {
						add_artifact = sword_tier_3_fury
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_sword_tier_3_fury
				}
				
				offering_sword_tier_3_heartseeker = {
					ROOT = {
						add_artifact = sword_tier_3_heartseeker
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_sword_tier_3_heartseeker
				}
				
				offering_sword_tier_3_vengeance = {
					ROOT = {
						add_artifact = sword_tier_3_vengeance
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_sword_tier_3_vengeance
				}
				
				offering_tachi = {
					ROOT = {
						add_artifact = tachi
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_tachi
				}
				
				offering_talwar = {
					ROOT = {
						add_artifact = talwar
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_talwar
				}
				
				offering_the_lily_crown = {
					ROOT = {
						add_artifact = the_lily_crown
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_the_lily_crown
				}
				
				offering_wrath = {
					ROOT = {
						add_artifact = wrath
						new_artifact = {
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_wrath
				}
				
				offering_random_world_sword = {
					ROOT = {
						add_artifact = random_world_sword
						
						new_artifact = {
							random_list = {
								10 = {
									set_name = "random_world_sword_1_FROM"
									set_description = "random_world_sword_desc_1"
								}
								
								10 = {
									set_name = "random_world_sword_2_FROM"
									set_description = "random_world_sword_desc_2"
								}
								
								10 = {
									set_name = "random_world_sword_3_FROM"
									set_description = "random_world_sword_desc_3"
								}
								
								10 = {
									set_name = "random_world_sword_4_FROM"
									set_description = "random_world_sword_desc_4"
								}
								
								10 = {
									set_name = "random_world_sword_5_FROM"
									set_description = "random_world_sword_desc_5"
								}
								
								10 = {
									set_name = "random_world_sword_6_FROM"
									set_description = "random_world_sword_desc_6"
								}
							}
							
							random_list = {
								10 = {
									set_picture = "GFX_sword_golden"
								}
								
								10 = {
									set_picture = "GFX_sword_of_heroes"
								}
								
								10 = {
									set_picture = "GFX_sword_engraved"
								}
								
								10 = {
									set_picture = "GFX_sword_T3_glow_green"
								}
								
								10 = {
									set_picture = "GFX_sword_T3_glow_purple"
								}
								
								10 = {
									set_picture = "GFX_sword_T3_glow_red"
								}
							}
							
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_random_world_sword
				}
				
				offering_random_world_armor = {
					ROOT = {
						add_artifact = random_world_armor
						
						new_artifact = {
							random_list = {
									10 = {
										set_name = "random_world_armor_1_FROM"
										set_description = "random_world_armor_desc_1"
									}
									
									10 = {
										set_name = "random_world_armor_2_FROM"
										set_description = "random_world_armor_desc_2"
									}
									
									10 = {
										set_name = "random_world_armor_3_FROM"
										set_description = "random_world_armor_desc_3"
									}
									
									10 = {
										set_name = "random_world_armor_4_FROM"
										set_description = "random_world_armor_desc_4"
									}
									
									10 = {
										set_name = "random_world_armor_5_FROM"
										set_description = "random_world_armor_desc_5"
									}
							}
							
							random_list = {
								10 = {
									set_picture = "GFX_guardian_armor"
								}
								
								10 = {
									set_picture = "GFX_champion_armor"
								}
								
								10 = {
									set_picture = "GFX_warden_armor"
								}
							}
							
							set_original_owner = FROM
						}
					}
					
					clr_character_flag = offering_random_world_armor
				}
			}
		}
		
		FROM = {
			character_event = { id = soh.8655 }
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8654 # No!
		
		FROM = {
			character_event = { id = soh.8656 }
		}
	}
}

# Offer accepted
character_event = {
	id = soh.8655
	desc = EVTDESC_SOH_8655
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8655 # Great!
		
		add_grace_major_effect = yes
	}
}

# Offer refused
character_event = {
	id = soh.8656
	desc = EVTDESC_SOH_8656
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8656 # Huh...
		
		wealth = 100
	}
}

### Gain Sympathy

# Sympathy
character_event = {
	id = soh.8657
	desc = EVTDESC_SOH_8657
	picture = GFX_evt_china_stable
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					limit = {
						NOT = {
							religion_group = ROOT
						}
					}
					
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = c_hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = tf_sympathy_target
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8657 # They're not so bad!
		
		event_target:tf_sympathy_target = {
			trigger_switch = {
				on_trigger = religion_group
				
				christian = { ROOT = { add_trait = sympathy_christendom } }
				jewish_group = { ROOT = { add_trait = sympathy_judaism } }
				muslim = { ROOT = { add_trait = sympathy_islam } }
				indian_group = { ROOT = { add_trait = sympathy_indian } }
				zoroastrian_group = { ROOT = { add_trait = sympathy_zoroastrianism } }
				pagan_group = { ROOT = { add_trait = sympathy_pagans } }
			}
		}
	}
}

### Random non-JD courtier

# Hidden event to see what you get
character_event = {
	id = soh.8658
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		random_list = {
			1 = {
				character_event = { id = soh.8659 } # Got soldier
			}
			
			1 = {
				character_event = { id = soh.8660 } # Got eunuch
			}
			
			1 = {
				character_event = { id = soh.8661 } # Got courtesan
			}
			
			1 = {
				character_event = { id = soh.8662 } # Got scholar
			}
			
			1 = {
				character_event = { id = soh.8663 } # Got minor noble
			}
			
			10 = {
				trigger = {
					ai = yes
				}
				
				# Nothing; keeps character spawning down
			}
		}
	}
}

# Gain courtier - young soldier
character_event = {
	id = soh.8659
	desc = EVTDESC_SOH_8659
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = FROMFROMFROM # Hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = tf_character_home_province
				}
			}
		}
		
		create_tf_soldier_effect = yes
	}
	
	option = {
		name = EVTOPTA_SOH_8659 # They're welcome here!
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTB_SOH_8659 # I don't like them!
		
		event_target:new_tf_character = {
			leave_court_and_die_effect = yes
		}
	}
}

# Gain courtier - eunuch
character_event = {
	id = soh.8660
	desc = EVTDESC_SOH_8660
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = FROMFROMFROM # Hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = tf_character_home_province
				}
			}
		}
		
		create_tf_eunuch_effect = yes
	}
	
	option = {
		name = EVTOPTA_SOH_8660 # He's welcome here!
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTB_SOH_8660 # I don't like him!
		
		event_target:new_tf_character = {
			leave_court_and_die_effect = yes
		}
	}
}

# Gain courtier - young courtesan
character_event = {
	id = soh.8661
	desc = EVTDESC_SOH_8661
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = FROMFROMFROM # Hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = tf_character_home_province
				}
			}
		}
		
		create_chinese_courtesan_no_children_effect = yes
		
		new_character = {
			save_event_target_as = new_tf_character
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8661 # She's welcome here!
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTB_SOH_8661 # I don't like her!
		
		event_target:new_tf_character = {
			leave_court_and_die_effect = yes
		}
	}
}

# Gain courtier - old scholar
character_event = {
	id = soh.8662
	desc = EVTDESC_SOH_8662
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_sender = {
				save_event_target_as = treasure_fleet_sender
			}
		}
		
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = c_hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = tf_character_home_province
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					event_target:treasure_fleet_sender = {
						OR = {
							gender_equality_trigger = yes
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_feature_minangkabau
						}
					}
				}
				
				create_random_priest = {
					age = 65
					female = yes
					dynasty = none
					attributes = {
						diplomacy = 5
						martial = 1
						stewardship = 6
						intrigue = 4
						learning = 8
					}
					
					culture = event_target:tf_character_home_province
					
					religion = event_target:tf_character_home_province
					
					trait = scholar
					
					random_traits =	yes
				}
			}
			
			50 = {
				trigger = {
					event_target:treasure_fleet_sender = {
						NOR = {
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_feature_minangkabau
						}
					}
				}
				
				create_random_priest = {
					age = 65
					female = no
					dynasty = none
					attributes = {
						diplomacy = 5
						martial = 1
						stewardship = 6
						intrigue = 4
						learning = 8
					}
					
					culture = event_target:tf_character_home_province
					
					religion = event_target:tf_character_home_province
					
					trait = scholar
					
					random_traits =	yes
				}
			}
		}
		
		new_character = {
			save_event_target_as = new_tf_character
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8662 # They're welcome here!
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTB_SOH_8662 # I don't like him!
		
		event_target:new_tf_character = {
			leave_court_and_die_effect = yes
		}
	}
}

# Gain courtier - random noble
character_event = {
	id = soh.8663
	desc = EVTDESC_SOH_8663
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = FROMFROMFROM # Hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = tf_character_home_province
				}
			}
		}
		
		create_character = {
			age = 35
			female = 50
			dynasty = random
			culture = event_target:tf_character_home_province
			religion = event_target:tf_character_home_province
			random_traits =	yes
		}
		
		new_character = {
			save_event_target_as = new_tf_character
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8663 # They're welcome here!
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTB_SOH_8663 # I don't like them!
		
		event_target:new_tf_character = {
			leave_court_and_die_effect = yes
		}
	}
}

### Random JD courtier

# Hidden event to see what you get
character_event = {
	id = soh.8664
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		random_list = {
			1 = {
				character_event = { id = soh.8665 } # Got Strategist
			}
			
			1 = {
				character_event = { id = soh.8666 } # Got Master Engineer
			}
			
			1 = {
				character_event = { id = soh.8667 } # Got Scholar-Bureaucrat
			}
			
			1 = {
				character_event = { id = soh.8668 } # Got Siege Engineer
			}
			
			1 = {
				character_event = { id = soh.8669 } # Got Physician
			}
			
			10 = {
				trigger = {
					ai = yes
				}
				
				# Nothing; keeps character spawning down
			}
		}
	}
}

# Got Strategist
character_event = {
	id = soh.8665
	desc = EVTDESC_SOH_8665
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = FROMFROMFROM # Hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = chinese_character_origin
				}
			}
		}
		
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_sender = {
				save_event_target_as = chinese_character_creator
			}
		}
		
		create_chinese_strategist_effect = yes
		
		new_character = {
			give_minor_title = title_strategist
			
			save_event_target_as = new_tf_character
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8665 # They're welcome here!
	}
}

# Got Master Engineer
character_event = {
	id = soh.8666
	desc = EVTDESC_SOH_8666
	picture = GFX_evt_china_invades
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = FROMFROMFROM # Hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = chinese_character_origin
				}
			}
		}
		
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_sender = {
				save_event_target_as = chinese_character_creator
			}
		}
		
		create_chinese_master_engineer_effect = yes
		
		new_character = {
			set_character_flag = master_engineer_just_spawned
			
			give_minor_title = title_master_engineer
			
			save_event_target_as = new_tf_character
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8666 # They're welcome here!
	}
}

# Got Scholar-Bureaucrat
character_event = {
	id = soh.8667
	desc = EVTDESC_SOH_8667
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = FROMFROMFROM # Hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = chinese_character_origin
				}
			}
		}
		
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_sender = {
				save_event_target_as = chinese_character_creator
			}
		}
		
		create_chinese_administrator_effect = yes
		
		new_character = {
			give_minor_title = title_administrator
			
			save_event_target_as = new_tf_character
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8667 # They're welcome here!
	}
}

# Got Siege Engineer
character_event = {
	id = soh.8668
	desc = EVTDESC_SOH_8668
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = FROMFROMFROM # Hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = chinese_character_origin
				}
			}
		}
		
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_sender = {
				save_event_target_as = chinese_character_creator
			}
		}
		
		create_chinese_siege_engineer_effect = yes
		
		new_character = {
			give_minor_title = title_commander
			
			save_event_target_as = new_tf_character
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8668 # They're welcome here!
	}
}

# Offer accepted - got Physician
character_event = {
	id = soh.8669
	desc = EVTDESC_SOH_8669
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		e_china = {
			holder_scope = {
				random_realm_province = {
					preferred_limit = {
						is_connected_to = {
							sub_realm = no
							target = FROMFROMFROM # Hangzhou
							land_gap = no
							naval_distance = yes
						}
						port = yes
					}
					
					save_event_target_as = chinese_character_origin
				}
			}
		}
		
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_sender = {
				save_event_target_as = chinese_character_creator
			}
		}
		
		create_chinese_physician_effect = yes
		
		new_character = {
			give_minor_title = title_court_physician
			
			save_event_target_as = new_tf_character
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8669 # They're welcome here!
	}
}

### Tech spread

# Hidden event to see what we got
character_event = {
	id = soh.8670
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		random_demesne_province = {
			limit = {
				port = yes
				is_in_active_treasure_fleet_region_trigger = yes
				treasure_fleet_tech_can_spread_here_trigger = yes
			}
			
			save_event_target_as = tf_tech_spread_province
		}
		
		random_list = {
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_infantry_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8671 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_cavalry_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8672 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_skirmish_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8673 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_melee_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8674 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_siege_equipment_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8675 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_recruitment_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8676 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_castle_construction_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8677 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_city_construction_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8678 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_fortifications_construction_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8679 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_trade_practices_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8680 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_construction_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8681 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_naval_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8682 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_noble_customs_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8683 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_popular_customs_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8684 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_religious_customs_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8685 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_majesty_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8686 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_culture_flex_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8687 }
			}
			
			1 = {
				trigger = {
					event_target:tf_tech_spread_province = {
						treasure_fleet_tech_legalism_can_spread_here_trigger = yes
					}
				}
				
				character_event = { id = soh.8688 }
			}
		}
	}
}

# Got Infantry increase
character_event = {
	id = soh.8671
	desc = EVTDESC_SOH_8671
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8671 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_INFANTRY
				value = 1
			}
		}
	}
}

# Got Cavalry increase
character_event = {
	id = soh.8672
	desc = EVTDESC_SOH_8672
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8672 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_CAVALRY
				value = 1
			}
		}
	}
}

# Got Skirmish increase
character_event = {
	id = soh.8673
	desc = EVTDESC_SOH_8673
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8673 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_SKIRMISH
				value = 1
			}
		}
	}
}

# Got Melee increase
character_event = {
	id = soh.8674
	desc = EVTDESC_SOH_8674
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8674 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_MELEE
				value = 1
			}
		}
	}
}

# Got Siege Equipment increase
character_event = {
	id = soh.8675
	desc = EVTDESC_SOH_8675
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8675 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_SIEGE_EQUIPMENT
				value = 1
			}
		}
	}
}

# Got Military Organization increase
character_event = {
	id = soh.8676
	desc = EVTDESC_SOH_8676
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8676 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_RECRUITMENT
				value = 1
			}
		}
	}
}

# Got Castle Infrastructure increase
character_event = {
	id = soh.8677
	desc = EVTDESC_SOH_8677
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8677 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_CASTLE_CONSTRUCTION
				value = 1
			}
		}
	}
}

# Got City and Temple increase
character_event = {
	id = soh.8678
	desc = EVTDESC_SOH_8678
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8678 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_CITY_CONSTRUCTION
				value = 1
			}
		}
	}
}

# Got Improved Keeps increase
character_event = {
	id = soh.8679
	desc = EVTDESC_SOH_8679
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8679 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_FORTIFICATIONS_CONSTRUCTION
				value = 1
			}
		}
	}
}

# Got Trade Practices increase
character_event = {
	id = soh.8680
	desc = EVTDESC_SOH_8680
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8680 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_TRADE_PRACTICES
				value = 1
			}
		}
	}
}

# Got Construction increase
character_event = {
	id = soh.8681
	desc = EVTDESC_SOH_8681
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8681 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_CONSTRUCTION
				value = 1
			}
		}
	}
}

# Got Shipbuilding increase
character_event = {
	id = soh.8682
	desc = EVTDESC_SOH_8682
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8682 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_NAVAL
				value = 1
			}
		}
	}
}

# Got Noble Customs increase
character_event = {
	id = soh.8683
	desc = EVTDESC_SOH_8683
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8683 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_NOBLE_CUSTOMS
				value = 1
			}
		}
	}
}

# Got Popular Customs increase
character_event = {
	id = soh.8684
	desc = EVTDESC_SOH_8684
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8684 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_POPULAR_CUSTOMS
				value = 1
			}
		}
	}
}

# Got Religious Customs increase
character_event = {
	id = soh.8685
	desc = EVTDESC_SOH_8685
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8685 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_RELIGIOUS_CUSTOMS
				value = 1
			}
		}
	}
}

# Got Majesty increase
character_event = {
	id = soh.8686
	desc = EVTDESC_SOH_8686
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8686 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_MAJESTY
				value = 1
			}
		}
	}
}

# Got Tolerance increase
character_event = {
	id = soh.8687
	desc = EVTDESC_SOH_8687
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8687 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_CULTURE_FLEX
				value = 1
			}
		}
	}
}

# Got Legalism increase
character_event = {
	id = soh.8688
	desc = EVTDESC_SOH_8688
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8688 # Great!
		
		event_target:tf_tech_spread_province = {
			change_tech = {
				technology = TECH_LEGALISM
				value = 1
			}
		}
	}
}

### Tech points

# Got tech points
character_event = {
	id = soh.8689
	desc = EVTDESC_SOH_8689
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8689 # Great!
		
		random_list = {
			33 = {
				military_techpoints = 25
			}
			
			33 = {
				economy_techpoints = 25
			}
			
			33 = {
				culture_techpoints = 25
			}
		}
	}
}

### Prosperity increase

# Prosperity increase in province
character_event = {
	id = soh.8690
	desc = EVTDESC_SOH_8690
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		random_demesne_province = {
			limit = {
				port = yes
				is_in_active_treasure_fleet_region_trigger = yes
				NOT = {
					has_province_modifier = prosperity_modifier_3
				}
			}
			
			save_event_target_as = prospering_province
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8690 # Great!
		
		if = {
			limit = {
				event_target:prospering_province = {
					OR = {
						has_province_modifier = depopulated_1
						has_province_modifier = depopulated_2
						has_province_modifier = depopulated_3
					}
				}
			}
			
			event_target:prospering_province = {
				decrease_depopulation_effect = yes
			}
		}
		
		else = {
			event_target:prospering_province = {
				increase_prosperity_effect = yes
			}
		}
	}
}

### Fireworks

# Fireworks are nice
character_event = {
	id = soh.8691
	desc = EVTDESC_SOH_8691
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8691 # Impressive!
		
		random = {
			chance = 25
			remove_trait_depressed_effect = yes
		}
	}
}

# Fireworks are stressful
character_event = {
	id = soh.8692
	desc = EVTDESC_SOH_8692
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8692 # I can't sleep!
		
		random = {
			chance = 25
			add_trait_stressed_effect = yes
		}
	}
}

### Invite guests

# Offer to invite guest over?
character_event = {
	id = soh.8693
	desc = EVTDESC_SOH_8693
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		e_china = {
			any_realm_character = {
				count = 3
				limit = {
					trait = treasure_fleet_voyage
					has_epidemic = no
					NOR = {
						has_any_opinion_modifier = opinion_tf_guest
						has_character_flag = left_treasure_fleet_voyage
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_tf_guest
					months = 1
				}
			}
		}
	}
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8693 # Yes!
		
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
			}
			
			character_event = { id = soh.8694 }
		}
		
		character_event = { id = soh.8695 days = 5 }
		
		wealth = -25
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTB_SOH_8693 # No!
		
		prestige = -25
	}
}

# Offer is made - guests
character_event = {
	id = soh.8694
	desc = EVTDESC_SOH_8694
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8694 # Sounds good!
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTB_SOH_8694 # Nah!
		
		remove_opinion = {
			who = FROM
			modifier = opinion_tf_guest
		}
		
		prestige = -25
	}
}

# Check to see what happened
character_event = {
	id = soh.8695
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				any_opinion_modifier_target = {
					has_opinion_modifier = {
						who = ROOT
						modifier = opinion_tf_guest
					}
				}
			}
			
			character_event = { id = soh.8697 }
		}
		
		else = {
			character_event = { id = soh.8696 }
		}
	}
}

# All guests refused
character_event = {
	id = soh.8696
	desc = EVTDESC_SOH_8696
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8696 # Curses!
		
		prestige = -50
	}
}

# At least one guest accepted - guests arrives
character_event = {
	id = soh.8697
	desc = EVTDESC_SOH_8697
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8697 # Welcome! Welcome!
		
		prestige = 10
		
		character_event = { id = soh.8699 days = 2 random = 2 }
		
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
			}
			
			character_event = { id = soh.8698 }
		}
	}
}

# Guests arrive - guests
character_event = {
	id = soh.8698
	desc = EVTDESC_SOH_8698
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8698 # Time for a feast!
	}
}

# Let's see what happens
character_event = {
	id = soh.8699
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			10 = {
				trigger = {
					any_opinion_modifier_target = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						NOR = {
							is_friend = ROOT
							is_lover = ROOT
							is_rival = ROOT
						}
					}
				}
				
				# Friendship with guest
				character_event = { id = soh.8700 }
			}
			
			5 = {
				trigger = {
					any_opinion_modifier_target = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						NOR = {
							is_friend = ROOT
							is_lover = ROOT
							is_rival = ROOT
						}
					}
				}
				
				# Rivalry with guest
				character_event = { id = soh.8702 }
			}
			
			1 = {
				trigger = {
					any_opinion_modifier_target = {
						is_adult = yes
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						NOR = {
							is_friend = ROOT
							is_lover = ROOT
							is_rival = ROOT
						}
						is_valid_romance_target = ROOT
					}
					is_adult = yes
				}
				
				# Possible tumbling
				character_event = { id = soh.8704 }
			}
			
			2 = {
				# Embarrassing host
				character_event = { id = soh.8710 }
			}
			
			2 = {
				# Embarrassing guest
				character_event = { id = soh.8712 }
			}
			10 = {
				trigger = {
					has_dlc = "Jade Dragon"
					any_opinion_modifier_target = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						OR = {
							NOT = {
								trait = temperate
							}
							trait = drunkard
						}
					}
				}
				
				# Drunk guest offers free Grace
				character_event = { id = soh.8714 }
			}
			
			5 = {
				trigger = {
					any_opinion_modifier_target = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						OR = {
							NOT = {
								trait = temperate
							}
							trait = drunkard
						}
					}
					suzerain = {
						is_chinese_emperor_trigger = yes
					}
				}
				
				# Drunk guest offers lower tributary tier
				character_event = { id = soh.8716 }
			}
			
			2 = {
				trigger = {
					has_dlc = "Jade Dragon"
					any_opinion_modifier_target = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						OR = {
							NOT = {
								trait = temperate
							}
							trait = drunkard
						}
					}
					
					treasure_fleet_has_artifacts_trigger = yes
				}
				
				# Drunk guest offers free artifact
				random_opinion_modifier_target = {
					limit = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						OR = {
							NOT = {
								trait = temperate
							}
							trait = drunkard
						}
					}
					
					character_event = { id = soh.8718 }
				}
			}
			
			10 = {
				# Guest and courtier become friends
				character_event = { id = soh.8720 }
			}
			
			10 = {
				# Guest and courtier become rivals
				character_event = { id = soh.8722 }
			}
			
			5 = {
				# Host accidentally insults China
				character_event = { id = soh.8724 }
			}
			
			10 = {
				# Host might imprison guest
				character_event = { id = soh.8726 }
			}
			
			5 = {
				trigger = {
					any_opinion_modifier_target = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						ai = yes # We don't want this to happen to the player
					}
				}
				
				# Guest chokes on food
				character_event = { id = soh.8733 }
			}
			
			25 = {
				# Uneventful feast
				character_event = { id = soh.8735 }
			}
			
			5 = {
				trigger = {
					any_opinion_modifier_target = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						NOT = {
							religion_group = ROOT
						}
					}
					NOT = {
						trait = zealous
					}
				}
				
				# Host gains sympathy
				character_event = { id = soh.8737 }
			}
			
			5 = {
				trigger = {
					any_opinion_modifier_target = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						NOR = {
							religion_group = ROOT
							trait = zealous
						}
					}
				}
				
				# Guest gains sympathy
				random_opinion_modifier_target = {
					limit = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_tf_guest
						}
						NOR = {
							religion_group = ROOT
							trait = zealous
						}
					}
					
					character_event = { id = soh.8738 }
				}
			}
		}
		
		character_event = { id = soh.8739 days = 5 random = 2 } # Next event selection
	}
}

# Friendship with guest
character_event = {
	id = soh.8700
	desc = EVTDESC_SOH_8700
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
				NOR = {
					is_friend = ROOT
					is_lover = ROOT
					is_rival = ROOT
				}
			}
			
			save_event_target_as = tf_feast_event_target
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8700 # That's great!
		
		add_friend = event_target:tf_feast_event_target
		
		event_target:tf_feast_event_target = {
			character_event = { id = soh.8701 }
		}
	}
}

# Inform guest about friendship
character_event = {
	id = soh.8701
	desc = EVTDESC_SOH_8701
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8701 # That's great!
		
		add_friend = FROM
	}
}

# Rivalry with guest
character_event = {
	id = soh.8702
	desc = EVTDESC_SOH_8702
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
				NOR = {
					is_friend = ROOT
					is_lover = ROOT
					is_rival = ROOT
				}
			}
			
			save_event_target_as = tf_feast_event_target
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8702 # I never should have invited them!
		
		add_rival = event_target:tf_feast_event_target
		
		event_target:tf_feast_event_target = {
			character_event = { id = soh.8703 }
		}
	}
}

# Inform guest about rivalry
character_event = {
	id = soh.8703
	desc = EVTDESC_SOH_8703
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8703 # I never should have accepted that invite!
		
		add_rival = FROM
	}
}

# Attractive guest - attempt to tumble?
character_event = {
	id = soh.8704
	desc = EVTDESC_SOH_8704
	picture = GFX_evt_dancing
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				is_adult = yes
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
				NOR = {
					is_friend = ROOT
					is_lover = ROOT
					is_rival = ROOT
				}
				is_valid_romance_target = ROOT
			}
			
			save_event_target_as = tf_feast_event_target
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8704 # Yes!
		
		event_target:tf_feast_event_target = {
			character_event = { id = soh.8705 days = 1 } # Other party approached
		}
		
		piety = -10
		
		ai_chance = {
			trigger = {
				NOR = {
					trait = chaste
					trait = celibate
					AND = {
						is_ascetic_trigger = yes
						NOT = {
							trait = lustful
						}
					}
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				event_target:tf_feast_event_target = {
					is_unattractive_trigger = yes
				}
			}
			
			mult_modifier = {
				factor = 5
				event_target:tf_feast_event_target = {
					is_attractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8704 # I don't think so!
		
		piety = 10
		
		ai_chance = {
			trigger = {
				NOR = {
					trait = lustful
					trait = master_seducer
					trait = master_seductress
				}
			}
			
			factor = 100
		}
	}
}

# Guest approached
character_event = {
	id = soh.8705
	desc = EVTDESC_SOH_8705
	picture = GFX_evt_dancing
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8705 # Yes!
		
		FROM = {
			character_event = { id = soh.8707 } # FROM informed
		}
		
		unprotected_sex_effect = yes
		
		piety = -10
		
		ai_chance = {
			trigger = {
				NOR = {
					trait = chaste
					trait = celibate
					AND = {
						is_ascetic_trigger = yes
						NOT = {
							trait = lustful
						}
					}
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				FROM = {
					is_unattractive_trigger = yes
				}
			}
			
			mult_modifier = {
				factor = 5
				FROM = {
					is_attractive_trigger = yes
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8705 # I don't think so!
		
		FROM = {
			character_event = { id = soh.8706 } # FROM informed
		}
		
		piety = 10
		
		ai_chance = {
			trigger = {
				NOR = {
					trait = lustful
					trait = master_seducer
					trait = master_seductress
				}
			}
			
			factor = 100
		}
	}
}

# Tumbling didn't happen
character_event = {
	id = soh.8706
	desc = EVTDESC_SOH_8706
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8706 # I see...
		
		prestige = -25
	}
}

# Seduction succeeded - lovers?
character_event = {
	id = soh.8707
	desc = EVTDESC_SOH_8707
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8707 # We should do this again!
		
		add_lover = FROM
		
		FROM = {
			character_event = { id = soh.8708 days = 1 } # Inform FROM
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8707 # This shouldn't become a long-term thing...
		
		FROM = {
			character_event = { id = soh.8709 days = 1 } # Inform FROM
		}
	}
}

# Lovers
character_event = {
	id = soh.8708
	desc = EVTDESC_SOH_8708
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8708 # That's great!
		
		add_lover = FROM
	}
}

# Not lovers
character_event = {
	id = soh.8709
	desc = EVTDESC_SOH_8709
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8709 # Perhaps that's for the best...
	}
}

# Host is an embarrasment - host
character_event = {
	id = soh.8710
	desc = EVTDESC_SOH_8710
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8710 # I misspoke...
		
		prestige = -25
		
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
			}
			
			character_event = { id = soh.8711 }
		}
	}
}

# Host is an embarrasment - guests
character_event = {
	id = soh.8711
	desc = EVTDESC_SOH_8711
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8711 # How embarrasing!
	}
}

# Guest is an embarrasment - host
character_event = {
	id = soh.8712
	desc = EVTDESC_SOH_8712
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
			}
			
			save_event_target_as = tf_feast_event_target
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8712 # How embarrasing!
		
		event_target:tf_feast_event_target = {
			character_event = { id = soh.8713 }
		}
	}
}

# Guest is an embarrasment - guest
character_event = {
	id = soh.8713
	desc = EVTDESC_SOH_8713
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8713 # I misspoke...
		
		prestige = -25
	}
}

# Drunk guest offers free Grace - host
character_event = {
	id = soh.8714
	desc = EVTDESC_SOH_8714
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
				OR = {
					NOT = {
						trait = temperate
					}
					trait = drunkard
				}
			}
			
			save_event_target_as = tf_feast_event_target
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8714 # That's great!
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			add_grace_massive_effect = yes
		}
		
		event_target:tf_feast_event_target = {
			character_event = { id = soh.8715 }
		}
	}
}

# Drunk guest offered free Grace - guest
character_event = {
	id = soh.8715
	desc = EVTDESC_SOH_8715
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8715 # Oops...
		
		prestige = -50
	}
}

# Drunk guest offers lower tributary tier - host
character_event = {
	id = soh.8716
	desc = EVTDESC_SOH_8716
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
				OR = {
					NOT = {
						trait = temperate
					}
					trait = drunkard
				}
			}
			
			save_event_target_as = tf_feast_event_target
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8716 # Don't look a gift horse in the mouth...
		
		if = {
			limit = {
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			decrease_tributary_tier_or_release_effect = yes
		}
		
		event_target:tf_feast_event_target = {
			character_event = { id = soh.8717 }
		}
	}
}

# Offer accepted - guest
character_event = {
	id = soh.8717
	desc = EVTDESC_SOH_8717
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8717 # I really screwed up...
		
		prestige = -100
	}
}

# Drunk guest offered free artifact - guest
character_event = {
	id = soh.8718
	desc = EVTDESC_SOH_8718
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8718 # Um, oops?
		
		FROM = {
			character_event = { id = soh.8719 }
		}
		
		prestige = -50
	}
}

# Drunk guest offers free artifact
character_event = {
	id = soh.8719
	desc = EVTDESC_SOH_8719
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_original_sender = {
				save_event_target_as = chinese_artifact_origin
			}
		}
		
		add_random_chinese_artifact_with_tf_moh_weight_effect = yes
	}
	
	option = {
		name = EVTOPTA_SOH_8719 # I'll take it!
	}
}

# Guest and courtier develop friendship - host
character_event = {
	id = soh.8720
	desc = EVTDESC_SOH_8720
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
			}
			
			save_event_target_as = tf_feast_event_target
		}
		
		random_courtier = {
			limit = {
				is_inaccessible_or_incapable_trigger = no
				is_landed = no
			}
			
			save_event_target_as = tf_feast_event_target_2
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8720 # That's great!
		
		event_target:tf_feast_event_target = {
			character_event = { id = soh.8721 }
		}
	}
}

# Guest and courtier develop friendship - guest
character_event = {
	id = soh.8721
	desc = EVTDESC_SOH_8721
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8721 # That's great!
		
		add_friend = event_target:tf_feast_event_target_2
	}
}

# Guest and courtier develop rivalry - host
character_event = {
	id = soh.8722
	desc = EVTDESC_SOH_8722
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
			}
			
			save_event_target_as = tf_feast_event_target
		}
		
		random_courtier = {
			limit = {
				is_inaccessible_or_incapable_trigger = no
				is_landed = no
			}
			
			save_event_target_as = tf_feast_event_target_2
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8722 # I see...
		
		event_target:tf_feast_event_target = {
			character_event = { id = soh.8723 }
		}
	}
}

# Guest and courtier develop rivalry - guest
character_event = {
	id = soh.8723
	desc = EVTDESC_SOH_8723
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8723 # I'll remember this!
		
		add_rival = event_target:tf_feast_event_target_2
	}
}

# Host accidentally insults China - host
character_event = {
	id = soh.8724
	desc = EVTDESC_SOH_8724
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8724 # I made a mistake...
		
		prestige = -100
		
		if = {
			limit = {
				has_dlc = "Jade Dragon"
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			detract_grace_major_effect = yes
		}
		
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
			}
			
			character_event = { id = soh.8725 }
		}
	}
}

# Host accidentally insults China - guest
character_event = {
	id = soh.8725
	desc = EVTDESC_SOH_8725
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8725 # How rude!
	}
}

# Host sees the opportunity to imprison guest - host
character_event = {
	id = soh.8726
	desc = EVTDESC_SOH_8726
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
			}
			
			preferred_limit = {
				any_rival = {
					character = ROOT
				}
			}
			
			save_event_target_as = tf_feast_event_target
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8726 # Yes!
		
		if = {
			limit = {
				has_dlc = "Jade Dragon"
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			if = {
				limit = {
					has_dlc = "Jade Dragon"
					e_china = {
						holder_scope = {
							is_chinese_emperor_trigger = yes
							is_close_relative = event_target:tf_feast_event_target
							dynasty = event_target:tf_feast_event_target
						}
					}
				}
				
				detract_grace_massive_effect = yes
			}
		}
		
		hidden_tooltip = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 2
						intrigue >= 24
					}
					
					mult_modifier = {
						factor = 2
						intrigue >= 20
					}
					
					mult_modifier = {
						factor = 2
						intrigue >= 16
					}
					
					mult_modifier = {
						factor = 2
						event_target:tf_feast_event_target = {
							intrigue < 12
						}
					}
					
					mult_modifier = {
						factor = 2
						event_target:tf_feast_event_target = {
							intrigue < 8
						}
					}
					
					mult_modifier = {
						factor = 2
						event_target:tf_feast_event_target = {
							intrigue < 4
						}
					}
					
					event_target:tf_feast_event_target = {
						character_event = { id = soh.8727 days = 1 }
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 2
						event_target:tf_feast_event_target = {
							intrigue >= 24
						}
					}
					
					mult_modifier = {
						factor = 2
						event_target:tf_feast_event_target = {
							intrigue >= 20
						}
					}
					
					mult_modifier = {
						factor = 2
						event_target:tf_feast_event_target = {
							intrigue >= 16
						}
					}
					
					mult_modifier = {
						factor = 2
						intrigue < 12
					}
					
					mult_modifier = {
						factor = 2
						intrigue < 8
					}
					
					mult_modifier = {
						factor = 2
						intrigue < 4
					}
					
					# Guest escapes
					event_target:tf_feast_event_target = {
						character_event = { id = soh.8730 days = 1 }
					}
				}
			}
		}
		
		ai_chance = {
			trigger = {
				OR = {
					event_target:tf_feast_event_target = {
						is_rival = ROOT
					}
					trait = cruel
					trait = arbitrary
				}
			}
			
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8726 # No!
		
		ai_chance = {
			trigger = {
				NOT = {
					event_target:tf_feast_event_target = {
						any_rival = {
							character = ROOT
						}
					}
				}
			}
			
			factor = 100
		}
	}
}

# Guest was imprisoned - guest
character_event = {
	id = soh.8727
	desc = EVTDESC_SOH_8727
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8727 # No!
		
		imprison = FROM
		
		remove_opinion = {
			modifier = opinion_tf_guest
			who = FROM
		}
		
		FROM = {
			character_event = { id = soh.8728 }
		}
	}
}

# Guest was imprisoned - host
character_event = {
	id = soh.8728
	desc = EVTDESC_SOH_8728
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8728 # Just as planned!
		
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					modifier = opinion_tf_guest
					who = ROOT
				}
			}
			
			character_event = { id = soh.8729 }
		}
	}
}

# Guest was imprisoned - other guests
character_event = {
	id = soh.8729
	desc = EVTDESC_SOH_8729
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8729 # I see...
	}
}

# Guest successfully escaped - guest
character_event = {
	id = soh.8730
	desc = EVTDESC_SOH_8730
	picture = GFX_evt_hiding_from_pursuers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8730 # I'm not caught that easily!
		
		remove_opinion = {
			modifier = opinion_tf_guest
			who = FROM
		}
		
		FROM = {
			character_event = { id = soh.8731 }
		}
	}
	
}

# Guest successfully escaped - host
character_event = {
	id = soh.8731
	desc = EVTDESC_SOH_8731
	picture = GFX_evt_hiding_from_pursuers
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8731 # That's not what I wanted...
		
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					modifier = opinion_tf_guest
					who = ROOT
				}
			}
			
			character_event = { id = soh.8732 }
		}
	}
}

# Guest successfully escaped - other guests
character_event = {
	id = soh.8732
	desc = EVTDESC_SOH_8732
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8732 # I see...
	}
}

# Guest chokes on food - host
character_event = {
	id = soh.8733
	desc = EVTDESC_SOH_8733
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
				ai = yes # Don't kill the player like this!
			}
			
			save_event_target_as = tf_feast_event_target
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8733 # Oops...
		
		if = {
			limit = {
				has_dlc = "Jade Dragon"
			}
			
			detract_grace_trivial_effect = yes
		}
		
		prestige = -10
		
		event_target:tf_feast_event_target = {
			character_event = { id = soh.8734 }
		}
	}
}

# Guest chokes on food - guest
character_event = {
	id = soh.8734
	desc = EVTDESC_SOH_8734
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8734 # Can't... breathe...
		
		death = {
			death_reason = death_accident_choked_to_death
		}
	}
}

# Uneventful feast - host
character_event = {
	id = soh.8735
	desc = EVTDESC_SOH_8735
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8735 # It was nice, I guess...
		
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					modifier = opinion_tf_guest
					who = ROOT
				}
			}
			
			character_event = { id = soh.8736 }
		}
	}
}

# Uneventful feast - guests
character_event = {
	id = soh.8736
	desc = EVTDESC_SOH_8736
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8736 # It was nice, I guess...
	}
}

# Host gains sympathy
character_event = {
	id = soh.8737
	desc = EVTDESC_SOH_8737
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_tf_guest
				}
				NOT = {
					religion_group = ROOT
				}
			}
			
			save_event_target_as = tf_feast_event_target
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8737 # That's great!
		
		event_target:tf_feast_event_target = {
			trigger_switch = {
				on_trigger = religion_group
				
				christian = { ROOT = { add_trait = sympathy_christendom } }
				jewish_group = { ROOT = { add_trait = sympathy_judaism } }
				muslim = { ROOT = { add_trait = sympathy_islam } }
				indian_group = { ROOT = { add_trait = sympathy_indian } }
				zoroastrian_group = { ROOT = { add_trait = sympathy_zoroastrianism } }
				pagan_group = { ROOT = { add_trait = sympathy_pagans } }
			}
		}
	}
}

# Guest gains sympathy
character_event = {
	id = soh.8738
	desc = EVTDESC_SOH_8738
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8738 # That's great!
		
		FROM = {
			trigger_switch = {
				on_trigger = religion_group
				
				christian = { ROOT = { add_trait = sympathy_christendom } }
				jewish_group = { ROOT = { add_trait = sympathy_judaism } }
				muslim = { ROOT = { add_trait = sympathy_islam } }
				indian_group = { ROOT = { add_trait = sympathy_indian } }
				zoroastrian_group = { ROOT = { add_trait = sympathy_zoroastrianism } }
				pagan_group = { ROOT = { add_trait = sympathy_pagans } }
			}
		}
	}
}

# Feast is over - host
character_event = {
	id = soh.8739
	desc = EVTDESC_SOH_8739
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8739 # I had a great time!
		
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					modifier = opinion_tf_guest
					who = ROOT
				}
			}
			
			character_event = { id = soh.8740 }
		}
	}
}

# Feast is over - guest
character_event = {
	id = soh.8740
	desc = EVTDESC_SOH_8740
	picture = GFX_evt_feast
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8740 # I had a great time!
	}
}



##### Port events - trait events

### Drinking with sailors

# Drinking with sailors - invitation
character_event = {
	id = soh.8741
	desc = EVTDESC_SOH_8741
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8741 # I'll drink with you!
		
		hidden_tooltip = {
			random_list = {
				25 = {
					trigger = {
						NOT = {
							trait = drunkard
						}
					}
					
					character_event = { id = soh.8742 days = 1 } # Felt ill
				}
				
				25 = {
					character_event = { id = soh.8743 days = 1 } # Woke up with a hangover
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						trait = drunkard
					}
					
					character_event = { id = soh.8744 days = 1 } # Made a fool of yourself
				}
				
				50 = {
					character_event = { id = soh.8745 days = 1 } # Nothing of note
				}
				
				25 = {
					trigger = {
						trait = temperate
					}
					
					character_event = { id = soh.8746 days = 1 } # Lost Temperate
				}
				
				25 = {
					trigger = {
						trait = drunkard
					}
					
					mult_modifier = {
						factor = 0.1
						trait = temperate
					}
					
					character_event = { id = soh.8747 days = 1 } # Drank them under the table
				}
				
				25 = {
					trigger = {
						NOT = {
							trait = drunkard
						}
					}
					
					character_event = { id = soh.8748 days = 1 } # Became drunkard
				}
			}
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				trait = temperate
			}
			
			mult_modifier = {
				factor = 0.01
				religion_group = muslim
				NOT = {
					trait = decadent
				}
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				trait = drunkard
			}
		}
		
		name = EVTOPTB_SOH_8741 # I think not!
		
		prestige = -50
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				NOT = {
					trait = temperate
				}
			}
			
			mult_modifier = {
				factor = 10
				trait = proud
			}
		}
	}
}

# Drinking with sailors - felt ill
character_event = {
	id = soh.8742
	desc = EVTDESC_SOH_8742
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8742 # Out of my way!
		
		prestige = -25
	}
}

# Drinking with sailors - hangover
character_event = {
	id = soh.8743
	desc = EVTDESC_SOH_8743
	picture = GFX_evt_drunk
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8743 # My head!
		
		prestige = -50
	}
}

# Drinking with sailors - made a fool of yourself
character_event = {
	id = soh.8744
	desc = EVTDESC_SOH_8744
	picture = GFX_evt_drunk
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8744 # I did what?
		
		prestige = -100
	}
}

# Drinking with sailors - nothing of note
character_event = {
	id = soh.8745
	desc = EVTDESC_SOH_8745
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8745 # I suppose that was okay...
	}
}

# Drinking with sailors - lost Temperate
character_event = {
	id = soh.8746
	desc = EVTDESC_SOH_8746
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8746 # I should drink more often...
		
		add_trait_partially_drunkard_effect = yes
	}
}

# Drinking with sailors - drank them under the table
character_event = {
	id = soh.8747
	desc = EVTDESC_SOH_8747
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8747 # I'm good at this!
		
		prestige = 50
	}
}

# Drinking with sailors - become Drunkard
character_event = {
	id = soh.8748
	desc = EVTDESC_SOH_8748
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8748 # Another round?
		
		add_trait_partially_drunkard_effect = yes
	}
}

### Tumble opportunity

# Someone wants to tumble
character_event = {
	id = soh.8749
	desc = EVTDESC_SOH_8749
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		d_treasure_fleet = {
			holder_scope = {
				if = {
					limit = {
						ROOT = {
							is_female = yes
							trait = homosexual
						}
					}
					
					create_character = {
						age = 19
						female = yes
						culture = PREV
						religion = PREV
						dynasty = none
						trait = homosexual
						trait = lustful
						trait = strong
						trait = ambitious
						trait = underhanded_rogue
						trait = treasure_fleet_voyage
					}
					
					new_character = {
						save_event_target_as = sex_partner
					}
				}
				
				else_if = {
					limit = {
						ROOT = {
							is_female = yes
							NOT = {
								trait = homosexual
							}
						}
					}
					
					create_character = {
						age = 19
						female = no
						culture = PREV
						religion = PREV
						dynasty = none
						trait = lustful
						trait = strong
						trait = ambitious
						trait = underhanded_rogue
						trait = treasure_fleet_voyage
					}
					
					new_character = {
						save_event_target_as = sex_partner
					}
				}
				
				else_if = {
					limit = {
						ROOT = {
							is_female = no
							trait = homosexual
						}
					}
					
					create_character = {
						age = 19
						female = no
						culture = PREV
						religion = PREV
						dynasty = none
						trait = homosexual
						trait = lustful
						trait = strong
						trait = ambitious
						trait = underhanded_rogue
						trait = treasure_fleet_voyage
					}
					
					new_character = {
						save_event_target_as = sex_partner
					}
				}
				
				else_if = {
					limit = {
						ROOT = {
							is_female = no
							NOT = {
								trait = homosexual
							}
						}
					}
					
					create_character = {
						age = 19
						female = yes
						culture = PREV
						religion = PREV
						dynasty = none
						trait = lustful
						trait = strong
						trait = ambitious
						trait = underhanded_rogue
						trait = treasure_fleet_voyage
					}
					
					new_character = {
						save_event_target_as = sex_partner
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8749 # I like the way you think!
		
		add_lover = event_target:sex_partner
		
		unprotected_sex_effect_event_target = yes
		
		event_target:sex_partner = {
			move_character = ROOT
			
			force_host = ROOT
		}
		
		ai_chance = {
			trigger = {
				NOR = {
					trait = chaste
					AND = {
						trait = celibate
						NOT = {
							trait = lustful
						}
					}
				}
			}
			
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8749 # Just this once!
		
		unprotected_sex_effect_event_target = yes
		
		ai_chance = {
			trigger = {
				NOR = {
					trait = chaste
					AND = {
						trait = celibate
						NOT = {
							trait = lustful
						}
					}
				}
			}
			
			
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = kind
			}
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
		}
	}
	
	option = {
		name = EVTOPTC_SOH_8749 # I think not!
		
		ai_chance = {
			trigger = {
				NAND = {
					trait = lustful
					OR = {
						trait = celibate
						trait = proud
					}
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				NOR = {
					trait = chaste
					trait = celibate
				}
			}
		}
	}
}

### Duelist gets to duel

# Duelist gets to duel sailors
character_event = {
	id = soh.8750
	desc = EVTDESC_SOH_8750
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8750 # You're on!
		
		pacifists_lose_piety_effect = yes
		
		add_one_duel_experience_modifier = yes
		
		hidden_tooltip = {
			random_list = {
				33 = {
					mult_modifier = {
						factor = 2
						combat_rating >= 50
					}
					
					character_event = { id = soh.8751 days = 1 random = 2 } # Duelist did well
				}
				
				34 = {
					character_event = { id = soh.8752 days = 1 random = 2 } # Duelist did okay
				}
				
				33 = {
					trigger = {
						combat_rating < 50
					}
					
					character_event = { id = soh.8753 days = 1 random = 2 } # Duelist did poorly
				}
			}
		}
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = craven
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = slothful
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8750 # I have other things to do...
		
		prestige = -25
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = brave
				}
			}
			
			factor = 100
		}
	}
}

# Duelist did well
character_event = {
	id = soh.8751
	desc = EVTDESC_SOH_8751
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8751 # I'm pretty good at this!
		
		prestige = 100
		
		random = {
			chance = 25
			add_trait_partially_proud_effect = yes
		}
	}
}

# Duelist did okay
character_event = {
	id = soh.8752
	desc = EVTDESC_SOH_8752
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8752 # Well fought!
		
		prestige = 25
	}
}

# Duelist did poorly
character_event = {
	id = soh.8753
	desc = EVTDESC_SOH_8753
	picture = GFX_evt_treasure_fleet
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8753 # Ow!
		
		prestige = -50
		
		add_trait_wounded_effect = yes
	}
	
	option = {
		name = EVTOPTB_SOH_8753 # Guards! Seize that man!
		
		add_trait_partially_cruel_effect = yes
		
		add_trait_wounded_effect = yes
	}
}

### Game master tries new games

# Gamer might gamble - unfamiliar games
character_event = {
	id = soh.8754
	desc = EVTDESC_SOH_8754
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8754 # You're on!
		
		hidden_tooltip = {
			random_list = {
				25 = {
					character_event = { id = soh.8755 days = 1 random = 2 } # Gamer won
				}
				
				75 = {
					character_event = { id = soh.8756 days = 1 random = 2 } # Gamer lost
				}
			}
		}
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = craven
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				trait = paranoid
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8754 # I have other things to do...
		
		prestige = -25
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = brave
				}
			}
			
			factor = 100
		}
	}
}

# Gamer won
character_event = {
	id = soh.8755
	desc = EVTDESC_SOH_8755
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8755 # Victory is mine!
		
		wealth = 100
	}
}

# Gamer lost
character_event = {
	id = soh.8756
	desc = EVTDESC_SOH_8756
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8756 # This cannot be!
		
		wealth = -100
	}
}

### Game master plays local games

# Gamer might gamble - familiar games
character_event = {
	id = soh.8757
	desc = EVTDESC_SOH_8757
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8757 # You're on!
		
		hidden_tooltip = {
			random_list = {
				75 = {
					character_event = { id = soh.8758 days = 1 random = 2 } # Gamer won
				}
				
				25 = {
					character_event = { id = soh.8759 days = 1 random = 2 } # Gamer lost
				}
			}
		}
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = craven
				}
			}
			
			factor = 100
			
			mult_modifier = {
				factor = 0.01
				trait = paranoid
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8757 # I have other things to do...
		
		prestige = -25
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = brave
				}
			}
			
			factor = 100
		}
	}
}

# Gamer won
character_event = {
	id = soh.8758
	desc = EVTDESC_SOH_8758
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8758 # Victory is mine!
		
		wealth = 100
	}
}

# Gamer lost
character_event = {
	id = soh.8759
	desc = EVTDESC_SOH_8759
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8759 # This cannot be!
		
		wealth = -100
	}
}

### Scholar learns something

# Scholar gets to study
character_event = {
	id = soh.8760
	desc = EVTDESC_SOH_8760
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8760 # It's worth doing!
		
		hidden_tooltip = {
			random_list = {
				25 = {
					character_event = { id = soh.8761 days = 1 random = 2 } # Military insight
				}
				
				25 = {
					character_event = { id = soh.8762 days = 1 random = 2 } # Economic insight
				}
				
				25 = {
					character_event = { id = soh.8763 days = 1 random = 2 } # Cultural insight
				}
				
				25 = {
					character_event = { id = soh.8764 days = 1 random = 2 } # Mixed insight
				}
				
				100 = {
					character_event = { id = soh.8765 days = 1 random = 2 } # Nothing
				}
			}
		}
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = slothful
				}
			}
			
			factor = 100
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8760 # I have other things to do...
		
		prestige = -25
		
		ai_chance = {
			trigger = {
				NOT = {
					trait = diligent
				}
			}
			
			factor = 100
		}
	}
}

# Discovered military insight
character_event = {
	id = soh.8761
	desc = EVTDESC_SOH_8761
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8761 # Knowledge is power!
		
		military_techpoints = 50
	}
}

# Discovered economic insight
character_event = {
	id = soh.8762
	desc = EVTDESC_SOH_8762
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8762 # Knowledge is power!
		
		economy_techpoints = 50
	}
}

# Discovered cultural insight
character_event = {
	id = soh.8763
	desc = EVTDESC_SOH_8763
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8763 # Knowledge is power!
		
		culture_techpoints = 50
	}
}

# Mixed insight
character_event = {
	id = soh.8764
	desc = EVTDESC_SOH_8764
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8764 # Knowledge is power!
		
		military_techpoints = 15
		economy_techpoints = 15
		culture_techpoints = 15
	}
}

# Nothing of note
character_event = {
	id = soh.8765
	desc = EVTDESC_SOH_8765
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8765 # There must be something here!
		
		prestige = -50
		
		random = {
			chance = 50
			add_trait_stressed_effect = yes
		}
	}
}

### Humble character impresses Chinese visitors

# Visitors impressed
character_event = {
	id = soh.8766
	desc = EVTDESC_SOH_8766
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8766 # Good to hear!
		
		if = {
			limit = {
				has_dlc = "Jade Dragon"
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			add_grace_trivial_effect  = yes
		}
		
		prestige = 50
	}
}

### Trying new food

# Become more gluttonous
character_event = {
	id = soh.8767
	desc = EVTDESC_SOH_8767
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8767 # I want more of that!
		
		add_trait_partially_gluttonous_effect = yes
	}
}

# Become fatter
character_event = {
	id = soh.8768
	desc = EVTDESC_SOH_8768
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8768 # I ate quite a lot...
		
		hidden_tooltip = {
			random_list = {
				1 = {
					gain_weight_small_effect = yes
				}
				
				1 = {
					gain_weight_medium_effect = yes
				}
				
				1 = {
					gain_weight_large_effect = yes
				}
			}
		}
	}
}

### Trade deals - become less Charitable

# Become more greedy
character_event = {
	id = soh.8769
	desc = EVTDESC_SOH_8769
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8769 # They did not get a fair price!
		
		add_trait_partially_greedy_effect = yes
		
		scaled_wealth = 0.1
	}
}

### Envy of China

# Become more envious
character_event = {
	id = soh.8770
	desc = EVTDESC_SOH_8770
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	immediate = {
		2753 = { # Hangzhou
			persistent_event_target:treasure_fleet_sender = {
				save_event_target_as = treasure_fleet_sender
			}
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8770 # I want what they have!
		
		add_trait_partially_envious_effect = yes
	}
}

### Proud character is proud

# Proud of own customs
character_event = {
	id = soh.8771
	desc = EVTDESC_SOH_8771
	picture = GFX_evt_china_open
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8771 # They are beneath me!
		
		if = {
			limit = {
				has_dlc = "Jade Dragon"
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			detract_grace_trivial_effect  = yes
		}
		
		prestige = 50
	}
}

### Punish law-breaking sailors?

# Deal with criminal sailors
character_event = {
	id = soh.8772
	desc = EVTDESC_SOH_8772
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8772 # They need to follow our laws!
		
		if = {
			limit = {
				has_dlc = "Jade Dragon"
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			detract_grace_minor_effect  = yes
		}
		
		prestige = 50
		
		add_trait_partially_just_effect = yes
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = arbitrary
			}
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
		}
	}
	
	option = {
		name = EVTOPTB_SOH_8772 # I guess I can let it slide...
		
		if = {
			limit = {
				has_dlc = "Jade Dragon"
				NOT = {
					has_global_flag = abort_treasure_fleet_asap
				}
			}
			
			detract_grace_minor_effect  = yes
		}
		
		prestige = -50
		
		add_trait_partially_arbitrary_effect = yes
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = just
			}
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
		}
	}
}

### Fear of China

# China is mighty
character_event = {
	id = soh.8773
	desc = EVTDESC_SOH_8773
	picture = GFX_evt_china_expansionist
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8773 # They could crush me...
		
		add_trait_partially_craven_effect = yes
	}
}

### Paranoia

# Strangers are scary
character_event = {
	id = soh.8774
	desc = EVTDESC_SOH_8774
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8774 # They must be up to something!
		
		add_trait_partially_paranoid_effect = yes
	}
}

### Shy character gets to interact with the Treasure Fleet

# Shy character might lose Shy
character_event = {
	id = soh.8775
	desc = EVTDESC_SOH_8775
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8775 # I actually kind of liked that...
		
		random = {
			chance = 25
			remove_trait_shy_effect = yes
		}
	}
}

### Become more Zealous

# Sailors' religion is weird
character_event = {
	id = soh.8776
	desc = EVTDESC_SOH_8776
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_global_flag = treasure_fleet_destroyed
		}
	}
	
	option = {
		name = EVTOPTA_SOH_8776 # Their ways are wrong!
		
		piety = 25
		
		add_trait_partially_zealous_effect = yes
	}
}

### Faqih

# Faqih inspires sailors
character_event = {
	id = soh.8777
	desc = EVTDESC_SOH_8777
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_8777 # God is great!
		
		piety = 50
	}
}