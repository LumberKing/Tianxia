# Chinese interest group infighting events
# By Silverswee(e)per

namespace = soh

# soh.4701-5100 reserved

# Eunuchs prefer courtiers, then GC, never vassals
# GC prefers vassals, then courtiers, never eunuchs
# Courtiers prefer eunuchs, then GC, never vassals
# Vassals prefer GC, then courtiers, never eunuchs
# Liege prefers courtiers, then GC, then eunuchs, never vassals
# A group that's +2 (+2 per law for GC) will always be disfavored
# Rivalries/etc. can override

##### Initial setup

# Hidden event for liege to decide if there's infighting - on_five_year_pulse
character_event = {
	id = soh.4701
	hide_window = yes
	
	is_triggered_only = yes # on_five_year_pulse
	
	has_dlc = "Jade Dragon"
	has_dlc = "Conclave"
	
	only_independent = yes
	
	trigger = {
		real_tier = emperor
		
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
		
		is_inaccessible_trigger = no
	}
	
	immediate = {
		if = {
			limit = {
				NOT = {
					has_character_modifier = ci_nuclear_option_in_effect
				}
			}
			
			clr_character_flag = fake_eunuch_challenge
			clr_character_flag = actual_eunuch_challenge
			clr_character_flag = grand_chancellor_challenge
			clr_character_flag = ci_courtier_challenge
			clr_character_flag = ci_vassal_challenge
			clr_character_flag = eunuchs_challenged
			clr_character_flag = grand_chancellor_challenged
			clr_character_flag = ci_courtiers_challenged
			clr_character_flag = ci_vassals_challenged
			
			random_list = {
				50 = {
					trigger = {
						has_regent = no # Someone will want to take advantage of this, most likely
					}
					
					mult_modifier = {
						factor = 5
						has_character_modifier = mandate_of_heaven_5
					}
					
					mult_modifier = {
						factor = 2
						has_character_modifier = mandate_of_heaven_4
					}
					# No infighting
				}
				
				50 = {
					mult_modifier = {
						factor = 2
						has_character_modifier = mandate_of_heaven_2
					}
					
					mult_modifier = {
						factor = 5
						has_character_modifier = mandate_of_heaven_1
					}
					
					# Infighting
					random_list = {
						1 = {
							# Fallback; should be irrelevant
						}
						25 = {
							trigger = {
								NOT = {
									primary_title = {
										has_law = eunuch_law_4
										has_law = grand_chancellor_law_0
										has_law = ci_courtier_law_0
										has_law = ci_vassal_law_0
									}
								}
							}
							
							mult_modifier = {
								factor = 2
								any_voter = {
									is_council_eunuch_trigger = yes
									OR = {
										trait = ambitious
										trait = envious
									}
								}
							}
							
							mult_modifier = {
								factor = 0.5
								primary_title = {
									has_law = eunuch_law_0
								}
							}
							
							mult_modifier = {
								factor = 1.5
								primary_title = {
									has_law = eunuch_law_2
								}
							}
							
							mult_modifier = {
								factor = 1.2
								primary_title = {
									has_law = eunuch_law_3
								}
							}
							
							if = {
								limit = {
									primary_title = {
										has_law = eunuch_law_0
									}
								}
								character_event = { id = soh.4702 } # See if there's a challenge
							}
							
							else = {
								random_voter = {
									limit = {
										is_council_eunuch_trigger = yes
									}
									
									preferred_limit = {
										trait = ambitious
										trait = envious
									}
									
									preferred_limit = {
										trait = ambitious
									}
									
									preferred_limit = {
										trait = envious
									}
									
									character_event = { id = soh.4703 } # See if there's a challenge
								}
							}
						}
						
						25 = {
							trigger = {
								NOT = {
									primary_title = {
										has_law = eunuch_law_0
										has_law = grand_chancellor_law_2
										has_law = ci_courtier_law_0
										has_law = ci_vassal_law_0
									}
								}
								
								any_vassal = {
									has_minor_title = title_grand_chancellor
								}
							}
							
							mult_modifier = {
								factor = 2
								any_vassal = {
									has_minor_title = title_grand_chancellor
									trait = ambitious
								}
							}
							
							mult_modifier = {
								factor = 0.5
								primary_title = {
									has_law = grand_chancellor_law_0
								}
							}
							
							mult_modifier = {
								factor = 1.5
								primary_title = {
									has_law = grand_chancellor_law_1
								}
							}
							
							any_vassal = {
								limit = {
									has_minor_title = title_grand_chancellor
								}
								
								character_event = { id = soh.4704 } # See if there's a challenge
							}
						}
						
						25 = {
							trigger  = {
								NOT = {
									primary_title = {
										has_law = eunuch_law_0
										has_law = grand_chancellor_law_0
										has_law = ci_courtier_law_4
										has_law = ci_vassal_law_0
									}
								}
							}
							
							mult_modifier = {
								factor = 2
								any_courtier = {
									is_adult = yes
									prisoner = no
									is_council_eunuch_trigger = no
									NAND = {
										dynasty = ROOT
										any_close_relative = {
											character = ROOT
										}
									}
									
									OR = {
										is_voter = yes
										any_spouse = {
											character = ROOT
										}
										any_consort = {
											character = ROOT
										}
										any_child = {
											character = ROOT
										}
										any_child_even_if_dead = {
											any_child = {
												character = ROOT
											}
										}
									}
									
									OR = {
										trait = ambitious
										trait = envious
									}
								}
							}
							
							mult_modifier = {
								factor = 0.5
								primary_title = {
									has_law = ci_courtier_law_0
								}
							}
							
							mult_modifier = {
								factor = 1.5
								primary_title = {
									has_law = ci_courtier_law_2
								}
							}
							
							mult_modifier = {
								factor = 1.2
								primary_title = {
									has_law = ci_courtier_law_3
								}
							}
							
							random_courtier = {
								limit = {
									is_adult = yes
									prisoner = no
									is_council_eunuch_trigger = no
									NAND = {
										dynasty = ROOT
										any_close_relative = {
											character = ROOT
										}
									}
									OR = {
										is_voter = yes
										any_spouse = {
											character = ROOT
										}
										any_consort = {
											character = ROOT
										}
										any_child = {
											character = ROOT
										}
										any_child_even_if_dead = {
											any_child = {
												character = ROOT
											}
										}
									}
								}
								
								preferred_limit = {
									trait = ambitious
									trait = envious
								}
								
								preferred_limit = {
									trait = ambitious
								}
								
								preferred_limit = {
									trait = envious
								}
								
								character_event = { id = soh.4705 } # See if there's a challenge
							}
						}
						
						25 = {
							trigger = {
								NOT = {
									primary_title = {
										has_law = eunuch_law_0
										has_law = grand_chancellor_law_0
										has_law = ci_courtier_law_0
										has_law = ci_vassal_law_4
									}
								}
							}
							
							mult_modifier = {
								factor = 2
								any_vassal = {
									is_adult = yes
									prisoner = no
									higher_tier_than = baron
									NAND = {
										dynasty = ROOT
										any_close_relative = {
											character = ROOT
										}
									}
									
									OR = {
										is_voter = yes
										is_powerful_vassal = yes
									}
									
									OR = {
										trait = ambitious
										trait = envious
									}
								}
							}
							
							mult_modifier = {
								factor = 0.5
								primary_title = {
									has_law = ci_vassal_law_0
								}
							}
							
							mult_modifier = {
								factor = 1.5
								primary_title = {
									has_law = ci_vassal_law_2
								}
							}
							
							mult_modifier = {
								factor = 1.2
								primary_title = {
									has_law = ci_vassal_law_3
								}
							}
							
							random_vassal = {
								limit = {
									is_adult = yes
									prisoner = no
									higher_tier_than = baron
									
									NAND = {
										dynasty = ROOT
										any_close_relative = {
											character = ROOT
										}
									}
									
									OR = {
										is_voter = yes
										is_powerful_vassal = yes
									}
								}
								
								preferred_limit = {
									trait = ambitious
									trait = envious
								}
								
								preferred_limit = {
									trait = ambitious
								}
								
								preferred_limit = {
									trait = envious
								}
								
								character_event = { id = soh.4706 } # See if there's a challenge
							}
						}
					}
				}
			}
		}
	}
}

# Fake eunuch might challenge
character_event = {
	id = soh.4702
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			25 = {
				trigger = {
					any_courtier_or_vassal = {
						has_minor_title = title_grand_chancellor
					}
					NOT = {
						primary_title = {
							has_law = grand_chancellor_law_0
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					primary_title = {
						has_law = grand_chancellor_law_2
					}
				}
				
				set_character_flag = fake_eunuch_challenge
				set_character_flag = grand_chancellor_challenged
				
				character_event = { id = soh.4707 }
			}
			
			25 = {
				trigger = {
					NOT = {
						primary_title = {
							has_law = ci_courtier_law_0
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					primary_title = {
						OR = {
							has_law = ci_courtier_law_2
							has_law = ci_courtier_law_3
							has_law = ci_courtier_law_4
						}
						
						NOR = {
							has_law = grand_chancellor_law_1
							has_law = grand_chancellor_law_2
							has_law = ci_vassal_law_1
							has_law = ci_vassal_law_2
							has_law = ci_vassal_law_3
							has_law = ci_vassal_law_4
						}
					}
				}
				
				mult_modifier = {
					factor = 5
					primary_title = {
						OR = {
							has_law = ci_courtier_law_3
							has_law = ci_courtier_law_4
						}
						
						NOR = {
							has_law = grand_chancellor_law_2
							has_law = ci_vassal_law_2
							has_law = ci_vassal_law_3
							has_law = ci_vassal_law_4
						}
					}
				}
				
				mult_modifier = {
					factor = 10
					primary_title = {
						has_law = ci_courtier_law_4
						NOR = {
							has_law = grand_chancellor_law_2
							has_law = ci_vassal_law_3
							has_law = ci_vassal_law_4
						}
					}
				}
				
				set_character_flag = fake_eunuch_challenge
				set_character_flag = ci_courtiers_challenged
				character_event = { id = soh.4732 }
			}
			
			25 = {
				trigger = {
					NOT = {
						primary_title = {
							has_law = ci_vassal_law_0
						}
					}
				}
				
				mult_modifier = {
					factor = 1.5
					primary_title = {
						has_law = ci_vassal_law_1
					}
				}
				
				mult_modifier = {
					factor = 2
					primary_title = {
						has_law = ci_vassal_law_2
					}
				}
				
				mult_modifier = {
					factor = 5
					primary_title = {
						has_law = ci_vassal_law_3
					}
				}
				
				mult_modifier = {
					factor = 10
					primary_title = {
						has_law = ci_vassal_law_4
					}
				}
				
				set_character_flag = fake_eunuch_challenge
				
				set_character_flag = ci_vassals_challenged
				
				character_event = { id = soh.4750 }
			}
			
			25 = {
				# No challenge
			}
		}
	}
}

# Eunuch might challenge
character_event = {
	id = soh.4703
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = eunuch_challenger
		random_list = {
			25 = {
				trigger = {
					FROM = {
						any_courtier_or_vassal = {
							has_minor_title = title_grand_chancellor
							NOR = {
								is_friend = ROOT
								is_lover = ROOT
							}
						}
						
						NOT = {
							primary_title = {
								has_law = grand_chancellor_law_0
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					FROM = {
						primary_title = {
							has_law = grand_chancellor_law_2
						}
					}
				}
				
				mult_modifier = {
					factor = 10
					any_rival = {
						liege = {
							character = FROM
						}
						
						has_minor_title = title_grand_chancellor
					}
				}
				
				FROM = {
					set_character_flag = actual_eunuch_challenge
					set_character_flag = grand_chancellor_challenged
					
					character_event = { id = soh.4707 }
				}
			}
			
			25 = {
				trigger = {
					FROM = {
						primary_title = {
							NOT = {
								has_law = ci_courtier_law_0
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					FROM = {
						primary_title = {
							OR = {
								has_law = ci_courtier_law_2
								has_law = ci_courtier_law_3
								has_law = ci_courtier_law_4
							}
							
							NOR = {
								has_law = grand_chancellor_law_1
								has_law = grand_chancellor_law_2
								has_law = ci_vassal_law_1
								has_law = ci_vassal_law_2
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 5
					FROM = {
						primary_title = {
							OR = {
								has_law = ci_courtier_law_3
								has_law = ci_courtier_law_4
							}
							
							NOR = {
								has_law = grand_chancellor_law_2
								has_law = ci_vassal_law_2
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 10
					FROM = {
						primary_title = {
							has_law = ci_courtier_law_4
							
							NOR = {
								has_law = grand_chancellor_law_2
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					any_rival = {
						host = {
							character = FROM
						}
						is_voter = yes
						is_council_eunuch_trigger = no
					}
				}
				
				mult_modifier = {
					factor = 0.2
					OR = {
						any_friend = {
							host = {
								character = FROM
							}
							is_voter = yes
							is_council_eunuch_trigger = no
							is_landed = no
						}
						
						any_lover = {
							host = {
								character = FROM
							}
							is_voter = yes
							is_council_eunuch_trigger = no
							is_landed = no
						}
					}
				}
				
				FROM = {
					set_character_flag = actual_eunuch_challenge
					set_character_flag = ci_courtiers_challenged
					
					character_event = { id = soh.4732 }
				}
			}
			
			25 = {
				trigger = {
					FROM = {
						primary_title = {
							NOT = {
								has_law = ci_vassal_law_0
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 1.5
					FROM = {
						primary_title = {
							has_law = ci_vassal_law_1
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					FROM = {
						primary_title = {
							has_law = ci_vassal_law_2
						}
					}
				}
				
				mult_modifier = {
					factor = 5
					FROM = {
						primary_title = {
							has_law = ci_vassal_law_3
						}
					}
				}
				
				mult_modifier = {
					factor = 10
					FROM = {
						primary_title = {
							has_law = ci_vassal_law_4
						}
					}
				}
				
				mult_modifier = {
					factor = 5
					any_rival = {
						is_landed = yes
						liege = {
							character = FROM
						}
						OR = {
							is_voter = yes
							is_powerful_vassal = yes
						}
						NOT = {
							has_minor_title = title_grand_chancellor
						}
					}
				}
				
				mult_modifier = {
					factor = 0.2
					OR = {
						any_friend = {
							is_landed = yes
							liege = {
								character = FROM
							}
							OR = {
								is_voter = yes
								is_powerful_vassal = yes
							}
							NOT = {
								has_minor_title = title_grand_chancellor
							}
						}
						
						any_lover = {
							is_landed = yes
							liege = {
								character = FROM
							}
							OR = {
								is_voter = yes
								is_powerful_vassal = yes
							}
							NOT = {
								has_minor_title = title_grand_chancellor
							}
						}
					}
				}
				
				FROM = {
					set_character_flag = actual_eunuch_challenge
					set_character_flag = ci_vassals_challenged
					
					character_event = { id = soh.4750 }
				}
			}
			
			25 = {
				mult_modifier = {
					factor = 0.1
					trait = ambitious
				}
				
				mult_modifier = {
					factor = 0.1
					trait = envious
				}
				
				mult_modifier = {
					factor = 10
					trait = content
				}
				
				mult_modifier = {
					factor = 10
					trait = humble
				}
				
				# No challenge
			}
		}
	}
}

# GC might challenge
character_event = {
	id = soh.4704
	desc = EVTDESC_SOH_4704
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				NOT = {
					primary_title = {
						has_law = eunuch_law_0
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4704 # I will challenge the eunuchs!
		
		FROM = {
			set_character_flag = grand_chancellor_challenge
			set_character_flag = eunuchs_challenged
			
			character_event = { id = soh.4775 }
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 1.5
				FROM = {
					primary_title = {
						has_law = eunuch_law_1
					}
				}
			}
			
			mult_modifier = {
				factor = 2
				FROM = {
					primary_title = {
						has_law = eunuch_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 5
				FROM = {
					primary_title = {
						has_law = eunuch_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 10
				FROM = {
					primary_title = {
						has_law = eunuch_law_4
					}
				}
			}
			
			mult_modifier = {
				factor = 10
				FROM = {
					any_voter = {
						is_council_eunuch_trigger = yes
						is_rival = ROOT
					}
				}
			}
			
			mult_modifier = {
				factor = 0.2
				FROM = {
					any_voter = {
						is_council_eunuch_trigger = yes
						OR = {
							is_friend = ROOT
							is_lover = ROOT
						}
					}
				}
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				NOT = {
					primary_title = {
						has_law = ci_courtier_law_0
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4704 # I will challenge the courtiers!
		
		FROM = {
			set_character_flag = grand_chancellor_challenge
			set_character_flag = ci_courtiers_challenged
			
			character_event = { id = soh.4800 }
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 2
				FROM = {
					primary_title = {
						OR = {
							has_law = ci_courtier_law_2
							has_law = ci_courtier_law_3
							has_law = ci_courtier_law_4
						}
						
						NOR = {
							has_law = eunuch_law_1
							has_law = eunuch_law_2
							has_law = eunuch_law_3
							has_law = eunuch_law_4
							has_law = ci_vassal_law_3
							has_law = ci_vassal_law_4
						}
					}
				}
			}
			
			mult_modifier = {
				factor = 5
				FROM = {
					primary_title = {
						OR = {
							has_law = ci_courtier_law_3
							has_law = ci_courtier_law_4
						}
						
						NOR = {
							has_law = eunuch_law_2
							has_law = eunuch_law_3
							has_law = eunuch_law_4
							has_law = ci_vassal_law_4
						}
					}
				}
			}
			
			mult_modifier = {
				factor = 10
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_4
						
						NOR = {
							has_law = eunuch_law_3
							has_law = eunuch_law_4
						}
					}
				}
			}
			
			mult_modifier = {
				factor = 2
				any_rival = {
					host = {
						character = FROM
					}
					
					is_voter = yes
					is_council_eunuch_trigger = no
				}
			}
			
			mult_modifier = {
				factor = 0.2
				OR = {
					any_friend = {
						host = {
							character = FROM
						}
						is_voter = yes
						is_council_eunuch_trigger = no
						is_landed = no
					}
					
					any_lover = {
						host = {
							character = FROM
						}
						is_voter = yes
						is_council_eunuch_trigger = no
						is_landed = no
					}
				}
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				NOT = {
					primary_title = {
						has_law = ci_vassal_law_0
					}
				}
			}
		}
		
		name = EVTOPTC_SOH_4704 # I will challenge the vassals!
		
		FROM = {
			set_character_flag = grand_chancellor_challenge
			set_character_flag = ci_vassals_challenged
			
			character_event = { id = soh.4825 }
		}
		
		ai_chance = {
			factor = 100
			
			trigger = {
				dynasty = FROM # Don't shoot yourself in the foot!
			}
			
			mult_modifier = {
				factor = 10
				is_powerful_vassal = no
			}
			
			mult_modifier = {
				factor = 5
				any_rival = {
					is_landed = yes
					liege = {
						character = FROM
					}
					OR = {
						is_voter = yes
						is_powerful_vassal = yes
					}
					NOT = {
						has_minor_title = title_grand_chancellor
					}
				}
			}
			
			mult_modifier = {
				factor = 0.2
				OR = {
					any_friend = {
						is_landed = yes
						liege = {
							character = FROM
						}
						OR = {
							is_voter = yes
							is_powerful_vassal = yes
						}
						NOT = {
							has_minor_title = title_grand_chancellor
						}
					}
					
					any_lover = {
						is_landed = yes
						liege = {
							character = FROM
						}
						OR = {
							is_voter = yes
							is_powerful_vassal = yes
						}
						NOT = {
							has_minor_title = title_grand_chancellor
						}
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTD_SOH_4704 # I don't wish to challenge anyone!
		
		prestige = -100
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 0.1
				trait = envious
			}
			
			mult_modifier = {
				factor = 10
				trait = content
			}
			
			mult_modifier = {
				factor = 10
				trait = humble
			}
		}
	}
}

# Courtier might challenge
character_event = {
	id = soh.4705
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = courtier_challenger
		
		random_list = {
			25 = {
				trigger = {
					FROM = {
						primary_title = {
							NOT = {
								has_law = eunuch_law_0
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					FROM = {
						primary_title = {
							OR = {
								has_law = eunuch_law_2
								has_law = eunuch_law_3
								has_law = eunuch_law_4
							}
							
							NOR = {
								has_law = grand_chancellor_law_1
								has_law = grand_chancellor_law_2
								has_law = ci_vassal_law_1
								has_law = ci_vassal_law_2
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 5
					FROM = {
						primary_title = {
							OR = {
								has_law = eunuch_law_3
								has_law = eunuch_law_4
							}
							
							NOR = {
								has_law = grand_chancellor_law_2
								has_law = ci_vassal_law_2
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 10
					FROM = {
						primary_title = {
							has_law = eunuch_law_4
							
							NOR = {
								has_law = grand_chancellor_law_2
								has_law = ci_vassal_law_3
								has_law = ci_vassal_law_4
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					any_rival = {
						host = {
							character = FROM
						}
						is_council_eunuch_trigger = yes
					}
				}
				
				mult_modifier = {
					factor = 0.2
					OR = {
						any_friend = {
							host = {
								character = FROM
							}
							is_council_eunuch_trigger = yes
						}
						
						any_lover = {
							host = {
								character = FROM
							}
							is_council_eunuch_trigger = yes
						}
					}
				}
				
				FROM = {
					set_character_flag = ci_courtier_challenge
					set_character_flag = eunuchs_challenged
					
					character_event = { id = soh.4858 }
				}
			}
			
			25 = {
				trigger = {
					FROM = {
						any_courtier_or_vassal = {
							has_minor_title = title_grand_chancellor
							NOR = {
								is_friend = ROOT
								is_lover = ROOT
							}
						}
						
						NOT = {
							primary_title = {
								has_law = grand_chancellor_law_0
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					FROM = {
						primary_title = {
							has_law = grand_chancellor_law_2
						}
					}
				}
				
				mult_modifier = {
					factor = 10
					any_rival = {
						liege = {
							character = FROM
						}
						has_minor_title = title_grand_chancellor
					}
				}
				
				FROM = {
					set_character_flag = ci_courtier_challenge
					set_character_flag = grand_chancellor_challenged
					
					character_event = { id = soh.4876 }
				}
			}
			
			25 = {
				trigger = {
					FROM = {
						primary_title = {
							NOT = {
								has_law = ci_vassal_law_0
							}
						}
					}
				}
				
				mult_modifier = {
					factor = 1.5
					FROM = {
						primary_title = {
							has_law = ci_vassal_law_1
						}
					}
				}
				
				mult_modifier = {
					factor = 2
					FROM = {
						primary_title = {
							has_law = ci_vassal_law_2
						}
					}
				}
				
				mult_modifier = {
					factor = 5
					FROM = {
						primary_title = {
							has_law = ci_vassal_law_3
						}
					}
				}
				
				mult_modifier = {
					factor = 10
					FROM = {
						primary_title = {
							has_law = ci_vassal_law_4
						}
					}
				}
				
				mult_modifier = {
					factor = 5
					any_rival = {
						is_landed = yes
						liege = {
							character = FROM
						}
						OR = {
							is_voter = yes
							is_powerful_vassal = yes
						}
						NOT = {
							has_minor_title = title_grand_chancellor
						}
					}
				}
				
				mult_modifier = {
					factor = 0.2
					OR = {
						any_friend = {
							is_landed = yes
							liege = {
								character = FROM
							}
							OR = {
								is_voter = yes
								is_powerful_vassal = yes
							}
							NOT = {
								has_minor_title = title_grand_chancellor
							}
						}
						
						any_lover = {
							is_landed = yes
							liege = {
								character = FROM
							}
								OR = {
									is_voter = yes
									is_powerful_vassal = yes
								}
							NOT = {
								has_minor_title = title_grand_chancellor
							}
						}
					}
				}
				
				FROM = {
					set_character_flag = ci_courtier_challenge
					set_character_flag = ci_vassals_challenged
					
					character_event = { id = soh.4901 }
				}
			}
			
			25 = {
				mult_modifier = {
					factor = 0.1
					trait = ambitious
				}
				
				mult_modifier = {
					factor = 0.1
					trait = envious
				}
				
				mult_modifier = {
					factor = 10
					trait = content
				}
				
				mult_modifier = {
					factor = 10
					trait = humble
				}
				
				# No challenge
			}
		}
	}
}

# Vassal might challenge
character_event = {
	id = soh.4706
	desc = EVTDESC_SOH_4706
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = vassal_challenger
	}
	
	option = {
		trigger = {
			FROM = {
				NOT = {
					primary_title = {
						has_law = eunuch_law_0
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4706 # I will challenge the eunuchs!
		
		FROM = {
			set_character_flag = ci_vassal_challenge
			set_character_flag = eunuchs_challenged
			
			character_event = { id = soh.4926 }
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 1.5
				FROM = {
					primary_title = {
						has_law = eunuch_law_1
					}
				}
			}
			
			mult_modifier = {
				factor = 2
				FROM = {
					primary_title = {
						has_law = eunuch_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 5
				FROM = {
					primary_title = {
						has_law = eunuch_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 10
				FROM = {
					primary_title = {
						has_law = eunuch_law_4
					}
				}
			}
			
			mult_modifier = {
				factor = 10
				FROM = {
					any_voter = {
						is_council_eunuch_trigger = yes
						is_rival = ROOT
					}
				}
			}
			
			mult_modifier = {
				factor = 0.2
				FROM = {
					any_voter = {
						is_council_eunuch_trigger = yes
						OR = {
							is_friend = ROOT
							is_lover = ROOT
						}
					}
				}
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				any_vassal = {
					has_minor_title = title_grand_chancellor
				}
				
				NOT = {
					primary_title = {
						has_law = grand_chancellor_law_0
					}
				}
			}
			NOT = {
				has_minor_title = title_grand_chancellor # This would just be silly!
			}
		}
		
		name = EVTOPTB_SOH_4706 # I will challenge the GC!
		
		FROM = {
			set_character_flag = ci_vassal_challenge
			set_character_flag = grand_chancellor_challenged
			
			character_event = { id = soh.4958 }
		}
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					any_friend = {
						is_landed = yes
						liege = {
							character = FROM
						}
						has_minor_title = title_grand_chancellor
					}
					any_lover = {
						is_landed = yes
						liege = {
							character = FROM
						}
						has_minor_title = title_grand_chancellor
					}
				}
			}
			
			mult_modifier = {
				factor = 10
				any_rival = {
					is_landed = yes
					liege = {
						character = FROM
					}
					has_minor_title = title_grand_chancellor
				}
			}
			
			mult_modifier = {
				factor = 2
				FROM = {
					dynasty = ROOT
				}
			}
			
			mult_modifier = {
				factor = 0.1
				FROM = {
					any_voter = {
						dynasty = ROOT
						has_minor_title = title_grand_chancellor
					}
				}
			}
			
			mult_modifier = {
				factor = 0.01 # Don't shoot yourself in the foot...
				any_owned_bloodline = {
					has_bloodline_flag = grand_chancellor_bloodline
					bloodline_is_active_for = PREV
				}
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				NOT = {
					primary_title = {
						has_law = ci_courtier_law_0
					}
				}
			}
		}
		
		name = EVTOPTC_SOH_4704 # I will challenge the courtiers!
		
		FROM = {
			set_character_flag = ci_vassal_challenge
			set_character_flag = ci_courtiers_challenged
			
			character_event = { id = soh.4995 }
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 2
				FROM = {
					primary_title = {
						OR = {
							has_law = ci_courtier_law_2
							has_law = ci_courtier_law_3
							has_law = ci_courtier_law_4
						}
						
						NOR = {
							has_law = eunuch_law_1
							has_law = eunuch_law_2
							has_law = eunuch_law_3
							has_law = eunuch_law_4
							has_law = ci_vassal_law_3
							has_law = ci_vassal_law_4
						}
					}
				}
			}
			
			mult_modifier = {
				factor = 5
				FROM = {
					primary_title = {
						OR = {
							has_law = ci_courtier_law_3
							has_law = ci_courtier_law_4
						}
						
						NOR = {
							has_law = eunuch_law_2
							has_law = eunuch_law_3
							has_law = eunuch_law_4
							has_law = ci_vassal_law_4
						}
					}
				}
			}
			
			mult_modifier = {
				factor = 10
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_4
						
						NOR = {
							has_law = eunuch_law_3
							has_law = eunuch_law_4
						}
					}
				}
			}
			
			mult_modifier = {
				factor = 2
				any_rival = {
					host = {
						character = FROM
					}
					is_voter = yes
					is_council_eunuch_trigger = no
				}
			}
			
			mult_modifier = {
				factor = 0.2
				OR = {
					any_friend = {
						host = {
							character = FROM
						}
						is_voter = yes
						is_council_eunuch_trigger = no
						is_landed = no
					}
					
					any_lover = {
						host = {
							character = FROM
						}
						is_voter = yes
						is_council_eunuch_trigger = no
						is_landed = no
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTD_SOH_4706 # I don't wish to challenge anyone!
		
		prestige = -100
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 0.1
				trait = envious
			}
			
			mult_modifier = {
				factor = 10
				trait = content
			}
			
			mult_modifier = {
				factor = 10
				trait = humble
			}
		}
	}
}



##### Infighting

### Eunuchs vs. GC

# Ruler informed of infighting
character_event = {
	id = soh.4707
	
	desc = {
		text = EVTDESC_SOH_4707_A
		trigger = {
			has_character_flag = actual_eunuch_challenge
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4707_B
		trigger = {
			has_character_flag = fake_eunuch_challenge
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
		
		any_courtier_or_vassal = {	
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			save_event_target_as = grand_chancellor
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4707 # I support the eunuchs!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					AND = {
						primary_title = {
							has_law = eunuch_law_4
						}
						NOT = {
							any_rival = {
								liege = {
									character = ROOT
								}
								has_minor_title = title_grand_chancellor
							}
						}
					}
					is_rival = event_target:eunuch_challenger 
				}
			}
			
			mult_modifier = {
				factor = 0.001
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_1
					NOT = {
						has_law = grand_chancellor_law_1
					}
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4707 # I support the GC!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			trigger = {
				NOR = {
					AND = {
						primary_title = {
							has_law = grand_chancellor_law_2
						}
						NOT = {
							is_rival = event_target:eunuch_challenger
						}
					}
					
					any_rival = {
						liege = {
							character = ROOT
						}
						has_minor_title = title_grand_chancellor
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_2
					NOT = {
						has_law = eunuch_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = grand_chancellor_law_2
					NOT = {
						has_law = eunuch_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_1
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = eunuch_law_0
				}
			}
			
			mult_modifier = {
				factor = 10
				any_friend = {
					liege = {
						character = ROOT
					}
					has_minor_title = title_grand_chancellor
				}
			}
			
			mult_modifier = {
				factor = 10
				any_lover = {
					liege = {
						character = ROOT
					}
					has_minor_title = title_grand_chancellor
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4707 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4707 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4707 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform eunuchs; they aren't playable!
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4708 }
		}
		
		character_event = { id = soh.4709 days = 15 random = 15 }
	}
}

# GC informed
character_event = {
	id = soh.4708
	
	desc = {
		text = EVTDESC_SOH_4708_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4708_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4708_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4708_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTA_SOH_4708 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTB_SOH_4708 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4708 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4708 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4709
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# First see if there's an actual eunuch to base it off of
		if = {
			limit = {
				OR = {
					has_character_flag = fake_eunuch_challenge
					event_target:eunuch_challenger = {
						is_alive = no
					}
				}
			}
			
			random_list = {
				20 = {
					set_character_flag = ci_challenge_is_diplomacy
				}
				
				20 = {
					set_character_flag = ci_challenge_is_martial
				}
				
				20 = {
					set_character_flag = ci_challenge_is_stewardship
				}
				
				20 = {
					set_character_flag = ci_challenge_is_intrigue
				}
				
				20 = {
					set_character_flag = ci_challenge_is_learning
				}
			}
			
			random_list = {
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 25
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 20
					}
				}
				
				70 = {
					set_variable = {
						which = ci_challenge_score
						value = 15
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
			}
		}
		
		# If so, pick a good stat for them
		else = {
			random_list = {
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 10
						}
					}
					
					set_character_flag = ci_challenge_is_diplomacy
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = diplomacy
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 10
						}
					}
					
					set_character_flag = ci_challenge_is_martial
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = martial
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 10
						}
					}
					
					set_character_flag = ci_challenge_is_stewardship
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = stewardship
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 10
						}
					}
					
					set_character_flag = ci_challenge_is_intrigue
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = intrigue
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 10
						}
					}
					
					set_character_flag = ci_challenge_is_learning
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = learning
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
			}
		}
		
		# Then add the mean of all other eunuchs' value in the relevant stat
		if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_4
				}
			}
			
			set_variable = {
				which = divisor
				value = 11
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			set_variable = {
				which = divisor
				value = 7
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			set_variable = {
				which = divisor
				value = 3
			}
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
				event_target:eunuch_challenger = {
					NOT = {
						character = PREV
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# Finally inform the GC
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4710 }
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4711 days = 15 random = 30 }
	}
}

# GC informed of challenge skill
character_event = {
	id = soh.4710
	
	desc = {
		text = EVTDESC_SOH_4710_A
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_diplomacy
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4710_B
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_martial
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4710_C
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_stewardship
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4710_D
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_intrigue
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4710_E
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_learning
			}
		}
	}
	
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning >= 20
				}
			}
		}
		
		name = EVTOPTA_SOH_4710 # Child's play!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 20
					diplomacy >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 20
					martial >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 20
					stewardship >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 20
					intrigue >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 20
					learning >= 10
				}
			}
		}
		
		name = EVTOPTB_SOH_4710 # Challenge accepted!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 10
				}
			}
		}
		
		name = EVTOPTC_SOH_4710 # This will be difficult...
	}
	
	after = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				ci_challenge_is_diplomacy = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_martial = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_stewardship = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_intrigue = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_learning = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4711
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4712 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4712 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4715 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4712 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4715 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4712 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4715 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4712 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4715 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4712 } # Successful scheming
					}
					75 = {
						character_event = { id = soh.4715 } # Failed scheming
					}
				}
			}
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4712 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4715 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4715 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4718 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4712
	desc = EVTDESC_SOH_4712
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4712 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
		}
		
		event_target:eunuch_challenger = {
			prestige = -500
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4713 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4714 }
		}
	}
}

# Scheming liege successful - GC
character_event = {
	id = soh.4713
	desc = EVTDESC_SOH_4713
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4713 # I did NOT see that coming!
		
		prestige = -500
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4714
	desc = EVTDESC_SOH_4714
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4714 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4715
	desc = EVTDESC_SOH_4715
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4715 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		event_target:eunuch_challenger = {
			prestige = 500
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4716 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4717 }
		}
		
		character_event = { id = soh.4718 days = 5 random = 10 }
	}
}

# Scheming liege failed - GC
character_event = {
	id = soh.4716
	desc = EVTDESC_SOH_4716
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4716 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4717
	desc = EVTDESC_SOH_4717
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4717 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4718
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						event_target:eunuch_challenger = {
							is_alive = yes
						}
					}
					
					event_target:eunuch_challenger = {
						character_event = { id = soh.4719 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4720 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				if = {
					limit = {
						any_voter = {
							has_minor_title = title_grand_chancellor
						}
					}
					
					any_voter = {
						limit = {
							has_minor_title = title_grand_chancellor
						}
						
						character_event = { id = soh.4727 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4728 } # Eunuchs weakened; sensible fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5027 } # Inconclusive struggle - liege
			}
		}
	}
}

# Eunuchs won - challenger
character_event = {
	id = soh.4719
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		prestige = 1000
		
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4721 } # Weaken GC
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = grand_chancellor_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4724 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 100
						any_rival = {
							liege = {
								character = FROM
							}
							has_minor_title = title_grand_chancellor
						}
					}
					
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = grand_chancellor_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4721 } # Weaken GC
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 100
						FROM = {
							primary_title = {
								has_law = eunuch_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = eunuch_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4724 } # Grow stronger
					}
				}
			}
		}
	}
}

# Hidden ping if no eunuch
character_event = {
	id = soh.4720
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4724 } # Grow stronger
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4721 } # Weaken GC
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = grand_chancellor_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4721 } # Weaken GC
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 100
						FROM = {
							primary_title = {
								has_law = eunuch_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = eunuch_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4724 } # Grow stronger
					}
				}
			}
		}
	}
}

# Eunuchs weakened GC - liege
character_event = {
	id = soh.4721
	desc = EVTDESC_SOH_4721
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4721 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4722 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4723 } # Inform vassals
		}
	}
}

# Eunuchs weakened GC - GC
character_event = {
	id = soh.4722
	desc = EVTDESC_SOH_4722
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4722 # Curses!
		
		prestige = -1000
	}
}

# Eunuchs weakened GC - others
character_event = {
	id = soh.4723
	desc = EVTDESC_SOH_4723
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4723 # Interesting...
	}
}

# Eunuchs grow stronger - liege
character_event = {
	id = soh.4724
	desc = EVTDESC_SOH_4724
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4724 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_0 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_4 }
			}
		}
		
		character_event = { id = soh.5301 } # Generate Council Eunuchs
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4725 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4726 } # Inform vassals
		}
	}
}

# Eunuchs grow stronger - GC
character_event = {
	id = soh.4725
	desc = EVTDESC_SOH_4725
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4725 # Curses!
		
		prestige = -1000
	}
}

# Eunuchs grow stronger - others
character_event = {
	id = soh.4726
	desc = EVTDESC_SOH_4726
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4726 # Interesting...
	}
}

# Eunuchs lost - GC
character_event = {
	id = soh.4727
	desc = EVTDESC_SOH_4727
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4727 # I will increase my own power!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4730 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = eunuch_law_0
						}
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4727 # I will weaken the eunuchs!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4728 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Eunuchs weakened - liege
character_event = {
	id = soh.4728
	desc = EVTDESC_SOH_4728
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4728 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					character = FROM
				}
			}
			
			character_event = { id = soh.4729 } # Inform vassals
		}
	}
}

# Eunuchs weakened - others
character_event = {
	id = soh.4729
	desc = EVTDESC_SOH_4729
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4729 # I see...
	}
}

# GC grows stronger - liege
character_event = {
	id = soh.4730
	desc = EVTDESC_SOH_4730
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4730 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_0 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_2 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					character = FROM
				}
			}
			
			character_event = { id = soh.4731 } # Inform vassals
		}
	}
}

# GC grows stronger - others
character_event = {
	id = soh.4731
	desc = EVTDESC_SOH_4731
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4731 # I see...
	}
}



### Eunuchs vs. courtiers

# Ruler informed of infighting
character_event = {
	id = soh.4732
	
	desc = {
		text = EVTDESC_SOH_4732_A
		trigger = {
			has_character_flag = actual_eunuch_challenge
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4732_B
		trigger = {
			has_character_flag = fake_eunuch_challenge
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4732 # I support the eunuchs!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = eunuch_law_4
						has_law = ci_courtier_law_0
					}
					is_rival = event_target:eunuch_challenger
				}
			}
			
			mult_modifier = {
				factor = 0.001
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
					NOT = {
						has_law = ci_courtier_law_4
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_1
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4732 # I support the courtiers!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NAND = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_3
					NOR = {
						has_law = eunuch_law_4
						has_law = eunuch_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_2
					NOR = {
						has_law = eunuch_law_4
						has_law = eunuch_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = eunuch_law_0
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4732 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4732 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4732 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform eunuchs or courtiers; they aren't playable!
		character_event = { id = soh.4733 days = 15 random = 15 }
	}
}

# Ping liege for skill check
character_event = {
	id = soh.4733
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# First see if there's an actual eunuch to base it off of
		if = {
			limit = {
				OR = {
					has_character_flag = fake_eunuch_challenge
					event_target:eunuch_challenger = {
						is_alive = no
					}
				}
			}
			
			random_list = {
				20 = {
					set_character_flag = ci_challenge_is_diplomacy
				}
				
				20 = {
					set_character_flag = ci_challenge_is_martial
				}
				
				20 = {
					set_character_flag = ci_challenge_is_stewardship
				}
				
				20 = {
					set_character_flag = ci_challenge_is_intrigue
				}
				
				20 = {
					set_character_flag = ci_challenge_is_learning
				}
			}
			
			random_list = {
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 25
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 20
					}
				}
				
				70 = {
					set_variable = {
						which = ci_challenge_score
						value = 15
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
			}
		}
		
		# If so, pick a good stat for them
		else = {
			random_list = {
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 10
						}
					}
					
					set_character_flag = ci_challenge_is_diplomacy
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = diplomacy
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 10
						}
					}
					
					set_character_flag = ci_challenge_is_martial
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = martial
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 10
						}
					}
					
					set_character_flag = ci_challenge_is_stewardship
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = stewardship
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 10
						}
					}
					
					set_character_flag = ci_challenge_is_intrigue
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = intrigue
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 10
						}
					}
					
					set_character_flag = ci_challenge_is_learning
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = learning
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
			}
		}
		
		# Then add the mean of all other eunuchs' value in the relevant stat
		if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_4
				}
			}
			
			set_variable = {
				which = divisor
				value = 11
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			set_variable = {
				which = divisor
				value = 7
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			set_variable = {
				which = divisor
				value = 3
			}
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
				event_target:eunuch_challenger = {
					NOT = {
						character = PREV
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# Now get the average score of all eligible courtiers
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = -1
				}
			}
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4734 days = 15 random = 30 }
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4734
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4735 } # Successful scheming
			}
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4735 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4737 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4735 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4737 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4735 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4737 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4735 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4737 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4735 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4737 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4735 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4737 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4737 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4739 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4735
	desc = EVTDESC_SOH_4735
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4735 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
		}
		
		event_target:eunuch_challenger = {
			prestige = -500
		}
		
		hidden_tooltip = {
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				prestige = -100
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4736 }
		}
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4736
	desc = EVTDESC_SOH_4736
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4736 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4737
	desc = EVTDESC_SOH_4737
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4737 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		event_target:eunuch_challenger = {
			prestige = 500
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4738 }
		}
		
		character_event = { id = soh.4739 days = 5 random = 10 }
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4738
	desc = EVTDESC_SOH_4738
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4738 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4739
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						event_target:eunuch_challenger = {
							is_alive = yes
						}
					}
					
					event_target:eunuch_challenger = {
						character_event = { id = soh.4740 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4741 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				if = {
					limit = {
						primary_title = {
							has_law = eunuch_law_0
						}
					}
					
					character_event = { id = soh.4748 } # Courtiers grow stronger
				}
				
				else_if = {
					limit = {
						NOT = {
							primary_title = {
								has_law = ci_courtier_law_4
							}
						}
					}
					
					random_list = {
						50 = {
							mult_modifier = {
								factor = 10
								primary_title = {
									has_law = eunuch_law_4
								}
							}
							
							mult_modifier = {
								factor = 5
								primary_title = {
									has_law = eunuch_law_3
								}
							}
							
							mult_modifier = {
								factor = 2
								primary_title = {
									has_law = eunuch_law_2
								}
							}
							
							character_event = { id = soh.4746 } # Eunuchs weakened
						}
						
						50 = {
							mult_modifier = {
								factor = 10
								primary_title = {
									has_law = ci_courtier_law_0
								}
							}
							
							mult_modifier = {
								factor = 5
								primary_title = {
									has_law = ci_courtier_law_1
								}
							}
							
							mult_modifier = {
								factor = 2
								primary_title = {
									has_law = ci_courtier_law_2
								}
							}
							
							character_event = { id = soh.4748 } # Courtiers grow stronger
						}
					}
				}
				
				else = {
					character_event = { id = soh.4746 } # Eunuchs weakened; sensible fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5030 } # Inconclusive struggle - liege
			}
		}
	}
}

# Eunuchs won - challenger
character_event = {
	id = soh.4740
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		prestige = 1000
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4742 } # Weaken courtiers
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4744 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4742 } # Weaken courtiers
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = eunuch_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = eunuch_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4744 } # Grow stronger
					}
				}
			}
		}
	}
}

# Hidden ping if no eunuch
character_event = {
	id = soh.4741
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4742 } # Weaken courtiers
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4744 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4742 } # Weaken courtiers
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = eunuch_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = eunuch_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = eunuch_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4744 } # Grow stronger
					}
				}
			}
		}
	}
}

# Eunuchs weakened courtiers - liege
character_event = {
	id = soh.4742
	desc = EVTDESC_SOH_4742
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4742 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4743 } # Inform vassals
		}
	}
}

# Eunuchs weakened courtiers - others
character_event = {
	id = soh.4743
	desc = EVTDESC_SOH_4743
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4743 # Interesting...
	}
}

# Eunuchs grow stronger - liege
character_event = {
	id = soh.4744
	desc = EVTDESC_SOH_4744
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4744 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_0 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_4 }
			}
		}
		character_event = { id = soh.5301 } # Generate Council Eunuchs
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4745 } # Inform vassals
		}
	}
}

# Eunuchs grow stronger - others
character_event = {
	id = soh.4745
	desc = EVTDESC_SOH_4745
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4745 # Interesting...
	}
}

# Eunuchs weakened - liege
character_event = {
	id = soh.4746
	desc = EVTDESC_SOH_4746
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4746 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4747 } # Inform vassals
		}
	}
}

# Eunuchs weakened - others
character_event = {
	id = soh.4747
	desc = EVTDESC_SOH_4747
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4747 # Interesting...
	}
}

# Courtiers grow stronger - liege
character_event = {
	id = soh.4748
	desc = EVTDESC_SOH_4748
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4748 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_0 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_4 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			character_event = { id = soh.4749 } # Inform vassals
		}
	}
}

# Courtiers grow stronger - others
character_event = {
	id = soh.4749
	desc = EVTDESC_SOH_4749
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4749 # Interesting...
	}
}



### Eunuchs vs. vassals

# Ruler informed of infighting
character_event = {
	id = soh.4750
	desc = {
		text = EVTDESC_SOH_4750_A
		trigger = {
			has_character_flag = actual_eunuch_challenge
		}
	}
	desc = {
		text = EVTDESC_SOH_4750_B
		trigger = {
			has_character_flag = fake_eunuch_challenge
		}
	}
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4750 # I support the eunuchs!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = eunuch_law_4
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = event_target:eunuch_challenger
			}
			
			mult_modifier = {
				factor = 10
				is_lover = event_target:eunuch_challenger
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4750 # I support the vassals!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = ci_vassal_law_4
					}
					primary_title = {
						has_law = eunuch_law_0
					}
				}
			}
			
			mult_modifier = {
				factor = 0.001
				primary_title = {
					has_law = ci_vassal_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_2
					NOR = {
						has_law = eunuch_law_4
						has_law = eunuch_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_2
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4750 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4750 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4750 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform eunuchs; they aren't playable!
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4751 }
		}
		
		character_event = { id = soh.4752 days = 15 random = 15 }
	}
}

# Relevant vassals informed
character_event = {
	id = soh.4751
	
	desc = {
		text = EVTDESC_SOH_4751_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4751_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4751_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4751_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTA_SOH_4751 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTB_SOH_4708 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4751 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4751 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4752
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# First see if there's an actual eunuch to base it off of
		if = {
			limit = {
				OR = {
					has_character_flag = fake_eunuch_challenge
					event_target:eunuch_challenger = {
						is_alive = no
					}
				}
			}
			
			random_list = {
				20 = {
					set_character_flag = ci_challenge_is_diplomacy
				}
				
				20 = {
					set_character_flag = ci_challenge_is_martial
				}
				
				20 = {
					set_character_flag = ci_challenge_is_stewardship
				}
				
				20 = {
					set_character_flag = ci_challenge_is_intrigue
				}
				
				20 = {
					set_character_flag = ci_challenge_is_learning
				}
			}
			
			random_list = {
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 25
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 20
					}
				}
				
				70 = {
					set_variable = {
						which = ci_challenge_score
						value = 15
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
			}
		}
		
		# If so, pick a good stat for them
		else = {
			random_list = {
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							diplomacy < 10
						}
					}
					
					set_character_flag = ci_challenge_is_diplomacy
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = diplomacy
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							martial < 10
						}
					}
					
					set_character_flag = ci_challenge_is_martial
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = martial
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							stewardship < 10
						}
					}
					
					set_character_flag = ci_challenge_is_stewardship
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = stewardship
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							intrigue < 10
						}
					}
					
					set_character_flag = ci_challenge_is_intrigue
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = intrigue
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:eunuch_challenger = {
							learning < 10
						}
					}
					
					set_character_flag = ci_challenge_is_learning
					
					event_target:eunuch_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = learning
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
			}
		}
		
		# Then add the mean of all other eunuchs' value in the relevant stat
		if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_4
				}
			}
			
			set_variable = {
				which = divisor
				value = 11
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			set_variable = {
				which = divisor
				value = 7
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			set_variable = {
				which = divisor
				value = 3
			}
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
				event_target:eunuch_challenger = {
					NOT = {
						character = PREV
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# Finally inform the relevant vassals
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4753 }
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4754 days = 15 random = 30 }
	}
}

# Relevant vassals informed of challenge skill
character_event = {
	id = soh.4753
	
	desc = {
		text = EVTDESC_SOH_4753_A
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_diplomacy
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4753_B
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_martial
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4753_C
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_stewardship
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4753_D
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_intrigue
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4753_E
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_learning
			}
		}
	}
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning >= 20
				}
			}
		}
		
		name = EVTOPTA_SOH_4753 # Child's play!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 20
					diplomacy >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 20
					martial >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 20
					stewardship >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 20
					intrigue >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 20
					learning >= 10
				}
			}
		}
		
		name = EVTOPTB_SOH_4753 # Challenge accepted!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 10
				}
			}
		}
		
		name = EVTOPTC_SOH_4753 # This will be difficult...
	}
	
	after = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				ci_challenge_is_diplomacy = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_martial = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_stewardship = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_intrigue = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_learning = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4754
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4755 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4755 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4758 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4755 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4758 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4755 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4758 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4755 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4758 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4755 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4758 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4755 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4758 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4758 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4761 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4755
	desc = EVTDESC_SOH_4755
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4755 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
		}
		
		event_target:eunuch_challenger = {
			prestige = -500
		}
		
		any_voter = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4756 }
		}
		
		any_vassal = {
			limit = {
				ai = no
				NOR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4757 }
		}
	}
}

# Scheming liege successful - relevant vassals
character_event = {
	id = soh.4756
	desc = EVTDESC_SOH_4756
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4756 # I did NOT see that coming!
		
		prestige = -100
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4757
	desc = EVTDESC_SOH_4757
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4757 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4758
	desc = EVTDESC_SOH_4758
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4758 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		event_target:eunuch_challenger = {
			prestige = 500
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_vassal = {
			# All of them!
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4759 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4760 }
		}
		
		character_event = { id = soh.4761 days = 5 random = 10 }
	}
}

# Scheming liege failed - relevant vassals
character_event = {
	id = soh.4759
	desc = EVTDESC_SOH_4759
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4759 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4760
	desc = EVTDESC_SOH_4760
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4717 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4761
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						event_target:eunuch_challenger = {
							is_alive = yes
						}
					}
					
					event_target:eunuch_challenger = {
						character_event = { id = soh.4762 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4763 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				if = {
					limit = {
						any_vassal = {
							OR = {
								is_voter = yes
								AND = {
									is_powerful_vassal = yes
									has_regent = no
								}
							}
						}
					}
					
					random_vassal = {
						limit = {
							OR = {
								is_voter = yes
								AND = {
									is_powerful_vassal = yes
									has_regent = no
								}
							}
						}
						
						preferred_limit = {
							NOT = {
								has_minor_title = title_grand_chancellor # The GC is somewhat different...
							}
						}
						
						character_event = { id = soh.4770 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4771 } # Eunuchs weakened; sensible fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5032 } # Inconclusive struggle - liege
			}
		}
	}
}

# Eunuchs won - challenger
character_event = {
	id = soh.4762
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		prestige = 1000
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4764 } # Weaken vassals
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_vassal_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4767 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4764 } # Weaken vassals
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = eunuch_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = eunuch_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4767 } # Grow stronger
					}
				}
			}
		}
	}
}

# Hidden ping if no eunuch
character_event = {
	id = soh.4763
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4764 } # Weaken vassals
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_vassal_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4767 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4764 } # Weaken vassals
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = eunuch_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = eunuch_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4767 } # Grow stronger
					}
				}
			}
		}
	}
}

# Eunuchs weakened vassals - liege
character_event = {
	id = soh.4764
	desc = EVTDESC_SOH_4764
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4764 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4765 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4766 } # Inform other vassals
		}
	}
}

# Eunuchs weakened vassals - relevant vassals
character_event = {
	id = soh.4765
	desc = EVTDESC_SOH_4765
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4765 # Curses!
		
		prestige = -100
	}
}

# Eunuchs weakened vassls - others
character_event = {
	id = soh.4766
	desc = EVTDESC_SOH_4766
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4766 # Curses!
	}
}

# Eunuchs grow stronger - liege
character_event = {
	id = soh.4767
	desc = EVTDESC_SOH_4767
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4767 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_0 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_4 }
			}
		}
		
		character_event = { id = soh.5301 } # Generate Council Eunuchs
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4768 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4769 } # Inform other vassals
		}
	}
}

# Eunuchs grow stronger - relevant vassals
character_event = {
	id = soh.4768
	desc = EVTDESC_SOH_4768
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4768 # Curses!
		
		prestige = -100
	}
}

# Eunuchs grow stronger - others
character_event = {
	id = soh.4769
	desc = EVTDESC_SOH_4769
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4769 # Curses!
	}
}

# Eunuchs lost - random relevant vassal
character_event = {
	id = soh.4770
	desc = EVTDESC_SOH_4770
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4770 # I will increase my own power!
		
		FROM = {
			character_event = { id = soh.4773 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = eunuch_law_0
						}
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4770 # I will weaken the eunuchs!
		
		FROM = {
			character_event = { id = soh.4771 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Eunuchs weakened - liege
character_event = {
	id = soh.4771
	desc = EVTDESC_SOH_4771
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4771 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_vassal = {
				# All of them!
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4772 } # Inform vassals
		}
	}
}

# Eunuchs weakened - others
character_event = {
	id = soh.4772
	desc = EVTDESC_SOH_4772
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4772 # I see...
	}
}

# Vassals grow stronger - liege
character_event = {
	id = soh.4773
	desc = EVTDESC_SOH_4773
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4773 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			any_vassal = {
				# All of them!
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_0 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_4 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4774 } # Inform vassals
		}
	}
}

# Vassals grow stronger - others
character_event = {
	id = soh.4774
	desc = EVTDESC_SOH_4774
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4774 # Excellent!
	}
}



### GC vs. eunuchs

# Ruler informed of infighting
character_event = {
	id = soh.4775
	desc = EVTDESC_SOH_4775
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4775 # I support the GC!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = grand_chancellor_law_2
						NOR = {
							has_law = eunuch_law_4
							has_law = eunuch_law_3
						}
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_1
					NOR = {
						has_law = eunuch_law_4
						has_law = eunuch_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_1
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = eunuch_law_0
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4775 # I support the eunuchs!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NAND = {
					primary_title = {
						has_law = eunuch_law_4
					}
					NOT = {
						is_rival = FROM
					}
				}
			}
			
			mult_modifier = {
				factor = 0.001
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_1
					NOR = {
						has_law = grand_chancellor_law_1
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4775 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4775 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4775 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform eunuchs; they aren't playable!
		FROM = {
			character_event = { id = soh.4776 }
		}
		
		character_event = { id = soh.4777 days = 15 random = 15 }
	}
}

# GC informed
character_event = {
	id = soh.4776
	
	desc = {
		text = EVTDESC_SOH_4776_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4776_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4776_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4776_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTA_SOH_4776 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTB_SOH_4776 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4776 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4776 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4777
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# To the GC!
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			clr_character_flag = ci_skill_selection_option_2
			
			character_event = { id = soh.4778 }
		}
	}
}

# GC picks skill
character_event = {
	id = soh.4778
	desc = EVTDESC_SOH_4778
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTA_SOH_4778 # Diplomacy is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_diplomacy
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = diplomacy
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4779 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 25
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 20
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 15
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 10
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTB_SOH_4778 # Martial is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_martial
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = martial
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4779 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				martial < 25
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 20
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 15
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 10
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTC_SOH_4778 # Stewardship is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_stewardship
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = stewardship
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4779 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				stewardship < 25
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 20
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 15
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 10
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTD_SOH_4778 # Intrigue is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_intrigue
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = intrigue
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4779 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				intrigue < 25
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 20
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 15
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 10
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTE_SOH_4778 # Learning is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_learning
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = learning
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4779 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				learning < 25
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 20
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 15
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 10
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 5
			}
		}
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTF_SOH_4778 # Maybe something else...
		
		if = {
			limit = {
				NOT = {
					has_character_flag = ci_skill_selection_option_2
				}
			}
			
			set_character_flag = ci_skill_selection_option_2
		}
		
		else = {
			clr_character_flag = ci_skill_selection_option_2
		}
		
		repeat_event = { id = soh.4778 }
	}
}

# Ping liege to get eunuchs' score
character_event = {
	id = soh.4779
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_4
				}
			}
			
			set_variable = {
				which = divisor
				value = 12
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			set_variable = {
				which = divisor
				value = 8
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			set_variable = {
				which = divisor
				value = 4
			}
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4780 days = 15 random = 30 }
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4780
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4781 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4781 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4784 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4781 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4784 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4781 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4784 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4781 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4784 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4781 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4784 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4781 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4784 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4784 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4787 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4781
	desc = EVTDESC_SOH_4781
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4781 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4782 }
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			
			prestige = -100
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4783 }
		}
	}
}

# Scheming liege successful - GC
character_event = {
	id = soh.4782
	desc = EVTDESC_SOH_4782
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4782 # I did NOT see that coming!
		
		prestige = -500
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4783
	desc = EVTDESC_SOH_4783
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4783 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4784
	desc = EVTDESC_SOH_4784
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4784 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			prestige = 100
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4785 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4786 }
		}
	}
}

# Scheming liege failed - GC
character_event = {
	id = soh.4785
	desc = EVTDESC_SOH_4785
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4785 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4786
	desc = EVTDESC_SOH_4786
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4717 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4787
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						any_voter = {
							has_minor_title = title_grand_chancellor
						}
					}
					
					any_voter = {
						limit = {
							has_minor_title = title_grand_chancellor
						}
						
						character_event = { id = soh.4788 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4789 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				character_event = { id = soh.4793 } # Ping
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5035 } # Inconclusive struggle - liege
			}
		}
	}
}

# GC won - GC
character_event = {
	id = soh.4788
	desc = EVTDESC_SOH_4788
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4788 # I will increase my own power!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4791 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = eunuch_law_0
						}
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4788 # I will weaken the eunuchs!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4789 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Eunuchs weakened - liege
character_event = {
	id = soh.4789
	desc = EVTDESC_SOH_4789
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4789 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					character = FROM
				}
			}
			
			character_event = { id = soh.4790 } # Inform vassals
		}
	}
}

# Eunuchs weakened - others
character_event = {
	id = soh.4790
	desc = EVTDESC_SOH_4790
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4790 # I see...
	}
}

# GC grows stronger - liege
character_event = {
	id = soh.4791
	desc = EVTDESC_SOH_4791
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4791 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_0 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_2 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					character = FROM
				}
			}
			
			character_event = { id = soh.4792 } # Inform vassals
		}
	}
}

# GC grows stronger - others
character_event = {
	id = soh.4792
	desc = EVTDESC_SOH_4792
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4792 # I see...
	}
}

# Hidden ping if GC lost
character_event = {
	id = soh.4793
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4797 } # Grow stronger
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4794 } # Weaken GC
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = grand_chancellor_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4794 } # Weaken GC
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 100
						FROM = {
							primary_title = {
								has_law = eunuch_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = eunuch_law_1
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4797 } # Grow stronger
					}
				}
			}
		}
	}
}

# Eunuchs weakened GC - liege
character_event = {
	id = soh.4794
	desc = EVTDESC_SOH_4794
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4794 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4795 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4796 } # Inform vassals
		}
	}
}

# Eunuchs weakened GC - GC
character_event = {
	id = soh.4795
	desc = EVTDESC_SOH_4795
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4795 # Curses!
		
		prestige = -1000
	}
}

# Eunuchs weakened GC - others
character_event = {
	id = soh.4796
	desc = EVTDESC_SOH_4796
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4796 # Interesting...
	}
}

# Eunuchs grow stronger - liege
character_event = {
	id = soh.4797
	desc = EVTDESC_SOH_4797
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4797 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_0 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_4 }
			}
		}
		character_event = { id = soh.5301 } # Generate Council Eunuchs
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4798 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4799 } # Inform vassals
		}
	}
}

# Eunuchs grow stronger - GC
character_event = {
	id = soh.4798
	desc = EVTDESC_SOH_4798
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4798 # Curses!
		
		prestige = -1000
	}
}

# Eunuchs grow stronger - others
character_event = {
	id = soh.4799
	desc = EVTDESC_SOH_4799
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4799 # Interesting...
	}
}



### GC vs. courtiers

# Ruler informed of infighting
character_event = {
	id = soh.4800
	desc = EVTDESC_SOH_4800
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4800 # I support the GC!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = grand_chancellor_law_2
						NOT = {
							has_law = ci_courtier_law_4
						}
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = grand_chancellor_law_1
					NOR = {
						has_law = ci_courtier_law_4
						has_law = ci_courtier_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_1
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_courtier_law_0
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4800 # I support the courtiers!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NAND = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
					NOT = {
						is_rival = FROM
					}
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_courtier_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_1
					NOR = {
						has_law = grand_chancellor_law_1
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4800 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4800 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4800 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform eunuchs; they aren't playable!
		FROM = {
			character_event = { id = soh.4801 }
		}
		
		character_event = { id = soh.4802 days = 15 random = 15 }
	}
}

# GC informed
character_event = {
	id = soh.4801
	
	desc = {
		text = EVTDESC_SOH_4801_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4801_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4801_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4801_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTB_SOH_4801 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTA_SOH_4801 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4801 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4801 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4802
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# To the GC!
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			clr_character_flag = ci_skill_selection_option_2
			
			character_event = { id = soh.4803 }
		}
	}
}

# GC picks skill
character_event = {
	id = soh.4803
	desc = EVTDESC_SOH_4803
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTA_SOH_4803 # Diplomacy is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_diplomacy
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = diplomacy
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4804 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 25
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 20
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 15
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 10
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTB_SOH_4803 # Martial is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_martial
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = martial
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4804 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				martial < 25
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 20
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 15
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 10
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTC_SOH_4803 # Stewardship is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_stewardship
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = stewardship
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4804 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				stewardship < 25
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 20
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 15
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 10
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTD_SOH_4803 # Intrigue is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_intrigue
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = intrigue
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4804 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				intrigue < 25
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 20
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 15
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 10
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTE_SOH_4803 # Learning is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_learning
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = learning
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4804 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				learning < 25
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 20
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 15
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 10
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 5
			}
		}
	}
	
	option = {
		trigger = {
			ai = no
		}
		name = EVTOPTF_SOH_4803 # Maybe something else...
		
		if = {
			limit = {
				NOT = {
					has_character_flag = ci_skill_selection_option_2
				}
			}
			
			set_character_flag = ci_skill_selection_option_2
		}
		
		else = {
			clr_character_flag = ci_skill_selection_option_2
		}
		
		repeat_event = { id = soh.4803 }
	}
}

# Ping liege to get courtiers' score
character_event = {
	id = soh.4804
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = -1
				}
			}
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4805 days = 15 random = 30 }
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4805
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4806 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4806 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4808 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4806 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4809 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4806 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4809 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4806 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4809 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4806 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4809 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4806 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4809 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4809 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4812 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4806
	desc = EVTDESC_SOH_4806
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4806 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4807 }
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			prestige = -100
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4808 }
		}
	}
}

# Scheming liege successful - GC
character_event = {
	id = soh.4807
	desc = EVTDESC_SOH_4807
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4807 # I did NOT see that coming!
		
		prestige = -500
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4808
	desc = EVTDESC_SOH_4808
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4808 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4809
	desc = EVTDESC_SOH_4809
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4809 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			prestige = 100
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4810 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4811 }
		}
	}
}

# Scheming liege failed - GC
character_event = {
	id = soh.4810
	desc = EVTDESC_SOH_4810
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4810 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4811
	desc = EVTDESC_SOH_4811
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4811 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4812
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						any_voter = {
							has_minor_title = title_grand_chancellor
						}
					}
					
					any_voter = {
						limit = {
							has_minor_title = title_grand_chancellor
						}
						
						character_event = { id = soh.4813 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4814 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				character_event = { id = soh.4818 } # Ping
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5038 } # Inconclusive struggle - liege
			}
		}
	}
}

# GC won - GC
character_event = {
	id = soh.4813
	desc = EVTDESC_SOH_4813
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4813 # I will increase my own power!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4816 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = ci_courtier_law_0
						}
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4813 # I will weaken the courtiers!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4814 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Courtiers weakened - liege
character_event = {
	id = soh.4814
	desc = EVTDESC_SOH_4814
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4814 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					character = FROM
				}
			}
			
			character_event = { id = soh.4815 } # Inform vassals
		}
	}
}

# Courtiers weakened - others
character_event = {
	id = soh.4815
	desc = EVTDESC_SOH_4815
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4815 # I see...
	}
}

# GC grows stronger - liege
character_event = {
	id = soh.4816
	desc = EVTDESC_SOH_4816
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4816 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_0 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_2 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					character = FROM
				}
			}
			
			character_event = { id = soh.4817 } # Inform vassals
		}
	}
}

# GC grows stronger - others
character_event = {
	id = soh.4817
	desc = EVTDESC_SOH_4817
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4817 # I see...
	}
}

# Hidden ping if GC lost
character_event = {
	id = soh.4818
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4822 } # Grow stronger
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4819 } # Weaken GC
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = grand_chancellor_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4819 } # Weaken GC
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 100
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_1
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4822 } # Grow stronger
					}
				}
			}
		}
	}
}

# Courtiers weakened GC - liege
character_event = {
	id = soh.4819
	desc = EVTDESC_SOH_4819
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4819 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4820 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4821 } # Inform vassals
		}
	}
}

# Courtiers weakened GC - GC
character_event = {
	id = soh.4820
	desc = EVTDESC_SOH_4820
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4820 # Curses!
		
		prestige = -1000
	}
}

# Courtiers weakened GC - others
character_event = {
	id = soh.4821
	desc = EVTDESC_SOH_4821
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4821 # Interesting...
	}
}

# Courtiers grow stronger - liege
character_event = {
	id = soh.4822
	desc = EVTDESC_SOH_4822
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4822 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_0 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_4 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4823 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4824 } # Inform vassals
		}
	}
}

# Courtiers grow stronger - GC
character_event = {
	id = soh.4823
	desc = EVTDESC_SOH_4823
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4823 # Curses!
		
		prestige = -1000
	}
}

# Courtiers grow stronger - others
character_event = {
	id = soh.4824
	desc = EVTDESC_SOH_4824
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4824 # Interesting...
	}
}



### GC vs. vassals

# Ruler informed of infighting
character_event = {
	id = soh.4825
	desc = EVTDESC_SOH_4825
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4825 # I support the GC!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = grand_chancellor_law_2
						NOR = {
							has_law = ci_vassal_law_4
							has_law = ci_vassal_law_3
						}
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = grand_chancellor_law_1
					NOR = {
						has_law = ci_vassal_law_4
						has_law = ci_vassal_law_3
						has_law = ci_vassal_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_1
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_0
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4825 # I support the vassals!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NAND = {
					primary_title = {
						has_law = ci_vassal_law_4
					}
					NOT = {
						is_rival = FROM
					}
				}
			}
			
			mult_modifier = {
				factor = 0.001
				primary_title = {
					has_law = ci_vassal_law_4
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_vassal_law_3
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_2
					NOR = {
						has_law = grand_chancellor_law_1
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_2
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4825 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4825 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4825 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		FROM = {
			character_event = { id = soh.4826 }
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				
				OR = {
					is_powerful_vassal = yes
					is_voter = yes
				}
			}
			
			character_event = { id = soh.4827 }
		}
		
		character_event = { id = soh.4828 days = 15 random = 15 }
	}
}

# GC informed
character_event = {
	id = soh.4826
	
	desc = {
		text = EVTDESC_SOH_4826_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4826_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4826_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4826_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTA_SOH_4826 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTB_SOH_4826 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4826 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4826 # Unsurprising...
	}
}

# Relevant vassals informed
character_event = {
	id = soh.4827
	
	desc = {
		text = EVTDESC_SOH_4827_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4827_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4801_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4827_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTA_SOH_4827 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTB_SOH_4827 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4827 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4827 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4828
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# To the GC!
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			clr_character_flag = ci_skill_selection_option_2
			
			character_event = { id = soh.4829 }
		}
	}
}

# GC picks skill
character_event = {
	id = soh.4829
	desc = EVTDESC_SOH_4829
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTA_SOH_4829 # Diplomacy is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_diplomacy
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = diplomacy
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4830 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 25
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 20
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 15
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 10
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTB_SOH_4829 # Martial is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_martial
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = martial
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4830 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				martial < 25
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 20
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 15
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 10
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTC_SOH_4829 # Stewardship is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_stewardship
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = stewardship
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4830 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				stewardship < 25
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 20
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 15
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 10
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTD_SOH_4829 # Intrigue is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_intrigue
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = intrigue
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4830 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				intrigue < 25
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 20
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 15
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 10
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTE_SOH_4829 # Learning is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_learning
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = learning
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4830 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				learning < 25
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 20
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 15
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 10
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 5
			}
		}
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTF_SOH_4829 # Maybe something else...
		
		if = {
			limit = {
				NOT = {
					has_character_flag = ci_skill_selection_option_2
				}
			}
			
			set_character_flag = ci_skill_selection_option_2
		}
		
		else = {
			clr_character_flag = ci_skill_selection_option_2
		}
		
		repeat_event = { id = soh.4829 }
	}
}

# Ping liege
character_event = {
	id = soh.4830
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		# Finally inform the relevant vassals
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4831 }
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4832 days = 15 random = 30 }
	}
}

# Relevant vassals informed of challenge skill
character_event = {
	id = soh.4831
	
	desc = {
		text = EVTDESC_SOH_4831_A
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_diplomacy
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4831_B
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_martial
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4831_C
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_stewardship
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4831_D
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_intrigue
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4831_E
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_learning
			}
		}
	}
	
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					intrigue >= 20
				}
			}
		}
		
		name = EVTOPTA_SOH_4831 # Child's play!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 20
					diplomacy >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 20
					martial >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 20
					stewardship >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 20
					intrigue >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 20
					learning >= 10
				}
			}
		}
		
		name = EVTOPTB_SOH_4831 # Challenge accepted!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 10
				}
			}
		}
		
		name = EVTOPTC_SOH_4831 # This will be difficult...
	}
	
	after = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				ci_challenge_is_diplomacy = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_martial = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_stewardship = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_intrigue = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_learning = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4832
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4833 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4833 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4837 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4833 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4837 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4833 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4837 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4833 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4837 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4833 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4837 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4833 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4837 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4837 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4841 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4833
	desc = EVTDESC_SOH_4833
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4833 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4834 }
		}
		
		any_vassal = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4835 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4836 }
		}
	}
}

# Scheming liege successful - GC
character_event = {
	id = soh.4834
	desc = EVTDESC_SOH_4834
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4834 # I did NOT see that coming!
		
		prestige = -500
	}
}

# Scheming liege successful - relevant vassals
character_event = {
	id = soh.4835
	desc = EVTDESC_SOH_4835
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4835 # I did NOT see that coming!
		
		prestige = -100
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4836
	desc = EVTDESC_SOH_4836
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4836 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4837
	desc = EVTDESC_SOH_4837
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4837 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		any_vassal = {
			# All of them!
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			prestige = 100
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4838 }
		}
		
		any_vassal = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4839 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4840 }
		}
	}
}

# Scheming liege failed - GC
character_event = {
	id = soh.4838
	desc = EVTDESC_SOH_4838
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4838 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - relevant vassal
character_event = {
	id = soh.4839
	desc = EVTDESC_SOH_4839
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4839 # Someone is getting dangerous ideas...
		
		prestige = 100
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4840
	desc = EVTDESC_SOH_4840
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4840 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4841
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						any_voter = {
							has_minor_title = title_grand_chancellor
						}
					}
					
					any_voter = {
						limit = {
							has_minor_title = title_grand_chancellor
						}
						
						character_event = { id = soh.4842 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4843 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				random_vassal = {
					limit = {
						NOT = {
							has_minor_title = title_grand_chancellor # The GC is somewhat different...
						}
						
						OR = {
							is_voter = yes
							AND = {
								is_powerful_vassal = yes
								has_regent = no
							}
						}
					}
					
					character_event = { id = soh.4849 } # Random vassal picks outcome
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5041 } # Inconclusive struggle - liege
			}
		}
	}
}

# GC won - GC
character_event = {
	id = soh.4842
	desc = EVTDESC_SOH_4842
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4842 # I will increase my own power!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4846 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = ci_vassal_law_0
						}
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4842 # I will weaken the vassals!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4843 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Vassals weakened - liege
character_event = {
	id = soh.4843
	desc = EVTDESC_SOH_4843
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4843 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4844 } # Inform vassals
		}
		
		any_realm_lord = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4845 } # Inform vassals
		}
	}
}

# Vassals weakened - relevant vassals
character_event = {
	id = soh.4844
	desc = EVTDESC_SOH_4844
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4844 # I see...
		
		prestige = -200
	}
}

# Vassals weakened - others
character_event = {
	id = soh.4845
	desc = EVTDESC_SOH_4845
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4845 # Curses!
	}
}

# GC grows stronger - liege
character_event = {
	id = soh.4846
	desc = EVTDESC_SOH_4846
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4846 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_0 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_2 }
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4847 } # Inform vassals
		}
		
		any_realm_lord = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4848 } # Inform vassals
		}
	}
}

# GC grows stronger - relevant vassals
character_event = {
	id = soh.4847
	desc = EVTDESC_SOH_4847
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4847 # I see...
		
		prestige = -200
	}
}

# GC grows stronger - others
character_event = {
	id = soh.4848
	desc = EVTDESC_SOH_4848
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4848 # I see...
	}
}

# GC lost - random relevant vassal
character_event = {
	id = soh.4849
	desc = EVTDESC_SOH_4849
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4849 # I will increase my own power!
		
		FROM = {
			character_event = { id = soh.4854 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = grand_chancellor_law_0
						}
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4849 # I will weaken the GC!
		
		FROM = {
			character_event = { id = soh.4850 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# GC weakened - liege
character_event = {
	id = soh.4850
	desc = EVTDESC_SOH_4850
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4850 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_vassal = {
				limit = {
					NOT = {
						has_minor_title = title_grand_chancellor
					}
				}
				
				# All of them!
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4851 }
		}
		
		any_vassal = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4852 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4853 }
		}
	}
}

# GC weakened - GC
character_event = {
	id = soh.4851
	desc = EVTDESC_SOH_4851
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4851 # Curses!
		
		prestige = -1000
	}
}

# GC weakened - relevant vassal
character_event = {
	id = soh.4852
	desc = EVTDESC_SOH_4852
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4852 # Excellent!
	}
}

# GC weakened - others
character_event = {
	id = soh.4853
	desc = EVTDESC_SOH_4853
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4853 # I see...
	}
}

# Vassals grow stronger - liege
character_event = {
	id = soh.4854
	desc = EVTDESC_SOH_4854
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4854 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_vassal = {
				limit = {
					NOT = {
						has_minor_title = title_grand_chancellor
					}
				}
				
				# All of them!
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_0 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_4 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4855 }
		}
		
		any_vassal = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4856 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4857 }
		}
	}
}

# Vassals grow stronger - GC
character_event = {
	id = soh.4855
	desc = EVTDESC_SOH_4855
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4855 # Not what I was going for!
		
		prestige = -1000
	}
}

# Vassals grow stronger - relevant vassal
character_event = {
	id = soh.4856
	desc = EVTDESC_SOH_4856
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4856 # Excellent!
	}
}

# Vassals grow stronger - others
character_event = {
	id = soh.4857
	desc = EVTDESC_SOH_4857
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4857 # Excellent!
	}
}



### Courtiers vs. eunuchs

# Ruler informed of infighting
character_event = {
	id = soh.4858
	desc = EVTDESC_SOH_4858
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4858 # I support the courties!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NAND = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
					NOT = {
						is_rival = FROM
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_3
					NOR = {
						has_law = eunuch_law_4
						has_law = eunuch_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_2
					NOR = {
						has_law = eunuch_law_4
						has_law = eunuch_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = eunuch_law_0
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4858 # I support the eunuchs!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOT = {
					primary_title = {
						has_law = eunuch_law_4
						has_law = ci_courtier_law_0
					}
				}
			}
			
			mult_modifier = {
				factor = 0.001
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
					NOT = {
						has_law = ci_courtier_law_4
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_1
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4858 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4858 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4858 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform eunuchs or courtiers; they aren't playable!
		character_event = { id = soh.4859 days = 15 random = 15 }
	}
}

# Ping liege for skill check
character_event = {
	id = soh.4859
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# First see if there's an actual courtier to base it off of
		if = {
			limit = {
				event_target:courtier_challenger = {
					is_alive = no
				}
			}
			
			random_list = {
				20 = {
					set_character_flag = ci_challenge_is_diplomacy
				}
				
				20 = {
					set_character_flag = ci_challenge_is_martial
				}
				
				20 = {
					set_character_flag = ci_challenge_is_stewardship
				}
				
				20 = {
					set_character_flag = ci_challenge_is_intrigue
				}
				
				20 = {
					set_character_flag = ci_challenge_is_learning
				}
			}
			
			random_list = {
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 25
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 20
					}
				}
				
				70 = {
					set_variable = {
						which = ci_challenge_score
						value = 15
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
			}
		}
		
		# If so, pick a good stat for them
		else = {
			random_list = {
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 10
						}
					}
					
					set_character_flag = ci_challenge_is_diplomacy
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = diplomacy
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 10
						}
					}
					
					set_character_flag = ci_challenge_is_martial
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = martial
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 10
						}
					}
					
					set_character_flag = ci_challenge_is_stewardship
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = stewardship
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 10
						}
					}
					
					set_character_flag = ci_challenge_is_intrigue
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = intrigue
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 10
						}
					}
					
					set_character_flag = ci_challenge_is_learning
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = learning
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
			}
		}
		
		# Now get the average score of all eligible courtiers
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# Then add the mean of all other eunuchs' value in the relevant stat
		if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_4
				}
			}
			
			set_variable = {
				which = divisor
				value = 11
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			set_variable = {
				which = divisor
				value = 7
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			set_variable = {
				which = divisor
				value = 3
			}
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
				event_target:courtier_challenger = {
					NOT = {
						character = PREV
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4860 days = 15 random = 30 }
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4860
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4861 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4861 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4863 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4861 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4863 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4861 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4863 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4861 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4863 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4861 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4863 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4861 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4863 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4863 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4865 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4861
	desc = EVTDESC_SOH_4861
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4861 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
		}
		
		event_target:courtier_challenger = {
			prestige = -500
		}
		
		hidden_tooltip = {
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				prestige = -100
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4862 }
		}
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4862
	desc = EVTDESC_SOH_4862
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4862 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4863
	desc = EVTDESC_SOH_4863
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4863 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		event_target:eunuch_challenger = {
			prestige = 500
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4864 }
		}
		
		character_event = { id = soh.4865 days = 5 random = 10 }
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4864
	desc = EVTDESC_SOH_4864
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4864 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4865
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						event_target:courtier_challenger = {
							is_alive = yes
						}
					}
					
					event_target:courtier_challenger = {
						character_event = { id = soh.4866 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4867 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				if = {
					limit = {
						primary_title = {
							has_law = ci_courtier_law_0
						}
					}
					
					character_event = { id = soh.4874 } # Eunuchs grow stronger
				}
				
				else_if = {
					limit = {
						NOT = {
							primary_title = {
								has_law = eunuch_law_4
							}
						}
					}
					
					random_list = {
						50 = {
							mult_modifier = {
								factor = 10
								primary_title = {
									has_law = ci_courtier_law_4
								}
							}
							
							mult_modifier = {
								factor = 5
								primary_title = {
									has_law = ci_courtier_law_3
								}
							}
							
							mult_modifier = {
								factor = 2
								primary_title = {
									has_law = ci_courtier_law_2
								}
							}
							
							character_event = { id = soh.4872 } # Courtiers weakened
						}
						
						50 = {
							mult_modifier = {
								factor = 10
								primary_title = {
									has_law = eunuch_law_0
								}
							}
							
							mult_modifier = {
								factor = 5
								primary_title = {
									has_law = eunuch_law_1
								}
							}
							
							mult_modifier = {
								factor = 2
								primary_title = {
									has_law = eunuch_law_2
								}
							}
							
							character_event = { id = soh.4874 } # Eunuchs grow stronger
						}
					}
				}
				
				else = {
					character_event = { id = soh.4872 } # Courtiers weakened; sensible fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5045 } # Inconclusive struggle - liege
			}
		}
	}
}

# Courtiers won - challenger
character_event = {
	id = soh.4866
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		prestige = 1000
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4868 } # Weaken eunuchs
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4870 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = eunuch_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = eunuch_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = eunuch_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4868 } # Weaken eunuchs
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4870 } # Grow stronger
					}
				}
			}
		}
	}
}

# Hidden ping if no courtier
character_event = {
	id = soh.4867
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4868 } # Weaken eunuchs
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4870 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = eunuch_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = eunuch_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = eunuch_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4868 } # Weaken eunuchs
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4870 } # Grow stronger
					}
				}
			}
		}
	}
}

# Courtiers weakened eunuchs - liege
character_event = {
	id = soh.4868
	desc = EVTDESC_SOH_4868
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4868 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4869 } # Inform vassals
		}
	}
}

# Courtiers weakened eunuchs - others
character_event = {
	id = soh.4869
	desc = EVTDESC_SOH_4869
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4869 # Interesting...
	}
}

# Courtiers grow stronger - liege
character_event = {
	id = soh.4870
	desc = EVTDESC_SOH_4870
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4870 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_0 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_4 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4871 } # Inform vassals
		}
	}
}

# Courtiers grow stronger - others
character_event = {
	id = soh.4871
	desc = EVTDESC_SOH_4871
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4871 # Interesting...
	}
}

# Courtiers weakened - liege
character_event = {
	id = soh.4872
	desc = EVTDESC_SOH_4872
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4872 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4873 } # Inform vassals
		}
	}
}

# Courtiers weakened - others
character_event = {
	id = soh.4873
	desc = EVTDESC_SOH_4873
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4873 # Interesting...
	}
}

# Eunuchs grow stronger - liege
character_event = {
	id = soh.4874
	desc = EVTDESC_SOH_4874
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4874 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_0 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_4 }
			}
		}
		
		character_event = { id = soh.5301 } # Generate Council Eunuchs
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4875 } # Inform vassals
		}
	}
}

# Eunuchs grow stronger - others
character_event = {
	id = soh.4875
	desc = EVTDESC_SOH_4875
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4875 # Interesting...
	}
}



### Courtiers vs. GC

# Ruler informed of infighting
character_event = {
	id = soh.4876
	desc = EVTDESC_SOH_4876
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
		
		any_courtier_or_vassal = {	
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			save_event_target_as = grand_chancellor
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4876 # I support the courtiers!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					AND = {
						primary_title = {
							has_law = ci_courtier_law_4
						}
						NOT = {
							any_rival = {
								liege = {
									character = ROOT
								}
								has_minor_title = title_grand_chancellor
							}
						}
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_3
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_1
					NOR = {
						has_law = grand_chancellor_law_2
						has_law = grand_chancellor_law_1
					}
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4876 # I support the GC!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					AND = {
						primary_title = {
							has_law = grand_chancellor_law_2
						}
						NOT = {
							is_rival = FROM
						}
					}
					
					any_rival = {
						liege = {
							character = ROOT
						}
						has_minor_title = title_grand_chancellor
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_2
					NOT = {
						has_law = ci_courtier_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = grand_chancellor_law_2
					NOT = {
						has_law = ci_courtier_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_1
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_courtier_law_0
				}
			}
			
			mult_modifier = {
				factor = 10
				any_friend = {
					liege = {
						character = ROOT
					}
					has_minor_title = title_grand_chancellor
				}
			}
			
			mult_modifier = {
				factor = 10
				any_lover = {
					liege = {
						character = ROOT
					}
					has_minor_title = title_grand_chancellor
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4876 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4876 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4876 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform courtiers; they aren't playable!
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4877 }
		}
		
		character_event = { id = soh.4878 days = 15 random = 15 }
	}
}

# GC informed
character_event = {
	id = soh.4877
	
	desc = {
		text = EVTDESC_SOH_4877_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4877_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4877_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4877_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTA_SOH_4877 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTB_SOH_4877 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4877 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4877 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4878
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# First see if there's an actual courtier to base it off of
		if = {
			limit = {
				event_target:courtier_challenger = {
					is_alive = no
				}
			}
			
			random_list = {
				20 = {
					set_character_flag = ci_challenge_is_diplomacy
				}
				
				20 = {
					set_character_flag = ci_challenge_is_martial
				}
				
				20 = {
					set_character_flag = ci_challenge_is_stewardship
				}
				
				20 = {
					set_character_flag = ci_challenge_is_intrigue
				}
				
				20 = {
					set_character_flag = ci_challenge_is_learning
				}
			}
			
			random_list = {
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 25
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 20
					}
				}
				
				70 = {
					set_variable = {
						which = ci_challenge_score
						value = 15
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
			}
		}
		
		# If so, pick a good stat for them
		else = {
			random_list = {
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 10
						}
					}
					
					set_character_flag = ci_challenge_is_diplomacy
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = diplomacy
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 10
						}
					}
					
					set_character_flag = ci_challenge_is_martial
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = martial
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 10
						}
					}
					
					set_character_flag = ci_challenge_is_stewardship
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = stewardship
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 10
						}
					}
					
					set_character_flag = ci_challenge_is_intrigue
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = intrigue
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 10
						}
					}
					
					set_character_flag = ci_challenge_is_learning
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = learning
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
			}
		}
		
		# Now get the average score of all eligible courtiers
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# Finally inform the GC
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4879 }
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4880 days = 15 random = 30 }
	}
}

# GC informed of challenge skill
character_event = {
	id = soh.4879
	
	desc = {
		text = EVTDESC_SOH_4879_A
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_diplomacy
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4879_B
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_martial
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4879_C
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_stewardship
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4879_D
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_intrigue
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4879_E
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_learning
			}
		}
	}
	
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					intrigue >= 20
				}
			}
		}
		
		name = EVTOPTA_SOH_4879 # Child's play!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 20
					diplomacy >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 20
					martial >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 20
					stewardship >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 20
					intrigue >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 20
					learning >= 10
				}
			}
		}
		
		name = EVTOPTB_SOH_4879 # Challenge accepted!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 10
				}
			}
		}
		
		name = EVTOPTC_SOH_4879 # This will be difficult...
	}
	
	after = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				ci_challenge_is_diplomacy = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_martial = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_stewardship = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_intrigue = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_learning = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4880
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4881 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4881 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4884 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4881 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4884 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4881 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4884 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4881 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4884 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4881 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4884 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4881 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4884 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4884 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4887 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4881
	desc = EVTDESC_SOH_4881
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4881 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
		}
		
		event_target:courtier_challenger = {
			prestige = -500
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4882 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4883 }
		}
	}
}

# Scheming liege successful - GC
character_event = {
	id = soh.4882
	desc = EVTDESC_SOH_4882
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4882 # I did NOT see that coming!
		
		prestige = -500
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4883
	desc = EVTDESC_SOH_4883
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4883 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4884
	desc = EVTDESC_SOH_4884
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4884 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		event_target:courtier_challenger = {
			prestige = 500
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4885 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4886 }
		}
		
		character_event = { id = soh.4887 days = 5 random = 10 }
	}
}

# Scheming liege failed - GC
character_event = {
	id = soh.4885
	desc = EVTDESC_SOH_4885
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4885 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4886
	desc = EVTDESC_SOH_4886
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4886 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4887
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						event_target:courtier_challenger = {
							is_alive = yes
						}
					}
					
					event_target:courtier_challenger = {
						character_event = { id = soh.4888 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4889 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				if = {
					limit = {
						any_voter = {
							has_minor_title = title_grand_chancellor
						}
					}
					
					any_voter = {
						limit = {
							has_minor_title = title_grand_chancellor
						}
						
						character_event = { id = soh.4896 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4897 } # Courtiers weakened; sensible fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5047 } # Inconclusive struggle - liege
			}
		}
	}
}

# Courtiers won - challenger
character_event = {
	id = soh.4888
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		prestige = 1000
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4890 } # Weaken GC
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = grand_chancellor_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4893 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 100
						any_rival = {
							liege = {
								character = FROM
							}
							has_minor_title = title_grand_chancellor
						}
					}
					
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = grand_chancellor_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4890 } # Weaken GC
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4893 } # Grow stronger
					}
				}
			}
		}
	}
}

# Hidden ping if no courtier
character_event = {
	id = soh.4889
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4893 } # Grow stronger
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4890 } # Weaken GC
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = grand_chancellor_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4890 } # Weaken GC
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4893 } # Grow stronger
					}
				}
			}
		}
	}
}

# Courtiers weakened GC - liege
character_event = {
	id = soh.4890
	desc = EVTDESC_SOH_4890
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4890 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4891 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4892 } # Inform vassals
		}
	}
}

# Courtiers weakened GC - GC
character_event = {
	id = soh.4891
	desc = EVTDESC_SOH_4891
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4891 # Curses!
		
		prestige = -1000
	}
}

# Courtiers weakened GC - others
character_event = {
	id = soh.4892
	desc = EVTDESC_SOH_4892
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4892 # Interesting...
	}
}

# Courtiers grow stronger - liege
character_event = {
	id = soh.4893
	desc = EVTDESC_SOH_4893
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4893 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_0 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_4 }
			}
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4894 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.4895 } # Inform vassals
		}
	}
}

# Courtiers grow stronger - GC
character_event = {
	id = soh.4894
	desc = EVTDESC_SOH_4894
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4894 # Curses!
		
		prestige = -1000
	}
}

# Courtiers grow stronger - others
character_event = {
	id = soh.4895
	desc = EVTDESC_SOH_4895
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4895 # Interesting...
	}
}

# Courtiers lost - GC
character_event = {
	id = soh.4896
	desc = EVTDESC_SOH_4896
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4896 # I will increase my own power!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4899 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = ci_courtier_law_0
						}
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4896 # I will weaken the courtiers!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4897 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Courtiers weakened - liege
character_event = {
	id = soh.4897
	desc = EVTDESC_SOH_4897
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4897 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					character = FROM
				}
			}
			
			character_event = { id = soh.4898 } # Inform vassals
		}
	}
}

# Courtiers weakened - others
character_event = {
	id = soh.4898
	desc = EVTDESC_SOH_4898
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4898 # I see...
	}
}

# GC grows stronger - liege
character_event = {
	id = soh.4899
	desc = EVTDESC_SOH_4899
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4899 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_0 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_2 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					character = FROM
				}
			}
			
			character_event = { id = soh.4900 } # Inform vassals
		}
	}
}

# GC grows stronger - others
character_event = {
	id = soh.4900
	desc = EVTDESC_SOH_4900
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4900 # I see...
	}
}



### Courtiers vs. vassals

# Ruler informed of infighting
character_event = {
	id = soh.4901
	desc = EVTDESC_SOH_4901
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4901 # I support the courtiers!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_courtier_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_2
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4901 # I support the vassals!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = ci_vassal_law_4
					}
					primary_title = {
						has_law = ci_courtier_law_0
					}
				}
			}
			
			mult_modifier = {
				factor = 0.001
				primary_title = {
					has_law = ci_vassal_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_2
					NOR = {
						has_law = ci_courtier_law_4
						has_law = ci_courtier_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_2
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4901 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4901 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4901 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform courtiers; they aren't playable!
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4902 }
		}
		
		character_event = { id = soh.4903 days = 15 random = 15 }
	}
}

# Relevant vassals informed
character_event = {
	id = soh.4902
	
	desc = {
		text = EVTDESC_SOH_4902_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4902_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4902_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4902_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTA_SOH_4902 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTB_SOH_4708 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4902 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4902 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4903
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# First see if there's an actual courtier to base it off of
		if = {
			limit = {
				event_target:courtier_challenger = {
					is_alive = no
				}
			}
			
			random_list = {
				20 = {
					set_character_flag = ci_challenge_is_diplomacy
				}
				
				20 = {
					set_character_flag = ci_challenge_is_martial
				}
				
				20 = {
					set_character_flag = ci_challenge_is_stewardship
				}
				
				20 = {
					set_character_flag = ci_challenge_is_intrigue
				}
				
				20 = {
					set_character_flag = ci_challenge_is_learning
				}
			}
			
			random_list = {
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 25
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 20
					}
				}
				
				70 = {
					set_variable = {
						which = ci_challenge_score
						value = 15
					}
				}
				
				10 = {
					set_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				5 = {
					set_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
			}
		}
		
		# If so, pick a good stat for them
		else = {
			random_list = {
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							diplomacy < 10
						}
					}
					
					set_character_flag = ci_challenge_is_diplomacy
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = diplomacy
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							martial < 10
						}
					}
					
					set_character_flag = ci_challenge_is_martial
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = martial
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							stewardship < 10
						}
					}
					
					set_character_flag = ci_challenge_is_stewardship
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = stewardship
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							intrigue < 10
						}
					}
					
					set_character_flag = ci_challenge_is_intrigue
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = intrigue
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
				
				1000 = {
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 25
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 20
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 15
						}
					}
					
					mult_modifier = {
						factor = 0.1
						event_target:courtier_challenger = {
							learning < 10
						}
					}
					
					set_character_flag = ci_challenge_is_learning
					
					event_target:courtier_challenger = {
						export_to_variable = {
							which = ci_challenge_score
							value = learning
						}
						
						ROOT = {
							change_variable = {
								which = ci_challenge_score
								which = PREV
							}
						}
					}
				}
			}
		}
		
		# Now get the average score of all eligible courtiers
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# Finally inform the relevant vassals
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4904 }
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4905 days = 15 random = 30 }
	}
}

# Relevant vassals informed of challenge skill
character_event = {
	id = soh.4904
	
	desc = {
		text = EVTDESC_SOH_4904_A
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_diplomacy
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4904_B
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_martial
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4904_C
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_stewardship
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4904_D
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_intrigue
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4904_E
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_learning
			}
		}
	}
	
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					intrigue >= 20
				}
			}
		}
		
		name = EVTOPTA_SOH_4904 # Child's play!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 20
					diplomacy >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 20
					martial >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 20
					stewardship >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 20
					intrigue >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 20
					learning >= 10
				}
			}
		}
		
		name = EVTOPTB_SOH_4904 # Challenge accepted!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 10
				}
			}
		}
		
		name = EVTOPTC_SOH_4904 # This will be difficult...
	}
	
	after = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				ci_challenge_is_diplomacy = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_martial = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_stewardship = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_intrigue = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_learning = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4905
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4906 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4906 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4909 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4906 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4909 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4906 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4909 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4906 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4909 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4906 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4909 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4906 } # Successful scheming
					}

					75 = {
						character_event = { id = soh.4909 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4909 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4912 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4906
	desc = EVTDESC_SOH_4906
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4906 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
		}
		
		event_target:courtier_challenger = {
			prestige = -500
		}
		
		any_voter = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4907 }
		}
		
		any_vassal = {
			limit = {
				ai = no
				NOR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4908 }
		}
	}
}

# Scheming liege successful - relevant vassals
character_event = {
	id = soh.4907
	desc = EVTDESC_SOH_4907
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4907 # I did NOT see that coming!
		
		prestige = -100
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4908
	desc = EVTDESC_SOH_4908
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4908 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4909
	desc = EVTDESC_SOH_4909
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4909 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		event_target:courtier_challenger = {
			prestige = 500
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_vassal = {
			# All of them!
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4910 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4911 }
		}
		
		character_event = { id = soh.4912 days = 5 random = 10 }
	}
}

# Scheming liege failed - relevant vassals
character_event = {
	id = soh.4910
	desc = EVTDESC_SOH_4910
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4910 # Someone is getting dangerous ideas...
		
		prestige = 100
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4911
	desc = EVTDESC_SOH_4911
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4717 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4912
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						event_target:courtier_challenger = {
							is_alive = yes
						}
					}
					
					event_target:courtier_challenger = {
						character_event = { id = soh.4913 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4914 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				if = {
					limit = {
						any_vassal = {
							OR = {
								is_voter = yes
								AND = {
									is_powerful_vassal = yes
									has_regent = no
								}
							}
						}
					}
					
					random_vassal = {
						limit = {
							OR = {
								is_voter = yes
								AND = {
									is_powerful_vassal = yes
									has_regent = no
								}
							}
						}
						
						preferred_limit = {
							NOT = {
								has_minor_title = title_grand_chancellor # The GC is somewhat different...
							}
						}
						
						character_event = { id = soh.4921 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4922 } # Courtiers weakened; sensible fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5050 } # Inconclusive struggle - liege
			}
		}
	}
}

# Courtiers won - challenger
character_event = {
	id = soh.4913
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		prestige = 1000
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4915 } # Weaken vassals
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_vassal_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4918 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4915 } # Weaken vassals
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4918 } # Grow stronger
					}
				}
			}
		}
	}
}

# Hidden ping if no courtier
character_event = {
	id = soh.4914
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4915 } # Weaken vassals
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_vassal_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4918 } # Grow stronger
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4915 } # Weaken vassals
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_1
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4918 } # Grow stronger
					}
				}
			}
		}
	}
}

# Courtiers weakened vassals - liege
character_event = {
	id = soh.4915
	desc = EVTDESC_SOH_4915
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4915 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4916 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4917 } # Inform other vassals
		}
	}
}

# Courtiers weakened vassals - relevant vassals
character_event = {
	id = soh.4916
	desc = EVTDESC_SOH_4916
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4916 # Curses!
		
		prestige = -100
	}
}

# Courtiers weakened vassls - others
character_event = {
	id = soh.4917
	desc = EVTDESC_SOH_4917
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4917 # Curses!
	}
}

# Courtiers grow stronger - liege
character_event = {
	id = soh.4918
	desc = EVTDESC_SOH_4918
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4918 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_0 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_4 }
			}
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4919 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4920 } # Inform other vassals
		}
	}
}

# Courtiers grow stronger - relevant vassals
character_event = {
	id = soh.4919
	desc = EVTDESC_SOH_4919
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4919 # Curses!
		
		prestige = -100
	}
}

# Courtiers grow stronger - others
character_event = {
	id = soh.4920
	desc = EVTDESC_SOH_4920
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4920 # Curses!
	}
}

# Courtiers lost - random relevant vassal
character_event = {
	id = soh.4921
	desc = EVTDESC_SOH_4921
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4921 # I will increase my own power!
		
		FROM = {
			character_event = { id = soh.4924 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = ci_courtier_law_0
						}
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4921 # I will weaken the courtiers!
		
		FROM = {
			character_event = { id = soh.4922 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Courtiers weakened - liege
character_event = {
	id = soh.4922
	desc = EVTDESC_SOH_4922
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4922 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_vassal = {
				# All of them!
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4923 } # Inform vassals
		}
	}
}

# Courtiers weakened - others
character_event = {
	id = soh.4923
	desc = EVTDESC_SOH_4923
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4923 # I see...
	}
}

# Vassals grow stronger - liege
character_event = {
	id = soh.4924
	desc = EVTDESC_SOH_4924
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4924 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			any_vassal = {
				# All of them!
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_0 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_4 }
			}
		}
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.4925 } # Inform vassals
		}
	}
}

# Vassals grow stronger - others
character_event = {
	id = soh.4925
	desc = EVTDESC_SOH_4925
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4925 # Excellent!
	}
}



### Vassals vs. eunuchs

# Ruler informed of infighting
character_event = {
	id = soh.4926
	desc = EVTDESC_SOH_4926
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4926 # I support the vassals!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = ci_vassal_law_4
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_3
					NOT = {
						has_law = eunuch_law_4
					}
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_vassal_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_vassal_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_1
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4926 # I support the eunuchs!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NAND = {
					primary_title = {
						has_law = eunuch_law_4
					}
					NOR = {
						is_rival = FROM
						primary_title = {
							OR = {
								has_law = ci_vassal_law_4
								has_law = ci_vassal_law_3
							}
						}
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_3
					NOR = {
						has_law = ci_vassal_law_4
						has_law = ci_vassal_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
					NOR = {
						has_law = ci_vassal_law_4
						has_law = ci_vassal_law_3
						has_law = ci_vassal_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = eunuch_law_1
					has_law = ci_vassal_law_0
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4926 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4926 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4926 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform eunuchs; they aren't playable!
		FROM = {
			character_event = { id = soh.4927 }
		}
		
		character_event = { id = soh.4928 days = 15 random = 15 }
	}
}

# Vassal informed
character_event = {
	id = soh.4927
	
	desc = {
		text = EVTDESC_SOH_4927_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4927_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4927_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4927_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTA_SOH_4927 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTB_SOH_4927 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4927 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4927 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4928
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# To the vassal!
		FROMFROM = {
			clr_character_flag = ci_skill_selection_option_2
			character_event = { id = soh.4929 }
		}
	}
}

# Vassal picks skill
character_event = {
	id = soh.4929
	desc = EVTDESC_SOH_4929
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTA_SOH_4929 # Diplomacy is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_diplomacy
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = diplomacy
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4930 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 25
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 20
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 15
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 10
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTB_SOH_4929 # Martial is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_martial
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = martial
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4930 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				martial < 25
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 20
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 15
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 10
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTC_SOH_4929 # Stewardship is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_stewardship
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = stewardship
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4930 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				stewardship < 25
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 20
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 15
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 10
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTD_SOH_4929 # Intrigue is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_intrigue
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = intrigue
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4930 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				intrigue < 25
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 20
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 15
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 10
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTE_SOH_4929 # Learning is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_learning
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = learning
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4930 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				learning < 25
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 20
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 15
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 10
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 5
			}
		}
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTF_SOH_4929 # Maybe something else...
		
		if = {
			limit = {
				NOT = {
					has_character_flag = ci_skill_selection_option_2
				}
			}
			
			set_character_flag = ci_skill_selection_option_2
		}
		
		else = {
			clr_character_flag = ci_skill_selection_option_2
		}
		
		repeat_event = { id = soh.4929 }
	}
}

# Ping liege to get eunuchs' score
character_event = {
	id = soh.4930
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_4
				}
			}
			
			set_variable = {
				which = divisor
				value = 12
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_3
				}
			}
			
			set_variable = {
				which = divisor
				value = 8
			}
		}
		
		else_if = {
			limit = {
				primary_title = {
					has_law = eunuch_law_2
				}
			}
			
			set_variable = {
				which = divisor
				value = 4
			}
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# Finally inform the relevant vassals
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4931 }
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4932 days = 15 random = 30 }
	}
}

# Relevant vassals informed of challenge skill
character_event = {
	id = soh.4931
	
	desc = {
		text = EVTDESC_SOH_4931_A
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_diplomacy
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4931_B
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_martial
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4931_C
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_stewardship
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4931_D
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_intrigue
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4931_E
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_learning
			}
		}
	}
	
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					intrigue >= 20
				}
			}
		}
		
		name = EVTOPTA_SOH_4931 # Child's play!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 20
					diplomacy >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 20
					martial >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 20
					stewardship >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 20
					intrigue >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 20
					learning >= 10
				}
			}
		}
		
		name = EVTOPTB_SOH_4931 # Challenge accepted!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 10
				}
			}
		}
		
		name = EVTOPTC_SOH_4931 # This will be difficult...
	}
	
	after = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				ci_challenge_is_diplomacy = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_martial = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_stewardship = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_intrigue = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_learning = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4932
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4933 } # Successful scheming
			}
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4933 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4937 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4933 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4937 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4933 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4937 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4933 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4937 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4933 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4937 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit  ={
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4933 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4937 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4937 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4941 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4933
	desc = EVTDESC_SOH_4933
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4933 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
		}
		
		event_target:vassal_challenger = {
			character_event = { id = soh.4934 }
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = event_target:vassal_challenger
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4935 }
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			prestige = -100
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4936 }
		}
	}
}

# Scheming liege successful - challenger
character_event = {
	id = soh.4934
	desc = EVTDESC_SOH_4934
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4934 # I did NOT see that coming!
		
		prestige = -500
	}
}

# Scheming liege successful - relevant vassals
character_event = {
	id = soh.4935
	desc = EVTDESC_SOH_4935
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4935 # I did NOT see that coming!
		
		prestige = -100
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4936
	desc = EVTDESC_SOH_4936
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4936 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4937
	desc = EVTDESC_SOH_4937
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4937 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			prestige = 100
		}
		
		event_target:vassal_challenger = {
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4938 }
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = event_target:vassal_challenger
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4939 }
		}
		
		any_voter = {
			limit = {
				is_council_eunuch_trigger = yes
			}
			
			prestige = 100
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4940 }
		}
	}
}

# Scheming liege failed - challenger
character_event = {
	id = soh.4938
	desc = EVTDESC_SOH_4938
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4938 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - relevant vassals
character_event = {
	id = soh.4939
	desc = EVTDESC_SOH_4939
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4939 # Someone is getting dangerous ideas...
		
		prestige = 100
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4940
	desc = EVTDESC_SOH_4940
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4940 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4941
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						event_target:vassal_challenger = {
							is_alive = yes
							liege = {
								character = ROOT
							}
						}
					}
					
					event_target:vassal_challenger = {
						character_event = { id = soh.4942 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4943 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				character_event = { id = soh.4949 } # Ping
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5053 } # Inconclusive struggle - liege
			}
		}
	}
}

# Vassals won - challenger
character_event = {
	id = soh.4942
	desc = EVTDESC_SOH_4942
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4942 # I will increase my own power!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4946 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = eunuch_law_0
						}
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4942 # I will weaken the eunuchs!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4943 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Eunuchs weakened - liege
character_event = {
	id = soh.4943
	desc = EVTDESC_SOH_4943
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4943 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_4 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_0 }
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4944 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = FROM
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4945 } # Inform vassals
		}
	}
}

# Eunuchs weakened - relevant vassals
character_event = {
	id = soh.4944
	desc = EVTDESC_SOH_4944
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4944 # I see...
		
		prestige = 100
	}
}

# Eunuchs weakened - others
character_event = {
	id = soh.4945
	desc = EVTDESC_SOH_4945
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4945 # I see...
	}
}

# Vassals grow stronger - liege
character_event = {
	id = soh.4946
	desc = EVTDESC_SOH_4946
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4946 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_0 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_4 }
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4947 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = FROM
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4948 } # Inform vassals
		}
	}
}

# Vassals grow stronger - relevant vassals
character_event = {
	id = soh.4947
	desc = EVTDESC_SOH_4947
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4947 # I see...
		
		prestige = 100
	}
}

# Vassals grow stronger - others
character_event = {
	id = soh.4948
	desc = EVTDESC_SOH_4948
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4948 # I see...
	}
}

# Hidden ping if vassals lost
character_event = {
	id = soh.4949
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = eunuch_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4954 } # Grow stronger
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_vassal_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.4950 } # Weaken vassals
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4950 } # Weaken vassals
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 100
						FROM = {
							primary_title = {
								has_law = eunuch_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = eunuch_law_1
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.4954 } # Grow stronger
					}
				}
			}
		}
	}
}

# Eunuchs weakened vassals - liege
character_event = {
	id = soh.4950
	desc = EVTDESC_SOH_4950
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4950 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
		}
		
		event_target:vassal_challenger = {
			character_event = { id = soh.4951 } # Inform challenger
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = event_target:vassal_challenger
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4952 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4953 } # Inform vassals
		}
	}
}

# Eunuchs weakened vassals - challenger
character_event = {
	id = soh.4951
	desc = EVTDESC_SOH_4951
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4951 # I see...
		
		prestige = -1000
	}
}

# Eunuchs weakened vassals - relevant vassals
character_event = {
	id = soh.4952
	desc = EVTDESC_SOH_4952
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4952 # Curses!
		
		prestige = -100
	}
}

# Eunuchs weakened vassals - others
character_event = {
	id = soh.4953
	desc = EVTDESC_SOH_4953
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4953 # Interesting...
	}
}

# Eunuchs grow stronger - liege
character_event = {
	id = soh.4954
	desc = EVTDESC_SOH_4954
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4954 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_voter = {
				limit = {
					is_council_eunuch_trigger = yes
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				eunuch_law_0 = { add_law = eunuch_law_1 }
				eunuch_law_1 = { add_law = eunuch_law_2 }
				eunuch_law_2 = { add_law = eunuch_law_3 }
				eunuch_law_3 = { add_law = eunuch_law_4 }
			}
		}
		
		character_event = { id = soh.5301 } # Generate Council Eunuchs
		
		event_target:vassal_challenger = {
			character_event = { id = soh.4955 } # Inform challenger
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = event_target:vassal_challenger
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4956 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4957 } # Inform vassals
		}
	}
}

# Eunuchs grow stronger - challenger
character_event = {
	id = soh.4955
	desc = EVTDESC_SOH_4955
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4955 # I see...
		
		prestige = -1000
	}
}

# Eunuchs grow stronger - relevant vassals
character_event = {
	id = soh.4956
	desc = EVTDESC_SOH_4956
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4956 # Curses!
		
		prestige = -100
	}
}

# Eunuchs grow stronger - others
character_event = {
	id = soh.4957
	desc = EVTDESC_SOH_4957
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4957 # Interesting...
	}
}



### Vassals vs. GC

# Ruler informed of infighting
character_event = {
	id = soh.4958
	desc = EVTDESC_SOH_4958
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
		
		any_courtier_or_vassal = {	
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			save_event_target_as = grand_chancellor
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4958 # I support the vassals!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					AND = {
						primary_title = {
							has_law = ci_vassal_law_4
						}
						NOT = {
							any_voter = {
								has_minor_title = title_grand_chancellor
								is_rival = ROOT
							}
						}
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_3
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_vassal_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_vassal_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_1
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4958 # I support the GC!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					AND = {
						primary_title = {
							has_law = grand_chancellor_law_2
						}
						NOR = {
							is_rival = FROM
							primary_title = {
								OR = {
									has_law = ci_vassal_law_4
									has_law = ci_vassal_law_3
								}
							}
							any_voter = {
								has_minor_title = title_grand_chancellor
								OR = {
									is_friend = ROOT
									is_lover = ROOT
								}
							}
						}
					}
					
					any_voter = {
						has_minor_title = title_grand_chancellor
						is_rival = ROOT
					}
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = grand_chancellor_law_2
					NOR = {
						has_law = ci_vassal_law_4
						has_law = ci_vassal_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_1
					NOR = {
						has_law = ci_vassal_law_4
						has_law = ci_vassal_law_3
						has_law = ci_vassal_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = grand_chancellor_law_1
				}
			}
			
			mult_modifier = {
				factor = 10
				any_voter = {
					has_minor_title = title_grand_chancellor
					is_friend = ROOT
				}
			}
			
			mult_modifier = {
				factor = 10
				any_voter = {
					has_minor_title = title_grand_chancellor
					is_lover = ROOT
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4958 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4958 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4958 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		FROM = {
			character_event = { id = soh.4959 }
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4960 }
		}
		
		character_event = { id = soh.4961 days = 15 random = 15 }
	}
}

# Vassal informed
character_event = {
	id = soh.4959
	
	desc = {
		text = EVTDESC_SOH_4959_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4959_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4959_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4959_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTA_SOH_4959 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTB_SOH_4959 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4959 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4959 # Unsurprising...
	}
}

# GC informed
character_event = {
	id = soh.4960
	
	desc = {
		text = EVTDESC_SOH_4960_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4960_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4960_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4960_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTA_SOH_4960 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTB_SOH_4960 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4960 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4960 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4961
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# To the vassal!
		FROMFROM = {
			clr_character_flag = ci_skill_selection_option_2
			character_event = { id = soh.4962 }
		}
	}
}

# Vassal picks skill
character_event = {
	id = soh.4962
	desc = EVTDESC_SOH_4962
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTA_SOH_4962 # Diplomacy is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_diplomacy
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = diplomacy
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4963 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 25
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 20
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 15
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 10
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTB_SOH_4962 # Martial is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_martial
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = martial
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4963 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				martial < 25
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 20
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 15
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 10
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTC_SOH_4962 # Stewardship is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_stewardship
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = stewardship
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4963 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				stewardship < 25
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 20
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 15
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 10
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTD_SOH_4962 # Intrigue is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_intrigue
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = intrigue
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4963 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				intrigue < 25
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 20
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 15
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 10
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTE_SOH_4962 # Learning is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_learning
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = learning
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4963 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				learning < 25
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 20
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 15
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 10
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 5
			}
		}
	}
	
	option = {
		trigger = {
			ai = no
		}
		name = EVTOPTF_SOH_4962 # Maybe something else...
		
		if = {
			limit = {
				NOT = {
					has_character_flag = ci_skill_selection_option_2
				}
			}
			
			set_character_flag = ci_skill_selection_option_2
		}
		
		else = {
			clr_character_flag = ci_skill_selection_option_2
		}
		
		repeat_event = { id = soh.4962 }
	}
}

# Ping liege
character_event = {
	id = soh.4963
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		# Inform the relevant vassals
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_vassal = {
			limit = {
				NOR = {
					character = FROM
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_vassal = {
			limit = {
				NOR = {
					character = FROM
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4964 }
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.4965 days = 1 }
	}
}

# Relevant vassals informed of challenge skill
character_event = {
	id = soh.4964
	
	desc = {
		text = EVTDESC_SOH_4964_A
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_diplomacy
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4964_B
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_martial
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4964_C
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_stewardship
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4964_D
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_intrigue
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4964_E
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_learning
			}
		}
	}
	
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					intrigue >= 20
				}
			}
		}
		
		name = EVTOPTA_SOH_4964 # Child's play!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 20
					diplomacy >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 20
					martial >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 20
					stewardship >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 20
					intrigue >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 20
					learning >= 10
				}
			}
		}
		
		name = EVTOPTB_SOH_4964 # Challenge accepted!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 10
				}
			}
		}
		
		name = EVTOPTC_SOH_4964 # This will be difficult...
	}
	
	after = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				ci_challenge_is_diplomacy = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_martial = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_stewardship = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_intrigue = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_learning = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
	}
}

# Ping liege
character_event = {
	id = soh.4965
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		# The GC is informed
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4966 }
		}
		
		# And fire the follow-up for ROOT
		
		character_event = { id = soh.4967 days = 15 random = 30 }
	}
}

# GC informed of challenge skill
character_event = {
	id = soh.4966
	
	desc = {
		text = EVTDESC_SOH_4966_A
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_diplomacy
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4966_B
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_martial
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4966_C
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_stewardship
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4966_D
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_intrigue
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4966_E
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_learning
			}
		}
	}
	
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					intrigue >= 20
				}
			}
		}
		
		name = EVTOPTA_SOH_4966 # Child's play!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 20
					diplomacy >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 20
					martial >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 20
					stewardship >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 20
					intrigue >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 20
					learning >= 10
				}
			}
		}
		
		name = EVTOPTB_SOH_4966 # Challenge accepted!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 10
				}
			}
		}
		
		name = EVTOPTC_SOH_4966 # This will be difficult...
	}
	
	after = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				ci_challenge_is_diplomacy = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_martial = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_stewardship = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_intrigue = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_learning = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1 
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.4967
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.4968 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.4968 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.4973 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4968 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4973 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4968 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4973 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.4968 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.4973 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4968 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4973 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.4968 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.4973 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.4973 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.4978 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.4968
	desc = EVTDESC_SOH_4968
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4968 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_0 }
			}
		}
		
		event_target:vassal_challenger = {
			character_event = { id = soh.4969 }
		}
		
		any_vassal = {
			limit = {
				NOR = {
					character = event_target:vassal_challenger
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4970 }
		}
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4971 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					has_minor_title = title_grand_chancellor
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4972 }
		}
	}
}

# Scheming liege successful - challenger
character_event = {
	id = soh.4969
	desc = EVTDESC_SOH_4969
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4969 # I did NOT see that coming!
		
		prestige = -500
	}
}

# Scheming liege successful - relevant vassals
character_event = {
	id = soh.4970
	desc = EVTDESC_SOH_4970
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4970 # I did NOT see that coming!
		
		prestige = -100
	}
}

# Scheming liege successful - GC
character_event = {
	id = soh.4971
	desc = EVTDESC_SOH_4971
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4971 # I did NOT see that coming!
		
		prestige = -500
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.4972
	desc = EVTDESC_SOH_4972
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4972 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.4973
	desc = EVTDESC_SOH_4973
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4973 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		event_target:vassal_challenger = {
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4974 }
		}
		
		any_vassal = {
			limit = {
				NOR = {
					character = event_target:vassal_challenger
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4975 }
		}
		
		any_vassal = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.4976 }
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					has_minor_title = title_grand_chancellor
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4977 }
		}
	}
}

# Scheming liege failed - challenger
character_event = {
	id = soh.4974
	desc = EVTDESC_SOH_4974
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4974 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - relevant vassals
character_event = {
	id = soh.4975
	desc = EVTDESC_SOH_4975
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4975 # Someone is getting dangerous ideas...
		
		prestige = 100
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - GC
character_event = {
	id = soh.4976
	desc = EVTDESC_SOH_4976
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4976 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.4977
	desc = EVTDESC_SOH_4977
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4977 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.4978
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						event_target:vassal_challenger = {
							is_alive = yes
							liege = {
								character = ROOT
							}
						}
					}
					
					event_target:vassal_challenger = {
						character_event = { id = soh.4979 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.4980 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				if = {
					limit = {
						any_voter = {
							has_minor_title = title_grand_chancellor
						}
					}
					
					any_voter = {
						limit = {
							has_minor_title = title_grand_chancellor
						}
						
						character_event = { id = soh.4988 } # GC selects outcome
					}
				}
				
				else = {
					character_event = { id = soh.4989 } # Vassals weakened - fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5057 } # Inconclusive struggle - liege
			}
		}
	}
}

# Vassals won - challenger
character_event = {
	id = soh.4979
	desc = EVTDESC_SOH_4979
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4979 # I will increase my own power!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4984 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = eunuch_law_0
						}
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4979 # I will weaken the eunuchs!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4980 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# GC weakened - liege
character_event = {
	id = soh.4980
	desc = EVTDESC_SOH_4980
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4980 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_2 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_2 }
			}
		}
		
		any_vassal = {
			limit = {
				NOR = {
					character = FROM
					has_minor_title = title_grand_chancellor
				}
				
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4981 } # Inform relevant vassals
		}
		
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4982 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = FROM
					has_minor_title = title_grand_chancellor
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4983 } # Inform vassals
		}
	}
}

# GC weakened - relevant vassals
character_event = {
	id = soh.4981
	desc = EVTDESC_SOH_4981
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4981 # Excellent!
		
		prestige = 100
	}
}

# GC weakened - GC
character_event = {
	id = soh.4982
	desc = EVTDESC_SOH_4982
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4982 # Curses!
		
		prestige = -1000
	}
}

# GC weakened - others
character_event = {
	id = soh.4983
	desc = EVTDESC_SOH_4983
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4983 # I see...
	}
}

# Vassals grow stronger - liege
character_event = {
	id = soh.4984
	desc = EVTDESC_SOH_4984
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4984 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_0 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_4 }
			}
		}
		
		any_vassal = {
			limit = {
				NOR = {
					character = FROM
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4985 } # Inform relevant vassals
		}
		
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.4986 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = FROM
					has_minor_title = title_grand_chancellor
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4987 } # Inform vassals
		}
	}
}

# Vassals grow stronger - relevant vassals
character_event = {
	id = soh.4985
	desc = EVTDESC_SOH_4985
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4985 # Excellent!
		
		prestige = 100
	}
}

# Vassals grow stronger - GC
character_event = {
	id = soh.4986
	desc = EVTDESC_SOH_4986
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4986 # Not what I was aiming for!
		
		prestige = -1000
	}
}

# Vassals grow stronger - others
character_event = {
	id = soh.4987
	desc = EVTDESC_SOH_4987
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4987 # Excellent!
	}
}

# GC won - GC
character_event = {
	id = soh.4988
	desc = EVTDESC_SOH_4988
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_4988 # I will increase my own power!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4992 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = ci_vassal_law_0
						}
						has_law = grand_chancellor_law_2
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_4988 # I will weaken the vassals!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.4989 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Vassals weakened - liege
character_event = {
	id = soh.4989
	desc = EVTDESC_SOH_4989
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4989 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4990 } # Inform vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4991 } # Inform vassals
		}
	}
}

# Vassals weakened - relevant vassals
character_event = {
	id = soh.4990
	desc = EVTDESC_SOH_4990
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4990 # I see...
		
		prestige = -200
	}
}

# Vassals weakened - others
character_event = {
	id = soh.4991
	desc = EVTDESC_SOH_4991
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4991 # Curses!
	}
}

# GC grows stronger - liege
character_event = {
	id = soh.4992
	desc = EVTDESC_SOH_4992
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4992 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				grand_chancellor_law_0 = { add_law = grand_chancellor_law_1 }
				grand_chancellor_law_1 = { add_law = grand_chancellor_law_2 }
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.4993 } # Inform vassals
		}
		
		any_realm_lord = {
			limit = {
				NOT = {
					has_minor_title = title_grand_chancellor
				}
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.4994 } # Inform vassals
		}
	}
}

# GC grows stronger - relevant vassals
character_event = {
	id = soh.4993
	desc = EVTDESC_SOH_4993
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4993 # I see...
		
		prestige = -200
	}
}

# GC grows stronger - others
character_event = {
	id = soh.4994
	desc = EVTDESC_SOH_4994
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_4994 # I see...
	}
}



### Vassals vs. courtiers

# Ruler informed of infighting
character_event = {
	id = soh.4995
	desc = EVTDESC_SOH_4995
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = ci_supporting_challenger
		clr_character_flag = ci_supporting_challenged
		clr_character_flag = ci_not_taking_sides
		clr_character_flag = ci_opposing_both_sides
		clr_character_flag = ci_unable_to_pick_side
		
		add_character_modifier = {
			modifier = ongoing_ci_law_challenge
			months = 3
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTA_SOH_4995 # I support the vassals!
		
		set_character_flag = ci_supporting_challenger
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NOR = {
					primary_title = {
						has_law = ci_vassal_law_4
					}
					is_rival = FROM
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_3
					NOT = {
						has_law = ci_courtier_law_4
					}
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_vassal_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.01
				primary_title = {
					has_law = ci_vassal_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_vassal_law_1
				}
			}
			
			mult_modifier = {
				factor = 10
				is_friend = FROM
			}
			
			mult_modifier = {
				factor = 10
				is_lover = FROM
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTB_SOH_4995 # I support the courtiers!
		
		set_character_flag = ci_supporting_challenged
		
		ai_chance = {
			factor = 100
			
			trigger = {
				NAND = {
					primary_title = {
						has_law = ci_courtier_law_4
					}
					NOR = {
						is_rival = FROM
						primary_title = {
							OR = {
								has_law = ci_vassal_law_4
								has_law = ci_vassal_law_3
							}
						}
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_3
					NOR = {
						has_law = ci_vassal_law_4
						has_law = ci_vassal_law_3
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_3
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_2
					NOR = {
						has_law = ci_vassal_law_4
						has_law = ci_vassal_law_3
						has_law = ci_vassal_law_2
					}
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_2
				}
			}
			
			mult_modifier = {
				factor = 0.1
				primary_title = {
					has_law = ci_courtier_law_1
					has_law = ci_vassal_law_0
				}
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTC_SOH_4995 # I won't pick a side!
		
		set_character_flag = ci_not_taking_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = slothful
			}
			
			mult_modifier = {
				factor = 5
				trait = content
			}
			
			mult_modifier = {
				factor = 2
				trait = humble
			}
			
			mult_modifier = {
				factor = 10
				is_dumb_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = no
		}
		
		name = EVTOPTD_SOH_4995 # I will oppose them both!
		
		set_character_flag = ci_opposing_both_sides
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 10
				trait = ambitious
			}
			
			mult_modifier = {
				factor = 5
				trait = diligent
			}
			
			mult_modifier = {
				factor = 2
				trait = proud
			}
			
			mult_modifier = {
				factor = 10
				is_smart_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_education_intrigue_trigger = yes
			}
			
			mult_modifier = {
				factor = 2
				has_lifestyle_intrigue_trigger = yes
			}
		}
	}
	
	option = {
		trigger = {
			has_regent = yes
		}
		
		name = EVTOPTE_SOH_4995 # I... can't get involved...
		
		set_character_flag = ci_unable_to_pick_side
		
		ai_chance = {
			factor = 100
		}
	}
	
	after = {
		# No need to inform courtiers; they aren't playable!
		FROM = {
			character_event = { id = soh.4996 }
		}
		
		character_event = { id = soh.4997 days = 15 random = 15 }
	}
}

# Vassal informed
character_event = {
	id = soh.4996
	
	desc = {
		text = EVTDESC_SOH_4996_A
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4996_B
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4996_C
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_4996_D
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
	}
	
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenged
			}
		}
		
		name = EVTOPTA_SOH_4996 # FROM's help won't save them!
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_supporting_challenger
			}
		}
		
		name = EVTOPTB_SOH_4996 # I won't disappoint FROM!
	}
	
	option = {
		trigger = {
			FROM = {
				OR = {
					has_character_flag = ci_not_taking_sides
					has_character_flag = ci_opposing_both_sides
				}
			}
		}
		
		name = EVTOPTC_SOH_4996 # As long as FROM isn't picking sides...
	}
	
	option = {
		trigger = {
			FROM = {
				has_character_flag = ci_unable_to_pick_side
			}
		}
		
		name = EVTOPTD_SOH_4996 # Unsurprising...
	}
}

# Ping liege
character_event = {
	id = soh.4997
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		clr_character_flag = ci_challenge_is_diplomacy
		clr_character_flag = ci_challenge_is_martial
		clr_character_flag = ci_challenge_is_stewardship
		clr_character_flag = ci_challenge_is_intrigue
		clr_character_flag = ci_challenge_is_learning
		
		set_variable = {
			which = ci_challenge_score
			value = 0
		}
		
		# To the vassal!
		FROMFROM = {
			clr_character_flag = ci_skill_selection_option_2
			character_event = { id = soh.4998 }
		}
	}
}

# Vassal picks skill
character_event = {
	id = soh.4998
	desc = EVTDESC_SOH_4998
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTA_SOH_4998 # Diplomacy is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_diplomacy
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = diplomacy
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4999 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 25
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 20
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 15
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 10
			}
			
			mult_modifier = {
				factor = 0.1
				diplomacy < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTB_SOH_4998 # Martial is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_martial
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = martial
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4999 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				martial < 25
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 20
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 15
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 10
			}
			
			mult_modifier = {
				factor = 0.1
				martial < 5
			}
		}
	}
	
	option = {
		trigger = {
			NOT = {
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTC_SOH_4998 # Stewardship is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_stewardship
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = stewardship
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4999 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				stewardship < 25
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 20
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 15
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 10
			}
			
			mult_modifier = {
				factor = 0.1
				stewardship < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTD_SOH_4998 # Intrigue is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_intrigue
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = intrigue
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4999 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				intrigue < 25
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 20
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 15
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 10
			}
			
			mult_modifier = {
				factor = 0.1
				intrigue < 5
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				ai = yes
				has_character_flag = ci_skill_selection_option_2
			}
		}
		
		name = EVTOPTE_SOH_4998 # Learning is the right choice!
		
		FROM = {
			set_character_flag = ci_challenge_is_learning
			
			hidden_tooltip = {
				ROOT = {
					export_to_variable = {
						which = ci_challenge_score
						value = learning
					}
				}
				
				change_variable = {
					which = ci_challenge_score
					which = ROOT
				}
			}
			
			character_event = { id = soh.4999 }
		}
		
		ai_chance = {
			factor = 1000
			
			mult_modifier = {
				factor = 0.1
				learning < 25
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 20
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 15
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 10
			}
			
			mult_modifier = {
				factor = 0.1
				learning < 5
			}
		}
	}
	
	option = {
		trigger = {
			ai = no
		}
		
		name = EVTOPTF_SOH_4998 # Maybe something else...
		
		if = {
			limit = {
				NOT = {
					has_character_flag = ci_skill_selection_option_2
				}
			}
			
			set_character_flag = ci_skill_selection_option_2
		}
		
		else = {
			clr_character_flag = ci_skill_selection_option_2
		}
		
		repeat_event = { id = soh.4998 }
	}
}

# Ping liege to get courtiers' score
character_event = {
	id = soh.4999
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			ROOT = {
				trigger_switch = {
					on_trigger = has_character_flag
					
					ci_challenge_is_diplomacy = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_martial = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_stewardship = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_intrigue = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
					
					ci_challenge_is_learning = {
						PREV = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = ROOT
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							multiply_variable = {
								which = ci_challenge_score
								value = -1
							}
							
							ROOT = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
		
		# Finally inform the relevant vassals
		set_variable = {
			which = divisor
			value = 0
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			# A bit clunky, but...
			ROOT = {
				change_variable = {
					which = divisor
					value = 1
				}
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5000 }
		}
		
		# And fire the follow-up for ROOT
		character_event = { id = soh.5001 days = 15 random = 30 }
	}
}

# Relevant vassals informed of challenge skill
character_event = {
	id = soh.5000
	
	desc = {
		text = EVTDESC_SOH_5000_A
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_diplomacy
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_5000_B
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_martial
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_5000_C
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_stewardship
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_5000_D
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_intrigue
			}
		}
	}
	
	desc = {
		text = EVTDESC_SOH_5000_E
		trigger = {
			FROM = {
				has_character_flag = ci_challenge_is_learning
			}
		}
	}
	
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue >= 20
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					intrigue >= 20
				}
			}
		}
		
		name = EVTOPTA_SOH_5000 # Child's play!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 20
					diplomacy >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 20
					martial >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 20
					stewardship >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 20
					intrigue >= 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 20
					learning >= 10
				}
			}
		}
		
		name = EVTOPTB_SOH_5000 # Challenge accepted!
	}
	
	option = {
		trigger = {
			OR = {
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_diplomacy
					}
					diplomacy < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_martial
					}
					martial < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_stewardship
					}
					stewardship < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_intrigue
					}
					intrigue < 10
				}
				AND = {
					FROM = {
						has_character_flag = ci_challenge_is_learning
					}
					learning < 10
				}
			}
		}
		
		name = EVTOPTC_SOH_5000 # This will be difficult...
	}
	
	after = {
		FROM = {
			trigger_switch = {
				on_trigger = has_character_flag
				
				ci_challenge_is_diplomacy = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = diplomacy
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_martial = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = martial
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_stewardship = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = stewardship
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_intrigue = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = intrigue
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
				
				ci_challenge_is_learning = {
					ROOT = {
						hidden_tooltip = {
							export_to_variable = {
								which = ci_challenge_score
								value = learning
							}
							
							set_variable = {
								which = divisor
								which = FROM
							}
							
							divide_variable = {
								which = ci_challenge_score
								which = divisor
							}
							
							FROM = {
								change_variable = {
									which = ci_challenge_score
									which = PREV
								}
							}
						}
					}
				}
			}
		}
	}
}

# Ping liege, check if scheming was successful
character_event = {
	id = soh.5001
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			government = chinese_imperial_government
			government = eastern_imperial_government
		}
	}
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_opposing_both_sides
			}
			
			# See how good we are at scheming comparing to the winning side's score
			set_variable = {
				which = ci_scheme_target
				which = ci_challenge_score
			}
			
			if = {
				limit = {
					check_variable = {
						which = ci_challenge_score
						value >= 0
					}
				}
				
				multiply_variable = {
					which = ci_scheme_target
					value = -1
				}
			}
			
			export_to_variable = {
				which = ci_intrigue
				value = intrigue
			}
			
			divide_variable = {
				which = ci_intrigue
				value = 2
			}
			
			change_variable = {
				which = ci_scheme_target
				which = ci_intrigue
			}
			
			if = {
				limit = {
					intrigue >= 20
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				character_event = { id = soh.5002 } # Successful scheming
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					75 = {
						character_event = { id = soh.5002 } # Successful scheming
					}
					
					25 = {
						character_event = { id = soh.5006 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					50 = {
						character_event = { id = soh.5002 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.5006 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 15
					check_variable = {
						which = ci_scheme_target
						value < 10
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.5002 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.5006 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				random_list = {
					50 = {
						character_event = { id = soh.5002 } # Successful scheming
					}
					
					50 = {
						character_event = { id = soh.5006 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					intrigue >= 10
					check_variable = {
						which = ci_scheme_target
						value < 5
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.5002 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.5006 } # Failed scheming
					}
				}
			}
			
			else_if = {
				limit = {
					check_variable = {
						which = ci_scheme_target
						value < 0
					}
				}
				
				random_list = {
					25 = {
						character_event = { id = soh.5002 } # Successful scheming
					}
					
					75 = {
						character_event = { id = soh.5006 } # Failed scheming
					}
				}
			}
			
			else = {
				character_event = { id = soh.5006 } # Failed scheming
			}
		}
		
		else = {
			# No scheming attempted
			character_event = { id = soh.5010 }
		}
	}
}

# Scheming liege successful - liege
character_event = {
	id = soh.5002
	desc = EVTDESC_SOH_5002
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5002 # Just as planned!
		
		prestige = 1000
		
		hidden_tooltip = {
			mandate_boost_medium_effect = yes
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
			
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
		}
		
		event_target:vassal_challenger = {
			character_event = { id = soh.5003 }
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = event_target:vassal_challenger
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5004 }
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			prestige = -100
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.5005 }
		}
	}
}

# Scheming liege successful - challenger
character_event = {
	id = soh.5003
	desc = EVTDESC_SOH_5003
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5003 # I did NOT see that coming!
		
		prestige = -500
	}
}

# Scheming liege successful - relevant vassals
character_event = {
	id = soh.5004
	desc = EVTDESC_SOH_5004
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5004 # I did NOT see that coming!
		
		prestige = -100
	}
}

# Scheming liege successful - others
character_event = {
	id = soh.5005
	desc = EVTDESC_SOH_5005
	picture = GFX_evt_china_golden_age
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5005 # Interesting...
	}
}

# Scheming liege failed - liege
character_event = {
	id = soh.5006
	desc = EVTDESC_SOH_5006
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5006 # That wasn't the plan!
		
		set_council_malcontent = yes
		
		prestige = -1000
		
		hidden_tooltip = {
			mandate_penalty_medium_effect = yes
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			prestige = 100
		}
		
		event_target:vassal_challenger = {
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.5007 }
		}
		any_vassal = {
			limit = {
				NOT = {
					character = event_target:vassal_challenger
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			opinion = {
				who = ROOT
				modifier = opinion_uppity_liege
				months = 60
			}
			
			character_event = { id = soh.5008 }
		}
		
		any_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				is_council_eunuch_trigger = no
				NAND = {
					dynasty = ROOT
					any_close_relative = {
						character = ROOT
					}
				}
				OR = {
					is_voter = yes
					any_spouse = {
						character = ROOT
					}
					any_consort = {
						character = ROOT
					}
					any_child = {
						character = ROOT
					}
					any_child_even_if_dead = {
						any_child = {
							character = ROOT
						}
					}
				}
			}
			
			prestige = 100
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.5009 }
		}
	}
}

# Scheming liege failed - challenger
character_event = {
	id = soh.5007
	desc = EVTDESC_SOH_5007
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5007 # Someone is getting dangerous ideas...
		
		prestige = 500
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - relevant vassals
character_event = {
	id = soh.5008
	desc = EVTDESC_SOH_5008
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5008 # Someone is getting dangerous ideas...
		
		prestige = 100
		
		opinion = {
			who = FROM
			modifier = opinion_uppity_liege
			months = 60
		}
	}
}

# Scheming liege failed - others
character_event = {
	id = soh.5009
	desc = EVTDESC_SOH_5009
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5009 # How curious...
	}
}

# Ping liege to calculate outcome (not if successful scheming)
character_event = {
	id = soh.5010
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = 2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = 1
					}
				}
			}
		}
		
		else_if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			random_list = {
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 20
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 20
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -10
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						OR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue <= 10
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning >= 10
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -5
					}
				}
				
				25 = {
					change_variable = {
						which = ci_challenge_score
						value = -2
					}
				}
				
				25 = {
					mult_modifier = {
						factor = 2
						NOR = {
							AND = {
								has_character_flag = ci_challenge_is_diplomacy
								diplomacy >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_martial
								martial >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_stewardship
								stewardship >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_intrigue
								intrigue >= 5
							}
							AND = {
								has_character_flag = ci_challenge_is_learning
								learning <= 5
							}
						}
					}
					
					change_variable = {
						which = ci_challenge_score
						value = -1
					}
				}
			}
		}
		
		random_list = {
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value >= -20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value >= 15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value >= 5
					}
				}
				
				if = {
					limit = {
						event_target:vassal_challenger = {
							is_alive = yes
							liege = {
								character = ROOT
							}
						}
					}
					
					event_target:vassal_challenger = {
						character_event = { id = soh.5011 } # Select outcome
					}
				}
				
				else = {
					character_event = { id = soh.5012 } # Fallback
				}
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value <= 20
					}
				}
				
				mult_modifier = {
					factor = 5
					check_variable = {
						which = ci_challenge_score
						value <= -15
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				mult_modifier = {
					factor = 2
					check_variable = {
						which = ci_challenge_score
						value <= -5
					}
				}
				
				character_event = { id = soh.5018 } # Ping
			}
			
			50 = {
				trigger = {
					check_variable = {
						which = ci_challenge_score
						value < 25
					}
					check_variable = {
						which = ci_challenge_score
						value > -25
					}
				}
				
				mult_modifier = {
					factor = 0.1
					has_character_flag = ci_opposing_both_sides
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value >= 10
					}
				}
				
				mult_modifier = {
					factor = 0.1
					check_variable = {
						which = ci_challenge_score
						value <= -10
					}
				}
				
				character_event = { id = soh.5062 } # Inconclusive struggle - liege
			}
		}
	}
}

# Vassals won - challenger
character_event = {
	id = soh.5011
	desc = EVTDESC_SOH_5011
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					NOT = {
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTA_SOH_5011 # I will increase my own power!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.5015 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = humble
			}
			
			mult_modifier = {
				factor = 0.1
				trait = content
			}
		}
	}
	
	option = {
		trigger = {
			FROM = {
				primary_title = {
					OR = {
						NOT = {
							has_law = ci_courtier_law_0
						}
						has_law = ci_vassal_law_4
					}
				}
			}
		}
		
		name = EVTOPTB_SOH_5011 # I will weaken the courtiers!
		
		prestige = 1000
		
		FROM = {
			character_event = { id = soh.5012 } # Inform liege
		}
		
		ai_chance = {
			factor = 100
			
			mult_modifier = {
				factor = 0.1
				trait = proud
			}
			
			mult_modifier = {
				factor = 0.1
				trait = ambitious
			}
		}
	}
}

# Courtiers weakened - liege
character_event = {
	id = soh.5012
	desc = EVTDESC_SOH_5012
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5012 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
				FROM = {
					NOT = {
						character = ROOT # This could be a fallback...
					}
				}
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_4 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_0 }
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5013 } # Inform vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = FROM
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.5014 } # Inform vassals
		}
	}
}

# Courtiers weakened - relevant vassals
character_event = {
	id = soh.5013
	desc = EVTDESC_SOH_5013
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5013 # I see...
		
		prestige = 100
	}
}

# Courtiers weakened - others
character_event = {
	id = soh.5014
	desc = EVTDESC_SOH_5014
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5014 # I see...
	}
}

# Vassals grow stronger - liege
character_event = {
	id = soh.5015
	desc = EVTDESC_SOH_5015
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5015 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenged
			}
			
			prestige = -500
			
			FROM = {
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_0 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_4 }
			}
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = FROM
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5016 } # Inform vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = FROM
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.5017 } # Inform vassals
		}
	}
}

# Vassals grow stronger - relevant vassals
character_event = {
	id = soh.5016
	desc = EVTDESC_SOH_5016
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5016 # I see...
		
		prestige = 100
	}
}

# Vassals grow stronger - others
character_event = {
	id = soh.5017
	desc = EVTDESC_SOH_5017
	picture = GFX_evt_china_diplomatic_success
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5017 # I see...
	}
}

# Hidden ping if vassals lost
character_event = {
	id = soh.5018
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_courtier_law_0
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.5023 } # Grow stronger
			}
		}
		
		else_if = {
			limit = {
				FROM = {
					primary_title = {
						has_law = ci_vassal_law_4
					}
				}
			}
			
			FROM = {
				character_event = { id = soh.5019 } # Weaken vassals
			}
		}
		
		else = {
			random_list = {
				50 = {
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_4
							}
						}
					}
					
					mult_modifier = {
						factor = 5
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_3
							}
						}
					}
					
					mult_modifier = {
						factor = 2
						FROM = {
							primary_title = {
								has_law = ci_vassal_law_2
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.5019 } # Weaken vassals
					}
				}
				
				50 = {
					mult_modifier = {
						factor = 100
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_0
							}
						}
					}
					
					mult_modifier = {
						factor = 10
						FROM = {
							primary_title = {
								has_law = ci_courtier_law_1
							}
						}
					}
					
					FROM = {
						character_event = { id = soh.5023 } # Grow stronger
					}
				}
			}
		}
	}
}

# Courtiers weakened vassals - liege
character_event = {
	id = soh.5019
	desc = EVTDESC_SOH_5019
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5019 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_vassal_law_4 = { add_law = ci_vassal_law_3 }
				ci_vassal_law_3 = { add_law = ci_vassal_law_2 }
				ci_vassal_law_2 = { add_law = ci_vassal_law_1 }
				ci_vassal_law_1 = { add_law = ci_vassal_law_0 }
			}
		}
		
		event_target:vassal_challenger = {
			character_event = { id = soh.5020 } # Inform challenger
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = event_target:vassal_challenger
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5021 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.5022 } # Inform vassals
		}
	}
}

# Courtiers weakened vassals - challenger
character_event = {
	id = soh.5020
	desc = EVTDESC_SOH_5020
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5020 # I see...
		
		prestige = -1000
	}
}

# Courtiers weakened vassals - relevant vassals
character_event = {
	id = soh.5021
	desc = EVTDESC_SOH_5021
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5021 # Curses!
		
		prestige = -100
	}
}

# Courtiers weakened vassals - others
character_event = {
	id = soh.5022
	desc = EVTDESC_SOH_5022
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5022 # Interesting...
	}
}

# Courtiers grow stronger - liege
character_event = {
	id = soh.5023
	desc = EVTDESC_SOH_5023
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5023 # I see...
		
		if = {
			limit = {
				has_character_flag = ci_supporting_challenger
			}
			
			prestige = -500
			
			any_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					is_council_eunuch_trigger = no
					NAND = {
						dynasty = ROOT
						any_close_relative = {
							character = ROOT
						}
					}
					OR = {
						is_voter = yes
						any_spouse = {
							character = ROOT
						}
						any_consort = {
							character = ROOT
						}
						any_child = {
							character = ROOT
						}
						any_child_even_if_dead = {
							any_child = {
								character = ROOT
							}
						}
					}
				}
				
				opinion = {
					who = ROOT
					modifier = opinion_opposed_victory
				}
			}
		}
		
		primary_title = {
			trigger_switch = {
				on_trigger = has_law
				
				ci_courtier_law_0 = { add_law = ci_courtier_law_1 }
				ci_courtier_law_1 = { add_law = ci_courtier_law_2 }
				ci_courtier_law_2 = { add_law = ci_courtier_law_3 }
				ci_courtier_law_3 = { add_law = ci_courtier_law_4 }
			}
		}
		
		event_target:vassal_challenger = {
			character_event = { id = soh.5024 } # Inform challenger
		}
		
		any_vassal = {
			limit = {
				NOT = {
					character = event_target:vassal_challenger
				}
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5025 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOR = {
					character = event_target:vassal_challenger
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
						liege = {
							character = ROOT
						}
					}
				}
			}
			
			character_event = { id = soh.5026 } # Inform vassals
		}
	}
}

# Courtiers grow stronger - challenger
character_event = {
	id = soh.5024
	desc = EVTDESC_SOH_5024
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5024 # I see...
		
		prestige = -1000
	}
}

# Courtiers grow stronger - relevant vassals
character_event = {
	id = soh.5025
	desc = EVTDESC_SOH_5025
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5025 # Curses!
		
		prestige = -100
	}
}

# Courtiers grow stronger - others
character_event = {
	id = soh.5026
	desc = EVTDESC_SOH_5026
	picture = GFX_evt_chinese_bureaucrat
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5026 # Interesting...
	}
}



##### Inconclusive end to struggles

### Eunuchs vs. GC ended inconclusive

# Inform liege
character_event = {
	id = soh.5027
	desc = EVTDESC_SOH_5027
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5027 # Perhaps that is for the best...
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.5028 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.5029 } # Inform relevant players
		}
	}
}

# Inform GC
character_event = {
	id = soh.5028
	desc = EVTDESC_SOH_5028
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5028 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5029
	desc = EVTDESC_SOH_5029
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5029 # Interesting...
	}
}

### Eunuchs vs. courtiers inconclusive

# Inform liege
character_event = {
	id = soh.5030
	desc = EVTDESC_SOH_5030
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5030 # Perhaps that is for the best...
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.5031 } # Inform relevant players
		}
	}
}

# Inform vassals
character_event = {
	id = soh.5031
	desc = EVTDESC_SOH_5031
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5031 # Interesting...
	}
}

### Eunuchs vs. vassals inconclusive

# Inform liege
character_event = {
	id = soh.5032
	desc = EVTDESC_SOH_5032
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5032 # Perhaps that is for the best...
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5033 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5034 } # Inform relevant players
		}
	}
}

# Inform relevant vassals
character_event = {
	id = soh.5033
	desc = EVTDESC_SOH_5033
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5033 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5034
	desc = EVTDESC_SOH_5034
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5034 # Interesting...
	}
}

### GC vs. eunuchs inconclusive

# Inform liege
character_event = {
	id = soh.5035
	desc = EVTDESC_SOH_5035
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5035 # Perhaps that is for the best...
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.5036 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.5037 } # Inform relevant players
		}
	}
}

# Inform GC
character_event = {
	id = soh.5036
	desc = EVTDESC_SOH_5036
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5036 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5037
	desc = EVTDESC_SOH_5037
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5037 # Interesting...
	}
}

### GC vs. courtiers inconclusive

# Inform liege
character_event = {
	id = soh.5038
	desc = EVTDESC_SOH_5038
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5038 # Perhaps that is for the best...
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.5039 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.5040 } # Inform relevant players
		}
	}
}

# Inform GC
character_event = {
	id = soh.5039
	desc = EVTDESC_SOH_5039
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5039 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5040
	desc = EVTDESC_SOH_5040
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5040 # Interesting...
	}
}

### GC vs. vassals inconclusive

# Inform liege
character_event = {
	id = soh.5041
	desc = EVTDESC_SOH_5041
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5041 # Perhaps that is for the best...
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.5042 } # Inform GC
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.5043 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5044 } # Inform relevant players
		}
	}
}

# Inform GC
character_event = {
	id = soh.5042
	desc = EVTDESC_SOH_5042
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5042 # I suppose I can live with that...
	}
}

# Inform relevant vassals
character_event = {
	id = soh.5043
	desc = EVTDESC_SOH_5043
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5043 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5044
	desc = EVTDESC_SOH_5044
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5044 # Interesting...
	}
}

### Courtiers vs. eunuchs inconclusive

# Inform liege
character_event = {
	id = soh.5045
	desc = EVTDESC_SOH_5045
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5045 # Perhaps that is for the best...
		
		any_realm_lord = {
			limit = {
				ai = no
			}
			
			character_event = { id = soh.5046 } # Inform relevant players
		}
	}
}

# Inform vassals
character_event = {
	id = soh.5046
	desc = EVTDESC_SOH_5046
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5046 # Interesting...
	}
}

### Courtiers vs. GC inconclusive

# Inform liege
character_event = {
	id = soh.5047
	desc = EVTDESC_SOH_5047
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5047 # Perhaps that is for the best...
		
		any_voter = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.5048 } # Inform GC
		}
		
		any_realm_lord = {
			limit = {
				ai = no
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.5049 } # Inform relevant players
		}
	}
}

# Inform GC
character_event = {
	id = soh.5048
	desc = EVTDESC_SOH_5048
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5048 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5049
	desc = EVTDESC_SOH_5049
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5049 # Interesting...
	}
}

### Courtiers vs. vassals inconclusive

# Inform liege
character_event = {
	id = soh.5050
	desc = EVTDESC_SOH_5050
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5050 # Perhaps that is for the best...
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5051 } # Inform relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5052 } # Inform relevant players
		}
	}
}

# Inform relevant vassals
character_event = {
	id = soh.5051
	desc = EVTDESC_SOH_5051
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5051 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5052
	desc = EVTDESC_SOH_5052
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5052 # Interesting...
	}
}

### Vassals vs. eunuchs inconclusive

# Inform liege
character_event = {
	id = soh.5053
	desc = EVTDESC_SOH_5053
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5053 # Perhaps that is for the best...
		
		any_vassal = {
			limit = {
				character = event_target:vassal_challenger
			}
			
			character_event = { id = soh.5054 } # Inform challenger
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5055 } # Inform other relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5056 } # Inform relevant players
		}
	}
}

# Inform challenger
character_event = {
	id = soh.5054
	desc = EVTDESC_SOH_5054
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5054 # I suppose I can live with that...
	}
}

# Inform other relevant vassals
character_event = {
	id = soh.5055
	desc = EVTDESC_SOH_5055
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5055 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5056
	desc = EVTDESC_SOH_5056
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5056 # Interesting...
	}
}

### Vassals vs. GC inconclusive

# Inform liege
character_event = {
	id = soh.5057
	desc = EVTDESC_SOH_5057
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5057 # Perhaps that is for the best...
		
		any_vassal = {
			limit = {
				character = event_target:vassal_challenger
			}
			
			character_event = { id = soh.5058 } # Inform challenger
		}
		
		any_vassal = {
			limit = {
				has_minor_title = title_grand_chancellor
			}
			
			character_event = { id = soh.5059 } # Inform other relevant vassals
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
				NOT = {
					has_minor_title = title_grand_chancellor
				}
			}
			
			character_event = { id = soh.5060 } # Inform other relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5061 } # Inform relevant players
		}
	}
}

# Inform challenger
character_event = {
	id = soh.5058
	desc = EVTDESC_SOH_5058
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5058 # I suppose I can live with that...
	}
}

# Inform GC
character_event = {
	id = soh.5059
	desc = EVTDESC_SOH_5059
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5059 # I suppose I can live with that...
	}
}

# Inform other relevant vassals
character_event = {
	id = soh.5060
	desc = EVTDESC_SOH_5060
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5060 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5061
	desc = EVTDESC_SOH_5061
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5061 # Interesting...
	}
}

### Vassals vs. courtiers inconclusive

# Inform liege
character_event = {
	id = soh.5062
	desc = EVTDESC_SOH_5062
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5062 # Perhaps that is for the best...
		
		any_vassal = {
			limit = {
				character = event_target:vassal_challenger
			}
			
			character_event = { id = soh.5063 } # Inform challenger
		}
		
		any_vassal = {
			limit = {
				OR = {
					is_voter = yes
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5064 } # Inform other relevant vassals
		}
		
		any_realm_lord = {
			limit = {
				NOR = {
					AND = {
						is_voter = yes
						liege = {
							character = ROOT
						}
					}
					AND = {
						is_powerful_vassal = yes
						has_regent = no
					}
				}
			}
			
			character_event = { id = soh.5065 } # Inform relevant players
		}
	}
}

# Inform challenger
character_event = {
	id = soh.5063
	desc = EVTDESC_SOH_5063
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5063 # I suppose I can live with that...
	}
}

# Inform other relevant vassals
character_event = {
	id = soh.5064
	desc = EVTDESC_SOH_5064
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5064 # I suppose I can live with that...
	}
}

# Inform other vassals
character_event = {
	id = soh.5065
	desc = EVTDESC_SOH_5065
	picture = GFX_evt_china_diplomatic_incident
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SOH_5065 # Interesting...
	}
}